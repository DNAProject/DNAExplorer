if (!Function.prototype.bind) { Function.prototype.bind = function (a) { if (typeof this !== "function") { throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable") } var e = Array.prototype.slice.call(arguments, 1), d = this, b = function () { }, c = function () { return d.apply(this instanceof b ? this : a, e.concat(Array.prototype.slice.call(arguments))) }; b.prototype = this.prototype; c.prototype = new b(); return c } }
/*! jQuery v1.12.4 | (c) jQuery Foundation | jquery.org/license */
; !function (d, c) { "object" == typeof module && "object" == typeof module.exports ? module.exports = d.document ? c(d, !0) : function (b) { if (!b.document) { throw new Error("jQuery requires a window with a document") } return c(b) } : c(d) }("undefined" != typeof window ? window : this, function (a, b) { var c = [], d = a.document, e = c.slice, f = c.concat, g = c.push, h = c.indexOf, i = {}, j = i.toString, k = i.hasOwnProperty, l = {}, m = "1.12.4", n = function (a, b) { return new n.fn.init(a, b) }, o = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g, p = /^-ms-/, q = /-([\da-z])/gi, r = function (a, b) { return b.toUpperCase() }; n.fn = n.prototype = { jquery: m, constructor: n, selector: "", length: 0, toArray: function () { return e.call(this) }, get: function (a) { return null != a ? 0 > a ? this[a + this.length] : this[a] : e.call(this) }, pushStack: function (a) { var b = n.merge(this.constructor(), a); return b.prevObject = this, b.context = this.context, b }, each: function (a) { return n.each(this, a) }, map: function (a) { return this.pushStack(n.map(this, function (b, c) { return a.call(b, c, b) })) }, slice: function () { return this.pushStack(e.apply(this, arguments)) }, first: function () { return this.eq(0) }, last: function () { return this.eq(-1) }, eq: function (a) { var b = this.length, c = +a + (0 > a ? b : 0); return this.pushStack(c >= 0 && b > c ? [this[c]] : []) }, end: function () { return this.prevObject || this.constructor() }, push: g, sort: c.sort, splice: c.splice }, n.extend = n.fn.extend = function () { var a, b, c, d, e, f, g = arguments[0] || {}, h = 1, i = arguments.length, j = !1; for ("boolean" == typeof g && (j = g, g = arguments[h] || {}, h++), "object" == typeof g || n.isFunction(g) || (g = {}), h === i && (g = this, h--); i > h; h++) { if (null != (e = arguments[h])) { for (d in e) { a = g[d], c = e[d], g !== c && (j && c && (n.isPlainObject(c) || (b = n.isArray(c))) ? (b ? (b = !1, f = a && n.isArray(a) ? a : []) : f = a && n.isPlainObject(a) ? a : {}, g[d] = n.extend(j, f, c)) : void 0 !== c && (g[d] = c)) } } } return g }, n.extend({ expando: "jQuery" + (m + Math.random()).replace(/\D/g, ""), isReady: !0, error: function (a) { throw new Error(a) }, noop: function () { }, isFunction: function (a) { return "function" === n.type(a) }, isArray: Array.isArray || function (a) { return "array" === n.type(a) }, isWindow: function (a) { return null != a && a == a.window }, isNumeric: function (a) { var b = a && a.toString(); return !n.isArray(a) && b - parseFloat(b) + 1 >= 0 }, isEmptyObject: function (a) { var b; for (b in a) { return !1 } return !0 }, isPlainObject: function (a) { var b; if (!a || "object" !== n.type(a) || a.nodeType || n.isWindow(a)) { return !1 } try { if (a.constructor && !k.call(a, "constructor") && !k.call(a.constructor.prototype, "isPrototypeOf")) { return !1 } } catch (c) { return !1 } if (!l.ownFirst) { for (b in a) { return k.call(a, b) } } for (b in a) { } return void 0 === b || k.call(a, b) }, type: function (a) { return null == a ? a + "" : "object" == typeof a || "function" == typeof a ? i[j.call(a)] || "object" : typeof a }, globalEval: function (b) { b && n.trim(b) && (a.execScript || function (b) { a.eval.call(a, b) })(b) }, camelCase: function (a) { return a.replace(p, "ms-").replace(q, r) }, nodeName: function (a, b) { return a.nodeName && a.nodeName.toLowerCase() === b.toLowerCase() }, each: function (a, b) { var c, d = 0; if (s(a)) { for (c = a.length; c > d; d++) { if (b.call(a[d], d, a[d]) === !1) { break } } } else { for (d in a) { if (b.call(a[d], d, a[d]) === !1) { break } } } return a }, trim: function (a) { return null == a ? "" : (a + "").replace(o, "") }, makeArray: function (a, b) { var c = b || []; return null != a && (s(Object(a)) ? n.merge(c, "string" == typeof a ? [a] : a) : g.call(c, a)), c }, inArray: function (a, b, c) { var d; if (b) { if (h) { return h.call(b, a, c) } for (d = b.length, c = c ? 0 > c ? Math.max(0, d + c) : c : 0; d > c; c++) { if (c in b && b[c] === a) { return c } } } return -1 }, merge: function (a, b) { var c = +b.length, d = 0, e = a.length; while (c > d) { a[e++] = b[d++] } if (c !== c) { while (void 0 !== b[d]) { a[e++] = b[d++] } } return a.length = e, a }, grep: function (a, b, c) { for (var d, e = [], f = 0, g = a.length, h = !c; g > f; f++) { d = !b(a[f], f), d !== h && e.push(a[f]) } return e }, map: function (a, b, c) { var d, e, g = 0, h = []; if (s(a)) { for (d = a.length; d > g; g++) { e = b(a[g], g, c), null != e && h.push(e) } } else { for (g in a) { e = b(a[g], g, c), null != e && h.push(e) } } return f.apply([], h) }, guid: 1, proxy: function (a, b) { var c, d, f; return "string" == typeof b && (f = a[b], b = a, a = f), n.isFunction(a) ? (c = e.call(arguments, 2), d = function () { return a.apply(b || this, c.concat(e.call(arguments))) }, d.guid = a.guid = a.guid || n.guid++ , d) : void 0 }, now: function () { return +new Date }, support: l }), "function" == typeof Symbol && (n.fn[Symbol.iterator] = c[Symbol.iterator]), n.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "), function (a, b) { i["[object " + b + "]"] = b.toLowerCase() }); function s(a) { var b = !!a && "length" in a && a.length, c = n.type(a); return "function" === c || n.isWindow(a) ? !1 : "array" === c || 0 === b || "number" == typeof b && b > 0 && b - 1 in a } var t = function (a) { var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u = "sizzle" + 1 * new Date, v = a.document, w = 0, x = 0, y = ga(), z = ga(), A = ga(), B = function (a, b) { return a === b && (l = !0), 0 }, C = 1 << 31, D = {}.hasOwnProperty, E = [], F = E.pop, G = E.push, H = E.push, I = E.slice, J = function (a, b) { for (var c = 0, d = a.length; d > c; c++) { if (a[c] === b) { return c } } return -1 }, K = "checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped", L = "[\\x20\\t\\r\\n\\f]", M = "(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+", N = "\\[" + L + "*(" + M + ")(?:" + L + "*([*^$|!~]?=)" + L + "*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(" + M + "))|)" + L + "*\\]", O = ":(" + M + ")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|" + N + ")*)|.*)\\)|)", P = new RegExp(L + "+", "g"), Q = new RegExp("^" + L + "+|((?:^|[^\\\\])(?:\\\\.)*)" + L + "+$", "g"), R = new RegExp("^" + L + "*," + L + "*"), S = new RegExp("^" + L + "*([>+~]|" + L + ")" + L + "*"), T = new RegExp("=" + L + "*([^\\]'\"]*?)" + L + "*\\]", "g"), U = new RegExp(O), V = new RegExp("^" + M + "$"), W = { ID: new RegExp("^#(" + M + ")"), CLASS: new RegExp("^\\.(" + M + ")"), TAG: new RegExp("^(" + M + "|[*])"), ATTR: new RegExp("^" + N), PSEUDO: new RegExp("^" + O), CHILD: new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\(" + L + "*(even|odd|(([+-]|)(\\d*)n|)" + L + "*(?:([+-]|)" + L + "*(\\d+)|))" + L + "*\\)|)", "i"), bool: new RegExp("^(?:" + K + ")$", "i"), needsContext: new RegExp("^" + L + "*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(" + L + "*((?:-\\d)?\\d*)" + L + "*\\)|)(?=[^-]|$)", "i") }, X = /^(?:input|select|textarea|button)$/i, Y = /^h\d$/i, Z = /^[^{]+\{\s*\[native \w/, $ = /^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/, _ = /[+~]/, aa = /'|\\/g, ba = new RegExp("\\\\([\\da-f]{1,6}" + L + "?|(" + L + ")|.)", "ig"), ca = function (a, b, c) { var d = "0x" + b - 65536; return d !== d || c ? b : 0 > d ? String.fromCharCode(d + 65536) : String.fromCharCode(d >> 10 | 55296, 1023 & d | 56320) }, da = function () { m() }; try { H.apply(E = I.call(v.childNodes), v.childNodes), E[v.childNodes.length].nodeType } catch (ea) { H = { apply: E.length ? function (a, b) { G.apply(a, I.call(b)) } : function (a, b) { var c = a.length, d = 0; while (a[c++] = b[d++]) { } a.length = c - 1 } } } function fa(a, b, d, e) { var f, h, j, k, l, o, r, s, w = b && b.ownerDocument, x = b ? b.nodeType : 9; if (d = d || [], "string" != typeof a || !a || 1 !== x && 9 !== x && 11 !== x) { return d } if (!e && ((b ? b.ownerDocument || b : v) !== n && m(b), b = b || n, p)) { if (11 !== x && (o = $.exec(a))) { if (f = o[1]) { if (9 === x) { if (!(j = b.getElementById(f))) { return d } if (j.id === f) { return d.push(j), d } } else { if (w && (j = w.getElementById(f)) && t(b, j) && j.id === f) { return d.push(j), d } } } else { if (o[2]) { return H.apply(d, b.getElementsByTagName(a)), d } if ((f = o[3]) && c.getElementsByClassName && b.getElementsByClassName) { return H.apply(d, b.getElementsByClassName(f)), d } } } if (c.qsa && !A[a + " "] && (!q || !q.test(a))) { if (1 !== x) { w = b, s = a } else { if ("object" !== b.nodeName.toLowerCase()) { (k = b.getAttribute("id")) ? k = k.replace(aa, "\\$&") : b.setAttribute("id", k = u), r = g(a), h = r.length, l = V.test(k) ? "#" + k : "[id='" + k + "']"; while (h--) { r[h] = l + " " + qa(r[h]) } s = r.join(","), w = _.test(a) && oa(b.parentNode) || b } } if (s) { try { return H.apply(d, w.querySelectorAll(s)), d } catch (y) { } finally { k === u && b.removeAttribute("id") } } } } return i(a.replace(Q, "$1"), b, d, e) } function ga() { var a = []; function b(c, e) { return a.push(c + " ") > d.cacheLength && delete b[a.shift()], b[c + " "] = e } return b } function ha(a) { return a[u] = !0, a } function ia(a) { var b = n.createElement("div"); try { return !!a(b) } catch (c) { return !1 } finally { b.parentNode && b.parentNode.removeChild(b), b = null } } function ja(a, b) { var c = a.split("|"), e = c.length; while (e--) { d.attrHandle[c[e]] = b } } function ka(a, b) { var c = b && a, d = c && 1 === a.nodeType && 1 === b.nodeType && (~b.sourceIndex || C) - (~a.sourceIndex || C); if (d) { return d } if (c) { while (c = c.nextSibling) { if (c === b) { return -1 } } } return a ? 1 : -1 } function la(a) { return function (b) { var c = b.nodeName.toLowerCase(); return "input" === c && b.type === a } } function ma(a) { return function (b) { var c = b.nodeName.toLowerCase(); return ("input" === c || "button" === c) && b.type === a } } function na(a) { return ha(function (b) { return b = +b, ha(function (c, d) { var e, f = a([], c.length, b), g = f.length; while (g--) { c[e = f[g]] && (c[e] = !(d[e] = c[e])) } }) }) } function oa(a) { return a && "undefined" != typeof a.getElementsByTagName && a } c = fa.support = {}, f = fa.isXML = function (a) { var b = a && (a.ownerDocument || a).documentElement; return b ? "HTML" !== b.nodeName : !1 }, m = fa.setDocument = function (a) { var b, e, g = a ? a.ownerDocument || a : v; return g !== n && 9 === g.nodeType && g.documentElement ? (n = g, o = n.documentElement, p = !f(n), (e = n.defaultView) && e.top !== e && (e.addEventListener ? e.addEventListener("unload", da, !1) : e.attachEvent && e.attachEvent("onunload", da)), c.attributes = ia(function (a) { return a.className = "i", !a.getAttribute("className") }), c.getElementsByTagName = ia(function (a) { return a.appendChild(n.createComment("")), !a.getElementsByTagName("*").length }), c.getElementsByClassName = Z.test(n.getElementsByClassName), c.getById = ia(function (a) { return o.appendChild(a).id = u, !n.getElementsByName || !n.getElementsByName(u).length }), c.getById ? (d.find.ID = function (a, b) { if ("undefined" != typeof b.getElementById && p) { var c = b.getElementById(a); return c ? [c] : [] } }, d.filter.ID = function (a) { var b = a.replace(ba, ca); return function (a) { return a.getAttribute("id") === b } }) : (delete d.find.ID, d.filter.ID = function (a) { var b = a.replace(ba, ca); return function (a) { var c = "undefined" != typeof a.getAttributeNode && a.getAttributeNode("id"); return c && c.value === b } }), d.find.TAG = c.getElementsByTagName ? function (a, b) { return "undefined" != typeof b.getElementsByTagName ? b.getElementsByTagName(a) : c.qsa ? b.querySelectorAll(a) : void 0 } : function (a, b) { var c, d = [], e = 0, f = b.getElementsByTagName(a); if ("*" === a) { while (c = f[e++]) { 1 === c.nodeType && d.push(c) } return d } return f }, d.find.CLASS = c.getElementsByClassName && function (a, b) { return "undefined" != typeof b.getElementsByClassName && p ? b.getElementsByClassName(a) : void 0 }, r = [], q = [], (c.qsa = Z.test(n.querySelectorAll)) && (ia(function (a) { o.appendChild(a).innerHTML = "<a id='" + u + "'></a><select id='" + u + "-\r\\' msallowcapture=''><option selected=''></option></select>", a.querySelectorAll("[msallowcapture^='']").length && q.push("[*^$]=" + L + "*(?:''|\"\")"), a.querySelectorAll("[selected]").length || q.push("\\[" + L + "*(?:value|" + K + ")"), a.querySelectorAll("[id~=" + u + "-]").length || q.push("~="), a.querySelectorAll(":checked").length || q.push(":checked"), a.querySelectorAll("a#" + u + "+*").length || q.push(".#.+[+~]") }), ia(function (a) { var b = n.createElement("input"); b.setAttribute("type", "hidden"), a.appendChild(b).setAttribute("name", "D"), a.querySelectorAll("[name=d]").length && q.push("name" + L + "*[*^$|!~]?="), a.querySelectorAll(":enabled").length || q.push(":enabled", ":disabled"), a.querySelectorAll("*,:x"), q.push(",.*:") })), (c.matchesSelector = Z.test(s = o.matches || o.webkitMatchesSelector || o.mozMatchesSelector || o.oMatchesSelector || o.msMatchesSelector)) && ia(function (a) { c.disconnectedMatch = s.call(a, "div"), s.call(a, "[s!='']:x"), r.push("!=", O) }), q = q.length && new RegExp(q.join("|")), r = r.length && new RegExp(r.join("|")), b = Z.test(o.compareDocumentPosition), t = b || Z.test(o.contains) ? function (a, b) { var c = 9 === a.nodeType ? a.documentElement : a, d = b && b.parentNode; return a === d || !(!d || 1 !== d.nodeType || !(c.contains ? c.contains(d) : a.compareDocumentPosition && 16 & a.compareDocumentPosition(d))) } : function (a, b) { if (b) { while (b = b.parentNode) { if (b === a) { return !0 } } } return !1 }, B = b ? function (a, b) { if (a === b) { return l = !0, 0 } var d = !a.compareDocumentPosition - !b.compareDocumentPosition; return d ? d : (d = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1, 1 & d || !c.sortDetached && b.compareDocumentPosition(a) === d ? a === n || a.ownerDocument === v && t(v, a) ? -1 : b === n || b.ownerDocument === v && t(v, b) ? 1 : k ? J(k, a) - J(k, b) : 0 : 4 & d ? -1 : 1) } : function (a, b) { if (a === b) { return l = !0, 0 } var c, d = 0, e = a.parentNode, f = b.parentNode, g = [a], h = [b]; if (!e || !f) { return a === n ? -1 : b === n ? 1 : e ? -1 : f ? 1 : k ? J(k, a) - J(k, b) : 0 } if (e === f) { return ka(a, b) } c = a; while (c = c.parentNode) { g.unshift(c) } c = b; while (c = c.parentNode) { h.unshift(c) } while (g[d] === h[d]) { d++ } return d ? ka(g[d], h[d]) : g[d] === v ? -1 : h[d] === v ? 1 : 0 }, n) : n }, fa.matches = function (a, b) { return fa(a, null, null, b) }, fa.matchesSelector = function (a, b) { if ((a.ownerDocument || a) !== n && m(a), b = b.replace(T, "='$1']"), c.matchesSelector && p && !A[b + " "] && (!r || !r.test(b)) && (!q || !q.test(b))) { try { var d = s.call(a, b); if (d || c.disconnectedMatch || a.document && 11 !== a.document.nodeType) { return d } } catch (e) { } } return fa(b, n, null, [a]).length > 0 }, fa.contains = function (a, b) { return (a.ownerDocument || a) !== n && m(a), t(a, b) }, fa.attr = function (a, b) { (a.ownerDocument || a) !== n && m(a); var e = d.attrHandle[b.toLowerCase()], f = e && D.call(d.attrHandle, b.toLowerCase()) ? e(a, b, !p) : void 0; return void 0 !== f ? f : c.attributes || !p ? a.getAttribute(b) : (f = a.getAttributeNode(b)) && f.specified ? f.value : null }, fa.error = function (a) { throw new Error("Syntax error, unrecognized expression: " + a) }, fa.uniqueSort = function (a) { var b, d = [], e = 0, f = 0; if (l = !c.detectDuplicates, k = !c.sortStable && a.slice(0), a.sort(B), l) { while (b = a[f++]) { b === a[f] && (e = d.push(f)) } while (e--) { a.splice(d[e], 1) } } return k = null, a }, e = fa.getText = function (a) { var b, c = "", d = 0, f = a.nodeType; if (f) { if (1 === f || 9 === f || 11 === f) { if ("string" == typeof a.textContent) { return a.textContent } for (a = a.firstChild; a; a = a.nextSibling) { c += e(a) } } else { if (3 === f || 4 === f) { return a.nodeValue } } } else { while (b = a[d++]) { c += e(b) } } return c }, d = fa.selectors = { cacheLength: 50, createPseudo: ha, match: W, attrHandle: {}, find: {}, relative: { ">": { dir: "parentNode", first: !0 }, " ": { dir: "parentNode" }, "+": { dir: "previousSibling", first: !0 }, "~": { dir: "previousSibling" } }, preFilter: { ATTR: function (a) { return a[1] = a[1].replace(ba, ca), a[3] = (a[3] || a[4] || a[5] || "").replace(ba, ca), "~=" === a[2] && (a[3] = " " + a[3] + " "), a.slice(0, 4) }, CHILD: function (a) { return a[1] = a[1].toLowerCase(), "nth" === a[1].slice(0, 3) ? (a[3] || fa.error(a[0]), a[4] = +(a[4] ? a[5] + (a[6] || 1) : 2 * ("even" === a[3] || "odd" === a[3])), a[5] = +(a[7] + a[8] || "odd" === a[3])) : a[3] && fa.error(a[0]), a }, PSEUDO: function (a) { var b, c = !a[6] && a[2]; return W.CHILD.test(a[0]) ? null : (a[3] ? a[2] = a[4] || a[5] || "" : c && U.test(c) && (b = g(c, !0)) && (b = c.indexOf(")", c.length - b) - c.length) && (a[0] = a[0].slice(0, b), a[2] = c.slice(0, b)), a.slice(0, 3)) } }, filter: { TAG: function (a) { var b = a.replace(ba, ca).toLowerCase(); return "*" === a ? function () { return !0 } : function (a) { return a.nodeName && a.nodeName.toLowerCase() === b } }, CLASS: function (a) { var b = y[a + " "]; return b || (b = new RegExp("(^|" + L + ")" + a + "(" + L + "|$)")) && y(a, function (a) { return b.test("string" == typeof a.className && a.className || "undefined" != typeof a.getAttribute && a.getAttribute("class") || "") }) }, ATTR: function (a, b, c) { return function (d) { var e = fa.attr(d, a); return null == e ? "!=" === b : b ? (e += "", "=" === b ? e === c : "!=" === b ? e !== c : "^=" === b ? c && 0 === e.indexOf(c) : "*=" === b ? c && e.indexOf(c) > -1 : "$=" === b ? c && e.slice(-c.length) === c : "~=" === b ? (" " + e.replace(P, " ") + " ").indexOf(c) > -1 : "|=" === b ? e === c || e.slice(0, c.length + 1) === c + "-" : !1) : !0 } }, CHILD: function (a, b, c, d, e) { var f = "nth" !== a.slice(0, 3), g = "last" !== a.slice(-4), h = "of-type" === b; return 1 === d && 0 === e ? function (a) { return !!a.parentNode } : function (b, c, i) { var j, k, l, m, n, o, p = f !== g ? "nextSibling" : "previousSibling", q = b.parentNode, r = h && b.nodeName.toLowerCase(), s = !i && !h, t = !1; if (q) { if (f) { while (p) { m = b; while (m = m[p]) { if (h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) { return !1 } } o = p = "only" === a && !o && "nextSibling" } return !0 } if (o = [g ? q.firstChild : q.lastChild], g && s) { m = q, l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === w && j[1], t = n && j[2], m = n && q.childNodes[n]; while (m = ++n && m && m[p] || (t = n = 0) || o.pop()) { if (1 === m.nodeType && ++t && m === b) { k[a] = [w, n, t]; break } } } else { if (s && (m = b, l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), j = k[a] || [], n = j[0] === w && j[1], t = n), t === !1) { while (m = ++n && m && m[p] || (t = n = 0) || o.pop()) { if ((h ? m.nodeName.toLowerCase() === r : 1 === m.nodeType) && ++t && (s && (l = m[u] || (m[u] = {}), k = l[m.uniqueID] || (l[m.uniqueID] = {}), k[a] = [w, t]), m === b)) { break } } } } return t -= e, t === d || t % d === 0 && t / d >= 0 } } }, PSEUDO: function (a, b) { var c, e = d.pseudos[a] || d.setFilters[a.toLowerCase()] || fa.error("unsupported pseudo: " + a); return e[u] ? e(b) : e.length > 1 ? (c = [a, a, "", b], d.setFilters.hasOwnProperty(a.toLowerCase()) ? ha(function (a, c) { var d, f = e(a, b), g = f.length; while (g--) { d = J(a, f[g]), a[d] = !(c[d] = f[g]) } }) : function (a) { return e(a, 0, c) }) : e } }, pseudos: { not: ha(function (a) { var b = [], c = [], d = h(a.replace(Q, "$1")); return d[u] ? ha(function (a, b, c, e) { var f, g = d(a, null, e, []), h = a.length; while (h--) { (f = g[h]) && (a[h] = !(b[h] = f)) } }) : function (a, e, f) { return b[0] = a, d(b, null, f, c), b[0] = null, !c.pop() } }), has: ha(function (a) { return function (b) { return fa(a, b).length > 0 } }), contains: ha(function (a) { return a = a.replace(ba, ca), function (b) { return (b.textContent || b.innerText || e(b)).indexOf(a) > -1 } }), lang: ha(function (a) { return V.test(a || "") || fa.error("unsupported lang: " + a), a = a.replace(ba, ca).toLowerCase(), function (b) { var c; do { if (c = p ? b.lang : b.getAttribute("xml:lang") || b.getAttribute("lang")) { return c = c.toLowerCase(), c === a || 0 === c.indexOf(a + "-") } } while ((b = b.parentNode) && 1 === b.nodeType); return !1 } }), target: function (b) { var c = a.location && a.location.hash; return c && c.slice(1) === b.id }, root: function (a) { return a === o }, focus: function (a) { return a === n.activeElement && (!n.hasFocus || n.hasFocus()) && !!(a.type || a.href || ~a.tabIndex) }, enabled: function (a) { return a.disabled === !1 }, disabled: function (a) { return a.disabled === !0 }, checked: function (a) { var b = a.nodeName.toLowerCase(); return "input" === b && !!a.checked || "option" === b && !!a.selected }, selected: function (a) { return a.parentNode && a.parentNode.selectedIndex, a.selected === !0 }, empty: function (a) { for (a = a.firstChild; a; a = a.nextSibling) { if (a.nodeType < 6) { return !1 } } return !0 }, parent: function (a) { return !d.pseudos.empty(a) }, header: function (a) { return Y.test(a.nodeName) }, input: function (a) { return X.test(a.nodeName) }, button: function (a) { var b = a.nodeName.toLowerCase(); return "input" === b && "button" === a.type || "button" === b }, text: function (a) { var b; return "input" === a.nodeName.toLowerCase() && "text" === a.type && (null == (b = a.getAttribute("type")) || "text" === b.toLowerCase()) }, first: na(function () { return [0] }), last: na(function (a, b) { return [b - 1] }), eq: na(function (a, b, c) { return [0 > c ? c + b : c] }), even: na(function (a, b) { for (var c = 0; b > c; c += 2) { a.push(c) } return a }), odd: na(function (a, b) { for (var c = 1; b > c; c += 2) { a.push(c) } return a }), lt: na(function (a, b, c) { for (var d = 0 > c ? c + b : c; --d >= 0;) { a.push(d) } return a }), gt: na(function (a, b, c) { for (var d = 0 > c ? c + b : c; ++d < b;) { a.push(d) } return a }) } }, d.pseudos.nth = d.pseudos.eq; for (b in { radio: !0, checkbox: !0, file: !0, password: !0, image: !0 }) { d.pseudos[b] = la(b) } for (b in { submit: !0, reset: !0 }) { d.pseudos[b] = ma(b) } function pa() { } pa.prototype = d.filters = d.pseudos, d.setFilters = new pa, g = fa.tokenize = function (a, b) { var c, e, f, g, h, i, j, k = z[a + " "]; if (k) { return b ? 0 : k.slice(0) } h = a, i = [], j = d.preFilter; while (h) { c && !(e = R.exec(h)) || (e && (h = h.slice(e[0].length) || h), i.push(f = [])), c = !1, (e = S.exec(h)) && (c = e.shift(), f.push({ value: c, type: e[0].replace(Q, " ") }), h = h.slice(c.length)); for (g in d.filter) { !(e = W[g].exec(h)) || j[g] && !(e = j[g](e)) || (c = e.shift(), f.push({ value: c, type: g, matches: e }), h = h.slice(c.length)) } if (!c) { break } } return b ? h.length : h ? fa.error(a) : z(a, i).slice(0) }; function qa(a) { for (var b = 0, c = a.length, d = ""; c > b; b++) { d += a[b].value } return d } function ra(a, b, c) { var d = b.dir, e = c && "parentNode" === d, f = x++; return b.first ? function (b, c, f) { while (b = b[d]) { if (1 === b.nodeType || e) { return a(b, c, f) } } } : function (b, c, g) { var h, i, j, k = [w, f]; if (g) { while (b = b[d]) { if ((1 === b.nodeType || e) && a(b, c, g)) { return !0 } } } else { while (b = b[d]) { if (1 === b.nodeType || e) { if (j = b[u] || (b[u] = {}), i = j[b.uniqueID] || (j[b.uniqueID] = {}), (h = i[d]) && h[0] === w && h[1] === f) { return k[2] = h[2] } if (i[d] = k, k[2] = a(b, c, g)) { return !0 } } } } } } function sa(a) { return a.length > 1 ? function (b, c, d) { var e = a.length; while (e--) { if (!a[e](b, c, d)) { return !1 } } return !0 } : a[0] } function ta(a, b, c) { for (var d = 0, e = b.length; e > d; d++) { fa(a, b[d], c) } return c } function ua(a, b, c, d, e) { for (var f, g = [], h = 0, i = a.length, j = null != b; i > h; h++) { (f = a[h]) && (c && !c(f, d, e) || (g.push(f), j && b.push(h))) } return g } function va(a, b, c, d, e, f) { return d && !d[u] && (d = va(d)), e && !e[u] && (e = va(e, f)), ha(function (f, g, h, i) { var j, k, l, m = [], n = [], o = g.length, p = f || ta(b || "*", h.nodeType ? [h] : h, []), q = !a || !f && b ? p : ua(p, m, a, h, i), r = c ? e || (f ? a : o || d) ? [] : g : q; if (c && c(q, r, h, i), d) { j = ua(r, n), d(j, [], h, i), k = j.length; while (k--) { (l = j[k]) && (r[n[k]] = !(q[n[k]] = l)) } } if (f) { if (e || a) { if (e) { j = [], k = r.length; while (k--) { (l = r[k]) && j.push(q[k] = l) } e(null, r = [], j, i) } k = r.length; while (k--) { (l = r[k]) && (j = e ? J(f, l) : m[k]) > -1 && (f[j] = !(g[j] = l)) } } } else { r = ua(r === g ? r.splice(o, r.length) : r), e ? e(null, g, r, i) : H.apply(g, r) } }) } function wa(a) { for (var b, c, e, f = a.length, g = d.relative[a[0].type], h = g || d.relative[" "], i = g ? 1 : 0, k = ra(function (a) { return a === b }, h, !0), l = ra(function (a) { return J(b, a) > -1 }, h, !0), m = [function (a, c, d) { var e = !g && (d || c !== j) || ((b = c).nodeType ? k(a, c, d) : l(a, c, d)); return b = null, e }]; f > i; i++) { if (c = d.relative[a[i].type]) { m = [ra(sa(m), c)] } else { if (c = d.filter[a[i].type].apply(null, a[i].matches), c[u]) { for (e = ++i; f > e; e++) { if (d.relative[a[e].type]) { break } } return va(i > 1 && sa(m), i > 1 && qa(a.slice(0, i - 1).concat({ value: " " === a[i - 2].type ? "*" : "" })).replace(Q, "$1"), c, e > i && wa(a.slice(i, e)), f > e && wa(a = a.slice(e)), f > e && qa(a)) } m.push(c) } } return sa(m) } function xa(a, b) { var c = b.length > 0, e = a.length > 0, f = function (f, g, h, i, k) { var l, o, q, r = 0, s = "0", t = f && [], u = [], v = j, x = f || e && d.find.TAG("*", k), y = w += null == v ? 1 : Math.random() || 0.1, z = x.length; for (k && (j = g === n || g || k); s !== z && null != (l = x[s]); s++) { if (e && l) { o = 0, g || l.ownerDocument === n || (m(l), h = !p); while (q = a[o++]) { if (q(l, g || n, h)) { i.push(l); break } } k && (w = y) } c && ((l = !q && l) && r-- , f && t.push(l)) } if (r += s, c && s !== r) { o = 0; while (q = b[o++]) { q(t, u, g, h) } if (f) { if (r > 0) { while (s--) { t[s] || u[s] || (u[s] = F.call(i)) } } u = ua(u) } H.apply(i, u), k && !f && u.length > 0 && r + b.length > 1 && fa.uniqueSort(i) } return k && (w = y, j = v), t }; return c ? ha(f) : f } return h = fa.compile = function (a, b) { var c, d = [], e = [], f = A[a + " "]; if (!f) { b || (b = g(a)), c = b.length; while (c--) { f = wa(b[c]), f[u] ? d.push(f) : e.push(f) } f = A(a, xa(e, d)), f.selector = a } return f }, i = fa.select = function (a, b, e, f) { var i, j, k, l, m, n = "function" == typeof a && a, o = !f && g(a = n.selector || a); if (e = e || [], 1 === o.length) { if (j = o[0] = o[0].slice(0), j.length > 2 && "ID" === (k = j[0]).type && c.getById && 9 === b.nodeType && p && d.relative[j[1].type]) { if (b = (d.find.ID(k.matches[0].replace(ba, ca), b) || [])[0], !b) { return e } n && (b = b.parentNode), a = a.slice(j.shift().value.length) } i = W.needsContext.test(a) ? 0 : j.length; while (i--) { if (k = j[i], d.relative[l = k.type]) { break } if ((m = d.find[l]) && (f = m(k.matches[0].replace(ba, ca), _.test(j[0].type) && oa(b.parentNode) || b))) { if (j.splice(i, 1), a = f.length && qa(j), !a) { return H.apply(e, f), e } break } } } return (n || h(a, o))(f, b, !p, e, !b || _.test(a) && oa(b.parentNode) || b), e }, c.sortStable = u.split("").sort(B).join("") === u, c.detectDuplicates = !!l, m(), c.sortDetached = ia(function (a) { return 1 & a.compareDocumentPosition(n.createElement("div")) }), ia(function (a) { return a.innerHTML = "<a href='#'></a>", "#" === a.firstChild.getAttribute("href") }) || ja("type|href|height|width", function (a, b, c) { return c ? void 0 : a.getAttribute(b, "type" === b.toLowerCase() ? 1 : 2) }), c.attributes && ia(function (a) { return a.innerHTML = "<input/>", a.firstChild.setAttribute("value", ""), "" === a.firstChild.getAttribute("value") }) || ja("value", function (a, b, c) { return c || "input" !== a.nodeName.toLowerCase() ? void 0 : a.defaultValue }), ia(function (a) { return null == a.getAttribute("disabled") }) || ja(K, function (a, b, c) { var d; return c ? void 0 : a[b] === !0 ? b.toLowerCase() : (d = a.getAttributeNode(b)) && d.specified ? d.value : null }), fa }(a); n.find = t, n.expr = t.selectors, n.expr[":"] = n.expr.pseudos, n.uniqueSort = n.unique = t.uniqueSort, n.text = t.getText, n.isXMLDoc = t.isXML, n.contains = t.contains; var u = function (a, b, c) { var d = [], e = void 0 !== c; while ((a = a[b]) && 9 !== a.nodeType) { if (1 === a.nodeType) { if (e && n(a).is(c)) { break } d.push(a) } } return d }, v = function (a, b) { for (var c = []; a; a = a.nextSibling) { 1 === a.nodeType && a !== b && c.push(a) } return c }, w = n.expr.match.needsContext, x = /^<([\w-]+)\s*\/?>(?:<\/\1>|)$/, y = /^.[^:#\[\.,]*$/; function z(a, b, c) { if (n.isFunction(b)) { return n.grep(a, function (a, d) { return !!b.call(a, d, a) !== c }) } if (b.nodeType) { return n.grep(a, function (a) { return a === b !== c }) } if ("string" == typeof b) { if (y.test(b)) { return n.filter(b, a, c) } b = n.filter(b, a) } return n.grep(a, function (a) { return n.inArray(a, b) > -1 !== c }) } n.filter = function (a, b, c) { var d = b[0]; return c && (a = ":not(" + a + ")"), 1 === b.length && 1 === d.nodeType ? n.find.matchesSelector(d, a) ? [d] : [] : n.find.matches(a, n.grep(b, function (a) { return 1 === a.nodeType })) }, n.fn.extend({ find: function (a) { var b, c = [], d = this, e = d.length; if ("string" != typeof a) { return this.pushStack(n(a).filter(function () { for (b = 0; e > b; b++) { if (n.contains(d[b], this)) { return !0 } } })) } for (b = 0; e > b; b++) { n.find(a, d[b], c) } return c = this.pushStack(e > 1 ? n.unique(c) : c), c.selector = this.selector ? this.selector + " " + a : a, c }, filter: function (a) { return this.pushStack(z(this, a || [], !1)) }, not: function (a) { return this.pushStack(z(this, a || [], !0)) }, is: function (a) { return !!z(this, "string" == typeof a && w.test(a) ? n(a) : a || [], !1).length } }); var A, B = /^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/, C = n.fn.init = function (a, b, c) { var e, f; if (!a) { return this } if (c = c || A, "string" == typeof a) { if (e = "<" === a.charAt(0) && ">" === a.charAt(a.length - 1) && a.length >= 3 ? [null, a, null] : B.exec(a), !e || !e[1] && b) { return !b || b.jquery ? (b || c).find(a) : this.constructor(b).find(a) } if (e[1]) { if (b = b instanceof n ? b[0] : b, n.merge(this, n.parseHTML(e[1], b && b.nodeType ? b.ownerDocument || b : d, !0)), x.test(e[1]) && n.isPlainObject(b)) { for (e in b) { n.isFunction(this[e]) ? this[e](b[e]) : this.attr(e, b[e]) } } return this } if (f = d.getElementById(e[2]), f && f.parentNode) { if (f.id !== e[2]) { return A.find(a) } this.length = 1, this[0] = f } return this.context = d, this.selector = a, this } return a.nodeType ? (this.context = this[0] = a, this.length = 1, this) : n.isFunction(a) ? "undefined" != typeof c.ready ? c.ready(a) : a(n) : (void 0 !== a.selector && (this.selector = a.selector, this.context = a.context), n.makeArray(a, this)) }; C.prototype = n.fn, A = n(d); var D = /^(?:parents|prev(?:Until|All))/, E = { children: !0, contents: !0, next: !0, prev: !0 }; n.fn.extend({ has: function (a) { var b, c = n(a, this), d = c.length; return this.filter(function () { for (b = 0; d > b; b++) { if (n.contains(this, c[b])) { return !0 } } }) }, closest: function (a, b) { for (var c, d = 0, e = this.length, f = [], g = w.test(a) || "string" != typeof a ? n(a, b || this.context) : 0; e > d; d++) { for (c = this[d]; c && c !== b; c = c.parentNode) { if (c.nodeType < 11 && (g ? g.index(c) > -1 : 1 === c.nodeType && n.find.matchesSelector(c, a))) { f.push(c); break } } } return this.pushStack(f.length > 1 ? n.uniqueSort(f) : f) }, index: function (a) { return a ? "string" == typeof a ? n.inArray(this[0], n(a)) : n.inArray(a.jquery ? a[0] : a, this) : this[0] && this[0].parentNode ? this.first().prevAll().length : -1 }, add: function (a, b) { return this.pushStack(n.uniqueSort(n.merge(this.get(), n(a, b)))) }, addBack: function (a) { return this.add(null == a ? this.prevObject : this.prevObject.filter(a)) } }); function F(a, b) { do { a = a[b] } while (a && 1 !== a.nodeType); return a } n.each({ parent: function (a) { var b = a.parentNode; return b && 11 !== b.nodeType ? b : null }, parents: function (a) { return u(a, "parentNode") }, parentsUntil: function (a, b, c) { return u(a, "parentNode", c) }, next: function (a) { return F(a, "nextSibling") }, prev: function (a) { return F(a, "previousSibling") }, nextAll: function (a) { return u(a, "nextSibling") }, prevAll: function (a) { return u(a, "previousSibling") }, nextUntil: function (a, b, c) { return u(a, "nextSibling", c) }, prevUntil: function (a, b, c) { return u(a, "previousSibling", c) }, siblings: function (a) { return v((a.parentNode || {}).firstChild, a) }, children: function (a) { return v(a.firstChild) }, contents: function (a) { return n.nodeName(a, "iframe") ? a.contentDocument || a.contentWindow.document : n.merge([], a.childNodes) } }, function (a, b) { n.fn[a] = function (c, d) { var e = n.map(this, b, c); return "Until" !== a.slice(-5) && (d = c), d && "string" == typeof d && (e = n.filter(d, e)), this.length > 1 && (E[a] || (e = n.uniqueSort(e)), D.test(a) && (e = e.reverse())), this.pushStack(e) } }); var G = /\S+/g; function H(a) { var b = {}; return n.each(a.match(G) || [], function (a, c) { b[c] = !0 }), b } n.Callbacks = function (a) { a = "string" == typeof a ? H(a) : n.extend({}, a); var b, c, d, e, f = [], g = [], h = -1, i = function () { for (e = a.once, d = b = !0; g.length; h = -1) { c = g.shift(); while (++h < f.length) { f[h].apply(c[0], c[1]) === !1 && a.stopOnFalse && (h = f.length, c = !1) } } a.memory || (c = !1), b = !1, e && (f = c ? [] : "") }, j = { add: function () { return f && (c && !b && (h = f.length - 1, g.push(c)), function d(b) { n.each(b, function (b, c) { n.isFunction(c) ? a.unique && j.has(c) || f.push(c) : c && c.length && "string" !== n.type(c) && d(c) }) }(arguments), c && !b && i()), this }, remove: function () { return n.each(arguments, function (a, b) { var c; while ((c = n.inArray(b, f, c)) > -1) { f.splice(c, 1), h >= c && h-- } }), this }, has: function (a) { return a ? n.inArray(a, f) > -1 : f.length > 0 }, empty: function () { return f && (f = []), this }, disable: function () { return e = g = [], f = c = "", this }, disabled: function () { return !f }, lock: function () { return e = !0, c || j.disable(), this }, locked: function () { return !!e }, fireWith: function (a, c) { return e || (c = c || [], c = [a, c.slice ? c.slice() : c], g.push(c), b || i()), this }, fire: function () { return j.fireWith(this, arguments), this }, fired: function () { return !!d } }; return j }, n.extend({ Deferred: function (a) { var b = [["resolve", "done", n.Callbacks("once memory"), "resolved"], ["reject", "fail", n.Callbacks("once memory"), "rejected"], ["notify", "progress", n.Callbacks("memory")]], c = "pending", d = { state: function () { return c }, always: function () { return e.done(arguments).fail(arguments), this }, then: function () { var a = arguments; return n.Deferred(function (c) { n.each(b, function (b, f) { var g = n.isFunction(a[b]) && a[b]; e[f[1]](function () { var a = g && g.apply(this, arguments); a && n.isFunction(a.promise) ? a.promise().progress(c.notify).done(c.resolve).fail(c.reject) : c[f[0] + "With"](this === d ? c.promise() : this, g ? [a] : arguments) }) }), a = null }).promise() }, promise: function (a) { return null != a ? n.extend(a, d) : d } }, e = {}; return d.pipe = d.then, n.each(b, function (a, f) { var g = f[2], h = f[3]; d[f[1]] = g.add, h && g.add(function () { c = h }, b[1 ^ a][2].disable, b[2][2].lock), e[f[0]] = function () { return e[f[0] + "With"](this === e ? d : this, arguments), this }, e[f[0] + "With"] = g.fireWith }), d.promise(e), a && a.call(e, e), e }, when: function (a) { var b = 0, c = e.call(arguments), d = c.length, f = 1 !== d || a && n.isFunction(a.promise) ? d : 0, g = 1 === f ? a : n.Deferred(), h = function (a, b, c) { return function (d) { b[a] = this, c[a] = arguments.length > 1 ? e.call(arguments) : d, c === i ? g.notifyWith(b, c) : --f || g.resolveWith(b, c) } }, i, j, k; if (d > 1) { for (i = new Array(d), j = new Array(d), k = new Array(d); d > b; b++) { c[b] && n.isFunction(c[b].promise) ? c[b].promise().progress(h(b, j, i)).done(h(b, k, c)).fail(g.reject) : --f } } return f || g.resolveWith(k, c), g.promise() } }); var I; n.fn.ready = function (a) { return n.ready.promise().done(a), this }, n.extend({ isReady: !1, readyWait: 1, holdReady: function (a) { a ? n.readyWait++ : n.ready(!0) }, ready: function (a) { (a === !0 ? --n.readyWait : n.isReady) || (n.isReady = !0, a !== !0 && --n.readyWait > 0 || (I.resolveWith(d, [n]), n.fn.triggerHandler && (n(d).triggerHandler("ready"), n(d).off("ready")))) } }); function J() { d.addEventListener ? (d.removeEventListener("DOMContentLoaded", K), a.removeEventListener("load", K)) : (d.detachEvent("onreadystatechange", K), a.detachEvent("onload", K)) } function K() { (d.addEventListener || "load" === a.event.type || "complete" === d.readyState) && (J(), n.ready()) } n.ready.promise = function (b) { if (!I) { if (I = n.Deferred(), "complete" === d.readyState || "loading" !== d.readyState && !d.documentElement.doScroll) { a.setTimeout(n.ready) } else { if (d.addEventListener) { d.addEventListener("DOMContentLoaded", K), a.addEventListener("load", K) } else { d.attachEvent("onreadystatechange", K), a.attachEvent("onload", K); var c = !1; try { c = null == a.frameElement && d.documentElement } catch (e) { } c && c.doScroll && !function f() { if (!n.isReady) { try { c.doScroll("left") } catch (b) { return a.setTimeout(f, 50) } J(), n.ready() } }() } } } return I.promise(b) }, n.ready.promise(); var L; for (L in n(l)) { break } l.ownFirst = "0" === L, l.inlineBlockNeedsLayout = !1, n(function () { var a, b, c, e; c = d.getElementsByTagName("body")[0], c && c.style && (b = d.createElement("div"), e = d.createElement("div"), e.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", c.appendChild(e).appendChild(b), "undefined" != typeof b.style.zoom && (b.style.cssText = "display:inline;margin:0;border:0;padding:1px;width:1px;zoom:1", l.inlineBlockNeedsLayout = a = 3 === b.offsetWidth, a && (c.style.zoom = 1)), c.removeChild(e)) }), function () { var a = d.createElement("div"); l.deleteExpando = !0; try { delete a.test } catch (b) { l.deleteExpando = !1 } a = null }(); var M = function (a) { var b = n.noData[(a.nodeName + " ").toLowerCase()], c = +a.nodeType || 1; return 1 !== c && 9 !== c ? !1 : !b || b !== !0 && a.getAttribute("classid") === b }, N = /^(?:\{[\w\W]*\}|\[[\w\W]*\])$/, O = /([A-Z])/g; function P(a, b, c) { if (void 0 === c && 1 === a.nodeType) { var d = "data-" + b.replace(O, "-$1").toLowerCase(); if (c = a.getAttribute(d), "string" == typeof c) { try { c = "true" === c ? !0 : "false" === c ? !1 : "null" === c ? null : +c + "" === c ? +c : N.test(c) ? n.parseJSON(c) : c } catch (e) { } n.data(a, b, c) } else { c = void 0 } } return c } function Q(a) { var b; for (b in a) { if (("data" !== b || !n.isEmptyObject(a[b])) && "toJSON" !== b) { return !1 } } return !0 } function R(a, b, d, e) { if (M(a)) { var f, g, h = n.expando, i = a.nodeType, j = i ? n.cache : a, k = i ? a[h] : a[h] && h; if (k && j[k] && (e || j[k].data) || void 0 !== d || "string" != typeof b) { return k || (k = i ? a[h] = c.pop() || n.guid++ : h), j[k] || (j[k] = i ? {} : { toJSON: n.noop }), "object" != typeof b && "function" != typeof b || (e ? j[k] = n.extend(j[k], b) : j[k].data = n.extend(j[k].data, b)), g = j[k], e || (g.data || (g.data = {}), g = g.data), void 0 !== d && (g[n.camelCase(b)] = d), "string" == typeof b ? (f = g[b], null == f && (f = g[n.camelCase(b)])) : f = g, f } } } function S(a, b, c) { if (M(a)) { var d, e, f = a.nodeType, g = f ? n.cache : a, h = f ? a[n.expando] : n.expando; if (g[h]) { if (b && (d = c ? g[h] : g[h].data)) { n.isArray(b) ? b = b.concat(n.map(b, n.camelCase)) : b in d ? b = [b] : (b = n.camelCase(b), b = b in d ? [b] : b.split(" ")), e = b.length; while (e--) { delete d[b[e]] } if (c ? !Q(d) : !n.isEmptyObject(d)) { return } } (c || (delete g[h].data, Q(g[h]))) && (f ? n.cleanData([a], !0) : l.deleteExpando || g != g.window ? delete g[h] : g[h] = void 0) } } } n.extend({ cache: {}, noData: { "applet ": !0, "embed ": !0, "object ": "clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" }, hasData: function (a) { return a = a.nodeType ? n.cache[a[n.expando]] : a[n.expando], !!a && !Q(a) }, data: function (a, b, c) { return R(a, b, c) }, removeData: function (a, b) { return S(a, b) }, _data: function (a, b, c) { return R(a, b, c, !0) }, _removeData: function (a, b) { return S(a, b, !0) } }), n.fn.extend({ data: function (a, b) { var c, d, e, f = this[0], g = f && f.attributes; if (void 0 === a) { if (this.length && (e = n.data(f), 1 === f.nodeType && !n._data(f, "parsedAttrs"))) { c = g.length; while (c--) { g[c] && (d = g[c].name, 0 === d.indexOf("data-") && (d = n.camelCase(d.slice(5)), P(f, d, e[d]))) } n._data(f, "parsedAttrs", !0) } return e } return "object" == typeof a ? this.each(function () { n.data(this, a) }) : arguments.length > 1 ? this.each(function () { n.data(this, a, b) }) : f ? P(f, a, n.data(f, a)) : void 0 }, removeData: function (a) { return this.each(function () { n.removeData(this, a) }) } }), n.extend({ queue: function (a, b, c) { var d; return a ? (b = (b || "fx") + "queue", d = n._data(a, b), c && (!d || n.isArray(c) ? d = n._data(a, b, n.makeArray(c)) : d.push(c)), d || []) : void 0 }, dequeue: function (a, b) { b = b || "fx"; var c = n.queue(a, b), d = c.length, e = c.shift(), f = n._queueHooks(a, b), g = function () { n.dequeue(a, b) }; "inprogress" === e && (e = c.shift(), d--), e && ("fx" === b && c.unshift("inprogress"), delete f.stop, e.call(a, g, f)), !d && f && f.empty.fire() }, _queueHooks: function (a, b) { var c = b + "queueHooks"; return n._data(a, c) || n._data(a, c, { empty: n.Callbacks("once memory").add(function () { n._removeData(a, b + "queue"), n._removeData(a, c) }) }) } }), n.fn.extend({ queue: function (a, b) { var c = 2; return "string" != typeof a && (b = a, a = "fx", c--), arguments.length < c ? n.queue(this[0], a) : void 0 === b ? this : this.each(function () { var c = n.queue(this, a, b); n._queueHooks(this, a), "fx" === a && "inprogress" !== c[0] && n.dequeue(this, a) }) }, dequeue: function (a) { return this.each(function () { n.dequeue(this, a) }) }, clearQueue: function (a) { return this.queue(a || "fx", []) }, promise: function (a, b) { var c, d = 1, e = n.Deferred(), f = this, g = this.length, h = function () { --d || e.resolveWith(f, [f]) }; "string" != typeof a && (b = a, a = void 0), a = a || "fx"; while (g--) { c = n._data(f[g], a + "queueHooks"), c && c.empty && (d++ , c.empty.add(h)) } return h(), e.promise(b) } }), function () { var a; l.shrinkWrapBlocks = function () { if (null != a) { return a } a = !1; var b, c, e; return c = d.getElementsByTagName("body")[0], c && c.style ? (b = d.createElement("div"), e = d.createElement("div"), e.style.cssText = "position:absolute;border:0;width:0;height:0;top:0;left:-9999px", c.appendChild(e).appendChild(b), "undefined" != typeof b.style.zoom && (b.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:1px;width:1px;zoom:1", b.appendChild(d.createElement("div")).style.width = "5px", a = 3 !== b.offsetWidth), c.removeChild(e), a) : void 0 } }(); var T = /[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source, U = new RegExp("^(?:([+-])=|)(" + T + ")([a-z%]*)$", "i"), V = ["Top", "Right", "Bottom", "Left"], W = function (a, b) { return a = b || a, "none" === n.css(a, "display") || !n.contains(a.ownerDocument, a) }; function X(a, b, c, d) { var e, f = 1, g = 20, h = d ? function () { return d.cur() } : function () { return n.css(a, b, "") }, i = h(), j = c && c[3] || (n.cssNumber[b] ? "" : "px"), k = (n.cssNumber[b] || "px" !== j && +i) && U.exec(n.css(a, b)); if (k && k[3] !== j) { j = j || k[3], c = c || [], k = +i || 1; do { f = f || ".5", k /= f, n.style(a, b, k + j) } while (f !== (f = h() / i) && 1 !== f && --g) } return c && (k = +k || +i || 0, e = c[1] ? k + (c[1] + 1) * c[2] : +c[2], d && (d.unit = j, d.start = k, d.end = e)), e } var Y = function (a, b, c, d, e, f, g) { var h = 0, i = a.length, j = null == c; if ("object" === n.type(c)) { e = !0; for (h in c) { Y(a, b, h, c[h], !0, f, g) } } else { if (void 0 !== d && (e = !0, n.isFunction(d) || (g = !0), j && (g ? (b.call(a, d), b = null) : (j = b, b = function (a, b, c) { return j.call(n(a), c) })), b)) { for (; i > h; h++) { b(a[h], c, g ? d : d.call(a[h], h, b(a[h], c))) } } } return e ? a : j ? b.call(a) : i ? b(a[0], c) : f }, Z = /^(?:checkbox|radio)$/i, $ = /<([\w:-]+)/, _ = /^$|\/(?:java|ecma)script/i, aa = /^\s+/, ba = "abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video"; function ca(a) { var b = ba.split("|"), c = a.createDocumentFragment(); if (c.createElement) { while (b.length) { c.createElement(b.pop()) } } return c } !function () { var a = d.createElement("div"), b = d.createDocumentFragment(), c = d.createElement("input"); a.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", l.leadingWhitespace = 3 === a.firstChild.nodeType, l.tbody = !a.getElementsByTagName("tbody").length, l.htmlSerialize = !!a.getElementsByTagName("link").length, l.html5Clone = "<:nav></:nav>" !== d.createElement("nav").cloneNode(!0).outerHTML, c.type = "checkbox", c.checked = !0, b.appendChild(c), l.appendChecked = c.checked, a.innerHTML = "<textarea>x</textarea>", l.noCloneChecked = !!a.cloneNode(!0).lastChild.defaultValue, b.appendChild(a), c = d.createElement("input"), c.setAttribute("type", "radio"), c.setAttribute("checked", "checked"), c.setAttribute("name", "t"), a.appendChild(c), l.checkClone = a.cloneNode(!0).cloneNode(!0).lastChild.checked, l.noCloneEvent = !!a.addEventListener, a[n.expando] = 1, l.attributes = !a.getAttribute(n.expando) }(); var da = { option: [1, "<select multiple='multiple'>", "</select>"], legend: [1, "<fieldset>", "</fieldset>"], area: [1, "<map>", "</map>"], param: [1, "<object>", "</object>"], thead: [1, "<table>", "</table>"], tr: [2, "<table><tbody>", "</tbody></table>"], col: [2, "<table><tbody></tbody><colgroup>", "</colgroup></table>"], td: [3, "<table><tbody><tr>", "</tr></tbody></table>"], _default: l.htmlSerialize ? [0, "", ""] : [1, "X<div>", "</div>"] }; da.optgroup = da.option, da.tbody = da.tfoot = da.colgroup = da.caption = da.thead, da.th = da.td; function ea(a, b) { var c, d, e = 0, f = "undefined" != typeof a.getElementsByTagName ? a.getElementsByTagName(b || "*") : "undefined" != typeof a.querySelectorAll ? a.querySelectorAll(b || "*") : void 0; if (!f) { for (f = [], c = a.childNodes || a; null != (d = c[e]); e++) { !b || n.nodeName(d, b) ? f.push(d) : n.merge(f, ea(d, b)) } } return void 0 === b || b && n.nodeName(a, b) ? n.merge([a], f) : f } function fa(a, b) { for (var c, d = 0; null != (c = a[d]); d++) { n._data(c, "globalEval", !b || n._data(b[d], "globalEval")) } } var ga = /<|&#?\w+;/, ha = /<tbody/i; function ia(a) { Z.test(a.type) && (a.defaultChecked = a.checked) } function ja(a, b, c, d, e) { for (var f, g, h, i, j, k, m, o = a.length, p = ca(b), q = [], r = 0; o > r; r++) { if (g = a[r], g || 0 === g) { if ("object" === n.type(g)) { n.merge(q, g.nodeType ? [g] : g) } else { if (ga.test(g)) { i = i || p.appendChild(b.createElement("div")), j = ($.exec(g) || ["", ""])[1].toLowerCase(), m = da[j] || da._default, i.innerHTML = m[1] + n.htmlPrefilter(g) + m[2], f = m[0]; while (f--) { i = i.lastChild } if (!l.leadingWhitespace && aa.test(g) && q.push(b.createTextNode(aa.exec(g)[0])), !l.tbody) { g = "table" !== j || ha.test(g) ? "<table>" !== m[1] || ha.test(g) ? 0 : i : i.firstChild, f = g && g.childNodes.length; while (f--) { n.nodeName(k = g.childNodes[f], "tbody") && !k.childNodes.length && g.removeChild(k) } } n.merge(q, i.childNodes), i.textContent = ""; while (i.firstChild) { i.removeChild(i.firstChild) } i = p.lastChild } else { q.push(b.createTextNode(g)) } } } } i && p.removeChild(i), l.appendChecked || n.grep(ea(q, "input"), ia), r = 0; while (g = q[r++]) { if (d && n.inArray(g, d) > -1) { e && e.push(g) } else { if (h = n.contains(g.ownerDocument, g), i = ea(p.appendChild(g), "script"), h && fa(i), c) { f = 0; while (g = i[f++]) { _.test(g.type || "") && c.push(g) } } } } return i = null, p } !function () { var b, c, e = d.createElement("div"); for (b in { submit: !0, change: !0, focusin: !0 }) { c = "on" + b, (l[b] = c in a) || (e.setAttribute(c, "t"), l[b] = e.attributes[c].expando === !1) } e = null }(); var ka = /^(?:input|select|textarea)$/i, la = /^key/, ma = /^(?:mouse|pointer|contextmenu|drag|drop)|click/, na = /^(?:focusinfocus|focusoutblur)$/, oa = /^([^.]*)(?:\.(.+)|)/; function pa() { return !0 } function qa() { return !1 } function ra() { try { return d.activeElement } catch (a) { } } function sa(a, b, c, d, e, f) { var g, h; if ("object" == typeof b) { "string" != typeof c && (d = d || c, c = void 0); for (h in b) { sa(a, h, c, d, b[h], f) } return a } if (null == d && null == e ? (e = c, d = c = void 0) : null == e && ("string" == typeof c ? (e = d, d = void 0) : (e = d, d = c, c = void 0)), e === !1) { e = qa } else { if (!e) { return a } } return 1 === f && (g = e, e = function (a) { return n().off(a), g.apply(this, arguments) }, e.guid = g.guid || (g.guid = n.guid++)), a.each(function () { n.event.add(this, b, e, d, c) }) } n.event = { global: {}, add: function (a, b, c, d, e) { var f, g, h, i, j, k, l, m, o, p, q, r = n._data(a); if (r) { c.handler && (i = c, c = i.handler, e = i.selector), c.guid || (c.guid = n.guid++), (g = r.events) || (g = r.events = {}), (k = r.handle) || (k = r.handle = function (a) { return "undefined" == typeof n || a && n.event.triggered === a.type ? void 0 : n.event.dispatch.apply(k.elem, arguments) }, k.elem = a), b = (b || "").match(G) || [""], h = b.length; while (h--) { f = oa.exec(b[h]) || [], o = q = f[1], p = (f[2] || "").split(".").sort(), o && (j = n.event.special[o] || {}, o = (e ? j.delegateType : j.bindType) || o, j = n.event.special[o] || {}, l = n.extend({ type: o, origType: q, data: d, handler: c, guid: c.guid, selector: e, needsContext: e && n.expr.match.needsContext.test(e), namespace: p.join(".") }, i), (m = g[o]) || (m = g[o] = [], m.delegateCount = 0, j.setup && j.setup.call(a, d, p, k) !== !1 || (a.addEventListener ? a.addEventListener(o, k, !1) : a.attachEvent && a.attachEvent("on" + o, k))), j.add && (j.add.call(a, l), l.handler.guid || (l.handler.guid = c.guid)), e ? m.splice(m.delegateCount++, 0, l) : m.push(l), n.event.global[o] = !0) } a = null } }, remove: function (a, b, c, d, e) { var f, g, h, i, j, k, l, m, o, p, q, r = n.hasData(a) && n._data(a); if (r && (k = r.events)) { b = (b || "").match(G) || [""], j = b.length; while (j--) { if (h = oa.exec(b[j]) || [], o = q = h[1], p = (h[2] || "").split(".").sort(), o) { l = n.event.special[o] || {}, o = (d ? l.delegateType : l.bindType) || o, m = k[o] || [], h = h[2] && new RegExp("(^|\\.)" + p.join("\\.(?:.*\\.|)") + "(\\.|$)"), i = f = m.length; while (f--) { g = m[f], !e && q !== g.origType || c && c.guid !== g.guid || h && !h.test(g.namespace) || d && d !== g.selector && ("**" !== d || !g.selector) || (m.splice(f, 1), g.selector && m.delegateCount-- , l.remove && l.remove.call(a, g)) } i && !m.length && (l.teardown && l.teardown.call(a, p, r.handle) !== !1 || n.removeEvent(a, o, r.handle), delete k[o]) } else { for (o in k) { n.event.remove(a, o + b[j], c, d, !0) } } } n.isEmptyObject(k) && (delete r.handle, n._removeData(a, "events")) } }, trigger: function (b, c, e, f) { var g, h, i, j, l, m, o, p = [e || d], q = k.call(b, "type") ? b.type : b, r = k.call(b, "namespace") ? b.namespace.split(".") : []; if (i = m = e = e || d, 3 !== e.nodeType && 8 !== e.nodeType && !na.test(q + n.event.triggered) && (q.indexOf(".") > -1 && (r = q.split("."), q = r.shift(), r.sort()), h = q.indexOf(":") < 0 && "on" + q, b = b[n.expando] ? b : new n.Event(q, "object" == typeof b && b), b.isTrigger = f ? 2 : 3, b.namespace = r.join("."), b.rnamespace = b.namespace ? new RegExp("(^|\\.)" + r.join("\\.(?:.*\\.|)") + "(\\.|$)") : null, b.result = void 0, b.target || (b.target = e), c = null == c ? [b] : n.makeArray(c, [b]), l = n.event.special[q] || {}, f || !l.trigger || l.trigger.apply(e, c) !== !1)) { if (!f && !l.noBubble && !n.isWindow(e)) { for (j = l.delegateType || q, na.test(j + q) || (i = i.parentNode); i; i = i.parentNode) { p.push(i), m = i } m === (e.ownerDocument || d) && p.push(m.defaultView || m.parentWindow || a) } o = 0; while ((i = p[o++]) && !b.isPropagationStopped()) { b.type = o > 1 ? j : l.bindType || q, g = (n._data(i, "events") || {})[b.type] && n._data(i, "handle"), g && g.apply(i, c), g = h && i[h], g && g.apply && M(i) && (b.result = g.apply(i, c), b.result === !1 && b.preventDefault()) } if (b.type = q, !f && !b.isDefaultPrevented() && (!l._default || l._default.apply(p.pop(), c) === !1) && M(e) && h && e[q] && !n.isWindow(e)) { m = e[h], m && (e[h] = null), n.event.triggered = q; try { e[q]() } catch (s) { } n.event.triggered = void 0, m && (e[h] = m) } return b.result } }, dispatch: function (a) { a = n.event.fix(a); var b, c, d, f, g, h = [], i = e.call(arguments), j = (n._data(this, "events") || {})[a.type] || [], k = n.event.special[a.type] || {}; if (i[0] = a, a.delegateTarget = this, !k.preDispatch || k.preDispatch.call(this, a) !== !1) { h = n.event.handlers.call(this, a, j), b = 0; while ((f = h[b++]) && !a.isPropagationStopped()) { a.currentTarget = f.elem, c = 0; while ((g = f.handlers[c++]) && !a.isImmediatePropagationStopped()) { a.rnamespace && !a.rnamespace.test(g.namespace) || (a.handleObj = g, a.data = g.data, d = ((n.event.special[g.origType] || {}).handle || g.handler).apply(f.elem, i), void 0 !== d && (a.result = d) === !1 && (a.preventDefault(), a.stopPropagation())) } } return k.postDispatch && k.postDispatch.call(this, a), a.result } }, handlers: function (a, b) { var c, d, e, f, g = [], h = b.delegateCount, i = a.target; if (h && i.nodeType && ("click" !== a.type || isNaN(a.button) || a.button < 1)) { for (; i != this; i = i.parentNode || this) { if (1 === i.nodeType && (i.disabled !== !0 || "click" !== a.type)) { for (d = [], c = 0; h > c; c++) { f = b[c], e = f.selector + " ", void 0 === d[e] && (d[e] = f.needsContext ? n(e, this).index(i) > -1 : n.find(e, this, null, [i]).length), d[e] && d.push(f) } d.length && g.push({ elem: i, handlers: d }) } } } return h < b.length && g.push({ elem: this, handlers: b.slice(h) }), g }, fix: function (a) { if (a[n.expando]) { return a } var b, c, e, f = a.type, g = a, h = this.fixHooks[f]; h || (this.fixHooks[f] = h = ma.test(f) ? this.mouseHooks : la.test(f) ? this.keyHooks : {}), e = h.props ? this.props.concat(h.props) : this.props, a = new n.Event(g), b = e.length; while (b--) { c = e[b], a[c] = g[c] } return a.target || (a.target = g.srcElement || d), 3 === a.target.nodeType && (a.target = a.target.parentNode), a.metaKey = !!a.metaKey, h.filter ? h.filter(a, g) : a }, props: "altKey bubbles cancelable ctrlKey currentTarget detail eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "), fixHooks: {}, keyHooks: { props: "char charCode key keyCode".split(" "), filter: function (a, b) { return null == a.which && (a.which = null != b.charCode ? b.charCode : b.keyCode), a } }, mouseHooks: { props: "button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "), filter: function (a, b) { var c, e, f, g = b.button, h = b.fromElement; return null == a.pageX && null != b.clientX && (e = a.target.ownerDocument || d, f = e.documentElement, c = e.body, a.pageX = b.clientX + (f && f.scrollLeft || c && c.scrollLeft || 0) - (f && f.clientLeft || c && c.clientLeft || 0), a.pageY = b.clientY + (f && f.scrollTop || c && c.scrollTop || 0) - (f && f.clientTop || c && c.clientTop || 0)), !a.relatedTarget && h && (a.relatedTarget = h === a.target ? b.toElement : h), a.which || void 0 === g || (a.which = 1 & g ? 1 : 2 & g ? 3 : 4 & g ? 2 : 0), a } }, special: { load: { noBubble: !0 }, focus: { trigger: function () { if (this !== ra() && this.focus) { try { return this.focus(), !1 } catch (a) { } } }, delegateType: "focusin" }, blur: { trigger: function () { return this === ra() && this.blur ? (this.blur(), !1) : void 0 }, delegateType: "focusout" }, click: { trigger: function () { return n.nodeName(this, "input") && "checkbox" === this.type && this.click ? (this.click(), !1) : void 0 }, _default: function (a) { return n.nodeName(a.target, "a") } }, beforeunload: { postDispatch: function (a) { void 0 !== a.result && a.originalEvent && (a.originalEvent.returnValue = a.result) } } }, simulate: function (a, b, c) { var d = n.extend(new n.Event, c, { type: a, isSimulated: !0 }); n.event.trigger(d, null, b), d.isDefaultPrevented() && c.preventDefault() } }, n.removeEvent = d.removeEventListener ? function (a, b, c) { a.removeEventListener && a.removeEventListener(b, c) } : function (a, b, c) { var d = "on" + b; a.detachEvent && ("undefined" == typeof a[d] && (a[d] = null), a.detachEvent(d, c)) }, n.Event = function (a, b) { return this instanceof n.Event ? (a && a.type ? (this.originalEvent = a, this.type = a.type, this.isDefaultPrevented = a.defaultPrevented || void 0 === a.defaultPrevented && a.returnValue === !1 ? pa : qa) : this.type = a, b && n.extend(this, b), this.timeStamp = a && a.timeStamp || n.now(), void (this[n.expando] = !0)) : new n.Event(a, b) }, n.Event.prototype = { constructor: n.Event, isDefaultPrevented: qa, isPropagationStopped: qa, isImmediatePropagationStopped: qa, preventDefault: function () { var a = this.originalEvent; this.isDefaultPrevented = pa, a && (a.preventDefault ? a.preventDefault() : a.returnValue = !1) }, stopPropagation: function () { var a = this.originalEvent; this.isPropagationStopped = pa, a && !this.isSimulated && (a.stopPropagation && a.stopPropagation(), a.cancelBubble = !0) }, stopImmediatePropagation: function () { var a = this.originalEvent; this.isImmediatePropagationStopped = pa, a && a.stopImmediatePropagation && a.stopImmediatePropagation(), this.stopPropagation() } }, n.each({ mouseenter: "mouseover", mouseleave: "mouseout", pointerenter: "pointerover", pointerleave: "pointerout" }, function (a, b) { n.event.special[a] = { delegateType: b, bindType: b, handle: function (a) { var c, d = this, e = a.relatedTarget, f = a.handleObj; return e && (e === d || n.contains(d, e)) || (a.type = f.origType, c = f.handler.apply(this, arguments), a.type = b), c } } }), l.submit || (n.event.special.submit = { setup: function () { return n.nodeName(this, "form") ? !1 : void n.event.add(this, "click._submit keypress._submit", function (a) { var b = a.target, c = n.nodeName(b, "input") || n.nodeName(b, "button") ? n.prop(b, "form") : void 0; c && !n._data(c, "submit") && (n.event.add(c, "submit._submit", function (a) { a._submitBubble = !0 }), n._data(c, "submit", !0)) }) }, postDispatch: function (a) { a._submitBubble && (delete a._submitBubble, this.parentNode && !a.isTrigger && n.event.simulate("submit", this.parentNode, a)) }, teardown: function () { return n.nodeName(this, "form") ? !1 : void n.event.remove(this, "._submit") } }), l.change || (n.event.special.change = { setup: function () { return ka.test(this.nodeName) ? ("checkbox" !== this.type && "radio" !== this.type || (n.event.add(this, "propertychange._change", function (a) { "checked" === a.originalEvent.propertyName && (this._justChanged = !0) }), n.event.add(this, "click._change", function (a) { this._justChanged && !a.isTrigger && (this._justChanged = !1), n.event.simulate("change", this, a) })), !1) : void n.event.add(this, "beforeactivate._change", function (a) { var b = a.target; ka.test(b.nodeName) && !n._data(b, "change") && (n.event.add(b, "change._change", function (a) { !this.parentNode || a.isSimulated || a.isTrigger || n.event.simulate("change", this.parentNode, a) }), n._data(b, "change", !0)) }) }, handle: function (a) { var b = a.target; return this !== b || a.isSimulated || a.isTrigger || "radio" !== b.type && "checkbox" !== b.type ? a.handleObj.handler.apply(this, arguments) : void 0 }, teardown: function () { return n.event.remove(this, "._change"), !ka.test(this.nodeName) } }), l.focusin || n.each({ focus: "focusin", blur: "focusout" }, function (a, b) { var c = function (a) { n.event.simulate(b, a.target, n.event.fix(a)) }; n.event.special[b] = { setup: function () { var d = this.ownerDocument || this, e = n._data(d, b); e || d.addEventListener(a, c, !0), n._data(d, b, (e || 0) + 1) }, teardown: function () { var d = this.ownerDocument || this, e = n._data(d, b) - 1; e ? n._data(d, b, e) : (d.removeEventListener(a, c, !0), n._removeData(d, b)) } } }), n.fn.extend({ on: function (a, b, c, d) { return sa(this, a, b, c, d) }, one: function (a, b, c, d) { return sa(this, a, b, c, d, 1) }, off: function (a, b, c) { var d, e; if (a && a.preventDefault && a.handleObj) { return d = a.handleObj, n(a.delegateTarget).off(d.namespace ? d.origType + "." + d.namespace : d.origType, d.selector, d.handler), this } if ("object" == typeof a) { for (e in a) { this.off(e, b, a[e]) } return this } return b !== !1 && "function" != typeof b || (c = b, b = void 0), c === !1 && (c = qa), this.each(function () { n.event.remove(this, a, c, b) }) }, trigger: function (a, b) { return this.each(function () { n.event.trigger(a, b, this) }) }, triggerHandler: function (a, b) { var c = this[0]; return c ? n.event.trigger(a, b, c, !0) : void 0 } }); var ta = / jQuery\d+="(?:null|\d+)"/g, ua = new RegExp("<(?:" + ba + ")[\\s/>]", "i"), va = /<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi, wa = /<script|<style|<link/i, xa = /checked\s*(?:[^=]|=\s*.checked.)/i, ya = /^true\/(.*)/, za = /^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g, Aa = ca(d), Ba = Aa.appendChild(d.createElement("div")); function Ca(a, b) { return n.nodeName(a, "table") && n.nodeName(11 !== b.nodeType ? b : b.firstChild, "tr") ? a.getElementsByTagName("tbody")[0] || a.appendChild(a.ownerDocument.createElement("tbody")) : a } function Da(a) { return a.type = (null !== n.find.attr(a, "type")) + "/" + a.type, a } function Ea(a) { var b = ya.exec(a.type); return b ? a.type = b[1] : a.removeAttribute("type"), a } function Fa(a, b) { if (1 === b.nodeType && n.hasData(a)) { var c, d, e, f = n._data(a), g = n._data(b, f), h = f.events; if (h) { delete g.handle, g.events = {}; for (c in h) { for (d = 0, e = h[c].length; e > d; d++) { n.event.add(b, c, h[c][d]) } } } g.data && (g.data = n.extend({}, g.data)) } } function Ga(a, b) { var c, d, e; if (1 === b.nodeType) { if (c = b.nodeName.toLowerCase(), !l.noCloneEvent && b[n.expando]) { e = n._data(b); for (d in e.events) { n.removeEvent(b, d, e.handle) } b.removeAttribute(n.expando) } "script" === c && b.text !== a.text ? (Da(b).text = a.text, Ea(b)) : "object" === c ? (b.parentNode && (b.outerHTML = a.outerHTML), l.html5Clone && a.innerHTML && !n.trim(b.innerHTML) && (b.innerHTML = a.innerHTML)) : "input" === c && Z.test(a.type) ? (b.defaultChecked = b.checked = a.checked, b.value !== a.value && (b.value = a.value)) : "option" === c ? b.defaultSelected = b.selected = a.defaultSelected : "input" !== c && "textarea" !== c || (b.defaultValue = a.defaultValue) } } function Ha(a, b, c, d) { b = f.apply([], b); var e, g, h, i, j, k, m = 0, o = a.length, p = o - 1, q = b[0], r = n.isFunction(q); if (r || o > 1 && "string" == typeof q && !l.checkClone && xa.test(q)) { return a.each(function (e) { var f = a.eq(e); r && (b[0] = q.call(this, e, f.html())), Ha(f, b, c, d) }) } if (o && (k = ja(b, a[0].ownerDocument, !1, a, d), e = k.firstChild, 1 === k.childNodes.length && (k = e), e || d)) { for (i = n.map(ea(k, "script"), Da), h = i.length; o > m; m++) { g = k, m !== p && (g = n.clone(g, !0, !0), h && n.merge(i, ea(g, "script"))), c.call(a[m], g, m) } if (h) { for (j = i[i.length - 1].ownerDocument, n.map(i, Ea), m = 0; h > m; m++) { g = i[m], _.test(g.type || "") && !n._data(g, "globalEval") && n.contains(j, g) && (g.src ? n._evalUrl && n._evalUrl(g.src) : n.globalEval((g.text || g.textContent || g.innerHTML || "").replace(za, ""))) } } k = e = null } return a } function Ia(a, b, c) { for (var d, e = b ? n.filter(b, a) : a, f = 0; null != (d = e[f]); f++) { c || 1 !== d.nodeType || n.cleanData(ea(d)), d.parentNode && (c && n.contains(d.ownerDocument, d) && fa(ea(d, "script")), d.parentNode.removeChild(d)) } return a } n.extend({ htmlPrefilter: function (a) { return a.replace(va, "<$1></$2>") }, clone: function (a, b, c) { var d, e, f, g, h, i = n.contains(a.ownerDocument, a); if (l.html5Clone || n.isXMLDoc(a) || !ua.test("<" + a.nodeName + ">") ? f = a.cloneNode(!0) : (Ba.innerHTML = a.outerHTML, Ba.removeChild(f = Ba.firstChild)), !(l.noCloneEvent && l.noCloneChecked || 1 !== a.nodeType && 11 !== a.nodeType || n.isXMLDoc(a))) { for (d = ea(f), h = ea(a), g = 0; null != (e = h[g]); ++g) { d[g] && Ga(e, d[g]) } } if (b) { if (c) { for (h = h || ea(a), d = d || ea(f), g = 0; null != (e = h[g]); g++) { Fa(e, d[g]) } } else { Fa(a, f) } } return d = ea(f, "script"), d.length > 0 && fa(d, !i && ea(a, "script")), d = h = e = null, f }, cleanData: function (a, b) { for (var d, e, f, g, h = 0, i = n.expando, j = n.cache, k = l.attributes, m = n.event.special; null != (d = a[h]); h++) { if ((b || M(d)) && (f = d[i], g = f && j[f])) { if (g.events) { for (e in g.events) { m[e] ? n.event.remove(d, e) : n.removeEvent(d, e, g.handle) } } j[f] && (delete j[f], k || "undefined" == typeof d.removeAttribute ? d[i] = void 0 : d.removeAttribute(i), c.push(f)) } } } }), n.fn.extend({ domManip: Ha, detach: function (a) { return Ia(this, a, !0) }, remove: function (a) { return Ia(this, a) }, text: function (a) { return Y(this, function (a) { return void 0 === a ? n.text(this) : this.empty().append((this[0] && this[0].ownerDocument || d).createTextNode(a)) }, null, a, arguments.length) }, append: function () { return Ha(this, arguments, function (a) { if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) { var b = Ca(this, a); b.appendChild(a) } }) }, prepend: function () { return Ha(this, arguments, function (a) { if (1 === this.nodeType || 11 === this.nodeType || 9 === this.nodeType) { var b = Ca(this, a); b.insertBefore(a, b.firstChild) } }) }, before: function () { return Ha(this, arguments, function (a) { this.parentNode && this.parentNode.insertBefore(a, this) }) }, after: function () { return Ha(this, arguments, function (a) { this.parentNode && this.parentNode.insertBefore(a, this.nextSibling) }) }, empty: function () { for (var a, b = 0; null != (a = this[b]); b++) { 1 === a.nodeType && n.cleanData(ea(a, !1)); while (a.firstChild) { a.removeChild(a.firstChild) } a.options && n.nodeName(a, "select") && (a.options.length = 0) } return this }, clone: function (a, b) { return a = null == a ? !1 : a, b = null == b ? a : b, this.map(function () { return n.clone(this, a, b) }) }, html: function (a) { return Y(this, function (a) { var b = this[0] || {}, c = 0, d = this.length; if (void 0 === a) { return 1 === b.nodeType ? b.innerHTML.replace(ta, "") : void 0 } if ("string" == typeof a && !wa.test(a) && (l.htmlSerialize || !ua.test(a)) && (l.leadingWhitespace || !aa.test(a)) && !da[($.exec(a) || ["", ""])[1].toLowerCase()]) { a = n.htmlPrefilter(a); try { for (; d > c; c++) { b = this[c] || {}, 1 === b.nodeType && (n.cleanData(ea(b, !1)), b.innerHTML = a) } b = 0 } catch (e) { } } b && this.empty().append(a) }, null, a, arguments.length) }, replaceWith: function () { var a = []; return Ha(this, arguments, function (b) { var c = this.parentNode; n.inArray(this, a) < 0 && (n.cleanData(ea(this)), c && c.replaceChild(b, this)) }, a) } }), n.each({ appendTo: "append", prependTo: "prepend", insertBefore: "before", insertAfter: "after", replaceAll: "replaceWith" }, function (a, b) { n.fn[a] = function (a) { for (var c, d = 0, e = [], f = n(a), h = f.length - 1; h >= d; d++) { c = d === h ? this : this.clone(!0), n(f[d])[b](c), g.apply(e, c.get()) } return this.pushStack(e) } }); var Ja, Ka = { HTML: "block", BODY: "block" }; function La(a, b) { var c = n(b.createElement(a)).appendTo(b.body), d = n.css(c[0], "display"); return c.detach(), d } function Ma(a) { var b = d, c = Ka[a]; return c || (c = La(a, b), "none" !== c && c || (Ja = (Ja || n("<iframe frameborder='0' width='0' height='0'/>")).appendTo(b.documentElement), b = (Ja[0].contentWindow || Ja[0].contentDocument).document, b.write(), b.close(), c = La(a, b), Ja.detach()), Ka[a] = c), c } var Na = /^margin/, Oa = new RegExp("^(" + T + ")(?!px)[a-z%]+$", "i"), Pa = function (a, b, c, d) { var e, f, g = {}; for (f in b) { g[f] = a.style[f], a.style[f] = b[f] } e = c.apply(a, d || []); for (f in b) { a.style[f] = g[f] } return e }, Qa = d.documentElement; !function () { var b, c, e, f, g, h, i = d.createElement("div"), j = d.createElement("div"); if (j.style) { j.style.cssText = "float:left;opacity:.5", l.opacity = "0.5" === j.style.opacity, l.cssFloat = !!j.style.cssFloat, j.style.backgroundClip = "content-box", j.cloneNode(!0).style.backgroundClip = "", l.clearCloneStyle = "content-box" === j.style.backgroundClip, i = d.createElement("div"), i.style.cssText = "border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute", j.innerHTML = "", i.appendChild(j), l.boxSizing = "" === j.style.boxSizing || "" === j.style.MozBoxSizing || "" === j.style.WebkitBoxSizing, n.extend(l, { reliableHiddenOffsets: function () { return null == b && k(), f }, boxSizingReliable: function () { return null == b && k(), e }, pixelMarginRight: function () { return null == b && k(), c }, pixelPosition: function () { return null == b && k(), b }, reliableMarginRight: function () { return null == b && k(), g }, reliableMarginLeft: function () { return null == b && k(), h } }); function k() { var k, l, m = d.documentElement; m.appendChild(i), j.style.cssText = "-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%", b = e = h = !1, c = g = !0, a.getComputedStyle && (l = a.getComputedStyle(j), b = "1%" !== (l || {}).top, h = "2px" === (l || {}).marginLeft, e = "4px" === (l || { width: "4px" }).width, j.style.marginRight = "50%", c = "4px" === (l || { marginRight: "4px" }).marginRight, k = j.appendChild(d.createElement("div")), k.style.cssText = j.style.cssText = "-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0", k.style.marginRight = k.style.width = "0", j.style.width = "1px", g = !parseFloat((a.getComputedStyle(k) || {}).marginRight), j.removeChild(k)), j.style.display = "none", f = 0 === j.getClientRects().length, f && (j.style.display = "", j.innerHTML = "<table><tr><td></td><td>t</td></tr></table>", j.childNodes[0].style.borderCollapse = "separate", k = j.getElementsByTagName("td"), k[0].style.cssText = "margin:0;border:0;padding:0;display:none", f = 0 === k[0].offsetHeight, f && (k[0].style.display = "", k[1].style.display = "none", f = 0 === k[0].offsetHeight)), m.removeChild(i) } } }(); var Ra, Sa, Ta = /^(top|right|bottom|left)$/; a.getComputedStyle ? (Ra = function (b) { var c = b.ownerDocument.defaultView; return c && c.opener || (c = a), c.getComputedStyle(b) }, Sa = function (a, b, c) { var d, e, f, g, h = a.style; return c = c || Ra(a), g = c ? c.getPropertyValue(b) || c[b] : void 0, "" !== g && void 0 !== g || n.contains(a.ownerDocument, a) || (g = n.style(a, b)), c && !l.pixelMarginRight() && Oa.test(g) && Na.test(b) && (d = h.width, e = h.minWidth, f = h.maxWidth, h.minWidth = h.maxWidth = h.width = g, g = c.width, h.width = d, h.minWidth = e, h.maxWidth = f), void 0 === g ? g : g + "" }) : Qa.currentStyle && (Ra = function (a) { return a.currentStyle }, Sa = function (a, b, c) { var d, e, f, g, h = a.style; return c = c || Ra(a), g = c ? c[b] : void 0, null == g && h && h[b] && (g = h[b]), Oa.test(g) && !Ta.test(b) && (d = h.left, e = a.runtimeStyle, f = e && e.left, f && (e.left = a.currentStyle.left), h.left = "fontSize" === b ? "1em" : g, g = h.pixelLeft + "px", h.left = d, f && (e.left = f)), void 0 === g ? g : g + "" || "auto" }); function Ua(a, b) { return { get: function () { return a() ? void delete this.get : (this.get = b).apply(this, arguments) } } } var Va = /alpha\([^)]*\)/i, Wa = /opacity\s*=\s*([^)]*)/i, Xa = /^(none|table(?!-c[ea]).+)/, Ya = new RegExp("^(" + T + ")(.*)$", "i"), Za = { position: "absolute", visibility: "hidden", display: "block" }, $a = { letterSpacing: "0", fontWeight: "400" }, _a = ["Webkit", "O", "Moz", "ms"], ab = d.createElement("div").style; function bb(a) { if (a in ab) { return a } var b = a.charAt(0).toUpperCase() + a.slice(1), c = _a.length; while (c--) { if (a = _a[c] + b, a in ab) { return a } } } function cb(a, b) { for (var c, d, e, f = [], g = 0, h = a.length; h > g; g++) { d = a[g], d.style && (f[g] = n._data(d, "olddisplay"), c = d.style.display, b ? (f[g] || "none" !== c || (d.style.display = ""), "" === d.style.display && W(d) && (f[g] = n._data(d, "olddisplay", Ma(d.nodeName)))) : (e = W(d), (c && "none" !== c || !e) && n._data(d, "olddisplay", e ? c : n.css(d, "display")))) } for (g = 0; h > g; g++) { d = a[g], d.style && (b && "none" !== d.style.display && "" !== d.style.display || (d.style.display = b ? f[g] || "" : "none")) } return a } function db(a, b, c) { var d = Ya.exec(b); return d ? Math.max(0, d[1] - (c || 0)) + (d[2] || "px") : b } function eb(a, b, c, d, e) { for (var f = c === (d ? "border" : "content") ? 4 : "width" === b ? 1 : 0, g = 0; 4 > f; f += 2) { "margin" === c && (g += n.css(a, c + V[f], !0, e)), d ? ("content" === c && (g -= n.css(a, "padding" + V[f], !0, e)), "margin" !== c && (g -= n.css(a, "border" + V[f] + "Width", !0, e))) : (g += n.css(a, "padding" + V[f], !0, e), "padding" !== c && (g += n.css(a, "border" + V[f] + "Width", !0, e))) } return g } function fb(a, b, c) { var d = !0, e = "width" === b ? a.offsetWidth : a.offsetHeight, f = Ra(a), g = l.boxSizing && "border-box" === n.css(a, "boxSizing", !1, f); if (0 >= e || null == e) { if (e = Sa(a, b, f), (0 > e || null == e) && (e = a.style[b]), Oa.test(e)) { return e } d = g && (l.boxSizingReliable() || e === a.style[b]), e = parseFloat(e) || 0 } return e + eb(a, b, c || (g ? "border" : "content"), d, f) + "px" } n.extend({ cssHooks: { opacity: { get: function (a, b) { if (b) { var c = Sa(a, "opacity"); return "" === c ? "1" : c } } } }, cssNumber: { animationIterationCount: !0, columnCount: !0, fillOpacity: !0, flexGrow: !0, flexShrink: !0, fontWeight: !0, lineHeight: !0, opacity: !0, order: !0, orphans: !0, widows: !0, zIndex: !0, zoom: !0 }, cssProps: { "float": l.cssFloat ? "cssFloat" : "styleFloat" }, style: function (a, b, c, d) { if (a && 3 !== a.nodeType && 8 !== a.nodeType && a.style) { var e, f, g, h = n.camelCase(b), i = a.style; if (b = n.cssProps[h] || (n.cssProps[h] = bb(h) || h), g = n.cssHooks[b] || n.cssHooks[h], void 0 === c) { return g && "get" in g && void 0 !== (e = g.get(a, !1, d)) ? e : i[b] } if (f = typeof c, "string" === f && (e = U.exec(c)) && e[1] && (c = X(a, b, e), f = "number"), null != c && c === c && ("number" === f && (c += e && e[3] || (n.cssNumber[h] ? "" : "px")), l.clearCloneStyle || "" !== c || 0 !== b.indexOf("background") || (i[b] = "inherit"), !(g && "set" in g && void 0 === (c = g.set(a, c, d))))) { try { i[b] = c } catch (j) { } } } }, css: function (a, b, c, d) { var e, f, g, h = n.camelCase(b); return b = n.cssProps[h] || (n.cssProps[h] = bb(h) || h), g = n.cssHooks[b] || n.cssHooks[h], g && "get" in g && (f = g.get(a, !0, c)), void 0 === f && (f = Sa(a, b, d)), "normal" === f && b in $a && (f = $a[b]), "" === c || c ? (e = parseFloat(f), c === !0 || isFinite(e) ? e || 0 : f) : f } }), n.each(["height", "width"], function (a, b) { n.cssHooks[b] = { get: function (a, c, d) { return c ? Xa.test(n.css(a, "display")) && 0 === a.offsetWidth ? Pa(a, Za, function () { return fb(a, b, d) }) : fb(a, b, d) : void 0 }, set: function (a, c, d) { var e = d && Ra(a); return db(a, c, d ? eb(a, b, d, l.boxSizing && "border-box" === n.css(a, "boxSizing", !1, e), e) : 0) } } }), l.opacity || (n.cssHooks.opacity = { get: function (a, b) { return Wa.test((b && a.currentStyle ? a.currentStyle.filter : a.style.filter) || "") ? 0.01 * parseFloat(RegExp.$1) + "" : b ? "1" : "" }, set: function (a, b) { var c = a.style, d = a.currentStyle, e = n.isNumeric(b) ? "alpha(opacity=" + 100 * b + ")" : "", f = d && d.filter || c.filter || ""; c.zoom = 1, (b >= 1 || "" === b) && "" === n.trim(f.replace(Va, "")) && c.removeAttribute && (c.removeAttribute("filter"), "" === b || d && !d.filter) || (c.filter = Va.test(f) ? f.replace(Va, e) : f + " " + e) } }), n.cssHooks.marginRight = Ua(l.reliableMarginRight, function (a, b) { return b ? Pa(a, { display: "inline-block" }, Sa, [a, "marginRight"]) : void 0 }), n.cssHooks.marginLeft = Ua(l.reliableMarginLeft, function (a, b) { return b ? (parseFloat(Sa(a, "marginLeft")) || (n.contains(a.ownerDocument, a) ? a.getBoundingClientRect().left - Pa(a, { marginLeft: 0 }, function () { return a.getBoundingClientRect().left }) : 0)) + "px" : void 0 }), n.each({ margin: "", padding: "", border: "Width" }, function (a, b) { n.cssHooks[a + b] = { expand: function (c) { for (var d = 0, e = {}, f = "string" == typeof c ? c.split(" ") : [c]; 4 > d; d++) { e[a + V[d] + b] = f[d] || f[d - 2] || f[0] } return e } }, Na.test(a) || (n.cssHooks[a + b].set = db) }), n.fn.extend({ css: function (a, b) { return Y(this, function (a, b, c) { var d, e, f = {}, g = 0; if (n.isArray(b)) { for (d = Ra(a), e = b.length; e > g; g++) { f[b[g]] = n.css(a, b[g], !1, d) } return f } return void 0 !== c ? n.style(a, b, c) : n.css(a, b) }, a, b, arguments.length > 1) }, show: function () { return cb(this, !0) }, hide: function () { return cb(this) }, toggle: function (a) { return "boolean" == typeof a ? a ? this.show() : this.hide() : this.each(function () { W(this) ? n(this).show() : n(this).hide() }) } }); function gb(a, b, c, d, e) { return new gb.prototype.init(a, b, c, d, e) } n.Tween = gb, gb.prototype = { constructor: gb, init: function (a, b, c, d, e, f) { this.elem = a, this.prop = c, this.easing = e || n.easing._default, this.options = b, this.start = this.now = this.cur(), this.end = d, this.unit = f || (n.cssNumber[c] ? "" : "px") }, cur: function () { var a = gb.propHooks[this.prop]; return a && a.get ? a.get(this) : gb.propHooks._default.get(this) }, run: function (a) { var b, c = gb.propHooks[this.prop]; return this.options.duration ? this.pos = b = n.easing[this.easing](a, this.options.duration * a, 0, 1, this.options.duration) : this.pos = b = a, this.now = (this.end - this.start) * b + this.start, this.options.step && this.options.step.call(this.elem, this.now, this), c && c.set ? c.set(this) : gb.propHooks._default.set(this), this } }, gb.prototype.init.prototype = gb.prototype, gb.propHooks = { _default: { get: function (a) { var b; return 1 !== a.elem.nodeType || null != a.elem[a.prop] && null == a.elem.style[a.prop] ? a.elem[a.prop] : (b = n.css(a.elem, a.prop, ""), b && "auto" !== b ? b : 0) }, set: function (a) { n.fx.step[a.prop] ? n.fx.step[a.prop](a) : 1 !== a.elem.nodeType || null == a.elem.style[n.cssProps[a.prop]] && !n.cssHooks[a.prop] ? a.elem[a.prop] = a.now : n.style(a.elem, a.prop, a.now + a.unit) } } }, gb.propHooks.scrollTop = gb.propHooks.scrollLeft = { set: function (a) { a.elem.nodeType && a.elem.parentNode && (a.elem[a.prop] = a.now) } }, n.easing = { linear: function (a) { return a }, swing: function (a) { return 0.5 - Math.cos(a * Math.PI) / 2 }, _default: "swing" }, n.fx = gb.prototype.init, n.fx.step = {}; var hb, ib, jb = /^(?:toggle|show|hide)$/, kb = /queueHooks$/; function lb() { return a.setTimeout(function () { hb = void 0 }), hb = n.now() } function mb(a, b) { var c, d = { height: a }, e = 0; for (b = b ? 1 : 0; 4 > e; e += 2 - b) { c = V[e], d["margin" + c] = d["padding" + c] = a } return b && (d.opacity = d.width = a), d } function nb(a, b, c) { for (var d, e = (qb.tweeners[b] || []).concat(qb.tweeners["*"]), f = 0, g = e.length; g > f; f++) { if (d = e[f].call(c, b, a)) { return d } } } function ob(a, b, c) { var d, e, f, g, h, i, j, k, m = this, o = {}, p = a.style, q = a.nodeType && W(a), r = n._data(a, "fxshow"); c.queue || (h = n._queueHooks(a, "fx"), null == h.unqueued && (h.unqueued = 0, i = h.empty.fire, h.empty.fire = function () { h.unqueued || i() }), h.unqueued++ , m.always(function () { m.always(function () { h.unqueued-- , n.queue(a, "fx").length || h.empty.fire() }) })), 1 === a.nodeType && ("height" in b || "width" in b) && (c.overflow = [p.overflow, p.overflowX, p.overflowY], j = n.css(a, "display"), k = "none" === j ? n._data(a, "olddisplay") || Ma(a.nodeName) : j, "inline" === k && "none" === n.css(a, "float") && (l.inlineBlockNeedsLayout && "inline" !== Ma(a.nodeName) ? p.zoom = 1 : p.display = "inline-block")), c.overflow && (p.overflow = "hidden", l.shrinkWrapBlocks() || m.always(function () { p.overflow = c.overflow[0], p.overflowX = c.overflow[1], p.overflowY = c.overflow[2] })); for (d in b) { if (e = b[d], jb.exec(e)) { if (delete b[d], f = f || "toggle" === e, e === (q ? "hide" : "show")) { if ("show" !== e || !r || void 0 === r[d]) { continue } q = !0 } o[d] = r && r[d] || n.style(a, d) } else { j = void 0 } } if (n.isEmptyObject(o)) { "inline" === ("none" === j ? Ma(a.nodeName) : j) && (p.display = j) } else { r ? "hidden" in r && (q = r.hidden) : r = n._data(a, "fxshow", {}), f && (r.hidden = !q), q ? n(a).show() : m.done(function () { n(a).hide() }), m.done(function () { var b; n._removeData(a, "fxshow"); for (b in o) { n.style(a, b, o[b]) } }); for (d in o) { g = nb(q ? r[d] : 0, d, m), d in r || (r[d] = g.start, q && (g.end = g.start, g.start = "width" === d || "height" === d ? 1 : 0)) } } } function pb(a, b) { var c, d, e, f, g; for (c in a) { if (d = n.camelCase(c), e = b[d], f = a[c], n.isArray(f) && (e = f[1], f = a[c] = f[0]), c !== d && (a[d] = f, delete a[c]), g = n.cssHooks[d], g && "expand" in g) { f = g.expand(f), delete a[d]; for (c in f) { c in a || (a[c] = f[c], b[c] = e) } } else { b[d] = e } } } function qb(a, b, c) { var d, e, f = 0, g = qb.prefilters.length, h = n.Deferred().always(function () { delete i.elem }), i = function () { if (e) { return !1 } for (var b = hb || lb(), c = Math.max(0, j.startTime + j.duration - b), d = c / j.duration || 0, f = 1 - d, g = 0, i = j.tweens.length; i > g; g++) { j.tweens[g].run(f) } return h.notifyWith(a, [j, f, c]), 1 > f && i ? c : (h.resolveWith(a, [j]), !1) }, j = h.promise({ elem: a, props: n.extend({}, b), opts: n.extend(!0, { specialEasing: {}, easing: n.easing._default }, c), originalProperties: b, originalOptions: c, startTime: hb || lb(), duration: c.duration, tweens: [], createTween: function (b, c) { var d = n.Tween(a, j.opts, b, c, j.opts.specialEasing[b] || j.opts.easing); return j.tweens.push(d), d }, stop: function (b) { var c = 0, d = b ? j.tweens.length : 0; if (e) { return this } for (e = !0; d > c; c++) { j.tweens[c].run(1) } return b ? (h.notifyWith(a, [j, 1, 0]), h.resolveWith(a, [j, b])) : h.rejectWith(a, [j, b]), this } }), k = j.props; for (pb(k, j.opts.specialEasing); g > f; f++) { if (d = qb.prefilters[f].call(j, a, k, j.opts)) { return n.isFunction(d.stop) && (n._queueHooks(j.elem, j.opts.queue).stop = n.proxy(d.stop, d)), d } } return n.map(k, nb, j), n.isFunction(j.opts.start) && j.opts.start.call(a, j), n.fx.timer(n.extend(i, { elem: a, anim: j, queue: j.opts.queue })), j.progress(j.opts.progress).done(j.opts.done, j.opts.complete).fail(j.opts.fail).always(j.opts.always) } n.Animation = n.extend(qb, { tweeners: { "*": [function (a, b) { var c = this.createTween(a, b); return X(c.elem, a, U.exec(b), c), c }] }, tweener: function (a, b) { n.isFunction(a) ? (b = a, a = ["*"]) : a = a.match(G); for (var c, d = 0, e = a.length; e > d; d++) { c = a[d], qb.tweeners[c] = qb.tweeners[c] || [], qb.tweeners[c].unshift(b) } }, prefilters: [ob], prefilter: function (a, b) { b ? qb.prefilters.unshift(a) : qb.prefilters.push(a) } }), n.speed = function (a, b, c) { var d = a && "object" == typeof a ? n.extend({}, a) : { complete: c || !c && b || n.isFunction(a) && a, duration: a, easing: c && b || b && !n.isFunction(b) && b }; return d.duration = n.fx.off ? 0 : "number" == typeof d.duration ? d.duration : d.duration in n.fx.speeds ? n.fx.speeds[d.duration] : n.fx.speeds._default, null != d.queue && d.queue !== !0 || (d.queue = "fx"), d.old = d.complete, d.complete = function () { n.isFunction(d.old) && d.old.call(this), d.queue && n.dequeue(this, d.queue) }, d }, n.fn.extend({ fadeTo: function (a, b, c, d) { return this.filter(W).css("opacity", 0).show().end().animate({ opacity: b }, a, c, d) }, animate: function (a, b, c, d) { var e = n.isEmptyObject(a), f = n.speed(b, c, d), g = function () { var b = qb(this, n.extend({}, a), f); (e || n._data(this, "finish")) && b.stop(!0) }; return g.finish = g, e || f.queue === !1 ? this.each(g) : this.queue(f.queue, g) }, stop: function (a, b, c) { var d = function (a) { var b = a.stop; delete a.stop, b(c) }; return "string" != typeof a && (c = b, b = a, a = void 0), b && a !== !1 && this.queue(a || "fx", []), this.each(function () { var b = !0, e = null != a && a + "queueHooks", f = n.timers, g = n._data(this); if (e) { g[e] && g[e].stop && d(g[e]) } else { for (e in g) { g[e] && g[e].stop && kb.test(e) && d(g[e]) } } for (e = f.length; e--;) { f[e].elem !== this || null != a && f[e].queue !== a || (f[e].anim.stop(c), b = !1, f.splice(e, 1)) } !b && c || n.dequeue(this, a) }) }, finish: function (a) { return a !== !1 && (a = a || "fx"), this.each(function () { var b, c = n._data(this), d = c[a + "queue"], e = c[a + "queueHooks"], f = n.timers, g = d ? d.length : 0; for (c.finish = !0, n.queue(this, a, []), e && e.stop && e.stop.call(this, !0), b = f.length; b--;) { f[b].elem === this && f[b].queue === a && (f[b].anim.stop(!0), f.splice(b, 1)) } for (b = 0; g > b; b++) { d[b] && d[b].finish && d[b].finish.call(this) } delete c.finish }) } }), n.each(["toggle", "show", "hide"], function (a, b) { var c = n.fn[b]; n.fn[b] = function (a, d, e) { return null == a || "boolean" == typeof a ? c.apply(this, arguments) : this.animate(mb(b, !0), a, d, e) } }), n.each({ slideDown: mb("show"), slideUp: mb("hide"), slideToggle: mb("toggle"), fadeIn: { opacity: "show" }, fadeOut: { opacity: "hide" }, fadeToggle: { opacity: "toggle" } }, function (a, b) { n.fn[a] = function (a, c, d) { return this.animate(b, a, c, d) } }), n.timers = [], n.fx.tick = function () { var a, b = n.timers, c = 0; for (hb = n.now(); c < b.length; c++) { a = b[c], a() || b[c] !== a || b.splice(c--, 1) } b.length || n.fx.stop(), hb = void 0 }, n.fx.timer = function (a) { n.timers.push(a), a() ? n.fx.start() : n.timers.pop() }, n.fx.interval = 13, n.fx.start = function () { ib || (ib = a.setInterval(n.fx.tick, n.fx.interval)) }, n.fx.stop = function () { a.clearInterval(ib), ib = null }, n.fx.speeds = { slow: 600, fast: 200, _default: 400 }, n.fn.delay = function (b, c) { return b = n.fx ? n.fx.speeds[b] || b : b, c = c || "fx", this.queue(c, function (c, d) { var e = a.setTimeout(c, b); d.stop = function () { a.clearTimeout(e) } }) }, function () { var a, b = d.createElement("input"), c = d.createElement("div"), e = d.createElement("select"), f = e.appendChild(d.createElement("option")); c = d.createElement("div"), c.setAttribute("className", "t"), c.innerHTML = "  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>", a = c.getElementsByTagName("a")[0], b.setAttribute("type", "checkbox"), c.appendChild(b), a = c.getElementsByTagName("a")[0], a.style.cssText = "top:1px", l.getSetAttribute = "t" !== c.className, l.style = /top/.test(a.getAttribute("style")), l.hrefNormalized = "/a" === a.getAttribute("href"), l.checkOn = !!b.value, l.optSelected = f.selected, l.enctype = !!d.createElement("form").enctype, e.disabled = !0, l.optDisabled = !f.disabled, b = d.createElement("input"), b.setAttribute("value", ""), l.input = "" === b.getAttribute("value"), b.value = "t", b.setAttribute("type", "radio"), l.radioValue = "t" === b.value }(); var rb = /\r/g, sb = /[\x20\t\r\n\f]+/g; n.fn.extend({ val: function (a) { var b, c, d, e = this[0]; if (arguments.length) { return d = n.isFunction(a), this.each(function (c) { var e; 1 === this.nodeType && (e = d ? a.call(this, c, n(this).val()) : a, null == e ? e = "" : "number" == typeof e ? e += "" : n.isArray(e) && (e = n.map(e, function (a) { return null == a ? "" : a + "" })), b = n.valHooks[this.type] || n.valHooks[this.nodeName.toLowerCase()], b && "set" in b && void 0 !== b.set(this, e, "value") || (this.value = e)) }) } if (e) { return b = n.valHooks[e.type] || n.valHooks[e.nodeName.toLowerCase()], b && "get" in b && void 0 !== (c = b.get(e, "value")) ? c : (c = e.value, "string" == typeof c ? c.replace(rb, "") : null == c ? "" : c) } } }), n.extend({ valHooks: { option: { get: function (a) { var b = n.find.attr(a, "value"); return null != b ? b : n.trim(n.text(a)).replace(sb, " ") } }, select: { get: function (a) { for (var b, c, d = a.options, e = a.selectedIndex, f = "select-one" === a.type || 0 > e, g = f ? null : [], h = f ? e + 1 : d.length, i = 0 > e ? h : f ? e : 0; h > i; i++) { if (c = d[i], (c.selected || i === e) && (l.optDisabled ? !c.disabled : null === c.getAttribute("disabled")) && (!c.parentNode.disabled || !n.nodeName(c.parentNode, "optgroup"))) { if (b = n(c).val(), f) { return b } g.push(b) } } return g }, set: function (a, b) { var c, d, e = a.options, f = n.makeArray(b), g = e.length; while (g--) { if (d = e[g], n.inArray(n.valHooks.option.get(d), f) > -1) { try { d.selected = c = !0 } catch (h) { d.scrollHeight } } else { d.selected = !1 } } return c || (a.selectedIndex = -1), e } } } }), n.each(["radio", "checkbox"], function () { n.valHooks[this] = { set: function (a, b) { return n.isArray(b) ? a.checked = n.inArray(n(a).val(), b) > -1 : void 0 } }, l.checkOn || (n.valHooks[this].get = function (a) { return null === a.getAttribute("value") ? "on" : a.value }) }); var tb, ub, vb = n.expr.attrHandle, wb = /^(?:checked|selected)$/i, xb = l.getSetAttribute, yb = l.input; n.fn.extend({ attr: function (a, b) { return Y(this, n.attr, a, b, arguments.length > 1) }, removeAttr: function (a) { return this.each(function () { n.removeAttr(this, a) }) } }), n.extend({ attr: function (a, b, c) { var d, e, f = a.nodeType; if (3 !== f && 8 !== f && 2 !== f) { return "undefined" == typeof a.getAttribute ? n.prop(a, b, c) : (1 === f && n.isXMLDoc(a) || (b = b.toLowerCase(), e = n.attrHooks[b] || (n.expr.match.bool.test(b) ? ub : tb)), void 0 !== c ? null === c ? void n.removeAttr(a, b) : e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : (a.setAttribute(b, c + ""), c) : e && "get" in e && null !== (d = e.get(a, b)) ? d : (d = n.find.attr(a, b), null == d ? void 0 : d)) } }, attrHooks: { type: { set: function (a, b) { if (!l.radioValue && "radio" === b && n.nodeName(a, "input")) { var c = a.value; return a.setAttribute("type", b), c && (a.value = c), b } } } }, removeAttr: function (a, b) { var c, d, e = 0, f = b && b.match(G); if (f && 1 === a.nodeType) { while (c = f[e++]) { d = n.propFix[c] || c, n.expr.match.bool.test(c) ? yb && xb || !wb.test(c) ? a[d] = !1 : a[n.camelCase("default-" + c)] = a[d] = !1 : n.attr(a, c, ""), a.removeAttribute(xb ? c : d) } } } }), ub = { set: function (a, b, c) { return b === !1 ? n.removeAttr(a, c) : yb && xb || !wb.test(c) ? a.setAttribute(!xb && n.propFix[c] || c, c) : a[n.camelCase("default-" + c)] = a[c] = !0, c } }, n.each(n.expr.match.bool.source.match(/\w+/g), function (a, b) { var c = vb[b] || n.find.attr; yb && xb || !wb.test(b) ? vb[b] = function (a, b, d) { var e, f; return d || (f = vb[b], vb[b] = e, e = null != c(a, b, d) ? b.toLowerCase() : null, vb[b] = f), e } : vb[b] = function (a, b, c) { return c ? void 0 : a[n.camelCase("default-" + b)] ? b.toLowerCase() : null } }), yb && xb || (n.attrHooks.value = { set: function (a, b, c) { return n.nodeName(a, "input") ? void (a.defaultValue = b) : tb && tb.set(a, b, c) } }), xb || (tb = { set: function (a, b, c) { var d = a.getAttributeNode(c); return d || a.setAttributeNode(d = a.ownerDocument.createAttribute(c)), d.value = b += "", "value" === c || b === a.getAttribute(c) ? b : void 0 } }, vb.id = vb.name = vb.coords = function (a, b, c) { var d; return c ? void 0 : (d = a.getAttributeNode(b)) && "" !== d.value ? d.value : null }, n.valHooks.button = { get: function (a, b) { var c = a.getAttributeNode(b); return c && c.specified ? c.value : void 0 }, set: tb.set }, n.attrHooks.contenteditable = { set: function (a, b, c) { tb.set(a, "" === b ? !1 : b, c) } }, n.each(["width", "height"], function (a, b) { n.attrHooks[b] = { set: function (a, c) { return "" === c ? (a.setAttribute(b, "auto"), c) : void 0 } } })), l.style || (n.attrHooks.style = { get: function (a) { return a.style.cssText || void 0 }, set: function (a, b) { return a.style.cssText = b + "" } }); var zb = /^(?:input|select|textarea|button|object)$/i, Ab = /^(?:a|area)$/i; n.fn.extend({ prop: function (a, b) { return Y(this, n.prop, a, b, arguments.length > 1) }, removeProp: function (a) { return a = n.propFix[a] || a, this.each(function () { try { this[a] = void 0, delete this[a] } catch (b) { } }) } }), n.extend({ prop: function (a, b, c) { var d, e, f = a.nodeType; if (3 !== f && 8 !== f && 2 !== f) { return 1 === f && n.isXMLDoc(a) || (b = n.propFix[b] || b, e = n.propHooks[b]), void 0 !== c ? e && "set" in e && void 0 !== (d = e.set(a, c, b)) ? d : a[b] = c : e && "get" in e && null !== (d = e.get(a, b)) ? d : a[b] } }, propHooks: { tabIndex: { get: function (a) { var b = n.find.attr(a, "tabindex"); return b ? parseInt(b, 10) : zb.test(a.nodeName) || Ab.test(a.nodeName) && a.href ? 0 : -1 } } }, propFix: { "for": "htmlFor", "class": "className" } }), l.hrefNormalized || n.each(["href", "src"], function (a, b) { n.propHooks[b] = { get: function (a) { return a.getAttribute(b, 4) } } }), l.optSelected || (n.propHooks.selected = { get: function (a) { var b = a.parentNode; return b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex), null }, set: function (a) { var b = a.parentNode; b && (b.selectedIndex, b.parentNode && b.parentNode.selectedIndex) } }), n.each(["tabIndex", "readOnly", "maxLength", "cellSpacing", "cellPadding", "rowSpan", "colSpan", "useMap", "frameBorder", "contentEditable"], function () { n.propFix[this.toLowerCase()] = this }), l.enctype || (n.propFix.enctype = "encoding"); var Bb = /[\t\r\n\f]/g; function Cb(a) { return n.attr(a, "class") || "" } n.fn.extend({ addClass: function (a) { var b, c, d, e, f, g, h, i = 0; if (n.isFunction(a)) { return this.each(function (b) { n(this).addClass(a.call(this, b, Cb(this))) }) } if ("string" == typeof a && a) { b = a.match(G) || []; while (c = this[i++]) { if (e = Cb(c), d = 1 === c.nodeType && (" " + e + " ").replace(Bb, " ")) { g = 0; while (f = b[g++]) { d.indexOf(" " + f + " ") < 0 && (d += f + " ") } h = n.trim(d), e !== h && n.attr(c, "class", h) } } } return this }, removeClass: function (a) { var b, c, d, e, f, g, h, i = 0; if (n.isFunction(a)) { return this.each(function (b) { n(this).removeClass(a.call(this, b, Cb(this))) }) } if (!arguments.length) { return this.attr("class", "") } if ("string" == typeof a && a) { b = a.match(G) || []; while (c = this[i++]) { if (e = Cb(c), d = 1 === c.nodeType && (" " + e + " ").replace(Bb, " ")) { g = 0; while (f = b[g++]) { while (d.indexOf(" " + f + " ") > -1) { d = d.replace(" " + f + " ", " ") } } h = n.trim(d), e !== h && n.attr(c, "class", h) } } } return this }, toggleClass: function (a, b) { var c = typeof a; return "boolean" == typeof b && "string" === c ? b ? this.addClass(a) : this.removeClass(a) : n.isFunction(a) ? this.each(function (c) { n(this).toggleClass(a.call(this, c, Cb(this), b), b) }) : this.each(function () { var b, d, e, f; if ("string" === c) { d = 0, e = n(this), f = a.match(G) || []; while (b = f[d++]) { e.hasClass(b) ? e.removeClass(b) : e.addClass(b) } } else { void 0 !== a && "boolean" !== c || (b = Cb(this), b && n._data(this, "__className__", b), n.attr(this, "class", b || a === !1 ? "" : n._data(this, "__className__") || "")) } }) }, hasClass: function (a) { var b, c, d = 0; b = " " + a + " "; while (c = this[d++]) { if (1 === c.nodeType && (" " + Cb(c) + " ").replace(Bb, " ").indexOf(b) > -1) { return !0 } } return !1 } }), n.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "), function (a, b) { n.fn[b] = function (a, c) { return arguments.length > 0 ? this.on(b, null, a, c) : this.trigger(b) } }), n.fn.extend({ hover: function (a, b) { return this.mouseenter(a).mouseleave(b || a) } }); var Db = a.location, Eb = n.now(), Fb = /\?/, Gb = /(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g; n.parseJSON = function (b) { if (a.JSON && a.JSON.parse) { return a.JSON.parse(b + "") } var c, d = null, e = n.trim(b + ""); return e && !n.trim(e.replace(Gb, function (a, b, e, f) { return c && b && (d = 0), 0 === d ? a : (c = e || b, d += !f - !e, "") })) ? Function("return " + e)() : n.error("Invalid JSON: " + b) }, n.parseXML = function (b) { var c, d; if (!b || "string" != typeof b) { return null } try { a.DOMParser ? (d = new a.DOMParser, c = d.parseFromString(b, "text/xml")) : (c = new a.ActiveXObject("Microsoft.XMLDOM"), c.async = "false", c.loadXML(b)) } catch (e) { c = void 0 } return c && c.documentElement && !c.getElementsByTagName("parsererror").length || n.error("Invalid XML: " + b), c }; var Hb = /#.*$/, Ib = /([?&])_=[^&]*/, Jb = /^(.*?):[ \t]*([^\r\n]*)\r?$/gm, Kb = /^(?:about|app|app-storage|.+-extension|file|res|widget):$/, Lb = /^(?:GET|HEAD)$/, Mb = /^\/\//, Nb = /^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/, Ob = {}, Pb = {}, Qb = "*/".concat("*"), Rb = Db.href, Sb = Nb.exec(Rb.toLowerCase()) || []; function Tb(a) { return function (b, c) { "string" != typeof b && (c = b, b = "*"); var d, e = 0, f = b.toLowerCase().match(G) || []; if (n.isFunction(c)) { while (d = f[e++]) { "+" === d.charAt(0) ? (d = d.slice(1) || "*", (a[d] = a[d] || []).unshift(c)) : (a[d] = a[d] || []).push(c) } } } } function Ub(a, b, c, d) { var e = {}, f = a === Pb; function g(h) { var i; return e[h] = !0, n.each(a[h] || [], function (a, h) { var j = h(b, c, d); return "string" != typeof j || f || e[j] ? f ? !(i = j) : void 0 : (b.dataTypes.unshift(j), g(j), !1) }), i } return g(b.dataTypes[0]) || !e["*"] && g("*") } function Vb(a, b) { var c, d, e = n.ajaxSettings.flatOptions || {}; for (d in b) { void 0 !== b[d] && ((e[d] ? a : c || (c = {}))[d] = b[d]) } return c && n.extend(!0, a, c), a } function Wb(a, b, c) { var d, e, f, g, h = a.contents, i = a.dataTypes; while ("*" === i[0]) { i.shift(), void 0 === e && (e = a.mimeType || b.getResponseHeader("Content-Type")) } if (e) { for (g in h) { if (h[g] && h[g].test(e)) { i.unshift(g); break } } } if (i[0] in c) { f = i[0] } else { for (g in c) { if (!i[0] || a.converters[g + " " + i[0]]) { f = g; break } d || (d = g) } f = f || d } return f ? (f !== i[0] && i.unshift(f), c[f]) : void 0 } function Xb(a, b, c, d) { var e, f, g, h, i, j = {}, k = a.dataTypes.slice(); if (k[1]) { for (g in a.converters) { j[g.toLowerCase()] = a.converters[g] } } f = k.shift(); while (f) { if (a.responseFields[f] && (c[a.responseFields[f]] = b), !i && d && a.dataFilter && (b = a.dataFilter(b, a.dataType)), i = f, f = k.shift()) { if ("*" === f) { f = i } else { if ("*" !== i && i !== f) { if (g = j[i + " " + f] || j["* " + f], !g) { for (e in j) { if (h = e.split(" "), h[1] === f && (g = j[i + " " + h[0]] || j["* " + h[0]])) { g === !0 ? g = j[e] : j[e] !== !0 && (f = h[0], k.unshift(h[1])); break } } } if (g !== !0) { if (g && a["throws"]) { b = g(b) } else { try { b = g(b) } catch (l) { return { state: "parsererror", error: g ? l : "No conversion from " + i + " to " + f } } } } } } } } return { state: "success", data: b } } n.extend({ active: 0, lastModified: {}, etag: {}, ajaxSettings: { url: Rb, type: "GET", isLocal: Kb.test(Sb[1]), global: !0, processData: !0, async: !0, contentType: "application/x-www-form-urlencoded; charset=UTF-8", accepts: { "*": Qb, text: "text/plain", html: "text/html", xml: "application/xml, text/xml", json: "application/json, text/javascript" }, contents: { xml: /\bxml\b/, html: /\bhtml/, json: /\bjson\b/ }, responseFields: { xml: "responseXML", text: "responseText", json: "responseJSON" }, converters: { "* text": String, "text html": !0, "text json": n.parseJSON, "text xml": n.parseXML }, flatOptions: { url: !0, context: !0 } }, ajaxSetup: function (a, b) { return b ? Vb(Vb(a, n.ajaxSettings), b) : Vb(n.ajaxSettings, a) }, ajaxPrefilter: Tb(Ob), ajaxTransport: Tb(Pb), ajax: function (b, c) { "object" == typeof b && (c = b, b = void 0), c = c || {}; var d, e, f, g, h, i, j, k, l = n.ajaxSetup({}, c), m = l.context || l, o = l.context && (m.nodeType || m.jquery) ? n(m) : n.event, p = n.Deferred(), q = n.Callbacks("once memory"), r = l.statusCode || {}, s = {}, t = {}, u = 0, v = "canceled", w = { readyState: 0, getResponseHeader: function (a) { var b; if (2 === u) { if (!k) { k = {}; while (b = Jb.exec(g)) { k[b[1].toLowerCase()] = b[2] } } b = k[a.toLowerCase()] } return null == b ? null : b }, getAllResponseHeaders: function () { return 2 === u ? g : null }, setRequestHeader: function (a, b) { var c = a.toLowerCase(); return u || (a = t[c] = t[c] || a, s[a] = b), this }, overrideMimeType: function (a) { return u || (l.mimeType = a), this }, statusCode: function (a) { var b; if (a) { if (2 > u) { for (b in a) { r[b] = [r[b], a[b]] } } else { w.always(a[w.status]) } } return this }, abort: function (a) { var b = a || v; return j && j.abort(b), y(0, b), this } }; if (p.promise(w).complete = q.add, w.success = w.done, w.error = w.fail, l.url = ((b || l.url || Rb) + "").replace(Hb, "").replace(Mb, Sb[1] + "//"), l.type = c.method || c.type || l.method || l.type, l.dataTypes = n.trim(l.dataType || "*").toLowerCase().match(G) || [""], null == l.crossDomain && (d = Nb.exec(l.url.toLowerCase()), l.crossDomain = !(!d || d[1] === Sb[1] && d[2] === Sb[2] && (d[3] || ("http:" === d[1] ? "80" : "443")) === (Sb[3] || ("http:" === Sb[1] ? "80" : "443")))), l.data && l.processData && "string" != typeof l.data && (l.data = n.param(l.data, l.traditional)), Ub(Ob, l, c, w), 2 === u) { return w } i = n.event && l.global, i && 0 === n.active++ && n.event.trigger("ajaxStart"), l.type = l.type.toUpperCase(), l.hasContent = !Lb.test(l.type), f = l.url, l.hasContent || (l.data && (f = l.url += (Fb.test(f) ? "&" : "?") + l.data, delete l.data), l.cache === !1 && (l.url = Ib.test(f) ? f.replace(Ib, "$1_=" + Eb++) : f + (Fb.test(f) ? "&" : "?") + "_=" + Eb++)), l.ifModified && (n.lastModified[f] && w.setRequestHeader("If-Modified-Since", n.lastModified[f]), n.etag[f] && w.setRequestHeader("If-None-Match", n.etag[f])), (l.data && l.hasContent && l.contentType !== !1 || c.contentType) && w.setRequestHeader("Content-Type", l.contentType), w.setRequestHeader("Accept", l.dataTypes[0] && l.accepts[l.dataTypes[0]] ? l.accepts[l.dataTypes[0]] + ("*" !== l.dataTypes[0] ? ", " + Qb + "; q=0.01" : "") : l.accepts["*"]); for (e in l.headers) { w.setRequestHeader(e, l.headers[e]) } if (l.beforeSend && (l.beforeSend.call(m, w, l) === !1 || 2 === u)) { return w.abort() } v = "abort"; for (e in { success: 1, error: 1, complete: 1 }) { w[e](l[e]) } if (j = Ub(Pb, l, c, w)) { if (w.readyState = 1, i && o.trigger("ajaxSend", [w, l]), 2 === u) { return w } l.async && l.timeout > 0 && (h = a.setTimeout(function () { w.abort("timeout") }, l.timeout)); try { u = 1, j.send(s, y) } catch (x) { if (!(2 > u)) { throw x } y(-1, x) } } else { y(-1, "No Transport") } function y(b, c, d, e) { var k, s, t, v, x, y = c; 2 !== u && (u = 2, h && a.clearTimeout(h), j = void 0, g = e || "", w.readyState = b > 0 ? 4 : 0, k = b >= 200 && 300 > b || 304 === b, d && (v = Wb(l, w, d)), v = Xb(l, v, w, k), k ? (l.ifModified && (x = w.getResponseHeader("Last-Modified"), x && (n.lastModified[f] = x), x = w.getResponseHeader("etag"), x && (n.etag[f] = x)), 204 === b || "HEAD" === l.type ? y = "nocontent" : 304 === b ? y = "notmodified" : (y = v.state, s = v.data, t = v.error, k = !t)) : (t = y, !b && y || (y = "error", 0 > b && (b = 0))), w.status = b, w.statusText = (c || y) + "", k ? p.resolveWith(m, [s, y, w]) : p.rejectWith(m, [w, y, t]), w.statusCode(r), r = void 0, i && o.trigger(k ? "ajaxSuccess" : "ajaxError", [w, l, k ? s : t]), q.fireWith(m, [w, y]), i && (o.trigger("ajaxComplete", [w, l]), --n.active || n.event.trigger("ajaxStop"))) } return w }, getJSON: function (a, b, c) { return n.get(a, b, c, "json") }, getScript: function (a, b) { return n.get(a, void 0, b, "script") } }), n.each(["get", "post"], function (a, b) { n[b] = function (a, c, d, e) { return n.isFunction(c) && (e = e || d, d = c, c = void 0), n.ajax(n.extend({ url: a, type: b, dataType: e, data: c, success: d }, n.isPlainObject(a) && a)) } }), n._evalUrl = function (a) { return n.ajax({ url: a, type: "GET", dataType: "script", cache: !0, async: !1, global: !1, "throws": !0 }) }, n.fn.extend({ wrapAll: function (a) { if (n.isFunction(a)) { return this.each(function (b) { n(this).wrapAll(a.call(this, b)) }) } if (this[0]) { var b = n(a, this[0].ownerDocument).eq(0).clone(!0); this[0].parentNode && b.insertBefore(this[0]), b.map(function () { var a = this; while (a.firstChild && 1 === a.firstChild.nodeType) { a = a.firstChild } return a }).append(this) } return this }, wrapInner: function (a) { return n.isFunction(a) ? this.each(function (b) { n(this).wrapInner(a.call(this, b)) }) : this.each(function () { var b = n(this), c = b.contents(); c.length ? c.wrapAll(a) : b.append(a) }) }, wrap: function (a) { var b = n.isFunction(a); return this.each(function (c) { n(this).wrapAll(b ? a.call(this, c) : a) }) }, unwrap: function () { return this.parent().each(function () { n.nodeName(this, "body") || n(this).replaceWith(this.childNodes) }).end() } }); function Yb(a) { return a.style && a.style.display || n.css(a, "display") } function Zb(a) { if (!n.contains(a.ownerDocument || d, a)) { return !0 } while (a && 1 === a.nodeType) { if ("none" === Yb(a) || "hidden" === a.type) { return !0 } a = a.parentNode } return !1 } n.expr.filters.hidden = function (a) { return l.reliableHiddenOffsets() ? a.offsetWidth <= 0 && a.offsetHeight <= 0 && !a.getClientRects().length : Zb(a) }, n.expr.filters.visible = function (a) { return !n.expr.filters.hidden(a) }; var $b = /%20/g, _b = /\[\]$/, ac = /\r?\n/g, bc = /^(?:submit|button|image|reset|file)$/i, cc = /^(?:input|select|textarea|keygen)/i; function dc(a, b, c, d) { var e; if (n.isArray(b)) { n.each(b, function (b, e) { c || _b.test(a) ? d(a, e) : dc(a + "[" + ("object" == typeof e && null != e ? b : "") + "]", e, c, d) }) } else { if (c || "object" !== n.type(b)) { d(a, b) } else { for (e in b) { dc(a + "[" + e + "]", b[e], c, d) } } } } n.param = function (a, b) { var c, d = [], e = function (a, b) { b = n.isFunction(b) ? b() : null == b ? "" : b, d[d.length] = encodeURIComponent(a) + "=" + encodeURIComponent(b) }; if (void 0 === b && (b = n.ajaxSettings && n.ajaxSettings.traditional), n.isArray(a) || a.jquery && !n.isPlainObject(a)) { n.each(a, function () { e(this.name, this.value) }) } else { for (c in a) { dc(c, a[c], b, e) } } return d.join("&").replace($b, "+") }, n.fn.extend({ serialize: function () { return n.param(this.serializeArray()) }, serializeArray: function () { return this.map(function () { var a = n.prop(this, "elements"); return a ? n.makeArray(a) : this }).filter(function () { var a = this.type; return this.name && !n(this).is(":disabled") && cc.test(this.nodeName) && !bc.test(a) && (this.checked || !Z.test(a)) }).map(function (a, b) { var c = n(this).val(); return null == c ? null : n.isArray(c) ? n.map(c, function (a) { return { name: b.name, value: a.replace(ac, "\r\n") } }) : { name: b.name, value: c.replace(ac, "\r\n") } }).get() } }), n.ajaxSettings.xhr = void 0 !== a.ActiveXObject ? function () { return this.isLocal ? ic() : d.documentMode > 8 ? hc() : /^(get|post|head|put|delete|options)$/i.test(this.type) && hc() || ic() } : hc; var ec = 0, fc = {}, gc = n.ajaxSettings.xhr(); a.attachEvent && a.attachEvent("onunload", function () { for (var a in fc) { fc[a](void 0, !0) } }), l.cors = !!gc && "withCredentials" in gc, gc = l.ajax = !!gc, gc && n.ajaxTransport(function (b) { if (!b.crossDomain || l.cors) { var c; return { send: function (d, e) { var f, g = b.xhr(), h = ++ec; if (g.open(b.type, b.url, b.async, b.username, b.password), b.xhrFields) { for (f in b.xhrFields) { g[f] = b.xhrFields[f] } } b.mimeType && g.overrideMimeType && g.overrideMimeType(b.mimeType), b.crossDomain || d["X-Requested-With"] || (d["X-Requested-With"] = "XMLHttpRequest"); for (f in d) { void 0 !== d[f] && g.setRequestHeader(f, d[f] + "") } g.send(b.hasContent && b.data || null), c = function (a, d) { var f, i, j; if (c && (d || 4 === g.readyState)) { if (delete fc[h], c = void 0, g.onreadystatechange = n.noop, d) { 4 !== g.readyState && g.abort() } else { j = {}, f = g.status, "string" == typeof g.responseText && (j.text = g.responseText); try { i = g.statusText } catch (k) { i = "" } f || !b.isLocal || b.crossDomain ? 1223 === f && (f = 204) : f = j.text ? 200 : 404 } } j && e(f, i, j, g.getAllResponseHeaders()) }, b.async ? 4 === g.readyState ? a.setTimeout(c) : g.onreadystatechange = fc[h] = c : c() }, abort: function () { c && c(void 0, !0) } } } }); function hc() { try { return new a.XMLHttpRequest } catch (b) { } } function ic() { try { return new a.ActiveXObject("Microsoft.XMLHTTP") } catch (b) { } } n.ajaxSetup({ accepts: { script: "text/javascript, application/javascript, application/ecmascript, application/x-ecmascript" }, contents: { script: /\b(?:java|ecma)script\b/ }, converters: { "text script": function (a) { return n.globalEval(a), a } } }), n.ajaxPrefilter("script", function (a) { void 0 === a.cache && (a.cache = !1), a.crossDomain && (a.type = "GET", a.global = !1) }), n.ajaxTransport("script", function (a) { if (a.crossDomain) { var b, c = d.head || n("head")[0] || d.documentElement; return { send: function (e, f) { b = d.createElement("script"), b.async = !0, a.scriptCharset && (b.charset = a.scriptCharset), b.src = a.url, b.onload = b.onreadystatechange = function (a, c) { (c || !b.readyState || /loaded|complete/.test(b.readyState)) && (b.onload = b.onreadystatechange = null, b.parentNode && b.parentNode.removeChild(b), b = null, c || f(200, "success")) }, c.insertBefore(b, c.firstChild) }, abort: function () { b && b.onload(void 0, !0) } } } }); var jc = [], kc = /(=)\?(?=&|$)|\?\?/; n.ajaxSetup({ jsonp: "callback", jsonpCallback: function () { var a = jc.pop() || n.expando + "_" + Eb++; return this[a] = !0, a } }), n.ajaxPrefilter("json jsonp", function (b, c, d) { var e, f, g, h = b.jsonp !== !1 && (kc.test(b.url) ? "url" : "string" == typeof b.data && 0 === (b.contentType || "").indexOf("application/x-www-form-urlencoded") && kc.test(b.data) && "data"); return h || "jsonp" === b.dataTypes[0] ? (e = b.jsonpCallback = n.isFunction(b.jsonpCallback) ? b.jsonpCallback() : b.jsonpCallback, h ? b[h] = b[h].replace(kc, "$1" + e) : b.jsonp !== !1 && (b.url += (Fb.test(b.url) ? "&" : "?") + b.jsonp + "=" + e), b.converters["script json"] = function () { return g || n.error(e + " was not called"), g[0] }, b.dataTypes[0] = "json", f = a[e], a[e] = function () { g = arguments }, d.always(function () { void 0 === f ? n(a).removeProp(e) : a[e] = f, b[e] && (b.jsonpCallback = c.jsonpCallback, jc.push(e)), g && n.isFunction(f) && f(g[0]), g = f = void 0 }), "script") : void 0 }), n.parseHTML = function (a, b, c) { if (!a || "string" != typeof a) { return null } "boolean" == typeof b && (c = b, b = !1), b = b || d; var e = x.exec(a), f = !c && []; return e ? [b.createElement(e[1])] : (e = ja([a], b, f), f && f.length && n(f).remove(), n.merge([], e.childNodes)) }; var lc = n.fn.load; n.fn.load = function (a, b, c) { if ("string" != typeof a && lc) { return lc.apply(this, arguments) } var d, e, f, g = this, h = a.indexOf(" "); return h > -1 && (d = n.trim(a.slice(h, a.length)), a = a.slice(0, h)), n.isFunction(b) ? (c = b, b = void 0) : b && "object" == typeof b && (e = "POST"), g.length > 0 && n.ajax({ url: a, type: e || "GET", dataType: "html", data: b }).done(function (a) { f = arguments, g.html(d ? n("<div>").append(n.parseHTML(a)).find(d) : a) }).always(c && function (a, b) { g.each(function () { c.apply(this, f || [a.responseText, b, a]) }) }), this }, n.each(["ajaxStart", "ajaxStop", "ajaxComplete", "ajaxError", "ajaxSuccess", "ajaxSend"], function (a, b) { n.fn[b] = function (a) { return this.on(b, a) } }), n.expr.filters.animated = function (a) { return n.grep(n.timers, function (b) { return a === b.elem }).length }; function mc(a) { return n.isWindow(a) ? a : 9 === a.nodeType ? a.defaultView || a.parentWindow : !1 } n.offset = { setOffset: function (a, b, c) { var d, e, f, g, h, i, j, k = n.css(a, "position"), l = n(a), m = {}; "static" === k && (a.style.position = "relative"), h = l.offset(), f = n.css(a, "top"), i = n.css(a, "left"), j = ("absolute" === k || "fixed" === k) && n.inArray("auto", [f, i]) > -1, j ? (d = l.position(), g = d.top, e = d.left) : (g = parseFloat(f) || 0, e = parseFloat(i) || 0), n.isFunction(b) && (b = b.call(a, c, n.extend({}, h))), null != b.top && (m.top = b.top - h.top + g), null != b.left && (m.left = b.left - h.left + e), "using" in b ? b.using.call(a, m) : l.css(m) } }, n.fn.extend({ offset: function (a) { if (arguments.length) { return void 0 === a ? this : this.each(function (b) { n.offset.setOffset(this, a, b) }) } var b, c, d = { top: 0, left: 0 }, e = this[0], f = e && e.ownerDocument; if (f) { return b = f.documentElement, n.contains(b, e) ? ("undefined" != typeof e.getBoundingClientRect && (d = e.getBoundingClientRect()), c = mc(f), { top: d.top + (c.pageYOffset || b.scrollTop) - (b.clientTop || 0), left: d.left + (c.pageXOffset || b.scrollLeft) - (b.clientLeft || 0) }) : d } }, position: function () { if (this[0]) { var a, b, c = { top: 0, left: 0 }, d = this[0]; return "fixed" === n.css(d, "position") ? b = d.getBoundingClientRect() : (a = this.offsetParent(), b = this.offset(), n.nodeName(a[0], "html") || (c = a.offset()), c.top += n.css(a[0], "borderTopWidth", !0), c.left += n.css(a[0], "borderLeftWidth", !0)), { top: b.top - c.top - n.css(d, "marginTop", !0), left: b.left - c.left - n.css(d, "marginLeft", !0) } } }, offsetParent: function () { return this.map(function () { var a = this.offsetParent; while (a && !n.nodeName(a, "html") && "static" === n.css(a, "position")) { a = a.offsetParent } return a || Qa }) } }), n.each({ scrollLeft: "pageXOffset", scrollTop: "pageYOffset" }, function (a, b) { var c = /Y/.test(b); n.fn[a] = function (d) { return Y(this, function (a, d, e) { var f = mc(a); return void 0 === e ? f ? b in f ? f[b] : f.document.documentElement[d] : a[d] : void (f ? f.scrollTo(c ? n(f).scrollLeft() : e, c ? e : n(f).scrollTop()) : a[d] = e) }, a, d, arguments.length, null) } }), n.each(["top", "left"], function (a, b) { n.cssHooks[b] = Ua(l.pixelPosition, function (a, c) { return c ? (c = Sa(a, b), Oa.test(c) ? n(a).position()[b] + "px" : c) : void 0 }) }), n.each({ Height: "height", Width: "width" }, function (a, b) { n.each({ padding: "inner" + a, content: b, "": "outer" + a }, function (c, d) { n.fn[d] = function (d, e) { var f = arguments.length && (c || "boolean" != typeof d), g = c || (d === !0 || e === !0 ? "margin" : "border"); return Y(this, function (b, c, d) { var e; return n.isWindow(b) ? b.document.documentElement["client" + a] : 9 === b.nodeType ? (e = b.documentElement, Math.max(b.body["scroll" + a], e["scroll" + a], b.body["offset" + a], e["offset" + a], e["client" + a])) : void 0 === d ? n.css(b, c, g) : n.style(b, c, d, g) }, b, f ? d : void 0, f, null) } }) }), n.fn.extend({ bind: function (a, b, c) { return this.on(a, null, b, c) }, unbind: function (a, b) { return this.off(a, null, b) }, delegate: function (a, b, c, d) { return this.on(b, a, c, d) }, undelegate: function (a, b, c) { return 1 === arguments.length ? this.off(a, "**") : this.off(b, a || "**", c) } }), n.fn.size = function () { return this.length }, n.fn.andSelf = n.fn.addBack, "function" == typeof define && define.amd && define("jquery", [], function () { return n }); var nc = a.jQuery, oc = a.$; return n.noConflict = function (b) { return a.$ === n && (a.$ = oc), b && a.jQuery === n && (a.jQuery = nc), n }, b || (a.jQuery = a.$ = n), n }); (function (f) { var e = { topSpacing: 0, bottomSpacing: 0, className: "js-sticky", wrapperClassName: "js-sticky-wrapper" }, b = f(window), d = f(document), j = [], a = b.height(), g = function () { var k = b.scrollTop(), u = d.height(), t = u - a, n = (k > t) ? t - k : 0; for (var p = 0; p < j.length; p++) { var v = j[p], l = v.stickyWrapper.offset().top, q = l - v.topSpacing - n; if (k <= q) { if (v.currentTop !== null) { v.stickyElement.css("position", "").css("top", "").removeClass(v.className); v.stickyElement.parent().removeClass(v.className); v.currentTop = null } } else { var o = v.stickyElement.outerWidth(true); var r = u - v.stickyElement.outerHeight() - v.topSpacing - v.bottomSpacing - k - n; if (r < 0) { r = r + v.topSpacing } else { r = v.topSpacing } if (v.currentTop != r) { v.stickyElement.css("position", "fixed").css("top", r).css("width", o).addClass(v.className); v.stickyElement.parent().addClass(v.className); v.currentTop = r } } } }, h = function () { a = b.height() }, c = { init: function (k) { var l = f.extend(e, k); return this.each(function () { var n = f(this); stickyId = n.attr("id"); wrapper = f("<div></div>").attr("id", stickyId + "-sticky-wrapper").addClass(l.wrapperClassName); n.wrapAll(wrapper); var o = n.parent(); o.css("height", n.outerHeight()); j.push({ topSpacing: l.topSpacing, bottomSpacing: l.bottomSpacing, stickyElement: n, currentTop: null, stickyWrapper: o, className: l.className }) }) }, update: g }; if (window.addEventListener) { window.addEventListener("scroll", g, false); window.addEventListener("resize", h, false) } else { if (window.attachEvent) { window.attachEvent("onscroll", g); window.attachEvent("onresize", h) } } f.fn.sticky = function (k) { if (c[k]) { return c[k].apply(this, Array.prototype.slice.call(arguments, 1)) } else { if (typeof k === "object" || !k) { return c.init.apply(this, arguments) } else { f.error("Method " + k + " does not exist on jQuery.sticky") } } }; f(function () { setTimeout(g, 0) }) })(jQuery); (function (d) { var l, a, f, b = d(window), e = { jqueryui: { container: "ui-widget ui-widget-content ui-corner-all", notice: "ui-state-highlight", notice_icon: "ui-icon ui-icon-info", info: "", info_icon: "ui-icon ui-icon-info", success: "ui-state-default", success_icon: "ui-icon ui-icon-circle-check", error: "ui-state-error", error_icon: "ui-icon ui-icon-alert", closer: "ui-icon ui-icon-close", pin_up: "ui-icon ui-icon-pin-w", pin_down: "ui-icon ui-icon-pin-s", hi_menu: "ui-state-default ui-corner-bottom", hi_btn: "ui-state-default ui-corner-all", hi_btnhov: "ui-state-hover", hi_hnd: "ui-icon ui-icon-grip-dotted-horizontal" }, bootstrap: { container: "alert-info", notice: "", notice_icon: "icon-exclamation-sign", info: "alert-info", info_icon: "icon-info-sign", success: "alert-success", success_icon: "icon-ok-sign", error: "alert-error", error_icon: "icon-warning-sign", closer: "icon-remove", pin_up: "icon-pause", pin_down: "icon-play", hi_menu: "well", hi_btn: "btn", hi_btnhov: "", hi_hnd: "icon-chevron-down" } }; var k = function () { f = d("body"); b = d(window); b.bind("resize", function () { if (a) { clearTimeout(a) } a = setTimeout(d.pnotify_position_all, 10) }) }; if (document.body) { k() } else { d(k) } d.extend({ pnotify_remove_all: function () { var o = b.data("pnotify"); if (o && o.length) { d.each(o, function () { if (this.pnotify_remove) { this.pnotify_remove() } }) } }, pnotify_position_all: function () { if (a) { clearTimeout(a) } a = null; var o = b.data("pnotify"); if (!o || !o.length) { return } d.each(o, function () { var p = this.opts.stack; if (!p) { return } p.nextpos1 = p.firstpos1; p.nextpos2 = p.firstpos2; p.addpos2 = 0; p.animation = true }); d.each(o, function () { this.pnotify_position() }) }, pnotify: function (x) { var y; var o; if (typeof x != "object") { o = d.extend({}, d.pnotify.defaults); o.text = x } else { o = d.extend({}, d.pnotify.defaults, x) } for (var r in o) { if (typeof r == "string" && r.match(/^pnotify_/)) { o[r.replace(/^pnotify_/, "")] = o[r] } } if (o.before_init) { if (o.before_init(o) === false) { return null } } var q; var s = function (D, A) { u.css("display", "none"); var z = document.elementFromPoint(D.clientX, D.clientY); u.css("display", "block"); var C = d(z); var B = C.css("cursor"); u.css("cursor", B != "auto" ? B : "default"); if (!q || q.get(0) != z) { if (q) { g.call(q.get(0), "mouseleave", D.originalEvent); g.call(q.get(0), "mouseout", D.originalEvent) } g.call(z, "mouseenter", D.originalEvent); g.call(z, "mouseover", D.originalEvent) } g.call(z, A, D.originalEvent); q = C }; var w = e[o.styling]; var u = d("<div />", { "class": "ui-pnotify " + o.addclass, css: { display: "none" }, mouseenter: function (z) { if (o.nonblock) { z.stopPropagation() } if (o.mouse_reset && y == "out") { u.stop(true); y = "in"; u.css("height", "auto").animate({ width: o.width, opacity: o.nonblock ? o.nonblock_opacity : o.opacity }, "fast") } if (o.nonblock) { u.animate({ opacity: o.nonblock_opacity }, "fast") } if (o.hide && o.mouse_reset) { u.pnotify_cancel_remove() } if (o.sticker && !o.nonblock) { u.sticker.trigger("pnotify_icon").css("visibility", "visible") } if (o.closer && !o.nonblock) { u.closer.css("visibility", "visible") } }, mouseleave: function (z) { if (o.nonblock) { z.stopPropagation() } q = null; u.css("cursor", "auto"); if (o.nonblock && y != "out") { u.animate({ opacity: o.opacity }, "fast") } if (o.hide && o.mouse_reset) { u.pnotify_queue_remove() } if (o.sticker_hover) { u.sticker.css("visibility", "hidden") } if (o.closer_hover) { u.closer.css("visibility", "hidden") } d.pnotify_position_all() }, mouseover: function (z) { if (o.nonblock) { z.stopPropagation() } }, mouseout: function (z) { if (o.nonblock) { z.stopPropagation() } }, mousemove: function (z) { if (o.nonblock) { z.stopPropagation(); s(z, "onmousemove") } }, mousedown: function (z) { if (o.nonblock) { z.stopPropagation(); z.preventDefault(); s(z, "onmousedown") } }, mouseup: function (z) { if (o.nonblock) { z.stopPropagation(); z.preventDefault(); s(z, "onmouseup") } }, click: function (z) { if (o.nonblock) { z.stopPropagation(); s(z, "onclick") } }, dblclick: function (z) { if (o.nonblock) { z.stopPropagation(); s(z, "ondblclick") } } }); u.opts = o; u.container = d("<div />", { "class": w.container + " ui-pnotify-container " + (o.type == "error" ? w.error : (o.type == "info" ? w.info : (o.type == "success" ? w.success : w.notice))) }).appendTo(u); if (o.cornerclass != "") { u.container.removeClass("ui-corner-all").addClass(o.cornerclass) } if (o.shadow) { u.container.addClass("ui-pnotify-shadow") } u.pnotify_version = "1.2.0"; u.pnotify = function (z) { var B = o; if (typeof z == "string") { o.text = z } else { o = d.extend({}, o, z) } for (var A in o) { if (typeof A == "string" && A.match(/^pnotify_/)) { o[A.replace(/^pnotify_/, "")] = o[A] } } u.opts = o; if (o.cornerclass != B.cornerclass) { u.container.removeClass("ui-corner-all").addClass(o.cornerclass) } if (o.shadow != B.shadow) { if (o.shadow) { u.container.addClass("ui-pnotify-shadow") } else { u.container.removeClass("ui-pnotify-shadow") } } if (o.addclass === false) { u.removeClass(B.addclass) } else { if (o.addclass !== B.addclass) { u.removeClass(B.addclass).addClass(o.addclass) } } if (o.title === false) { u.title_container.slideUp("fast") } else { if (o.title !== B.title) { if (o.title_escape) { u.title_container.text(o.title).slideDown(200) } else { u.title_container.html(o.title).slideDown(200) } } } if (o.text === false) { u.text_container.slideUp("fast") } else { if (o.text !== B.text) { if (o.text_escape) { u.text_container.text(o.text).slideDown(200) } else { u.text_container.html(o.insert_brs ? String(o.text).replace(/\n/g, "<br />") : o.text).slideDown(200) } } } u.pnotify_history = o.history; u.pnotify_hide = o.hide; if (o.type != B.type) { u.container.removeClass(w.error + " " + w.notice + " " + w.success + " " + w.info).addClass(o.type == "error" ? w.error : (o.type == "info" ? w.info : (o.type == "success" ? w.success : w.notice))) } if (o.icon !== B.icon || (o.icon === true && o.type != B.type)) { u.container.find("div.ui-pnotify-icon").remove(); if (o.icon !== false) { d("<div />", { "class": "ui-pnotify-icon" }).append(d("<span />", { "class": o.icon === true ? (o.type == "error" ? w.error_icon : (o.type == "info" ? w.info_icon : (o.type == "success" ? w.success_icon : w.notice_icon))) : o.icon })).prependTo(u.container) } } if (o.width !== B.width) { u.animate({ width: o.width }) } if (o.min_height !== B.min_height) { u.container.animate({ minHeight: o.min_height }) } if (o.opacity !== B.opacity) { u.fadeTo(o.animate_speed, o.opacity) } if (!o.closer || o.nonblock) { u.closer.css("display", "none") } else { u.closer.css("display", "block") } if (!o.sticker || o.nonblock) { u.sticker.css("display", "none") } else { u.sticker.css("display", "block") } u.sticker.trigger("pnotify_icon"); if (o.sticker_hover) { u.sticker.css("visibility", "hidden") } else { if (!o.nonblock) { u.sticker.css("visibility", "visible") } } if (o.closer_hover) { u.closer.css("visibility", "hidden") } else { if (!o.nonblock) { u.closer.css("visibility", "visible") } } if (!o.hide) { u.pnotify_cancel_remove() } else { if (!B.hide) { u.pnotify_queue_remove() } } u.pnotify_queue_position(); return u }; u.pnotify_position = function (E) { var C = u.opts.stack; if (!C) { return } if (!C.nextpos1) { C.nextpos1 = C.firstpos1 } if (!C.nextpos2) { C.nextpos2 = C.firstpos2 } if (!C.addpos2) { C.addpos2 = 0 } var G = u.css("display") == "none"; if (!G || E) { var F, D; var z = {}; var B; switch (C.dir1) { case "down": B = "top"; break; case "up": B = "bottom"; break; case "left": B = "right"; break; case "right": B = "left"; break }F = parseInt(u.css(B)); if (isNaN(F)) { F = 0 } if (typeof C.firstpos1 == "undefined" && !G) { C.firstpos1 = F; C.nextpos1 = C.firstpos1 } var A; switch (C.dir2) { case "down": A = "top"; break; case "up": A = "bottom"; break; case "left": A = "right"; break; case "right": A = "left"; break }D = parseInt(u.css(A)); if (isNaN(D)) { D = 0 } if (typeof C.firstpos2 == "undefined" && !G) { C.firstpos2 = D; C.nextpos2 = C.firstpos2 } if ((C.dir1 == "down" && C.nextpos1 + u.height() > b.height()) || (C.dir1 == "up" && C.nextpos1 + u.height() > b.height()) || (C.dir1 == "left" && C.nextpos1 + u.width() > b.width()) || (C.dir1 == "right" && C.nextpos1 + u.width() > b.width())) { C.nextpos1 = C.firstpos1; C.nextpos2 += C.addpos2 + (typeof C.spacing2 == "undefined" ? 25 : C.spacing2); C.addpos2 = 0 } if (C.animation && C.nextpos2 < D) { switch (C.dir2) { case "down": z.top = C.nextpos2 + "px"; break; case "up": z.bottom = C.nextpos2 + "px"; break; case "left": z.right = C.nextpos2 + "px"; break; case "right": z.left = C.nextpos2 + "px"; break } } else { u.css(A, C.nextpos2 + "px") } switch (C.dir2) { case "down": case "up": if (u.outerHeight(true) > C.addpos2) { C.addpos2 = u.height() } break; case "left": case "right": if (u.outerWidth(true) > C.addpos2) { C.addpos2 = u.width() } break }if (C.nextpos1) { if (C.animation && (F > C.nextpos1 || z.top || z.bottom || z.right || z.left)) { switch (C.dir1) { case "down": z.top = C.nextpos1 + "px"; break; case "up": z.bottom = C.nextpos1 + "px"; break; case "left": z.right = C.nextpos1 + "px"; break; case "right": z.left = C.nextpos1 + "px"; break } } else { u.css(B, C.nextpos1 + "px") } } if (z.top || z.bottom || z.right || z.left) { u.animate(z, { duration: 500, queue: false }) } switch (C.dir1) { case "down": case "up": C.nextpos1 += u.height() + (typeof C.spacing1 == "undefined" ? 25 : C.spacing1); break; case "left": case "right": C.nextpos1 += u.width() + (typeof C.spacing1 == "undefined" ? 25 : C.spacing1); break } } }; u.pnotify_queue_position = function (z) { if (a) { clearTimeout(a) } if (!z) { z = 10 } a = setTimeout(d.pnotify_position_all, z) }; u.pnotify_display = function () { if (!u.parent().length) { u.appendTo(f) } if (o.before_open) { if (o.before_open(u) === false) { return } } if (o.stack.push != "top") { u.pnotify_position(true) } if (o.animation == "fade" || o.animation.effect_in == "fade") { u.show().fadeTo(0, 0).hide() } else { if (o.opacity != 1) { u.show().fadeTo(0, o.opacity).hide() } } u.animate_in(function () { if (o.after_open) { o.after_open(u) } u.pnotify_queue_position(); if (o.hide) { u.pnotify_queue_remove() } }) }; u.pnotify_remove = function () { if (u.timer) { window.clearTimeout(u.timer); u.timer = null } if (o.before_close) { if (o.before_close(u) === false) { return } } u.animate_out(function () { if (o.after_close) { if (o.after_close(u) === false) { return } } u.pnotify_queue_position(); if (o.remove) { u.detach() } }) }; u.animate_in = function (A) { y = "in"; var z; if (typeof o.animation.effect_in != "undefined") { z = o.animation.effect_in } else { z = o.animation } if (z == "none") { u.show(); A() } else { if (z == "show") { u.show(o.animate_speed, A) } else { if (z == "fade") { u.show().fadeTo(o.animate_speed, o.opacity, A) } else { if (z == "slide") { u.slideDown(o.animate_speed, A) } else { if (typeof z == "function") { z("in", A, u) } else { u.show(z, (typeof o.animation.options_in == "object" ? o.animation.options_in : {}), o.animate_speed, A) } } } } } }; u.animate_out = function (A) { y = "out"; var z; if (typeof o.animation.effect_out != "undefined") { z = o.animation.effect_out } else { z = o.animation } if (z == "none") { u.hide(); A() } else { if (z == "show") { u.hide(o.animate_speed, A) } else { if (z == "fade") { u.fadeOut(o.animate_speed, A) } else { if (z == "slide") { u.slideUp(o.animate_speed, A) } else { if (typeof z == "function") { z("out", A, u) } else { u.hide(z, (typeof o.animation.options_out == "object" ? o.animation.options_out : {}), o.animate_speed, A) } } } } } }; u.pnotify_cancel_remove = function () { if (u.timer) { window.clearTimeout(u.timer) } }; u.pnotify_queue_remove = function () { u.pnotify_cancel_remove(); u.timer = window.setTimeout(function () { u.pnotify_remove() }, (isNaN(o.delay) ? 0 : o.delay)) }; u.closer = d("<div />", { "class": "ui-pnotify-closer", css: { cursor: "pointer", visibility: o.closer_hover ? "hidden" : "visible" }, click: function () { u.pnotify_remove(); u.sticker.css("visibility", "hidden"); u.closer.css("visibility", "hidden") } }).append(d("<span />", { "class": w.closer })).appendTo(u.container); if (!o.closer || o.nonblock) { u.closer.css("display", "none") } u.sticker = d("<div />", { "class": "ui-pnotify-sticker", css: { cursor: "pointer", visibility: o.sticker_hover ? "hidden" : "visible" }, click: function () { o.hide = !o.hide; if (o.hide) { u.pnotify_queue_remove() } else { u.pnotify_cancel_remove() } d(this).trigger("pnotify_icon") } }).bind("pnotify_icon", function () { d(this).children().removeClass(w.pin_up + " " + w.pin_down).addClass(o.hide ? w.pin_up : w.pin_down) }).append(d("<span />", { "class": w.pin_up })).appendTo(u.container); if (!o.sticker || o.nonblock) { u.sticker.css("display", "none") } if (o.icon !== false) { d("<div />", { "class": "ui-pnotify-icon" }).append(d("<span />", { "class": o.icon === true ? (o.type == "error" ? w.error_icon : (o.type == "info" ? w.info_icon : (o.type == "success" ? w.success_icon : w.notice_icon))) : o.icon })).prependTo(u.container) } u.title_container = d("<h4 />", { "class": "ui-pnotify-title" }).appendTo(u.container); if (o.title === false) { u.title_container.hide() } else { if (o.title_escape) { u.title_container.text(o.title) } else { u.title_container.html(o.title) } } u.text_container = d("<div />", { "class": "ui-pnotify-text" }).appendTo(u.container); if (o.text === false) { u.text_container.hide() } else { if (o.text_escape) { u.text_container.text(o.text) } else { u.text_container.html(o.insert_brs ? String(o.text).replace(/\n/g, "<br />") : o.text) } } if (typeof o.width == "string") { u.css("width", o.width) } if (typeof o.min_height == "string") { u.container.css("min-height", o.min_height) } u.pnotify_history = o.history; u.pnotify_hide = o.hide; var v = b.data("pnotify"); if (v == null || typeof v != "object") { v = [] } if (o.stack.push == "top") { v = d.merge([u], v) } else { v = d.merge(v, [u]) } b.data("pnotify", v); if (o.stack.push == "top") { u.pnotify_queue_position(1) } if (o.after_init) { o.after_init(u) } if (o.history) { var p = b.data("pnotify_history"); if (typeof p == "undefined") { p = d("<div />", { "class": "ui-pnotify-history-container " + w.hi_menu, mouseleave: function () { p.animate({ top: "-" + l + "px" }, { duration: 100, queue: false }) } }).append(d("<div />", { "class": "ui-pnotify-history-header", text: "Redisplay" })).append(d("<button />", { "class": "ui-pnotify-history-all " + w.hi_btn, text: "All", mouseenter: function () { d(this).addClass(w.hi_btnhov) }, mouseleave: function () { d(this).removeClass(w.hi_btnhov) }, click: function () { d.each(v, function () { if (this.pnotify_history) { if (this.is(":visible")) { if (this.pnotify_hide) { this.pnotify_queue_remove() } } else { if (this.pnotify_display) { this.pnotify_display() } } } }); return false } })).append(d("<button />", { "class": "ui-pnotify-history-last " + w.hi_btn, text: "Last", mouseenter: function () { d(this).addClass(w.hi_btnhov) }, mouseleave: function () { d(this).removeClass(w.hi_btnhov) }, click: function () { var z = -1; var A; do { if (z == -1) { A = v.slice(z) } else { A = v.slice(z, z + 1) } if (!A[0]) { break } z-- } while (!A[0].pnotify_history || A[0].is(":visible")); if (!A[0]) { return false } if (A[0].pnotify_display) { A[0].pnotify_display() } return false } })).appendTo(f); var t = d("<span />", { "class": "ui-pnotify-history-pulldown " + w.hi_hnd, mouseenter: function () { p.animate({ top: "0" }, { duration: 100, queue: false }) } }).appendTo(p); l = t.offset().top + 2; p.css({ top: "-" + l + "px" }); b.data("pnotify_history", p) } } o.stack.animation = false; u.pnotify_display(); return u } }); var n = /^on/, c = /^(dbl)?click$|^mouse(move|down|up|over|out|enter|leave)$|^contextmenu$/, j = /^(focus|blur|select|change|reset)$|^key(press|down|up)$/, h = /^(scroll|resize|(un)?load|abort|error)$/; var g = function (p, o) { var q; p = p.toLowerCase(); if (document.createEvent && this.dispatchEvent) { p = p.replace(n, ""); if (p.match(c)) { d(this).offset(); q = document.createEvent("MouseEvents"); q.initMouseEvent(p, o.bubbles, o.cancelable, o.view, o.detail, o.screenX, o.screenY, o.clientX, o.clientY, o.ctrlKey, o.altKey, o.shiftKey, o.metaKey, o.button, o.relatedTarget) } else { if (p.match(j)) { q = document.createEvent("UIEvents"); q.initUIEvent(p, o.bubbles, o.cancelable, o.view, o.detail) } else { if (p.match(h)) { q = document.createEvent("HTMLEvents"); q.initEvent(p, o.bubbles, o.cancelable) } } } if (!q) { return } this.dispatchEvent(q) } else { if (!p.match(n)) { p = "on" + p } q = document.createEventObject(o); this.fireEvent(p, q) } }; d.pnotify.defaults = { title: false, title_escape: false, text: false, text_escape: false, styling: "bootstrap", addclass: "", cornerclass: "", nonblock: false, nonblock_opacity: 0.2, history: true, width: "300px", min_height: "16px", type: "notice", icon: false, animation: "fade", animate_speed: "fast", opacity: 1, shadow: true, closer: true, closer_hover: true, sticker: true, sticker_hover: true, hide: true, delay: 2000, mouse_reset: true, remove: true, insert_brs: true, stack: { dir1: "down", dir2: "left", push: "bottom", spacing1: 25, spacing2: 25 } } })(jQuery); (function (d) { var c = ["icon", "icons", "svg", ".svg", "png", ".png", "vector", "symbol", "glyph", "flat", "ai", "vista", "3d", "simple", "button", "black", "pictogram", "raw", "pixel perfect", "pixel", "perfect"]; var a = new Array(); var b = new Array(); d.fn.doAutosize = function (j) { var g = d(this).data("minwidth"), r = d(this).data("maxwidth"), l = "", q = d(this), k = d("#" + d(this).data("tester_id")); if (l === (l = q.val())) { return } var f = l.replace(/&/g, "&amp;").replace(/\s/g, " ").replace(/</g, "&lt;").replace(/>/g, "&gt;"); k.html(f); var p = k.width(), n = (p + j.comfortZone) >= g ? p + j.comfortZone : g, h = q.width(), e = (n < h && n >= g) || (n > g && n < r); if (e) { q.width(n) } }; d.fn.resetAutosize = function (g) { var h = d(this).data("minwidth") || g.minInputWidth || d(this).width(), j = d(this).data("maxwidth") || g.maxInputWidth || (d(this).closest(".tagsinput").width() - g.inputPadding), k = "", f = d(this), e = "tag_autosize_tester"; if (d("#" + e).length == 0) { d("<tester/>").css({ position: "absolute", top: -9999, left: -9999, width: "auto", fontSize: f.css("fontSize"), fontFamily: f.css("fontFamily"), fontWeight: f.css("fontWeight"), letterSpacing: f.css("letterSpacing"), whiteSpace: "nowrap" }).attr("id", e).appendTo("body") } f.data("minwidth", h); f.data("maxwidth", j); f.data("tester_id", e); f.css("width", h) }; d.fn.addTag = function (f, e) { e = jQuery.extend({ focus: false, callback: true }, e); this.each(function () { var n = d(this).attr("id"); var g = d(this).val().split(a[n]); if (g[0] == "") { g = new Array() } f = jQuery.trim(f); if (e.unique) { var h = d(this).tagExist(f); if (h == true) { d("#" + n + "_tag").addClass("not_valid") } } else { var h = false } if (f != "" && h != true) { var k = d("<span>").addClass("tag").append(d("<span>").text(f).append("&nbsp;&nbsp;"), d("<a>", { href: "#", title: "Remove tag", text: "×" }).click(function () { return d("#" + n).removeTag(escape(f)) })).insertBefore("#" + n + "_addTag"); if (g.length >= 7) { k.addClass("warning") } if ((d.inArray(f, c) > -1) || (f.match(/^\d+/))) { k.addClass("warning") } g.push(f); d("#" + n + "_tag").val(""); if (e.focus) { d("#" + n + "_tag").focus() } else { d("#" + n + "_tag").blur() } d.fn.tagsInput.updateTagsField(this, g); if (e.callback && b[n] && b[n]["onAddTag"]) { var l = b[n]["onAddTag"]; l.call(this, f) } if (b[n] && b[n]["onChange"]) { var j = g.length; var l = b[n]["onChange"]; l.call(this, d(this), g[j - 1]) } } }); return false }; d.fn.removeTag = function (e) { e = unescape(e); this.each(function () { var j = d(this).attr("id"); var g = d(this).val().split(a[j]); d("#" + j + "_tagsinput .tag").remove(); str = ""; for (i = 0; i < g.length; i++) { if (g[i] != e) { str = str + a[j] + g[i] } } d.fn.tagsInput.importTags(this, str); if (b[j] && b[j]["onRemoveTag"]) { var h = b[j]["onRemoveTag"]; h.call(this, e) } }); return false }; d.fn.tagExist = function (f) { var g = d(this).attr("id"); var e = d(this).val().split(a[g]); return (jQuery.inArray(f, e) >= 0) }; d.fn.importTags = function (e) { id = d(this).attr("id"); d("#" + id + "_tagsinput .tag").remove(); d.fn.tagsInput.importTags(this, e) }; d.fn.tagsInput = function (e) { var f = jQuery.extend({ interactive: true, defaultText: "Add a tag", minChars: 0, width: "300px", height: "100px", autocomplete: { selectFirst: false }, hide: true, delimiter: ",", unique: true, removeWithBackspace: true, placeholderColor: "#666666", autosize: true, comfortZone: 20, inputPadding: 6 * 2 }, e); this.each(function () { if (f.hide) { d(this).hide() } var j = d(this).attr("id"); if (!j || a[d(this).attr("id")]) { j = d(this).attr("id", "tags" + new Date().getTime()).attr("id") } var h = jQuery.extend({ pid: j, real_input: "#" + j, holder: "#" + j + "_tagsinput", input_wrapper: "#" + j + "_addTag", fake_input: "#" + j + "_tag" }, f); a[j] = h.delimiter; if (f.onAddTag || f.onRemoveTag || f.onChange) { b[j] = new Array(); b[j]["onAddTag"] = f.onAddTag; b[j]["onRemoveTag"] = f.onRemoveTag; b[j]["onChange"] = f.onChange } var g = '<div id="' + j + '_tagsinput" class="tagsinput"><div id="' + j + '_addTag">'; if (f.interactive) { g = g + '<input id="' + j + '_tag" value="" data-default="' + f.defaultText + '" autofocus="autofocus" />' } g = g + '</div><div class="tags_clear"></div></div>'; d(g).insertAfter(this); d(h.holder).css("width", f.width); d(h.holder).css("min-height", f.height); d(h.holder).css("height", "100%"); if (d(h.real_input).val() != "") { d.fn.tagsInput.importTags(d(h.real_input), d(h.real_input).val()) } if (f.interactive) { d(h.fake_input).val(d(h.fake_input).attr("data-default")); d(h.fake_input).css("color", f.placeholderColor); d(h.fake_input).resetAutosize(f); d(h.holder).bind("click", h, function (k) { d(k.data.fake_input).focus() }); d(h.fake_input).bind("focus", h, function (k) { if (d(k.data.fake_input).val() == d(k.data.fake_input).attr("data-default")) { d(k.data.fake_input).val("") } d(k.data.fake_input).css("color", "#000000") }); if (f.autocomplete_url != undefined) { autocomplete_options = { source: f.autocomplete_url }; for (attrname in f.autocomplete) { autocomplete_options[attrname] = f.autocomplete[attrname] } if (jQuery.Autocompleter !== undefined) { d(h.fake_input).autocomplete(f.autocomplete_url, f.autocomplete); d(h.fake_input).bind("result", h, function (k, n, l) { if (n) { d("#" + j).addTag(n[0] + "", { focus: true, unique: (f.unique) }) } }) } else { if (jQuery.ui.autocomplete !== undefined) { d(h.fake_input).autocomplete(autocomplete_options); d(h.fake_input).bind("autocompleteselect", h, function (k, l) { d(k.data.real_input).addTag(l.item.value, { focus: true, unique: (f.unique) }); return false }) } } } else { d(h.fake_input).bind("blur", h, function (k) { var l = d(this).attr("data-default"); if (d(k.data.fake_input).val() != "" && d(k.data.fake_input).val() != l) { if ((k.data.minChars <= d(k.data.fake_input).val().length) && (!k.data.maxChars || (k.data.maxChars >= d(k.data.fake_input).val().length))) { d(k.data.real_input).addTag(d(k.data.fake_input).val(), { focus: true, unique: (f.unique) }) } } else { d(k.data.fake_input).val(d(k.data.fake_input).attr("data-default")); d(k.data.fake_input).css("color", f.placeholderColor) } return false }) } d(h.fake_input).bind("keypress", h, function (k) { if (k.which == k.data.delimiter.charCodeAt(0) || k.which == 13) { k.preventDefault(); if ((k.data.minChars <= d(k.data.fake_input).val().length) && (!k.data.maxChars || (k.data.maxChars >= d(k.data.fake_input).val().length))) { d(k.data.real_input).addTag(d(k.data.fake_input).val(), { focus: true, unique: (f.unique) }) } d(k.data.fake_input).resetAutosize(f); return false } else { if (k.data.autosize) { d(k.data.fake_input).doAutosize(f) } } }); h.removeWithBackspace && d(h.fake_input).bind("keydown", function (l) { if (l.keyCode == 8 && d(this).val() == "") { l.preventDefault(); var k = d(this).closest(".tagsinput").find(".tag:last").text(); var n = d(this).attr("id").replace(/_tag$/, ""); k = k.replace(/[\s]+×$/, ""); d("#" + n).removeTag(escape(k)); d(this).trigger("focus") } }); d(h.fake_input).blur(); if (h.unique) { d(h.fake_input).keydown(function (k) { if (k.keyCode == 8 || String.fromCharCode(k.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)) { d(this).removeClass("not_valid") } }) } } }); return this }; d.fn.tagsInput.updateTagsField = function (f, e) { var g = d(f).attr("id"); d(f).val(e.join(a[g])) }; d.fn.tagsInput.importTags = function (h, j) { d(h).val(""); var k = d(h).attr("id"); var e = j.split(a[k]); for (i = 0; i < e.length; i++) { d(h).addTag(e[i], { focus: false, callback: false }) } if (b[k] && b[k]["onChange"]) { var g = b[k]["onChange"]; g.call(h, h, e[i]) } } })(jQuery); (function (a, b, c) { b.fn.disabled = function (d) { if (d) { this.attr("disabled", "disabled") } else { this.removeAttr("disabled") } return this } })(window, window.jQuery); (function () { var e, a, k, d, j, l, o, r, q, h, b, t, f, v, p, u, x, g, w, n = [].slice, c = [].indexOf || function (A) { for (var z = 0, y = this.length; z < y; z++) { if (z in this && this[z] === A) { return z } } return -1 }, s = this; e = jQuery; e.payment = {}; e.payment.fn = {}; e.fn.payment = function () { var y, z; z = arguments[0], y = 2 <= arguments.length ? n.call(arguments, 1) : []; return e.payment.fn[z].apply(this, y) }; j = /(\d{1,4})/g; d = [{ type: "maestro", pattern: /^(5018|5020|5038|6304|6759|676[1-3])/, format: j, length: [12, 13, 14, 15, 16, 17, 18, 19], cvcLength: [3], luhn: true }, { type: "dinersclub", pattern: /^(36|38|30[0-5])/, format: j, length: [14], cvcLength: [3], luhn: true }, { type: "laser", pattern: /^(6706|6771|6709)/, format: j, length: [16, 17, 18, 19], cvcLength: [3], luhn: true }, { type: "jcb", pattern: /^35/, format: j, length: [16], cvcLength: [3], luhn: true }, { type: "unionpay", pattern: /^62/, format: j, length: [16, 17, 18, 19], cvcLength: [3], luhn: false }, { type: "discover", pattern: /^(6011|65|64[4-9]|622)/, format: j, length: [16], cvcLength: [3], luhn: true }, { type: "mastercard", pattern: /^5[1-5]/, format: j, length: [16], cvcLength: [3], luhn: true }, { type: "amex", pattern: /^3[47]/, format: /(\d{1,4})(\d{1,6})?(\d{1,5})?/, length: [15], cvcLength: [3, 4], luhn: true }, { type: "visa", pattern: /^4/, format: j, length: [13, 14, 15, 16], cvcLength: [3], luhn: true }]; a = function (A) { var z, B, y; A = (A + "").replace(/\D/g, ""); for (B = 0, y = d.length; B < y; B++) { z = d[B]; if (z.pattern.test(A)) { return z } } }; k = function (A) { var z, B, y; for (B = 0, y = d.length; B < y; B++) { z = d[B]; if (z.type === A) { return z } } }; f = function (z) { var E, D, C, A, B, y; C = true; A = 0; D = (z + "").split("").reverse(); for (B = 0, y = D.length; B < y; B++) { E = D[B]; E = parseInt(E, 10); if ((C = !C)) { E *= 2 } if (E > 9) { E -= 9 } A += E } return A % 10 === 0 }; t = function (y) { var z; if ((y.prop("selectionStart") != null) && y.prop("selectionStart") !== y.prop("selectionEnd")) { return true } if (typeof document !== "undefined" && document !== null ? (z = document.selection) != null ? typeof z.createRange === "function" ? z.createRange().text : void 0 : void 0 : void 0) { return true } return false }; v = function (y) { var z = this; return setTimeout(function () { var A, B; A = e(y.currentTarget); B = A.val(); B = e.payment.formatCardNumber(B); return A.val(B) }) }; r = function (D) { var y, z, F, B, A, E, C; F = String.fromCharCode(D.which); if (!/^\d+$/.test(F)) { return } y = e(D.currentTarget); C = y.val(); z = a(C + F); B = (C.replace(/\D/g, "") + F).length; E = 16; if (z) { E = z.length[z.length.length - 1] } if (B >= E) { return } if ((y.prop("selectionStart") != null) && y.prop("selectionStart") !== C.length) { return } if (z && z.type === "amex") { A = /^(\d{4}|\d{4}\s\d{6})$/ } else { A = /(?:^|\s)(\d{4})$/ } if (A.test(C)) { D.preventDefault(); return y.val(C + " " + F) } else { if (A.test(C + F)) { D.preventDefault(); return y.val(C + F + " ") } } }; l = function (A) { var y, z; y = e(A.currentTarget); z = y.val(); if (A.meta) { return } if ((y.prop("selectionStart") != null) && y.prop("selectionStart") !== z.length) { return } if (A.which === 8 && /\s\d?$/.test(z)) { A.preventDefault(); return y.val(z.replace(/\s\d?$/, "")) } }; q = function (z) { var y, B, A; B = String.fromCharCode(z.which); if (!/^\d+$/.test(B)) { return } y = e(z.currentTarget); A = y.val() + B; if (/^\d$/.test(A) && (A !== "0" && A !== "1")) { z.preventDefault(); return y.val("0" + A + " / ") } else { if (/^\d\d$/.test(A)) { z.preventDefault(); return y.val("" + A + " / ") } } }; h = function (z) { var y, B, A; B = String.fromCharCode(z.which); if (!/^\d+$/.test(B)) { return } y = e(z.currentTarget); A = y.val(); if (/^\d\d$/.test(A)) { return y.val("" + A + " / ") } }; b = function (A) { var y, z, B; z = String.fromCharCode(A.which); if (z !== "/") { return } y = e(A.currentTarget); B = y.val(); if (/^\d$/.test(B) && B !== "0") { return y.val("0" + B + " / ") } }; o = function (A) { var y, z; if (A.meta) { return } y = e(A.currentTarget); z = y.val(); if (A.which !== 8) { return } if ((y.prop("selectionStart") != null) && y.prop("selectionStart") !== z.length) { return } if (/\s\/\s?\d?$/.test(z)) { A.preventDefault(); return y.val(z.replace(/\s\/\s?\d?$/, "")) } }; g = function (z) { var y; if (z.metaKey || z.ctrlKey) { return true } if (z.which === 32) { return false } if (z.which === 0) { return true } if (z.which < 33) { return true } y = String.fromCharCode(z.which); return !!/[\d\s]/.test(y) }; u = function (B) { var y, z, C, A; y = e(B.currentTarget); C = String.fromCharCode(B.which); if (!/^\d+$/.test(C)) { return } if (t(y)) { return } A = (y.val() + C).replace(/\D/g, ""); z = a(A); if (z) { return A.length <= z.length[z.length.length - 1] } else { return A.length <= 16 } }; x = function (A) { var y, B, z; y = e(A.currentTarget); B = String.fromCharCode(A.which); if (!/^\d+$/.test(B)) { return } if (t(y)) { return } z = y.val() + B; z = z.replace(/\D/g, ""); if (z.length > 6) { return false } }; p = function (z) { var y, B, A; y = e(z.currentTarget); B = String.fromCharCode(z.which); if (!/^\d+$/.test(B)) { return } A = y.val() + B; return A.length <= 4 }; w = function (C) { var z, B, A, y, D; z = e(C.currentTarget); D = z.val(); y = e.payment.cardType(D) || "unknown"; if (!z.hasClass(y)) { B = (function () { var G, F, E; E = []; for (G = 0, F = d.length; G < F; G++) { A = d[G]; E.push(A.type) } return E })(); z.removeClass("unknown"); z.removeClass(B.join(" ")); z.addClass(y); z.toggleClass("identified", y !== "unknown"); return z.trigger("payment.cardType", y) } }; e.payment.fn.formatCardCVC = function () { this.payment("restrictNumeric"); this.on("keypress", p); return this }; e.payment.fn.formatCardExpiry = function () { this.payment("restrictNumeric"); this.on("keypress", x); this.on("keypress", q); this.on("keypress", b); this.on("keypress", h); this.on("keydown", o); return this }; e.payment.fn.formatCardNumber = function () { this.payment("restrictNumeric"); this.on("keypress", u); this.on("keypress", r); this.on("keydown", l); this.on("keyup", w); this.on("paste", v); return this }; e.payment.fn.restrictNumeric = function () { this.on("keypress", g); return this }; e.payment.fn.cardExpiryVal = function () { return e.payment.cardExpiryVal(e(this).val()) }; e.payment.cardExpiryVal = function (B) { var C, A, y, z; B = B.replace(/\s/g, ""); z = B.split("/", 2), C = z[0], y = z[1]; if ((y != null ? y.length : void 0) === 2 && /^\d+$/.test(y)) { A = (new Date).getFullYear(); A = A.toString().slice(0, 2); y = A + y } C = parseInt(C, 10); y = parseInt(y, 10); return { month: C, year: y } }; e.payment.validateCardNumber = function (z) { var y, A; z = (z + "").replace(/\s+|-/g, ""); if (!/^\d+$/.test(z)) { return false } y = a(z); if (!y) { return false } return (A = z.length, c.call(y.length, A) >= 0) && (y.luhn === false || f(z)) }; e.payment.validateCardExpiry = function (D, z) { var A, y, C, B; if (typeof D === "object" && "month" in D) { B = D, D = B.month, z = B.year } if (!(D && z)) { return false } D = e.trim(D); z = e.trim(z); if (!/^\d+$/.test(D)) { return false } if (!/^\d+$/.test(z)) { return false } if (!(parseInt(D, 10) <= 12)) { return false } if (z.length === 2) { C = (new Date).getFullYear(); C = C.toString().slice(0, 2); z = C + z } y = new Date(z, D); A = new Date; y.setMonth(y.getMonth() - 1); y.setMonth(y.getMonth() + 1, 1); return y > A }; e.payment.validateCardCVC = function (z, A) { var B, y; z = e.trim(z); if (!/^\d+$/.test(z)) { return false } if (A) { return B = z.length, c.call((y = k(A)) != null ? y.cvcLength : void 0, B) >= 0 } else { return z.length >= 3 && z.length <= 4 } }; e.payment.cardType = function (y) { var z; if (!y) { return null } return ((z = a(y)) != null ? z.type : void 0) || null }; e.payment.formatCardNumber = function (A) { var z, y, C, B; z = a(A); if (!z) { return A } C = z.length[z.length.length - 1]; A = A.replace(/\D/g, ""); A = A.slice(0, +C + 1 || 9000000000); if (z.format.global) { return (B = A.match(z.format)) != null ? B.join(" ") : void 0 } else { y = z.format.exec(A); if (y != null) { y.shift() } return y != null ? y.join(" ") : void 0 } } }).call(this); (function ($) { var escape = /["\\\x00-\x1f\x7f-\x9f]/g, meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, hasOwn = Object.prototype.hasOwnProperty; $.toJSON = typeof JSON === "object" && JSON.stringify ? JSON.stringify : function (o) { if (o === null) { return "null" } var pairs, k, name, val, type = $.type(o); if (type === "undefined") { return undefined } if (type === "number" || type === "boolean") { return String(o) } if (type === "string") { return $.quoteString(o) } if (typeof o.toJSON === "function") { return $.toJSON(o.toJSON()) } if (type === "date") { var month = o.getUTCMonth() + 1, day = o.getUTCDate(), year = o.getUTCFullYear(), hours = o.getUTCHours(), minutes = o.getUTCMinutes(), seconds = o.getUTCSeconds(), milli = o.getUTCMilliseconds(); if (month < 10) { month = "0" + month } if (day < 10) { day = "0" + day } if (hours < 10) { hours = "0" + hours } if (minutes < 10) { minutes = "0" + minutes } if (seconds < 10) { seconds = "0" + seconds } if (milli < 100) { milli = "0" + milli } if (milli < 10) { milli = "0" + milli } return '"' + year + "-" + month + "-" + day + "T" + hours + ":" + minutes + ":" + seconds + "." + milli + 'Z"' } pairs = []; if ($.isArray(o)) { for (k = 0; k < o.length; k++) { pairs.push($.toJSON(o[k]) || "null") } return "[" + pairs.join(",") + "]" } if (typeof o === "object") { for (k in o) { if (hasOwn.call(o, k)) { type = typeof k; if (type === "number") { name = '"' + k + '"' } else { if (type === "string") { name = $.quoteString(k) } else { continue } } type = typeof o[k]; if (type !== "function" && type !== "undefined") { val = $.toJSON(o[k]); pairs.push(name + ":" + val) } } } return "{" + pairs.join(",") + "}" } }; $.evalJSON = typeof JSON === "object" && JSON.parse ? JSON.parse : function (str) { return eval("(" + str + ")") }; $.secureEvalJSON = typeof JSON === "object" && JSON.parse ? JSON.parse : function (str) { var filtered = str.replace(/\\["\\\/bfnrtu]/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""); if (/^[\],:{}\s]*$/.test(filtered)) { return eval("(" + str + ")") } throw new SyntaxError("Error parsing JSON, source is not valid.") }; $.quoteString = function (str) { if (str.match(escape)) { return '"' + str.replace(escape, function (a) { var c = meta[a]; if (typeof c === "string") { return c } c = a.charCodeAt(); return "\\u00" + Math.floor(c / 16).toString(16) + (c % 16).toString(16) }) + '"' } return '"' + str + '"' } }(jQuery));
/*!
 * jQuery Cookie Plugin v1.4.1
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2006, 2014 Klaus Hartl
 * Released under the MIT license
 */
(function (a) { if (typeof define === "function" && define.amd) { define(["jquery"], a) } else { if (typeof exports === "object") { module.exports = a(require("jquery")) } else { a(jQuery) } } }(function (f) { var a = /\+/g; function d(j) { return b.raw ? j : encodeURIComponent(j) } function g(j) { return b.raw ? j : decodeURIComponent(j) } function h(j) { return d(b.json ? JSON.stringify(j) : String(j)) } function c(j) { if (j.indexOf('"') === 0) { j = j.slice(1, -1).replace(/\\"/g, '"').replace(/\\\\/g, "\\") } try { j = decodeURIComponent(j.replace(a, " ")); return b.json ? JSON.parse(j) : j } catch (k) { } } function e(k, j) { var l = b.raw ? k : c(k); return f.isFunction(j) ? j(l) : l } var b = f.cookie = function (r, q, w) { if (arguments.length > 1 && !f.isFunction(q)) { w = f.extend({}, b.defaults, w); if (typeof w.expires === "number") { var s = w.expires, v = w.expires = new Date(); v.setMilliseconds(v.getMilliseconds() + s * 86400000) } return (document.cookie = [d(r), "=", h(q), w.expires ? "; expires=" + w.expires.toUTCString() : "", w.path ? "; path=" + w.path : "", w.domain ? "; domain=" + w.domain : "", w.secure ? "; secure" : ""].join("")) } var x = r ? undefined : {}, u = document.cookie ? document.cookie.split("; ") : [], p = 0, n = u.length; for (; p < n; p++) { var o = u[p].split("="), j = g(o.shift()), k = o.join("="); if (r === j) { x = e(k, q); break } if (!r && (k = e(k)) !== undefined) { x[j] = k } } return x }; b.defaults = {}; f.removeCookie = function (k, j) { f.cookie(k, "", f.extend({}, j, { expires: -1 })); return !f.cookie(k) } }));
/*!
 * jQuery Validation Plugin v1.16.0
 *
 * http://jqueryvalidation.org/
 *
 * Copyright (c) 2016 Jörn Zaefferer
 * Released under the MIT license
 */
(function (a) { if (typeof define === "function" && define.amd) { define(["jquery"], a) } else { if (typeof module === "object" && module.exports) { module.exports = a(require("jquery")) } else { a(jQuery) } } }(function (c) { c.extend(c.fn, { validate: function (d) { if (!this.length) { if (d && d.debug && window.console) { console.warn("Nothing selected, can't validate, returning nothing.") } return } var e = c.data(this[0], "validator"); if (e) { return e } this.attr("novalidate", "novalidate"); e = new c.validator(d, this[0]); c.data(this[0], "validator", e); if (e.settings.onsubmit) { this.on("click.validate", ":submit", function (f) { if (e.settings.submitHandler) { e.submitButton = f.target } if (c(this).hasClass("cancel")) { e.cancelSubmit = true } if (c(this).attr("formnovalidate") !== undefined) { e.cancelSubmit = true } }); this.on("submit.validate", function (f) { if (e.settings.debug) { f.preventDefault() } function g() { var j, h; if (e.settings.submitHandler) { if (e.submitButton) { j = c("<input type='hidden'/>").attr("name", e.submitButton.name).val(c(e.submitButton).val()).appendTo(e.currentForm) } h = e.settings.submitHandler.call(e, e.currentForm, f); if (e.submitButton) { j.remove() } if (h !== undefined) { return h } return false } return true } if (e.cancelSubmit) { e.cancelSubmit = false; return g() } if (e.form()) { if (e.pendingRequest) { e.formSubmitted = true; return false } return g() } else { e.focusInvalid(); return false } }) } return e }, valid: function () { var e, d, f; if (c(this[0]).is("form")) { e = this.validate().form() } else { f = []; e = true; d = c(this[0].form).validate(); this.each(function () { e = d.element(this) && e; if (!e) { f = f.concat(d.errorList) } }); d.errorList = f } return e }, rules: function (g, d) { var j = this[0], f, l, n, h, e, k; if (j == null || j.form == null) { return } if (g) { f = c.data(j.form, "validator").settings; l = f.rules; n = c.validator.staticRules(j); switch (g) { case "add": c.extend(n, c.validator.normalizeRule(d)); delete n.messages; l[j.name] = n; if (d.messages) { f.messages[j.name] = c.extend(f.messages[j.name], d.messages) } break; case "remove": if (!d) { delete l[j.name]; return n } k = {}; c.each(d.split(/\s/), function (o, p) { k[p] = n[p]; delete n[p]; if (p === "required") { c(j).removeAttr("aria-required") } }); return k } } h = c.validator.normalizeRules(c.extend({}, c.validator.classRules(j), c.validator.attributeRules(j), c.validator.dataRules(j), c.validator.staticRules(j)), j); if (h.required) { e = h.required; delete h.required; h = c.extend({ required: e }, h); c(j).attr("aria-required", "true") } if (h.remote) { e = h.remote; delete h.remote; h = c.extend(h, { remote: e }) } return h } }); c.extend(c.expr.pseudos || c.expr[":"], { blank: function (d) { return !c.trim("" + c(d).val()) }, filled: function (d) { var e = c(d).val(); return e !== null && !!c.trim("" + e) }, unchecked: function (d) { return !c(d).prop("checked") } }); c.validator = function (d, e) { this.settings = c.extend(true, {}, c.validator.defaults, d); this.currentForm = e; this.init() }; c.validator.format = function (d, e) { if (arguments.length === 1) { return function () { var f = c.makeArray(arguments); f.unshift(d); return c.validator.format.apply(this, f) } } if (e === undefined) { return d } if (arguments.length > 2 && e.constructor !== Array) { e = c.makeArray(arguments).slice(1) } if (e.constructor !== Array) { e = [e] } c.each(e, function (f, g) { d = d.replace(new RegExp("\\{" + f + "\\}", "g"), function () { return g }) }); return d }; c.extend(c.validator, { defaults: { messages: {}, groups: {}, rules: {}, errorClass: "error", pendingClass: "pending", validClass: "valid", errorElement: "label", focusCleanup: false, focusInvalid: true, errorContainer: c([]), errorLabelContainer: c([]), onsubmit: true, ignore: ":hidden", ignoreTitle: false, onfocusin: function (d) { this.lastActive = d; if (this.settings.focusCleanup) { if (this.settings.unhighlight) { this.settings.unhighlight.call(this, d, this.settings.errorClass, this.settings.validClass) } this.hideThese(this.errorsFor(d)) } }, onfocusout: function (d) { if (!this.checkable(d) && (d.name in this.submitted || !this.optional(d))) { this.element(d) } }, onkeyup: function (e, f) { var d = [16, 17, 18, 20, 35, 36, 37, 38, 39, 40, 45, 144, 225]; if (f.which === 9 && this.elementValue(e) === "" || c.inArray(f.keyCode, d) !== -1) { return } else { if (e.name in this.submitted || e.name in this.invalid) { this.element(e) } } }, onclick: function (d) { if (d.name in this.submitted) { this.element(d) } else { if (d.parentNode.name in this.submitted) { this.element(d.parentNode) } } }, highlight: function (f, d, e) { if (f.type === "radio") { this.findByName(f.name).addClass(d).removeClass(e) } else { c(f).addClass(d).removeClass(e) } }, unhighlight: function (f, d, e) { if (f.type === "radio") { this.findByName(f.name).removeClass(d).addClass(e) } else { c(f).removeClass(d).addClass(e) } } }, setDefaults: function (d) { c.extend(c.validator.defaults, d) }, messages: { required: "This field is required.", remote: "Please fix this field.", email: "Please enter a valid email address.", url: "Please enter a valid URL.", date: "Please enter a valid date.", dateISO: "Please enter a valid date (ISO).", number: "Please enter a valid number.", digits: "Please enter only digits.", equalTo: "Please enter the same value again.", maxlength: c.validator.format("Please enter no more than {0} characters."), minlength: c.validator.format("Please enter at least {0} characters."), rangelength: c.validator.format("Please enter a value between {0} and {1} characters long."), range: c.validator.format("Please enter a value between {0} and {1}."), max: c.validator.format("Please enter a value less than or equal to {0}."), min: c.validator.format("Please enter a value greater than or equal to {0}."), step: c.validator.format("Please enter a multiple of {0}.") }, autoCreateRanges: false, prototype: { init: function () { this.labelContainer = c(this.settings.errorLabelContainer); this.errorContext = this.labelContainer.length && this.labelContainer || c(this.currentForm); this.containers = c(this.settings.errorContainer).add(this.settings.errorLabelContainer); this.submitted = {}; this.valueCache = {}; this.pendingRequest = 0; this.pending = {}; this.invalid = {}; this.reset(); var d = (this.groups = {}), f; c.each(this.settings.groups, function (g, h) { if (typeof h === "string") { h = h.split(/\s/) } c.each(h, function (k, j) { d[j] = g }) }); f = this.settings.rules; c.each(f, function (g, h) { f[g] = c.validator.normalizeRule(h) }); function e(k) { if (!this.form && this.hasAttribute("contenteditable")) { this.form = c(this).closest("form")[0] } var h = c.data(this.form, "validator"), g = "on" + k.type.replace(/^validate/, ""), j = h.settings; if (j[g] && !c(this).is(j.ignore)) { j[g].call(h, this, k) } } c(this.currentForm).on("focusin.validate focusout.validate keyup.validate", ":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'], [type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox'], [contenteditable], [type='button']", e).on("click.validate", "select, option, [type='radio'], [type='checkbox']", e); if (this.settings.invalidHandler) { c(this.currentForm).on("invalid-form.validate", this.settings.invalidHandler) } c(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required", "true") }, form: function () { this.checkForm(); c.extend(this.submitted, this.errorMap); this.invalid = c.extend({}, this.errorMap); if (!this.valid()) { c(this.currentForm).triggerHandler("invalid-form", [this]) } this.showErrors(); return this.valid() }, checkForm: function () { this.prepareForm(); for (var d = 0, e = (this.currentElements = this.elements()); e[d]; d++) { this.check(e[d]) } return this.valid() }, element: function (h) { var j = this.clean(h), g = this.validationTargetFor(j), f = this, d = true, e, k; if (g === undefined) { delete this.invalid[j.name] } else { this.prepareElement(g); this.currentElements = c(g); k = this.groups[g.name]; if (k) { c.each(this.groups, function (n, l) { if (l === k && n !== g.name) { j = f.validationTargetFor(f.clean(f.findByName(n))); if (j && j.name in f.invalid) { f.currentElements.push(j); d = f.check(j) && d } } }) } e = this.check(g) !== false; d = d && e; if (e) { this.invalid[g.name] = false } else { this.invalid[g.name] = true } if (!this.numberOfInvalids()) { this.toHide = this.toHide.add(this.containers) } this.showErrors(); c(h).attr("aria-invalid", !e) } return d }, showErrors: function (e) { if (e) { var d = this; c.extend(this.errorMap, e); this.errorList = c.map(this.errorMap, function (g, f) { return { message: g, element: d.findByName(f)[0] } }); this.successList = c.grep(this.successList, function (f) { return !(f.name in e) }) } if (this.settings.showErrors) { this.settings.showErrors.call(this, this.errorMap, this.errorList) } else { this.defaultShowErrors() } }, resetForm: function () { if (c.fn.resetForm) { c(this.currentForm).resetForm() } this.invalid = {}; this.submitted = {}; this.prepareForm(); this.hideErrors(); var d = this.elements().removeData("previousValue").removeAttr("aria-invalid"); this.resetElements(d) }, resetElements: function (e) { var d; if (this.settings.unhighlight) { for (d = 0; e[d]; d++) { this.settings.unhighlight.call(this, e[d], this.settings.errorClass, ""); this.findByName(e[d].name).removeClass(this.settings.validClass) } } else { e.removeClass(this.settings.errorClass).removeClass(this.settings.validClass) } }, numberOfInvalids: function () { return this.objectLength(this.invalid) }, objectLength: function (f) { var e = 0, d; for (d in f) { if (f[d]) { e++ } } return e }, hideErrors: function () { this.hideThese(this.toHide) }, hideThese: function (d) { d.not(this.containers).text(""); this.addWrapper(d).hide() }, valid: function () { return this.size() === 0 }, size: function () { return this.errorList.length }, focusInvalid: function () { if (this.settings.focusInvalid) { try { c(this.findLastActive() || this.errorList.length && this.errorList[0].element || []).filter(":visible").focus().trigger("focusin") } catch (d) { } } }, findLastActive: function () { var d = this.lastActive; return d && c.grep(this.errorList, function (e) { return e.element.name === d.name }).length === 1 && d }, elements: function () { var e = this, d = {}; return c(this.currentForm).find("input, select, textarea, [contenteditable]").not(":submit, :reset, :image, :disabled").not(this.settings.ignore).filter(function () { var f = this.name || c(this).attr("name"); if (!f && e.settings.debug && window.console) { console.error("%o has no name assigned", this) } if (this.hasAttribute("contenteditable")) { this.form = c(this).closest("form")[0] } if (f in d || !e.objectLength(c(this).rules())) { return false } d[f] = true; return true }) }, clean: function (d) { return c(d)[0] }, errors: function () { var d = this.settings.errorClass.split(" ").join("."); return c(this.settings.errorElement + "." + d, this.errorContext) }, resetInternals: function () { this.successList = []; this.errorList = []; this.errorMap = {}; this.toShow = c([]); this.toHide = c([]) }, reset: function () { this.resetInternals(); this.currentElements = c([]) }, prepareForm: function () { this.reset(); this.toHide = this.errors().add(this.containers) }, prepareElement: function (d) { this.reset(); this.toHide = this.errorsFor(d) }, elementValue: function (f) { var e = c(f), g = f.type, h, d; if (g === "radio" || g === "checkbox") { return this.findByName(f.name).filter(":checked").val() } else { if (g === "number" && typeof f.validity !== "undefined") { return f.validity.badInput ? "NaN" : e.val() } } if (f.hasAttribute("contenteditable")) { h = e.text() } else { h = e.val() } if (g === "file") { if (h.substr(0, 12) === "C:\\fakepath\\") { return h.substr(12) } d = h.lastIndexOf("/"); if (d >= 0) { return h.substr(d + 1) } d = h.lastIndexOf("\\"); if (d >= 0) { return h.substr(d + 1) } return h } if (typeof h === "string") { return h.replace(/\r/g, "") } return h }, check: function (g) { g = this.validationTargetFor(this.clean(g)); var l = c(g).rules(), j = c.map(l, function (p, e) { return e }).length, n = false, f = this.elementValue(g), o, d, k; if (typeof l.normalizer === "function") { f = l.normalizer.call(g, f); if (typeof f !== "string") { throw new TypeError("The normalizer should return a string value.") } delete l.normalizer } for (d in l) { k = { method: d, parameters: l[d] }; try { o = c.validator.methods[d].call(this, f, g, k.parameters); if (o === "dependency-mismatch" && j === 1) { n = true; continue } n = false; if (o === "pending") { this.toHide = this.toHide.not(this.errorsFor(g)); return } if (!o) { this.formatAndAdd(g, k); return false } } catch (h) { if (this.settings.debug && window.console) { console.log("Exception occurred when checking element " + g.id + ", check the '" + k.method + "' method.", h) } if (h instanceof TypeError) { h.message += ".  Exception occurred when checking element " + g.id + ", check the '" + k.method + "' method." } throw h } } if (n) { return } if (this.objectLength(l)) { this.successList.push(g) } return true }, customDataMessage: function (d, e) { return c(d).data("msg" + e.charAt(0).toUpperCase() + e.substring(1).toLowerCase()) || c(d).data("msg") }, customMessage: function (e, f) { var d = this.settings.messages[e]; return d && (d.constructor === String ? d : d[f]) }, findDefined: function () { for (var d = 0; d < arguments.length; d++) { if (arguments[d] !== undefined) { return arguments[d] } } return undefined }, defaultMessage: function (e, g) { if (typeof g === "string") { g = { method: g } } var f = this.findDefined(this.customMessage(e.name, g.method), this.customDataMessage(e, g.method), !this.settings.ignoreTitle && e.title || undefined, c.validator.messages[g.method], "<strong>Warning: No message defined for " + e.name + "</strong>"), d = /\$?\{(\d+)\}/g; if (typeof f === "function") { f = f.call(this, g.parameters, e) } else { if (d.test(f)) { f = c.validator.format(f.replace(d, "{$1}"), g.parameters) } } return f }, formatAndAdd: function (d, f) { var e = this.defaultMessage(d, f); this.errorList.push({ message: e, element: d, method: f.method }); this.errorMap[d.name] = e; this.submitted[d.name] = e }, addWrapper: function (d) { if (this.settings.wrapper) { d = d.add(d.parent(this.settings.wrapper)) } return d }, defaultShowErrors: function () { var e, f, d; for (e = 0; this.errorList[e]; e++) { d = this.errorList[e]; if (this.settings.highlight) { this.settings.highlight.call(this, d.element, this.settings.errorClass, this.settings.validClass) } this.showLabel(d.element, d.message) } if (this.errorList.length) { this.toShow = this.toShow.add(this.containers) } if (this.settings.success) { for (e = 0; this.successList[e]; e++) { this.showLabel(this.successList[e]) } } if (this.settings.unhighlight) { for (e = 0, f = this.validElements(); f[e]; e++) { this.settings.unhighlight.call(this, f[e], this.settings.errorClass, this.settings.validClass) } } this.toHide = this.toHide.not(this.toShow); this.hideErrors(); this.addWrapper(this.toShow).show() }, validElements: function () { return this.currentElements.not(this.invalidElements()) }, invalidElements: function () { return c(this.errorList).map(function () { return this.element }) }, showLabel: function (g, n) { var e, k, f, l, h = this.errorsFor(g), j = this.idOrName(g), d = c(g).attr("aria-describedby"); if (h.length) { h.removeClass(this.settings.validClass).addClass(this.settings.errorClass); h.html(n) } else { h = c("<" + this.settings.errorElement + ">").attr("id", j + "-error").addClass(this.settings.errorClass).html(n || ""); e = h; if (this.settings.wrapper) { e = h.hide().show().wrap("<" + this.settings.wrapper + "/>").parent() } if (this.labelContainer.length) { this.labelContainer.append(e) } else { if (this.settings.errorPlacement) { this.settings.errorPlacement.call(this, e, c(g)) } else { e.insertAfter(g) } } if (h.is("label")) { h.attr("for", j) } else { if (h.parents("label[for='" + this.escapeCssMeta(j) + "']").length === 0) { f = h.attr("id"); if (!d) { d = f } else { if (!d.match(new RegExp("\\b" + this.escapeCssMeta(f) + "\\b"))) { d += " " + f } } c(g).attr("aria-describedby", d); k = this.groups[g.name]; if (k) { l = this; c.each(l.groups, function (p, o) { if (o === k) { c("[name='" + l.escapeCssMeta(p) + "']", l.currentForm).attr("aria-describedby", h.attr("id")) } }) } } } } if (!n && this.settings.success) { h.text(""); if (typeof this.settings.success === "string") { h.addClass(this.settings.success) } else { this.settings.success(h, g) } } this.toShow = this.toShow.add(h) }, errorsFor: function (f) { var e = this.escapeCssMeta(this.idOrName(f)), g = c(f).attr("aria-describedby"), d = "label[for='" + e + "'], label[for='" + e + "'] *"; if (g) { d = d + ", #" + this.escapeCssMeta(g).replace(/\s+/g, ", #") } return this.errors().filter(d) }, escapeCssMeta: function (d) { return d.replace(/([\\!"#$%&'()*+,./:;<=>?@\[\]^`{|}~])/g, "\\$1") }, idOrName: function (d) { return this.groups[d.name] || (this.checkable(d) ? d.name : d.id || d.name) }, validationTargetFor: function (d) { if (this.checkable(d)) { d = this.findByName(d.name) } return c(d).not(this.settings.ignore)[0] }, checkable: function (d) { return (/radio|checkbox/i).test(d.type) }, findByName: function (d) { return c(this.currentForm).find("[name='" + this.escapeCssMeta(d) + "']") }, getLength: function (e, d) { switch (d.nodeName.toLowerCase()) { case "select": return c("option:selected", d).length; case "input": if (this.checkable(d)) { return this.findByName(d.name).filter(":checked").length } }return e.length }, depend: function (e, d) { return this.dependTypes[typeof e] ? this.dependTypes[typeof e](e, d) : true }, dependTypes: { "boolean": function (d) { return d }, string: function (e, d) { return !!c(e, d.form).length }, "function": function (e, d) { return e(d) } }, optional: function (d) { var e = this.elementValue(d); return !c.validator.methods.required.call(this, e, d) && "dependency-mismatch" }, startRequest: function (d) { if (!this.pending[d.name]) { this.pendingRequest++; c(d).addClass(this.settings.pendingClass); this.pending[d.name] = true } }, stopRequest: function (d, e) { this.pendingRequest--; if (this.pendingRequest < 0) { this.pendingRequest = 0 } delete this.pending[d.name]; c(d).removeClass(this.settings.pendingClass); if (e && this.pendingRequest === 0 && this.formSubmitted && this.form()) { c(this.currentForm).submit(); this.formSubmitted = false } else { if (!e && this.pendingRequest === 0 && this.formSubmitted) { c(this.currentForm).triggerHandler("invalid-form", [this]); this.formSubmitted = false } } }, previousValue: function (d, e) { e = typeof e === "string" && e || "remote"; return c.data(d, "previousValue") || c.data(d, "previousValue", { old: null, valid: true, message: this.defaultMessage(d, { method: e }) }) }, destroy: function () { this.resetForm(); c(this.currentForm).off(".validate").removeData("validator").find(".validate-equalTo-blur").off(".validate-equalTo").removeClass("validate-equalTo-blur") } }, classRuleSettings: { required: { required: true }, email: { email: true }, url: { url: true }, date: { date: true }, dateISO: { dateISO: true }, number: { number: true }, digits: { digits: true }, creditcard: { creditcard: true } }, addClassRules: function (d, e) { if (d.constructor === String) { this.classRuleSettings[d] = e } else { c.extend(this.classRuleSettings, d) } }, classRules: function (e) { var f = {}, d = c(e).attr("class"); if (d) { c.each(d.split(" "), function () { if (this in c.validator.classRuleSettings) { c.extend(f, c.validator.classRuleSettings[this]) } }) } return f }, normalizeAttributeRule: function (f, d, g, e) { if (/min|max|step/.test(g) && (d === null || /number|range|text/.test(d))) { e = Number(e); if (isNaN(e)) { e = undefined } } if (e || e === 0) { f[g] = e } else { if (d === g && d !== "range") { f[g] = true } } }, attributeRules: function (e) { var h = {}, d = c(e), f = e.getAttribute("type"), j, g; for (j in c.validator.methods) { if (j === "required") { g = e.getAttribute(j); if (g === "") { g = true } g = !!g } else { g = d.attr(j) } this.normalizeAttributeRule(h, f, j, g) } if (h.maxlength && /-1|2147483647|524288/.test(h.maxlength)) { delete h.maxlength } return h }, dataRules: function (e) { var h = {}, d = c(e), f = e.getAttribute("type"), j, g; for (j in c.validator.methods) { g = d.data("rule" + j.charAt(0).toUpperCase() + j.substring(1).toLowerCase()); this.normalizeAttributeRule(h, f, j, g) } return h }, staticRules: function (e) { var f = {}, d = c.data(e.form, "validator"); if (d.settings.rules) { f = c.validator.normalizeRule(d.settings.rules[e.name]) || {} } return f }, normalizeRules: function (e, d) { c.each(e, function (h, g) { if (g === false) { delete e[h]; return } if (g.param || g.depends) { var f = true; switch (typeof g.depends) { case "string": f = !!c(g.depends, d.form).length; break; case "function": f = g.depends.call(d, d); break }if (f) { e[h] = g.param !== undefined ? g.param : true } else { c.data(d.form, "validator").resetElements(c(d)); delete e[h] } } }); c.each(e, function (f, g) { e[f] = c.isFunction(g) && f !== "normalizer" ? g(d) : g }); c.each(["minlength", "maxlength"], function () { if (e[this]) { e[this] = Number(e[this]) } }); c.each(["rangelength", "range"], function () { var f; if (e[this]) { if (c.isArray(e[this])) { e[this] = [Number(e[this][0]), Number(e[this][1])] } else { if (typeof e[this] === "string") { f = e[this].replace(/[\[\]]/g, "").split(/[\s,]+/); e[this] = [Number(f[0]), Number(f[1])] } } } }); if (c.validator.autoCreateRanges) { if (e.min != null && e.max != null) { e.range = [e.min, e.max]; delete e.min; delete e.max } if (e.minlength != null && e.maxlength != null) { e.rangelength = [e.minlength, e.maxlength]; delete e.minlength; delete e.maxlength } } return e }, normalizeRule: function (e) { if (typeof e === "string") { var d = {}; c.each(e.split(/\s/), function () { d[this] = true }); e = d } return e }, addMethod: function (d, f, e) { c.validator.methods[d] = f; c.validator.messages[d] = e !== undefined ? e : c.validator.messages[d]; if (f.length < 3) { c.validator.addClassRules(d, c.validator.normalizeRule(d)) } }, methods: { required: function (e, d, g) { if (!this.depend(g, d)) { return "dependency-mismatch" } if (d.nodeName.toLowerCase() === "select") { var f = c(d).val(); return f && f.length > 0 } if (this.checkable(d)) { return this.getLength(e, d) > 0 } return e.length > 0 }, email: function (e, d) { return this.optional(d) || /^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e) }, url: function (e, d) { return this.optional(d) || /^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e) }, date: function (e, d) { return this.optional(d) || !/Invalid|NaN/.test(new Date(e).toString()) }, dateISO: function (e, d) { return this.optional(d) || /^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e) }, number: function (e, d) { return this.optional(d) || /^(?:-?\d+|-?\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e) }, digits: function (e, d) { return this.optional(d) || /^\d+$/.test(e) }, minlength: function (f, d, g) { var e = c.isArray(f) ? f.length : this.getLength(f, d); return this.optional(d) || e >= g }, maxlength: function (f, d, g) { var e = c.isArray(f) ? f.length : this.getLength(f, d); return this.optional(d) || e <= g }, rangelength: function (f, d, g) { var e = c.isArray(f) ? f.length : this.getLength(f, d); return this.optional(d) || (e >= g[0] && e <= g[1]) }, min: function (e, d, f) { return this.optional(d) || e >= f }, max: function (e, d, f) { return this.optional(d) || e <= f }, range: function (e, d, f) { return this.optional(d) || (e >= f[0] && e <= f[1]) }, step: function (p, h, f) { var o = c(h).attr("type"), n = "Step attribute on input type " + o + " is not supported.", l = ["text", "number", "range"], q = new RegExp("\\b" + o + "\\b"), j = o && !q.test(l.join()), g = function (s) { var r = ("" + s).match(/(?:\.(\d+))?$/); if (!r) { return 0 } return r[1] ? r[1].length : 0 }, k = function (r) { return Math.round(r * Math.pow(10, e)) }, d = true, e; if (j) { throw new Error(n) } e = g(f); if (g(p) > e || k(p) % k(f) !== 0) { d = false } return this.optional(h) || d }, equalTo: function (e, d, g) { var f = c(g); if (this.settings.onfocusout && f.not(".validate-equalTo-blur").length) { f.addClass("validate-equalTo-blur").on("blur.validate-equalTo", function () { c(d).valid() }) } return e === f.val() }, remote: function (j, e, k, l) { if (this.optional(e)) { return "dependency-mismatch" } l = typeof l === "string" && l || "remote"; var f = this.previousValue(e, l), d, h, g; if (!this.settings.messages[e.name]) { this.settings.messages[e.name] = {} } f.originalMessage = f.originalMessage || this.settings.messages[e.name][l]; this.settings.messages[e.name][l] = f.message; k = typeof k === "string" && { url: k } || k; g = c.param(c.extend({ data: j }, k.data)); if (f.old === g) { return f.valid } f.old = g; d = this; this.startRequest(e); h = {}; h[e.name] = j; c.ajax(c.extend(true, { mode: "abort", port: "validate" + e.name, dataType: "json", data: h, context: d.currentForm, success: function (o) { var q = o === true || o === "true", r, p, n; d.settings.messages[e.name][l] = f.originalMessage; if (q) { n = d.formSubmitted; d.resetInternals(); d.toHide = d.errorsFor(e); d.formSubmitted = n; d.successList.push(e); d.invalid[e.name] = false; d.showErrors() } else { r = {}; p = o || d.defaultMessage(e, { method: l, parameters: j }); r[e.name] = f.message = p; d.invalid[e.name] = true; d.showErrors(r) } f.valid = q; d.stopRequest(e, q) } }, k)); return "pending" } } }); var a = {}, b; if (c.ajaxPrefilter) { c.ajaxPrefilter(function (f, e, g) { var d = f.port; if (f.mode === "abort") { if (a[d]) { a[d].abort() } a[d] = g } }) } else { b = c.ajax; c.ajax = function (e) { var f = ("mode" in e ? e : c.ajaxSettings).mode, d = ("port" in e ? e : c.ajaxSettings).port; if (f === "abort") { if (a[d]) { a[d].abort() } a[d] = b.apply(this, arguments); return a[d] } return b.apply(this, arguments) } } return c }));
/*! $.noUiSlider - WTFPL - refreshless.com/nouislider/ */
(function (at) { function aq(e) { throw new RangeError("noUiSlider: " + e) } function al(f, e, h) { (f[e] || f[h]) && f[e] === f[h] && aq("(Link) '" + e + "' can't match '" + h + "'.'") } function am(e) { return "number" === typeof e && !isNaN(e) && isFinite(e) } function ac(e) { return at.isArray(e) ? e : [e] } function ae(f, e) { f.addClass(e); setTimeout(function () { f.removeClass(e) }, 300) } function ak(f, e) { return 100 * e / (f[1] - f[0]) } function ab(h, f) { if (f >= h.d.slice(-1)[0]) { return 100 } for (var s = 1, t, l, q; f >= h.d[s];) { s++ } t = h.d[s - 1]; l = h.d[s]; q = h.c[s - 1]; t = [t, l]; return q + ak(t, 0 > t[0] ? f + Math.abs(t[0]) : f - t[0]) / (100 / (h.c[s] - q)) } function F(f, e) { for (var h = 1, l; e >= f.c[h];) { h++ } if (f.m) { return l = f.c[h - 1], h = f.c[h], e - l > (h - l) / 2 ? h : l } f.h[h - 1] ? (l = f.h[h - 1], h = f.c[h - 1] + Math.round((e - f.c[h - 1]) / l) * l) : h = e; return h } function an(f) { void 0 === f && (f = {}); "object" !== typeof f && aq("(Format) 'format' option must be an object."); var e = {}; at(E).each(function (h, l) { void 0 === f[l] ? e[l] = aj[h] : typeof f[l] === typeof aj[h] ? ("decimals" === l && (0 > f[l] || 7 < f[l]) && aq("(Format) 'format.decimals' option must be between 0 and 7."), e[l] = f[l]) : aq("(Format) 'format." + l + "' must be a " + typeof aj[h] + ".") }); al(e, "mark", "thousand"); al(e, "prefix", "negative"); al(e, "prefix", "negativeBefore"); this.B = e } function ao(H, G) { if (!(this instanceof ao)) { throw Error("Link: Don't use Link as a function. Use the 'new' keyword.") } if (!H) { throw new RangeError("Link: missing parameters.") } this.g = H.format || {}; this.update = !G; var C = this, D = H.target || function () { }, y = H.method, z = "string" === typeof D && 0 === D.indexOf("-tooltip-"), x = "string" === typeof D && 0 !== D.indexOf("-"), q = "function" === typeof D, e = D instanceof at || at.zepto && at.zepto.isZ(D), J = e && D.is("input, select, textarea"), t = e && "function" === typeof y, I = e && "string" === typeof y && D[y]; if (z) { this.method = y || "html", this.j = at(D.replace("-tooltip-", "") || "<div/>")[0] } else { if (x) { this.method = "val", this.j = document.createElement("input"), this.j.name = D, this.j.type = "hidden" } else { if (q) { this.target = !1, this.method = D } else { if (e) { if (y && (t || I)) { this.target = D; this.method = y; return } if (!y && J) { this.method = "val"; this.target = D; this.target.on("change", function (h) { h = at(h.target).val(); var f = C.q; C.u.val([f ? null : h, f ? h : null], { link: C }) }); return } if (!y && !J) { this.method = "html"; this.target = D; return } } throw new RangeError("Link: Invalid Link.") } } } } function B(f, e) { am(e) || aq("'step' is not numeric."); f.h[0] = e } function A(f, e) { ("object" !== typeof e || at.isArray(e)) && aq("'range' is not an object."); at.each(e, function (h, q) { var l; "number" === typeof q && (q = [q]); at.isArray(q) || aq("'range' contains invalid value."); l = "min" === h ? 0 : "max" === h ? 100 : parseFloat(h); am(l) && am(q[0]) || aq("'range' value isn't numeric."); f.c.push(l); f.d.push(q[0]); l ? f.h.push(isNaN(q[1]) ? !1 : q[1]) : isNaN(q[1]) || (f.h[0] = q[1]) }); at.each(f.h, function (h, l) { if (!l) { return !0 } f.h[h] = ak([f.d[h], f.d[h + 1]], l) / (100 / (f.c[h + 1] - f.c[h])) }) } function w(f, e) { "number" === typeof e && (e = [e]); (!at.isArray(e) || !e.length || 2 < e.length) && aq("'start' option is incorrect."); f.a = e.length; f.start = e } function v(f, e) { f.m = e; "boolean" !== typeof e && aq("'snap' option must be a boolean.") } function u(f, e) { "lower" === e && 1 === f.a ? f.i = 1 : "upper" === e && 1 === f.a ? f.i = 2 : !0 === e && 2 === f.a ? f.i = 3 : !1 === e ? f.i = 0 : aq("'connect' option was doesn't match handle count.") } function r(f, e) { switch (e) { case "horizontal": f.k = 0; break; case "vertical": f.k = 1; break; default: aq("'orientation' option is invalid.") } } function p(f, e) { 2 < f.c.length && aq("'margin' option is only supported on linear sliders."); f.margin = ak(f.d, e); am(e) || aq("'margin' option must be numeric.") } function o(f, e) { switch (e) { case "ltr": f.dir = 0; break; case "rtl": f.dir = 1; f.i = [0, 2, 1, 3][f.i]; break; default: aq("'direction' option was not recognized.") } } function n(f, e) { "string" !== typeof e && aq("'behaviour' must be a string containing options."); var h = 0 <= e.indexOf("snap"); f.n = { p: 0 <= e.indexOf("tap") || h, extend: 0 <= e.indexOf("extend"), s: 0 <= e.indexOf("drag"), fixed: 0 <= e.indexOf("fixed"), m: h } } function k(f, e, h) { f.o = [e.lower, e.upper]; f.g = new an(e.format); at.each(f.o, function (l, q) { at.isArray(q) || aq("'serialization." + (l ? "upper" : "lower") + "' must be an array."); at.each(q, function () { this instanceof ao || aq("'serialization." + (l ? "upper" : "lower") + "' can only contain Link instances."); this.q = l; this.u = h; this.scope = this.scope || h; this.g = new an(at.extend({}, e.format, this.g)) }) }); f.dir && 1 < f.a && f.o.reverse() } function j(f, e) { var h = { c: [], d: [], h: [!1], margin: 0 }, l; l = { step: { e: !1, f: B }, range: { e: !0, f: A }, start: { e: !0, f: w }, snap: { e: !1, f: v }, connect: { e: !0, f: u }, orientation: { e: !1, f: r }, margin: { e: !1, f: p }, direction: { e: !0, f: o }, behaviour: { e: !0, f: n }, serialization: { e: !0, f: k } }; f = at.extend({ connect: !1, direction: "ltr", behaviour: "tap", orientation: "horizontal" }, f); f.serialization = at.extend({ lower: [], upper: [], format: {} }, f.serialization); at.each(l, function (s, q) { if (void 0 === f[s]) { if (q.e) { aq("'" + s + "' is required.") } else { return !0 } } q.f(h, f[s], e) }); h.style = h.k ? "top" : "left"; return h } function g(f, e) { var h = at("<div><div/></div>").addClass(ar[2]), l = ["-lower", "-upper"]; f.dir && l.reverse(); h.children().addClass(ar[3] + " " + ar[3] + l[e]); return h } function d(f, e) { e.j && (e = new ao({ target: at(e.j).clone().appendTo(f), method: e.method, format: e.g }, !0)); return e } function c(H, G) { var C, D = []; for (C = 0; C < H.a; C++) { var z = D, y = C, x = H.o[C], s = G[C].children(), q = void 0, t = []; t.push(new ao({ format: H.g }, !0)); for (q = 0; q < x.length; q++) { t.push(d(s, x[q])) } z[y] = t } return D } function b(f, e, h) { switch (f) { case 1: e.addClass(ar[7]); h[0].addClass(ar[6]); break; case 3: h[1].addClass(ar[6]); case 2: h[0].addClass(ar[7]); case 0: e.addClass(ar[6]) } } function ag(f, e) { var h, l = []; for (h = 0; h < f.a; h++) { l.push(g(f, h).appendTo(e)) } return l } function au(f, e) { e.addClass([ar[0], ar[8 + f.dir], ar[4 + f.k]].join(" ")); return at("<div/>").appendTo(e).addClass(ar[1]) } function ai(S, R, O) { function P() { return C[["width", "height"][R.k]]() } function N(q) { var h, s = [K.val()]; for (h = 0; h < q.length; h++) { K.trigger(q[h], s) } } function M(h, y, x) { var s = h[0] !== L[0][0] ? 1 : 0, t = z[0] + R.margin, q = z[1] - R.margin; x && 1 < L.length && (y = s ? Math.max(y, t) : Math.min(y, q)); 100 > y && (y = F(R, y)); y = Math.max(Math.min(parseFloat(y.toFixed(7)), 100), 0); if (y === z[s]) { return 1 === L.length ? !1 : y === t || y === q ? 0 : !1 } h.css(R.style, y + "%"); h.is(":first-child") && h.toggleClass(ar[17], 50 < y); z[s] = y; R.dir && (y = 100 - y); at(l[s]).each(function () { this.write(R, y, h.children(), K) }); return !0 } function I(q, h, s) { s || ae(K, ar[14]); M(q, h, !1); N(["slide", "set", "change"]) } function J(h, t, s, q) { h = h.replace(/\s/g, ".nui ") + ".nui"; t.on(h, function (y) { var X = K.attr("disabled"); if (K.hasClass(ar[14]) || void 0 !== X && null !== X) { return !1 } y.preventDefault(); var X = 0 === y.type.indexOf("touch"), V = 0 === y.type.indexOf("mouse"), W = 0 === y.type.indexOf("pointer"), x, U, T = y; 0 === y.type.indexOf("MSPointer") && (W = !0); y.originalEvent && (y = y.originalEvent); X && (x = y.changedTouches[0].pageX, U = y.changedTouches[0].pageY); if (V || W) { W || void 0 !== window.pageXOffset || (window.pageXOffset = document.documentElement.scrollLeft, window.pageYOffset = document.documentElement.scrollTop), x = y.clientX + window.pageXOffset, U = y.clientY + window.pageYOffset } T.v = [x, U]; T.cursor = V; y = T; y.l = y.v[R.k]; s(y, q) }) } function H(s, q) { var y = q.a || L, x, t = !1, t = 100 * (s.l - q.start) / P(), h = y[0][0] !== L[0][0] ? 1 : 0; var T = q.w; x = t + T[0]; t += T[1]; 1 < y.length ? (0 > x && (t += Math.abs(x)), 100 < t && (x -= t - 100), x = [Math.max(Math.min(x, 100), 0), Math.max(Math.min(t, 100), 0)]) : x = [x, t]; t = M(y[0], x[h], 1 === y.length); 1 < y.length && (t = M(y[1], x[h ? 0 : 1], !1) || t); t && N(["slide"]) } function G(h) { at("." + ar[15]).removeClass(ar[15]); h.cursor && at("body").css("cursor", "").off(".nui"); af.off(".nui"); K.removeClass(ar[12]); N(["set", "change"]) } function D(q, h) { 1 === h.a.length && h.a[0].children().addClass(ar[15]); q.stopPropagation(); J(ap.move, af, H, { start: q.l, a: h.a, w: [z[0], z[L.length - 1]] }); J(ap.end, af, G, null); q.cursor && (at("body").css("cursor", at(q.target).css("cursor")), 1 < L.length && K.addClass(ar[12]), at("body").on("selectstart.nui", !1)) } function f(h) { var s = h.l, q = 0; h.stopPropagation(); at.each(L, function () { q += this.offset()[R.style] }); q = s < q / 2 || 1 === L.length ? 0 : 1; s -= C.offset()[R.style]; s = 100 * s / P(); I(L[q], s, R.n.m); R.n.m && D(h, { a: [L[q]] }) } function e(h) { var q = (h = h.l < C.offset()[R.style]) ? 0 : 100; h = h ? 0 : L.length - 1; I(L[h], q, !1) } var K = at(S), z = [-1, -1], C, l, L; if (!K.is(":empty")) { throw Error("Slider was already initialized.") } C = au(R, K); L = ag(R, C); l = c(R, L); b(R.i, K, L); (function (q) { var h; if (!q.fixed) { for (h = 0; h < L.length; h++) { J(ap.start, L[h].children(), D, { a: [L[h]] }) } } q.p && J(ap.start, C, f, { a: L }); q.extend && (K.addClass(ar[16]), q.p && J(ap.start, K, e, { a: L })); q.s && (h = C.find("." + ar[7]).addClass(ar[10]), q.fixed && (h = h.add(C.children().not(h).children())), J(ap.start, h, D, { a: L })) })(R.n); S.F = function (q, y, t, x, s) { var h; R.dir && 1 < R.a && q.reverse(); s && ae(K, ar[14]); for (h = 0; h < (1 < L.length ? 3 : 1); h++) { s = t || l[h % 2][0], s = s.valueOf(q[h % 2]), !1 !== s && (s = ab(R, s), R.dir && (s = 100 - s), !0 !== M(L[h % 2], s, !0) && at(l[h % 2]).each(function () { this.write(R, z[h % 2], L[h % 2].children(), K, x) })) } !0 === y && N(["set"]) }; S.D = function () { var h, q = []; for (h = 0; h < R.a; h++) { q[h] = l[h][0].A } return 1 === q.length ? q[0] : R.dir && 1 < R.a ? q.reverse() : q }; S.r = function () { at.each(l, function () { at.each(this, function () { this.target && this.target.off(".nui") }) }); at(this).off(".nui").removeClass(ar.join(" ")).empty(); return O }; K.val(R.start) } function ah(f) { this.length || aq("Can't initialize slider on empty selection."); var e = j(f, this); return this.each(function () { ai(this, e, f) }) } function a(e) { return this.each(function () { var f = at(this).val(), h = this.r(), l = at.extend({}, h, e); at(this).noUiSlider(l); h.start === l.start && at(this).val(f) }) } var af = at(document), ad = at.fn.val, ap = window.navigator.G ? { start: "pointerdown", move: "pointermove", end: "pointerup" } : window.navigator.msPointerEnabled ? { start: "MSPointerDown", move: "MSPointerMove", end: "MSPointerUp" } : { start: "mousedown touchstart", move: "mousemove touchmove", end: "mouseup touchend" }, ar = "noUi-target noUi-base noUi-origin noUi-handle noUi-horizontal noUi-vertical noUi-background noUi-connect noUi-ltr noUi-rtl noUi-dragable  noUi-state-drag  noUi-state-tap noUi-active noUi-extended noUi-stacking".split(" "), E = "decimals mark thousand prefix postfix encoder decoder negative negativeBefore".split(" "), aj = [2, ".", "", "", "", function (e) { return e }, function (e) { return e }, "-", ""]; an.prototype.b = function (e) { return this.B[e] }; an.prototype.C = function (l) { function h(e) { return e.split("").reverse().join("") } l = this.b("encoder")(l); var t = "", x = "", s = "", q = ""; 0 > l && (t = this.b("negative"), x = this.b("negativeBefore")); l = Math.abs(l).toFixed(this.b("decimals")).toString(); l = l.split("."); 0 === parseFloat(l) && (l[0] = "0"); this.b("thousand") ? (s = h(l[0]).match(/.{1,3}/g), s = h(s.join(h(this.b("thousand"))))) : s = l[0]; this.b("mark") && 1 < l.length && (q = this.b("mark") + l[1]); return x + this.b("prefix") + t + s + q + this.b("postfix") }; an.prototype.t = function (f) { function e(l) { return l.replace(/[\-\/\\\^$*+?.()|\[\]{}]/g, "\\$&") } var h; if (null === f || void 0 === f) { return !1 } f = f.toString(); h = f.replace(RegExp("^" + e(this.b("negativeBefore"))), ""); f !== h ? (f = h, h = "-") : h = ""; f = f.replace(RegExp("^" + e(this.b("prefix"))), ""); this.b.negative && (h = "", f = f.replace(RegExp("^" + e(this.b("negative"))), "-")); f = f.replace(RegExp(e(this.b("postfix")) + "$"), "").replace(RegExp(e(this.b("thousand")), "g"), "").replace(this.b("mark"), "."); f = this.b("decoder")(parseFloat(h + f)); return isNaN(f) ? !1 : f }; ao.prototype.write = function (t, q, C, D, z) { if (!this.update || !1 !== z) { if (100 <= q) { q = t.d.slice(-1)[0] } else { z = 1; for (var y, x, s; q >= t.c[z];) { z++ } y = t.d[z - 1]; x = t.d[z]; s = t.c[z - 1]; y = [y, x]; q = 100 / (t.c[z] - s) * (q - s) * (y[1] - y[0]) / 100 + y[0] } this.A = q = this.format(q); if ("function" === typeof this.method) { this.method.call(this.target[0] || D[0], q, C, D) } else { this.target[this.method](q, C, D) } } }; ao.prototype.format = function (e) { return this.g.C(e) }; ao.prototype.valueOf = function (e) { return this.g.t(e) }; at.noUiSlider = { Link: ao }; at.fn.noUiSlider = function (f, e) { return (e ? a : ah).call(this, f) }; at.fn.val = function () { var f = Array.prototype.slice.call(arguments, 0), e, l, q, h; if (!f.length) { return this.hasClass(ar[0]) ? this[0].D() : ad.apply(this) } "object" === typeof f[1] ? (e = f[1].set, l = f[1].link, q = f[1].update, h = f[1].animate) : !0 === f[1] && (e = !0); return this.each(function () { at(this).hasClass(ar[0]) ? this.F(ac(f[0]), e, l, q, h) : ad.apply(at(this), f) }) } })(window.jQuery || window.Zepto); this.Handlebars = {}, function (b) { b.VERSION = "1.0.rc.1", b.helpers = {}, b.partials = {}, b.registerHelper = function (f, d, g) { g && (d.not = g), this.helpers[f] = d }, b.registerPartial = function (f, d) { this.partials[f] = d }, b.registerHelper("helperMissing", function (d) { if (arguments.length === 2) { return undefined } throw new Error("Could not find property '" + d + "'") }); var a = Object.prototype.toString, c = "[object Function]"; b.registerHelper("blockHelperMissing", function (h, f) { var g = f.inverse || function () { }, j = f.fn, e = "", d = a.call(h); return d === c && (h = h.call(this)), h === !0 ? j(this) : h === !1 || h == null ? g(this) : d === "[object Array]" ? h.length > 0 ? b.helpers.each(h, f) : g(this) : j(h) }), b.K = function () { }, b.createFrame = Object.create || function (d) { b.K.prototype = d; var e = new b.K; return b.K.prototype = null, e }, b.registerHelper("each", function (p, g) { var d = g.fn, h = g.inverse, q = 0, e = "", l; g.data && (l = b.createFrame(g.data)); if (p && typeof p == "object") { if (p instanceof Array) { for (var k = p.length; q < k; q++) { l && (l.index = q), e += d(p[q], { data: l }) } } else { for (var j in p) { p.hasOwnProperty(j) && (l && (l.key = j), e += d(p[j], { data: l }), q++) } } } return q === 0 && (e = h(this)), e }), b.registerHelper("if", function (f, d) { var e = a.call(f); return e === c && (f = f.call(this)), !f || b.Utils.isEmpty(f) ? d.inverse(this) : d.fn(this) }), b.registerHelper("unless", function (e, g) { var f = g.fn, d = g.inverse; return g.fn = d, g.inverse = f, b.helpers["if"].call(this, e, g) }), b.registerHelper("with", function (f, d) { return d.fn(f) }), b.registerHelper("log", function (d) { b.log(d) }) }(this.Handlebars); var errorProps = ["description", "fileName", "lineNumber", "message", "name", "number", "stack"]; Handlebars.Exception = function (b) { var a = Error.prototype.constructor.apply(this, arguments); for (var c = 0; c < errorProps.length; c++) { this[errorProps[c]] = a[errorProps[c]] } }, Handlebars.Exception.prototype = new Error, Handlebars.SafeString = function (a) { this.string = a }, Handlebars.SafeString.prototype.toString = function () { return this.string.toString() }, function () { var c = { "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#x27;", "`": "&#x60;" }, a = /[&<>"'`]/g, d = /[&<>"'`]/, b = function (e) { return c[e] || "&amp;" }; Handlebars.Utils = { escapeExpression: function (f) { return f instanceof Handlebars.SafeString ? f.toString() : f == null || f === !1 ? "" : d.test(f) ? f.replace(a, b) : f }, isEmpty: function (f) { return typeof f == "undefined" ? !0 : f === null ? !0 : f === !1 ? !0 : Object.prototype.toString.call(f) === "[object Array]" && f.length === 0 ? !0 : !1 } } }(), Handlebars.VM = { template: function (b) { var a = { escapeExpression: Handlebars.Utils.escapeExpression, invokePartial: Handlebars.VM.invokePartial, programs: [], program: function (f, c, g) { var d = this.programs[f]; return g ? Handlebars.VM.program(c, g) : d ? d : (d = this.programs[f] = Handlebars.VM.program(c), d) }, programWithDepth: Handlebars.VM.programWithDepth, noop: Handlebars.VM.noop }; return function (d, c) { return c = c || {}, b.call(a, Handlebars, d, c.helpers, c.partials, c.data) } }, programWithDepth: function (c, a, d) { var b = Array.prototype.slice.call(arguments, 2); return function (f, e) { return e = e || {}, c.apply(this, [f, e.data || a].concat(b)) } }, program: function (b, a) { return function (d, c) { return c = c || {}, b(d, c.data || a) } }, noop: function () { return "" }, invokePartial: function (f, b, h, d, a, c) { var g = { helpers: d, partials: a, data: c }; if (f === undefined) { throw new Handlebars.Exception("The partial " + b + " could not be found") } if (f instanceof Function) { return f(h, g) } if (!Handlebars.compile) { throw new Handlebars.Exception("The partial " + b + " could not be compiled when running in runtime-only mode") } return a[b] = Handlebars.compile(f, { data: c !== undefined }), a[b](h, g) } }, Handlebars.template = Handlebars.VM.template; !function (j, l, a) { var e = ["webkit", "Moz", "ms", "O"], r = {}, q; function g(s, v) { var t = l.createElement(s || "div"), u; for (u in v) { t[u] = v[u] } return t } function h(t) { for (var s = 1, u = arguments.length; s < u; s++) { t.appendChild(arguments[s]) } return t } var k = function () { var s = g("style", { type: "text/css" }); h(l.getElementsByTagName("head")[0], s); return s.sheet || s.styleSheet }(); function c(w, s, x, B) { var t = ["opacity", s, ~~(w * 100), x, B].join("-"), u = 0.01 + x / B * 100, A = Math.max(1 - (1 - w) / s * (100 - u), w), y = q.substring(0, q.indexOf("Animation")).toLowerCase(), v = y && "-" + y + "-" || ""; if (!r[t]) { k.insertRule("@" + v + "keyframes " + t + "{0%{opacity:" + A + "}" + u + "%{opacity:" + w + "}" + (u + 0.01) + "%{opacity:1}" + (u + s) % 100 + "%{opacity:" + w + "}100%{opacity:" + A + "}}", k.cssRules.length); r[t] = 1 } return t } function p(w, x) { var v = w.style, t, u; if (v[x] !== a) { return x } x = x.charAt(0).toUpperCase() + x.slice(1); for (u = 0; u < e.length; u++) { t = e[u] + x; if (v[t] !== a) { return t } } } function f(s, u) { for (var t in u) { s.style[p(s, t) || t] = u[t] } return s } function o(u) { for (var s = 1; s < arguments.length; s++) { var t = arguments[s]; for (var v in t) { if (u[v] === a) { u[v] = t[v] } } } return u } function n(s) { var t = { x: s.offsetLeft, y: s.offsetTop }; while ((s = s.offsetParent)) { t.x += s.offsetLeft, t.y += s.offsetTop } return t } var d = { lines: 12, length: 7, width: 5, radius: 10, rotate: 0, corners: 1, color: "#000", speed: 1, trail: 100, opacity: 1 / 4, fps: 20, zIndex: 2000000000, className: "spinner", top: "auto", left: "auto", position: "relative" }; function b(s) { if (!this.spin) { return new b(s) } this.opts = o(s || {}, b.defaults, d) } b.defaults = {}; o(b.prototype, { spin: function (z) { this.stop(); var D = this, s = D.opts, t = D.el = f(g(0, { className: s.className }), { position: s.position, width: 0, zIndex: s.zIndex }), C = s.radius + s.length + s.width, E, B; if (z) { z.insertBefore(t, z.firstChild || null); B = n(z); E = n(t); f(t, { left: (s.left == "auto" ? B.x - E.x + (z.offsetWidth >> 1) : parseInt(s.left, 10) + C) + "px", top: (s.top == "auto" ? B.y - E.y + (z.offsetHeight >> 1) : parseInt(s.top, 10) + C) + "px" }) } t.setAttribute("aria-role", "progressbar"); D.lines(t, D.opts); if (!q) { var w = 0, u = s.fps, y = u / s.speed, x = (1 - s.opacity) / (y * s.trail / 100), A = y / s.lines; (function v() { w++; for (var F = s.lines; F; F--) { var G = Math.max(1 - (w + F * A) % y * x, s.opacity); D.opacity(t, s.lines - F, G, s) } D.timeout = D.el && setTimeout(v, ~~(1000 / u)) })() } return D }, stop: function () { var s = this.el; if (s) { clearTimeout(this.timeout); if (s.parentNode) { s.parentNode.removeChild(s) } this.el = a } return this }, lines: function (u, w) { var t = 0, s; function v(x, y) { return f(g(), { position: "absolute", width: (w.length + w.width) + "px", height: w.width + "px", background: x, boxShadow: y, transformOrigin: "left", transform: "rotate(" + ~~(360 / w.lines * t + w.rotate) + "deg) translate(" + w.radius + "px,0)", borderRadius: (w.corners * w.width >> 1) + "px" }) } for (; t < w.lines; t++) { s = f(g(), { position: "absolute", top: 1 + ~(w.width / 2) + "px", transform: w.hwaccel ? "translate3d(0,0,0)" : "", opacity: w.opacity, animation: q && c(w.opacity, w.trail, t, w.lines) + " " + 1 / w.speed + "s linear infinite" }); if (w.shadow) { h(s, f(v("#000", "0 0 4px #000"), { top: 2 + "px" })) } h(u, h(s, v(w.color, "0 0 1px rgba(0,0,0,.1)"))) } return u }, opacity: function (t, s, u) { if (s < t.childNodes.length) { t.childNodes[s].style.opacity = u } } }); (function () { function t(v, s) { return g("<" + v + ' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">', s) } var u = f(g("group"), { behavior: "url(#default#VML)" }); if (!p(u, "transform") && u.adj) { k.addRule(".spin-vml", "behavior:url(#default#VML)"); b.prototype.lines = function (x, w) { var v = w.length + w.width, D = 2 * v; function C() { return f(t("group", { coordsize: D + " " + D, coordorigin: -v + " " + -v }), { width: D, height: D }) } var y = -(w.width + w.length) * 2 + "px", B = f(C(), { position: "absolute", top: y, left: y }), A; function z(E, s, F) { h(B, h(f(C(), { rotation: 360 / w.lines * E + "deg", left: ~~s }), h(f(t("roundrect", { arcsize: w.corners }), { width: v, height: w.width, left: w.radius, top: -w.width >> 1, filter: F }), t("fill", { color: w.color, opacity: w.opacity }), t("stroke", { opacity: 0 })))) } if (w.shadow) { for (A = 1; A <= w.lines; A++) { z(A, -2, "progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)") } } for (A = 1; A <= w.lines; A++) { z(A) } return h(x, B) }; b.prototype.opacity = function (v, s, x, w) { var y = v.firstChild; w = w.shadow && w.lines || 0; if (y && s + w < y.childNodes.length) { y = y.childNodes[s + w]; y = y && y.firstChild; y = y && y.firstChild; if (y) { y.opacity = x } } } } else { q = p(u, "animation") } })(); if (typeof define == "function" && define.amd) { define(function () { return b }) } else { j.Spinner = b } }(window, document); (function (a) { if (typeof a.fn.each2 == "undefined") { a.extend(a.fn, { each2: function (f) { var d = a([0]), e = -1, b = this.length; while (++e < b && (d.context = d[0] = this[e]) && f.call(d[0], e, d) !== false) { } return this } }) } })(jQuery); (function (F, o) { if (window.Select2 !== o) { return } var M, P, z, c, a, r, q = { x: 0, y: 0 }, x, y, M = { TAB: 9, ENTER: 13, ESC: 27, SPACE: 32, LEFT: 37, UP: 38, RIGHT: 39, DOWN: 40, SHIFT: 16, CTRL: 17, ALT: 18, PAGE_UP: 33, PAGE_DOWN: 34, HOME: 36, END: 35, BACKSPACE: 8, DELETE: 46, isArrow: function (R) { R = R.which ? R.which : R; switch (R) { case M.LEFT: case M.RIGHT: case M.UP: case M.DOWN: return true }return false }, isControl: function (S) { var R = S.which; switch (R) { case M.SHIFT: case M.CTRL: case M.ALT: return true }if (S.metaKey) { return true } return false }, isFunctionKey: function (R) { R = R.which ? R.which : R; return R >= 112 && R <= 123 } }, D = "<div class='select2-measure-scrollbar'></div>", d = { "\u24B6": "A", "\uFF21": "A", "\u00C0": "A", "\u00C1": "A", "\u00C2": "A", "\u1EA6": "A", "\u1EA4": "A", "\u1EAA": "A", "\u1EA8": "A", "\u00C3": "A", "\u0100": "A", "\u0102": "A", "\u1EB0": "A", "\u1EAE": "A", "\u1EB4": "A", "\u1EB2": "A", "\u0226": "A", "\u01E0": "A", "\u00C4": "A", "\u01DE": "A", "\u1EA2": "A", "\u00C5": "A", "\u01FA": "A", "\u01CD": "A", "\u0200": "A", "\u0202": "A", "\u1EA0": "A", "\u1EAC": "A", "\u1EB6": "A", "\u1E00": "A", "\u0104": "A", "\u023A": "A", "\u2C6F": "A", "\uA732": "AA", "\u00C6": "AE", "\u01FC": "AE", "\u01E2": "AE", "\uA734": "AO", "\uA736": "AU", "\uA738": "AV", "\uA73A": "AV", "\uA73C": "AY", "\u24B7": "B", "\uFF22": "B", "\u1E02": "B", "\u1E04": "B", "\u1E06": "B", "\u0243": "B", "\u0182": "B", "\u0181": "B", "\u24B8": "C", "\uFF23": "C", "\u0106": "C", "\u0108": "C", "\u010A": "C", "\u010C": "C", "\u00C7": "C", "\u1E08": "C", "\u0187": "C", "\u023B": "C", "\uA73E": "C", "\u24B9": "D", "\uFF24": "D", "\u1E0A": "D", "\u010E": "D", "\u1E0C": "D", "\u1E10": "D", "\u1E12": "D", "\u1E0E": "D", "\u0110": "D", "\u018B": "D", "\u018A": "D", "\u0189": "D", "\uA779": "D", "\u01F1": "DZ", "\u01C4": "DZ", "\u01F2": "Dz", "\u01C5": "Dz", "\u24BA": "E", "\uFF25": "E", "\u00C8": "E", "\u00C9": "E", "\u00CA": "E", "\u1EC0": "E", "\u1EBE": "E", "\u1EC4": "E", "\u1EC2": "E", "\u1EBC": "E", "\u0112": "E", "\u1E14": "E", "\u1E16": "E", "\u0114": "E", "\u0116": "E", "\u00CB": "E", "\u1EBA": "E", "\u011A": "E", "\u0204": "E", "\u0206": "E", "\u1EB8": "E", "\u1EC6": "E", "\u0228": "E", "\u1E1C": "E", "\u0118": "E", "\u1E18": "E", "\u1E1A": "E", "\u0190": "E", "\u018E": "E", "\u24BB": "F", "\uFF26": "F", "\u1E1E": "F", "\u0191": "F", "\uA77B": "F", "\u24BC": "G", "\uFF27": "G", "\u01F4": "G", "\u011C": "G", "\u1E20": "G", "\u011E": "G", "\u0120": "G", "\u01E6": "G", "\u0122": "G", "\u01E4": "G", "\u0193": "G", "\uA7A0": "G", "\uA77D": "G", "\uA77E": "G", "\u24BD": "H", "\uFF28": "H", "\u0124": "H", "\u1E22": "H", "\u1E26": "H", "\u021E": "H", "\u1E24": "H", "\u1E28": "H", "\u1E2A": "H", "\u0126": "H", "\u2C67": "H", "\u2C75": "H", "\uA78D": "H", "\u24BE": "I", "\uFF29": "I", "\u00CC": "I", "\u00CD": "I", "\u00CE": "I", "\u0128": "I", "\u012A": "I", "\u012C": "I", "\u0130": "I", "\u00CF": "I", "\u1E2E": "I", "\u1EC8": "I", "\u01CF": "I", "\u0208": "I", "\u020A": "I", "\u1ECA": "I", "\u012E": "I", "\u1E2C": "I", "\u0197": "I", "\u24BF": "J", "\uFF2A": "J", "\u0134": "J", "\u0248": "J", "\u24C0": "K", "\uFF2B": "K", "\u1E30": "K", "\u01E8": "K", "\u1E32": "K", "\u0136": "K", "\u1E34": "K", "\u0198": "K", "\u2C69": "K", "\uA740": "K", "\uA742": "K", "\uA744": "K", "\uA7A2": "K", "\u24C1": "L", "\uFF2C": "L", "\u013F": "L", "\u0139": "L", "\u013D": "L", "\u1E36": "L", "\u1E38": "L", "\u013B": "L", "\u1E3C": "L", "\u1E3A": "L", "\u0141": "L", "\u023D": "L", "\u2C62": "L", "\u2C60": "L", "\uA748": "L", "\uA746": "L", "\uA780": "L", "\u01C7": "LJ", "\u01C8": "Lj", "\u24C2": "M", "\uFF2D": "M", "\u1E3E": "M", "\u1E40": "M", "\u1E42": "M", "\u2C6E": "M", "\u019C": "M", "\u24C3": "N", "\uFF2E": "N", "\u01F8": "N", "\u0143": "N", "\u00D1": "N", "\u1E44": "N", "\u0147": "N", "\u1E46": "N", "\u0145": "N", "\u1E4A": "N", "\u1E48": "N", "\u0220": "N", "\u019D": "N", "\uA790": "N", "\uA7A4": "N", "\u01CA": "NJ", "\u01CB": "Nj", "\u24C4": "O", "\uFF2F": "O", "\u00D2": "O", "\u00D3": "O", "\u00D4": "O", "\u1ED2": "O", "\u1ED0": "O", "\u1ED6": "O", "\u1ED4": "O", "\u00D5": "O", "\u1E4C": "O", "\u022C": "O", "\u1E4E": "O", "\u014C": "O", "\u1E50": "O", "\u1E52": "O", "\u014E": "O", "\u022E": "O", "\u0230": "O", "\u00D6": "O", "\u022A": "O", "\u1ECE": "O", "\u0150": "O", "\u01D1": "O", "\u020C": "O", "\u020E": "O", "\u01A0": "O", "\u1EDC": "O", "\u1EDA": "O", "\u1EE0": "O", "\u1EDE": "O", "\u1EE2": "O", "\u1ECC": "O", "\u1ED8": "O", "\u01EA": "O", "\u01EC": "O", "\u00D8": "O", "\u01FE": "O", "\u0186": "O", "\u019F": "O", "\uA74A": "O", "\uA74C": "O", "\u01A2": "OI", "\uA74E": "OO", "\u0222": "OU", "\u24C5": "P", "\uFF30": "P", "\u1E54": "P", "\u1E56": "P", "\u01A4": "P", "\u2C63": "P", "\uA750": "P", "\uA752": "P", "\uA754": "P", "\u24C6": "Q", "\uFF31": "Q", "\uA756": "Q", "\uA758": "Q", "\u024A": "Q", "\u24C7": "R", "\uFF32": "R", "\u0154": "R", "\u1E58": "R", "\u0158": "R", "\u0210": "R", "\u0212": "R", "\u1E5A": "R", "\u1E5C": "R", "\u0156": "R", "\u1E5E": "R", "\u024C": "R", "\u2C64": "R", "\uA75A": "R", "\uA7A6": "R", "\uA782": "R", "\u24C8": "S", "\uFF33": "S", "\u1E9E": "S", "\u015A": "S", "\u1E64": "S", "\u015C": "S", "\u1E60": "S", "\u0160": "S", "\u1E66": "S", "\u1E62": "S", "\u1E68": "S", "\u0218": "S", "\u015E": "S", "\u2C7E": "S", "\uA7A8": "S", "\uA784": "S", "\u24C9": "T", "\uFF34": "T", "\u1E6A": "T", "\u0164": "T", "\u1E6C": "T", "\u021A": "T", "\u0162": "T", "\u1E70": "T", "\u1E6E": "T", "\u0166": "T", "\u01AC": "T", "\u01AE": "T", "\u023E": "T", "\uA786": "T", "\uA728": "TZ", "\u24CA": "U", "\uFF35": "U", "\u00D9": "U", "\u00DA": "U", "\u00DB": "U", "\u0168": "U", "\u1E78": "U", "\u016A": "U", "\u1E7A": "U", "\u016C": "U", "\u00DC": "U", "\u01DB": "U", "\u01D7": "U", "\u01D5": "U", "\u01D9": "U", "\u1EE6": "U", "\u016E": "U", "\u0170": "U", "\u01D3": "U", "\u0214": "U", "\u0216": "U", "\u01AF": "U", "\u1EEA": "U", "\u1EE8": "U", "\u1EEE": "U", "\u1EEC": "U", "\u1EF0": "U", "\u1EE4": "U", "\u1E72": "U", "\u0172": "U", "\u1E76": "U", "\u1E74": "U", "\u0244": "U", "\u24CB": "V", "\uFF36": "V", "\u1E7C": "V", "\u1E7E": "V", "\u01B2": "V", "\uA75E": "V", "\u0245": "V", "\uA760": "VY", "\u24CC": "W", "\uFF37": "W", "\u1E80": "W", "\u1E82": "W", "\u0174": "W", "\u1E86": "W", "\u1E84": "W", "\u1E88": "W", "\u2C72": "W", "\u24CD": "X", "\uFF38": "X", "\u1E8A": "X", "\u1E8C": "X", "\u24CE": "Y", "\uFF39": "Y", "\u1EF2": "Y", "\u00DD": "Y", "\u0176": "Y", "\u1EF8": "Y", "\u0232": "Y", "\u1E8E": "Y", "\u0178": "Y", "\u1EF6": "Y", "\u1EF4": "Y", "\u01B3": "Y", "\u024E": "Y", "\u1EFE": "Y", "\u24CF": "Z", "\uFF3A": "Z", "\u0179": "Z", "\u1E90": "Z", "\u017B": "Z", "\u017D": "Z", "\u1E92": "Z", "\u1E94": "Z", "\u01B5": "Z", "\u0224": "Z", "\u2C7F": "Z", "\u2C6B": "Z", "\uA762": "Z", "\u24D0": "a", "\uFF41": "a", "\u1E9A": "a", "\u00E0": "a", "\u00E1": "a", "\u00E2": "a", "\u1EA7": "a", "\u1EA5": "a", "\u1EAB": "a", "\u1EA9": "a", "\u00E3": "a", "\u0101": "a", "\u0103": "a", "\u1EB1": "a", "\u1EAF": "a", "\u1EB5": "a", "\u1EB3": "a", "\u0227": "a", "\u01E1": "a", "\u00E4": "a", "\u01DF": "a", "\u1EA3": "a", "\u00E5": "a", "\u01FB": "a", "\u01CE": "a", "\u0201": "a", "\u0203": "a", "\u1EA1": "a", "\u1EAD": "a", "\u1EB7": "a", "\u1E01": "a", "\u0105": "a", "\u2C65": "a", "\u0250": "a", "\uA733": "aa", "\u00E6": "ae", "\u01FD": "ae", "\u01E3": "ae", "\uA735": "ao", "\uA737": "au", "\uA739": "av", "\uA73B": "av", "\uA73D": "ay", "\u24D1": "b", "\uFF42": "b", "\u1E03": "b", "\u1E05": "b", "\u1E07": "b", "\u0180": "b", "\u0183": "b", "\u0253": "b", "\u24D2": "c", "\uFF43": "c", "\u0107": "c", "\u0109": "c", "\u010B": "c", "\u010D": "c", "\u00E7": "c", "\u1E09": "c", "\u0188": "c", "\u023C": "c", "\uA73F": "c", "\u2184": "c", "\u24D3": "d", "\uFF44": "d", "\u1E0B": "d", "\u010F": "d", "\u1E0D": "d", "\u1E11": "d", "\u1E13": "d", "\u1E0F": "d", "\u0111": "d", "\u018C": "d", "\u0256": "d", "\u0257": "d", "\uA77A": "d", "\u01F3": "dz", "\u01C6": "dz", "\u24D4": "e", "\uFF45": "e", "\u00E8": "e", "\u00E9": "e", "\u00EA": "e", "\u1EC1": "e", "\u1EBF": "e", "\u1EC5": "e", "\u1EC3": "e", "\u1EBD": "e", "\u0113": "e", "\u1E15": "e", "\u1E17": "e", "\u0115": "e", "\u0117": "e", "\u00EB": "e", "\u1EBB": "e", "\u011B": "e", "\u0205": "e", "\u0207": "e", "\u1EB9": "e", "\u1EC7": "e", "\u0229": "e", "\u1E1D": "e", "\u0119": "e", "\u1E19": "e", "\u1E1B": "e", "\u0247": "e", "\u025B": "e", "\u01DD": "e", "\u24D5": "f", "\uFF46": "f", "\u1E1F": "f", "\u0192": "f", "\uA77C": "f", "\u24D6": "g", "\uFF47": "g", "\u01F5": "g", "\u011D": "g", "\u1E21": "g", "\u011F": "g", "\u0121": "g", "\u01E7": "g", "\u0123": "g", "\u01E5": "g", "\u0260": "g", "\uA7A1": "g", "\u1D79": "g", "\uA77F": "g", "\u24D7": "h", "\uFF48": "h", "\u0125": "h", "\u1E23": "h", "\u1E27": "h", "\u021F": "h", "\u1E25": "h", "\u1E29": "h", "\u1E2B": "h", "\u1E96": "h", "\u0127": "h", "\u2C68": "h", "\u2C76": "h", "\u0265": "h", "\u0195": "hv", "\u24D8": "i", "\uFF49": "i", "\u00EC": "i", "\u00ED": "i", "\u00EE": "i", "\u0129": "i", "\u012B": "i", "\u012D": "i", "\u00EF": "i", "\u1E2F": "i", "\u1EC9": "i", "\u01D0": "i", "\u0209": "i", "\u020B": "i", "\u1ECB": "i", "\u012F": "i", "\u1E2D": "i", "\u0268": "i", "\u0131": "i", "\u24D9": "j", "\uFF4A": "j", "\u0135": "j", "\u01F0": "j", "\u0249": "j", "\u24DA": "k", "\uFF4B": "k", "\u1E31": "k", "\u01E9": "k", "\u1E33": "k", "\u0137": "k", "\u1E35": "k", "\u0199": "k", "\u2C6A": "k", "\uA741": "k", "\uA743": "k", "\uA745": "k", "\uA7A3": "k", "\u24DB": "l", "\uFF4C": "l", "\u0140": "l", "\u013A": "l", "\u013E": "l", "\u1E37": "l", "\u1E39": "l", "\u013C": "l", "\u1E3D": "l", "\u1E3B": "l", "\u017F": "l", "\u0142": "l", "\u019A": "l", "\u026B": "l", "\u2C61": "l", "\uA749": "l", "\uA781": "l", "\uA747": "l", "\u01C9": "lj", "\u24DC": "m", "\uFF4D": "m", "\u1E3F": "m", "\u1E41": "m", "\u1E43": "m", "\u0271": "m", "\u026F": "m", "\u24DD": "n", "\uFF4E": "n", "\u01F9": "n", "\u0144": "n", "\u00F1": "n", "\u1E45": "n", "\u0148": "n", "\u1E47": "n", "\u0146": "n", "\u1E4B": "n", "\u1E49": "n", "\u019E": "n", "\u0272": "n", "\u0149": "n", "\uA791": "n", "\uA7A5": "n", "\u01CC": "nj", "\u24DE": "o", "\uFF4F": "o", "\u00F2": "o", "\u00F3": "o", "\u00F4": "o", "\u1ED3": "o", "\u1ED1": "o", "\u1ED7": "o", "\u1ED5": "o", "\u00F5": "o", "\u1E4D": "o", "\u022D": "o", "\u1E4F": "o", "\u014D": "o", "\u1E51": "o", "\u1E53": "o", "\u014F": "o", "\u022F": "o", "\u0231": "o", "\u00F6": "o", "\u022B": "o", "\u1ECF": "o", "\u0151": "o", "\u01D2": "o", "\u020D": "o", "\u020F": "o", "\u01A1": "o", "\u1EDD": "o", "\u1EDB": "o", "\u1EE1": "o", "\u1EDF": "o", "\u1EE3": "o", "\u1ECD": "o", "\u1ED9": "o", "\u01EB": "o", "\u01ED": "o", "\u00F8": "o", "\u01FF": "o", "\u0254": "o", "\uA74B": "o", "\uA74D": "o", "\u0275": "o", "\u01A3": "oi", "\u0223": "ou", "\uA74F": "oo", "\u24DF": "p", "\uFF50": "p", "\u1E55": "p", "\u1E57": "p", "\u01A5": "p", "\u1D7D": "p", "\uA751": "p", "\uA753": "p", "\uA755": "p", "\u24E0": "q", "\uFF51": "q", "\u024B": "q", "\uA757": "q", "\uA759": "q", "\u24E1": "r", "\uFF52": "r", "\u0155": "r", "\u1E59": "r", "\u0159": "r", "\u0211": "r", "\u0213": "r", "\u1E5B": "r", "\u1E5D": "r", "\u0157": "r", "\u1E5F": "r", "\u024D": "r", "\u027D": "r", "\uA75B": "r", "\uA7A7": "r", "\uA783": "r", "\u24E2": "s", "\uFF53": "s", "\u00DF": "s", "\u015B": "s", "\u1E65": "s", "\u015D": "s", "\u1E61": "s", "\u0161": "s", "\u1E67": "s", "\u1E63": "s", "\u1E69": "s", "\u0219": "s", "\u015F": "s", "\u023F": "s", "\uA7A9": "s", "\uA785": "s", "\u1E9B": "s", "\u24E3": "t", "\uFF54": "t", "\u1E6B": "t", "\u1E97": "t", "\u0165": "t", "\u1E6D": "t", "\u021B": "t", "\u0163": "t", "\u1E71": "t", "\u1E6F": "t", "\u0167": "t", "\u01AD": "t", "\u0288": "t", "\u2C66": "t", "\uA787": "t", "\uA729": "tz", "\u24E4": "u", "\uFF55": "u", "\u00F9": "u", "\u00FA": "u", "\u00FB": "u", "\u0169": "u", "\u1E79": "u", "\u016B": "u", "\u1E7B": "u", "\u016D": "u", "\u00FC": "u", "\u01DC": "u", "\u01D8": "u", "\u01D6": "u", "\u01DA": "u", "\u1EE7": "u", "\u016F": "u", "\u0171": "u", "\u01D4": "u", "\u0215": "u", "\u0217": "u", "\u01B0": "u", "\u1EEB": "u", "\u1EE9": "u", "\u1EEF": "u", "\u1EED": "u", "\u1EF1": "u", "\u1EE5": "u", "\u1E73": "u", "\u0173": "u", "\u1E77": "u", "\u1E75": "u", "\u0289": "u", "\u24E5": "v", "\uFF56": "v", "\u1E7D": "v", "\u1E7F": "v", "\u028B": "v", "\uA75F": "v", "\u028C": "v", "\uA761": "vy", "\u24E6": "w", "\uFF57": "w", "\u1E81": "w", "\u1E83": "w", "\u0175": "w", "\u1E87": "w", "\u1E85": "w", "\u1E98": "w", "\u1E89": "w", "\u2C73": "w", "\u24E7": "x", "\uFF58": "x", "\u1E8B": "x", "\u1E8D": "x", "\u24E8": "y", "\uFF59": "y", "\u1EF3": "y", "\u00FD": "y", "\u0177": "y", "\u1EF9": "y", "\u0233": "y", "\u1E8F": "y", "\u00FF": "y", "\u1EF7": "y", "\u1E99": "y", "\u1EF5": "y", "\u01B4": "y", "\u024F": "y", "\u1EFF": "y", "\u24E9": "z", "\uFF5A": "z", "\u017A": "z", "\u1E91": "z", "\u017C": "z", "\u017E": "z", "\u1E93": "z", "\u1E95": "z", "\u01B6": "z", "\u0225": "z", "\u0240": "z", "\u2C6C": "z", "\uA763": "z" }; x = F(document); a = (function () { var R = 1; return function () { return R++ } }()); function e(U) { var S, T, R, V; if (!U || U.length < 1) { return U } S = ""; for (T = 0, R = U.length; T < R; T++) { V = U.charAt(T); S += d[V] || V } return S } function s(T, U) { var S = 0, R = U.length; for (; S < R; S = S + 1) { if (v(T, U[S])) { return S } } return -1 } function O() { var R = F(D); R.appendTo("body"); var S = { width: R.width() - R[0].clientWidth, height: R.height() - R[0].clientHeight }; R.remove(); return S } function v(S, R) { if (S === R) { return true } if (S === o || R === o) { return false } if (S === null || R === null) { return false } if (S.constructor === String) { return S + "" === R + "" } if (R.constructor === String) { return R + "" === S + "" } return false } function j(S, U) { var V, T, R; if (S === null || S.length < 1) { return [] } V = S.split(U); for (T = 0, R = V.length; T < R; T = T + 1) { V[T] = F.trim(V[T]) } return V } function h(R) { return R.outerWidth(false) - R.width() } function H(S) { var R = "keyup-change-value"; S.on("keydown", function () { if (F.data(S, R) === o) { F.data(S, R, S.val()) } }); S.on("keyup", function () { var T = F.data(S, R); if (T !== o && S.val() !== T) { F.removeData(S, R); S.trigger("keyup-change") } }) } x.on("mousemove", function (R) { q.x = R.pageX; q.y = R.pageY }); function L(R) { R.on("mousemove", function (T) { var S = q; if (S === o || S.x !== T.pageX || S.y !== T.pageY) { F(T.target).trigger("mousemove-filtered", T) } }) } function l(U, S, R) { R = R || o; var T; return function () { var V = arguments; window.clearTimeout(T); T = window.setTimeout(function () { S.apply(R, V) }, U) } } function u(T) { var R = false, S; return function () { if (R === false) { S = T(); R = true } return S } } function n(R, T) { var S = l(R, function (U) { T.trigger("scroll-debounced", U) }); T.on("scroll", function (U) { if (s(U.target, T.get()) >= 0) { S(U) } }) } function K(R) { if (R[0] === document.activeElement) { return } window.setTimeout(function () { var T = R[0], U = R.val().length, S; R.focus(); if (R.is(":visible") && T === document.activeElement) { if (T.setSelectionRange) { T.setSelectionRange(U, U) } else { if (T.createTextRange) { S = T.createTextRange(); S.collapse(false); S.select() } } } }, 0) } function f(R) { R = F(R)[0]; var U = 0; var S = 0; if ("selectionStart" in R) { U = R.selectionStart; S = R.selectionEnd - U } else { if ("selection" in document) { R.focus(); var T = document.selection.createRange(); S = document.selection.createRange().text.length; T.moveStart("character", -R.value.length); U = T.text.length - S } } return { offset: U, length: S } } function C(R) { R.preventDefault(); R.stopPropagation() } function b(R) { R.preventDefault(); R.stopImmediatePropagation() } function p(S) { if (!r) { var R = S[0].currentStyle || window.getComputedStyle(S[0], null); r = F(document.createElement("div")).css({ position: "absolute", left: "-10000px", top: "-10000px", display: "none", fontSize: R.fontSize, fontFamily: R.fontFamily, fontStyle: R.fontStyle, fontWeight: R.fontWeight, letterSpacing: R.letterSpacing, textTransform: R.textTransform, whiteSpace: "nowrap" }); r.attr("class", "select2-sizer"); F("body").append(r) } r.text(S.val()); return r.width() } function k(S, W, R) { var U, V = [], T; U = S.attr("class"); if (U) { U = "" + U; F(U.split(" ")).each2(function () { if (this.indexOf("select2-") === 0) { V.push(this) } }) } U = W.attr("class"); if (U) { U = "" + U; F(U.split(" ")).each2(function () { if (this.indexOf("select2-") !== 0) { T = R(this); if (T) { V.push(this) } } }) } S.attr("class", V.join(" ")) } function w(W, V, T, R) { var U = e(W.toUpperCase()).indexOf(e(V.toUpperCase())), S = V.length; if (U < 0) { T.push(R(W)); return } T.push(R(W.substring(0, U))); T.push("<span class='select2-match'>"); T.push(R(W.substring(U, U + S))); T.push("</span>"); T.push(R(W.substring(U + S, W.length))) } function I(R) { var S = { "\\": "&#92;", "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;", "/": "&#47;" }; return String(R).replace(/[&<>"'\/\\]/g, function (T) { return S[T] }) } function G(S) { var V, T = null, W = S.quietMillis || 100, U = S.url, R = this; return function (X) { window.clearTimeout(V); V = window.setTimeout(function () { var aa = S.data, Z = U, ac = S.transport || F.fn.select2.ajaxDefaults.transport, Y = { type: S.type || "GET", cache: S.cache || false, jsonpCallback: S.jsonpCallback || o, dataType: S.dataType || "json" }, ab = F.extend({}, F.fn.select2.ajaxDefaults.params, Y); aa = aa ? aa.call(R, X.term, X.page, X.context) : null; Z = (typeof Z === "function") ? Z.call(R, X.term, X.page, X.context) : Z; if (T) { T.abort() } if (S.params) { if (F.isFunction(S.params)) { F.extend(ab, S.params.call(R)) } else { F.extend(ab, S.params) } } F.extend(ab, { url: Z, dataType: S.dataType, data: aa, success: function (ae) { var ad = S.results(ae, X.page); X.callback(ad) } }); T = ac.call(R, ab) }, W) } } function J(S) { var V = S, U, T, W = function (X) { return "" + X.text }; if (F.isArray(V)) { T = V; V = { results: T } } if (F.isFunction(V) === false) { T = V; V = function () { return T } } var R = V(); if (R.text) { W = R.text; if (!F.isFunction(W)) { U = R.text; W = function (X) { return X[U] } } } return function (Z) { var Y = Z.term, X = { results: [] }, aa; if (Y === "") { Z.callback(V()); return } aa = function (ac, ae) { var ad, ab; ac = ac[0]; if (ac.children) { ad = {}; for (ab in ac) { if (ac.hasOwnProperty(ab)) { ad[ab] = ac[ab] } } ad.children = []; F(ac.children).each2(function (af, ag) { aa(ag, ad.children) }); if (ad.children.length || Z.matcher(Y, W(ad), ac)) { ae.push(ad) } } else { if (Z.matcher(Y, W(ac), ac)) { ae.push(ac) } } }; F(V().results).each2(function (ac, ab) { aa(ab, X.results) }); Z.callback(X) } } function B(S) { var R = F.isFunction(S); return function (V) { var U = V.term, T = { results: [] }; F(R ? S() : S).each(function () { var W = this.text !== o, X = W ? this.text : this; if (U === "" || V.matcher(U, X)) { T.results.push(W ? this : { id: this, text: this }) } }); V.callback(T) } } function A(R, S) { if (F.isFunction(R)) { return true } if (!R) { return false } throw new Error(S + " must be a function or a falsy value") } function E(R) { return F.isFunction(R) ? R() : R } function t(R) { var S = 0; F.each(R, function (T, U) { if (U.children) { S += t(U.children) } else { S++ } }); return S } function g(Z, aa, X, R) { var S = Z, ab = false, U, Y, V, T, W; if (!R.createSearchChoice || !R.tokenSeparators || R.tokenSeparators.length < 1) { return o } while (true) { Y = -1; for (V = 0, T = R.tokenSeparators.length; V < T; V++) { W = R.tokenSeparators[V]; Y = Z.indexOf(W); if (Y >= 0) { break } } if (Y < 0) { break } U = Z.substring(0, Y); Z = Z.substring(Y + W.length); if (U.length > 0) { U = R.createSearchChoice.call(this, U, aa); if (U !== o && U !== null && R.id(U) !== o && R.id(U) !== null) { ab = false; for (V = 0, T = aa.length; V < T; V++) { if (v(R.id(U), R.id(aa[V]))) { ab = true; break } } if (!ab) { X(U) } } } } if (S !== Z) { return Z } } function N(R, S) { var T = function () { }; T.prototype = new R; T.prototype.constructor = T; T.prototype.parent = R.prototype; T.prototype = F.extend(T.prototype, S); return T } P = N(Object, { bind: function (S) { var R = this; return function () { S.apply(R, arguments) } }, init: function (V) { var T, S, W = ".select2-results", U, R; this.opts = V = this.prepareOpts(V); this.id = V.id; if (V.element.data("select2") !== o && V.element.data("select2") !== null) { V.element.data("select2").destroy() } this.container = this.createContainer(); this.containerId = "s2id_" + (V.element.attr("id") || "autogen" + a()); this.containerSelector = "#" + this.containerId.replace(/([;&,\.\+\*\~':"\!\^#$%@\[\]\(\)=>\|])/g, "\\$1"); this.container.attr("id", this.containerId); this.body = u(function () { return V.element.closest("body") }); k(this.container, this.opts.element, this.opts.adaptContainerCssClass); this.container.attr("style", V.element.attr("style")); this.container.css(E(V.containerCss)); this.container.addClass(E(V.containerCssClass)); this.elementTabIndex = this.opts.element.attr("tabindex"); this.opts.element.data("select2", this).attr("tabindex", "-1").before(this.container); this.container.data("select2", this); this.dropdown = this.container.find(".select2-drop"); this.dropdown.addClass(E(V.dropdownCssClass)); this.dropdown.data("select2", this); k(this.dropdown, this.opts.element, this.opts.adaptDropdownCssClass); this.results = T = this.container.find(W); this.search = S = this.container.find("input.select2-input"); this.queryCount = 0; this.resultsPage = 0; this.context = null; this.initContainer(); L(this.results); this.dropdown.on("mousemove-filtered touchstart touchmove touchend", W, this.bind(this.highlightUnderEvent)); n(80, this.results); this.dropdown.on("scroll-debounced", W, this.bind(this.loadMoreIfNeeded)); F(this.container).on("change", ".select2-input", function (X) { X.stopPropagation() }); F(this.dropdown).on("change", ".select2-input", function (X) { X.stopPropagation() }); if (F.fn.mousewheel) { T.mousewheel(function (ab, ac, Z, Y) { var aa = T.scrollTop(), X; if (Y > 0 && aa - Y <= 0) { T.scrollTop(0); C(ab) } else { if (Y < 0 && T.get(0).scrollHeight - T.scrollTop() + Y <= T.height()) { T.scrollTop(T.get(0).scrollHeight - T.height()); C(ab) } } }) } H(S); S.on("keyup-change input paste", this.bind(this.updateResults)); S.on("focus", function () { S.addClass("select2-focused") }); S.on("blur", function () { S.removeClass("select2-focused") }); this.dropdown.on("mouseup", W, this.bind(function (X) { if (F(X.target).closest(".select2-result-selectable").length > 0) { this.highlightUnderEvent(X); this.selectHighlighted(X) } })); this.dropdown.on("click mouseup mousedown", function (X) { X.stopPropagation() }); if (F.isFunction(this.opts.initSelection)) { this.initSelection(); this.monitorSource() } if (V.maximumInputLength !== null) { this.search.attr("maxlength", V.maximumInputLength) } var U = V.element.prop("disabled"); if (U === o) { U = false } this.enable(!U); var R = V.element.prop("readonly"); if (R === o) { R = false } this.readonly(R); y = y || O(); this.autofocus = V.element.prop("autofocus"); V.element.prop("autofocus", false); if (this.autofocus) { this.focus() } this.nextSearchTerm = o }, destroy: function () { var S = this.opts.element, R = S.data("select2"); this.close(); if (this.propertyObserver) { delete this.propertyObserver; this.propertyObserver = null } if (R !== o) { R.container.remove(); R.dropdown.remove(); S.removeClass("select2-offscreen").removeData("select2").off(".select2").prop("autofocus", this.autofocus || false); if (this.elementTabIndex) { S.attr({ tabindex: this.elementTabIndex }) } else { S.removeAttr("tabindex") } S.show() } }, optionToData: function (R) { if (R.is("option")) { return { id: R.prop("value"), text: R.text(), element: R.get(), css: R.attr("class"), disabled: R.prop("disabled"), locked: v(R.attr("locked"), "locked") || v(R.data("locked"), true) } } else { if (R.is("optgroup")) { return { text: R.attr("label"), children: [], element: R.get(), css: R.attr("class") } } } }, prepareOpts: function (W) { var U, S, R, V, T = this; U = W.element; if (U.get(0).tagName.toLowerCase() === "select") { this.select = S = W.element } if (S) { F.each(["id", "multiple", "ajax", "query", "createSearchChoice", "initSelection", "data", "tags"], function () { if (this in W) { throw new Error("Option '" + this + "' is not allowed for Select2 when attached to a <select> element.") } }) } W = F.extend({}, { populateResults: function (Y, aa, ad) { var ac, ab, X, Z, ae = this.opts.id; ac = function (al, af, ak) { var am, ah, ar, ao, ai, aq, ag, ap, an, aj; al = W.sortResults(al, af, ad); for (am = 0, ah = al.length; am < ah; am = am + 1) { ar = al[am]; ai = (ar.disabled === true); ao = (!ai) && (ae(ar) !== o); aq = ar.children && ar.children.length > 0; ag = F("<li></li>"); ag.addClass("select2-results-dept-" + ak); ag.addClass("select2-result"); ag.addClass(ao ? "select2-result-selectable" : "select2-result-unselectable"); if (ai) { ag.addClass("select2-disabled") } if (aq) { ag.addClass("select2-result-with-children") } ag.addClass(T.opts.formatResultCssClass(ar)); ap = F(document.createElement("div")); ap.addClass("select2-result-label"); aj = W.formatResult(ar, ap, ad, T.opts.escapeMarkup); if (aj !== o) { ap.html(aj) } ag.append(ap); if (aq) { an = F("<ul></ul>"); an.addClass("select2-result-sub"); ac(ar.children, an, ak + 1); ag.append(an) } ag.data("select2-data", ar); af.append(ag) } }; ac(aa, Y, 0) } }, F.fn.select2.defaults, W); if (typeof (W.id) !== "function") { R = W.id; W.id = function (X) { return X[R] } } if (F.isArray(W.element.data("select2Tags"))) { if ("tags" in W) { throw "tags specified as both an attribute 'data-select2-tags' and in options of Select2 " + W.element.attr("id") } W.tags = W.element.data("select2Tags") } if (S) { W.query = this.bind(function (ab) { var aa = { results: [], more: false }, Z = ab.term, Y, X, ac; ac = function (ad, af) { var ae; if (ad.is("option")) { if (ab.matcher(Z, ad.text(), ad)) { af.push(T.optionToData(ad)) } } else { if (ad.is("optgroup")) { ae = T.optionToData(ad); ad.children().each2(function (ag, ah) { ac(ah, ae.children) }); if (ae.children.length > 0) { af.push(ae) } } } }; Y = U.children(); if (this.getPlaceholder() !== o && Y.length > 0) { X = this.getPlaceholderOption(); if (X) { Y = Y.not(X) } } Y.each2(function (ad, ae) { ac(ae, aa.results) }); ab.callback(aa) }); W.id = function (X) { return X.id }; W.formatResultCssClass = function (X) { return X.css } } else { if (!("query" in W)) { if ("ajax" in W) { V = W.element.data("ajax-url"); if (V && V.length > 0) { W.ajax.url = V } W.query = G.call(W.element, W.ajax) } else { if ("data" in W) { W.query = J(W.data) } else { if ("tags" in W) { W.query = B(W.tags); if (W.createSearchChoice === o) { W.createSearchChoice = function (X) { return { id: F.trim(X), text: F.trim(X) } } } if (W.initSelection === o) { W.initSelection = function (X, Z) { var Y = []; F(j(X.val(), W.separator)).each(function () { var ac = this, ab = this, aa = W.tags; if (F.isFunction(aa)) { aa = aa() } F(aa).each(function () { if (v(this.id, ac)) { ab = this.text; return false } }); Y.push({ id: ac, text: ab }) }); Z(Y) } } } } } } } if (typeof (W.query) !== "function") { throw "query function not defined for Select2 " + W.element.attr("id") } return W }, monitorSource: function () { var R = this.opts.element, S; R.on("change.select2", this.bind(function (T) { if (this.opts.element.data("select2-change-triggered") !== true) { this.initSelection() } })); S = this.bind(function () { var V, U, T = this; var W = R.prop("disabled"); if (W === o) { W = false } this.enable(!W); var U = R.prop("readonly"); if (U === o) { U = false } this.readonly(U); k(this.container, this.opts.element, this.opts.adaptContainerCssClass); this.container.addClass(E(this.opts.containerCssClass)); k(this.dropdown, this.opts.element, this.opts.adaptDropdownCssClass); this.dropdown.addClass(E(this.opts.dropdownCssClass)) }); R.on("propertychange.select2 DOMAttrModified.select2", S); if (this.mutationCallback === o) { this.mutationCallback = function (T) { T.forEach(S) } } if (typeof WebKitMutationObserver !== "undefined") { if (this.propertyObserver) { delete this.propertyObserver; this.propertyObserver = null } this.propertyObserver = new WebKitMutationObserver(this.mutationCallback); this.propertyObserver.observe(R.get(0), { attributes: true, subtree: false }) } }, triggerSelect: function (S) { var R = F.Event("select2-selecting", { val: this.id(S), object: S }); this.opts.element.trigger(R); return !R.isDefaultPrevented() }, triggerChange: function (R) { R = R || {}; R = F.extend({}, R, { type: "change", val: this.val() }); this.opts.element.data("select2-change-triggered", true); this.opts.element.trigger(R); this.opts.element.data("select2-change-triggered", false); this.opts.element.click(); if (this.opts.blurOnChange) { this.opts.element.blur() } }, isInterfaceEnabled: function () { return this.enabledInterface === true }, enableInterface: function () { var R = this._enabled && !this._readonly, S = !R; if (R === this.enabledInterface) { return false } this.container.toggleClass("select2-container-disabled", S); this.close(); this.enabledInterface = R; return true }, enable: function (R) { if (R === o) { R = true } if (this._enabled === R) { return } this._enabled = R; this.opts.element.prop("disabled", !R); this.enableInterface() }, disable: function () { this.enable(false) }, readonly: function (R) { if (R === o) { R = false } if (this._readonly === R) { return false } this._readonly = R; this.opts.element.prop("readonly", R); this.enableInterface(); return true }, opened: function () { return this.container.hasClass("select2-dropdown-open") }, positionDropdown: function () { var T = this.dropdown, V = this.container.offset(), ac = this.container.outerHeight(false), ad = this.container.outerWidth(false), Z = T.outerHeight(false), S = F(window).scrollLeft() + F(window).width(), ag = F(window).scrollTop() + F(window).height(), U = V.top + ac, ae = V.left, R = U + Z <= ag, X = (V.top - Z) >= this.body().scrollTop(), aa = T.outerWidth(false), ai = ae + aa <= S, ah = T.hasClass("select2-drop-above"), W, af, Y, ab; if (this.opts.dropdownAutoWidth) { ab = F(".select2-results", T)[0]; T.addClass("select2-drop-auto-width"); T.css("width", ""); aa = T.outerWidth(false) + (ab.scrollHeight === ab.clientHeight ? 0 : y.width); aa > ad ? ad = aa : aa = ad; ai = ae + aa <= S } else { this.container.removeClass("select2-drop-auto-width") } if (this.body().css("position") !== "static") { W = this.body().offset(); U -= W.top; ae -= W.left } if (ah) { af = true; if (!X && R) { af = false } } else { af = false; if (!R && X) { af = true } } if (!ai) { ae = V.left + ad - aa } if (af) { U = V.top - Z; this.container.addClass("select2-drop-above"); T.addClass("select2-drop-above") } else { this.container.removeClass("select2-drop-above"); T.removeClass("select2-drop-above") } Y = F.extend({ top: U, left: ae, width: ad }, E(this.opts.dropdownCss)); T.css(Y) }, shouldOpen: function () { var R; if (this.opened()) { return false } if (this._enabled === false || this._readonly === true) { return false } R = F.Event("select2-opening"); this.opts.element.trigger(R); return !R.isDefaultPrevented() }, clearDropdownAlignmentPreference: function () { this.container.removeClass("select2-drop-above"); this.dropdown.removeClass("select2-drop-above") }, open: function () { if (!this.shouldOpen()) { return false } this.opening(); return true }, opening: function () { var X = this.containerId, R = "scroll." + X, U = "resize." + X, T = "orientationchange." + X, S, W; this.container.addClass("select2-dropdown-open").addClass("select2-container-active"); this.clearDropdownAlignmentPreference(); if (this.dropdown[0] !== this.body().children().last()[0]) { this.dropdown.detach().appendTo(this.body()) } S = F("#select2-drop-mask"); if (S.length == 0) { S = F(document.createElement("div")); S.attr("id", "select2-drop-mask").attr("class", "select2-drop-mask"); S.hide(); S.appendTo(this.body()); S.on("mousedown touchstart click", function (Z) { var aa = F("#select2-drop"), Y; if (aa.length > 0) { Y = aa.data("select2"); if (Y.opts.selectOnBlur) { Y.selectHighlighted({ noFocus: true }) } Y.close({ focus: false }); Z.preventDefault(); Z.stopPropagation() } }) } if (this.dropdown.prev()[0] !== S[0]) { this.dropdown.before(S) } F("#select2-drop").removeAttr("id"); this.dropdown.attr("id", "select2-drop"); S.show(); this.positionDropdown(); this.dropdown.show(); this.positionDropdown(); this.dropdown.addClass("select2-drop-active"); var V = this; this.container.parents().add(window).each(function () { F(this).on(U + " " + R + " " + T, function (Y) { V.positionDropdown() }) }) }, close: function () { if (!this.opened()) { return } var U = this.containerId, R = "scroll." + U, T = "resize." + U, S = "orientationchange." + U; this.container.parents().add(window).each(function () { F(this).off(R).off(T).off(S) }); this.clearDropdownAlignmentPreference(); F("#select2-drop-mask").hide(); this.dropdown.removeAttr("id"); this.dropdown.hide(); this.container.removeClass("select2-dropdown-open"); this.results.empty(); this.clearSearch(); this.search.removeClass("select2-active"); this.opts.element.trigger(F.Event("select2-close")) }, externalSearch: function (R) { this.open(); this.search.val(R); this.updateResults(false) }, clearSearch: function () { }, getMaximumSelectionSize: function () { return E(this.opts.maximumSelectionSize) }, ensureHighlightVisible: function () { var U = this.results, T, R, Y, X, V, W, S; R = this.highlight(); if (R < 0) { return } if (R == 0) { U.scrollTop(0); return } T = this.findHighlightableChoices().find(".select2-result-label"); Y = F(T[R]); X = Y.offset().top + Y.outerHeight(true); if (R === T.length - 1) { S = U.find("li.select2-more-results"); if (S.length > 0) { X = S.offset().top + S.outerHeight(true) } } V = U.offset().top + U.outerHeight(true); if (X > V) { U.scrollTop(U.scrollTop() + (X - V)) } W = Y.offset().top - U.offset().top; if (W < 0 && Y.css("display") != "none") { U.scrollTop(U.scrollTop() + W) } }, findHighlightableChoices: function () { return this.results.find(".select2-result-selectable:not(.select2-selected):not(.select2-disabled)") }, moveHighlight: function (U) { var T = this.findHighlightableChoices(), S = this.highlight(); while (S > -1 && S < T.length) { S += U; var R = F(T[S]); if (R.hasClass("select2-result-selectable") && !R.hasClass("select2-disabled") && !R.hasClass("select2-selected")) { this.highlight(S); break } } }, highlight: function (S) { var U = this.findHighlightableChoices(), R, T; if (arguments.length === 0) { return s(U.filter(".select2-highlighted")[0], U.get()) } if (S >= U.length) { S = U.length - 1 } if (S < 0) { S = 0 } this.removeHighlight(); R = F(U[S]); R.addClass("select2-highlighted"); this.ensureHighlightVisible(); T = R.data("select2-data"); if (T) { this.opts.element.trigger({ type: "select2-highlight", val: this.id(T), choice: T }) } }, removeHighlight: function () { this.results.find(".select2-highlighted").removeClass("select2-highlighted") }, countSelectableResults: function () { return this.findHighlightableChoices().length }, highlightUnderEvent: function (S) { var R = F(S.target).closest(".select2-result-selectable"); if (R.length > 0 && !R.is(".select2-highlighted")) { var T = this.findHighlightableChoices(); this.highlight(T.index(R)) } else { if (R.length == 0) { this.removeHighlight() } } }, loadMoreIfNeeded: function () { var V = this.results, U = V.find("li.select2-more-results"), Y, X = -1, W = this.resultsPage + 1, R = this, T = this.search.val(), S = this.context; if (U.length === 0) { return } Y = U.offset().top - V.offset().top - V.height(); if (Y <= this.opts.loadMorePadding) { U.addClass("select2-active"); this.opts.query({ element: this.opts.element, term: T, page: W, context: S, matcher: this.opts.matcher, callback: this.bind(function (Z) { if (!R.opened()) { return } R.opts.populateResults.call(this, V, Z.results, { term: T, page: W, context: S }); R.postprocessResults(Z, false, false); if (Z.more === true) { U.detach().appendTo(V).text(R.opts.formatLoadMore(W + 1)); window.setTimeout(function () { R.loadMoreIfNeeded() }, 10) } else { U.remove() } R.positionDropdown(); R.resultsPage = W; R.context = Z.context; this.opts.element.trigger({ type: "select2-loaded", items: Z }) }) }) } }, tokenize: function () { }, updateResults: function (Z) { var ad = this.search, X = this.results, R = this.opts, W, ac = this, aa, V = ad.val(), T = F.data(this.container, "select2-last-term"), ab; if (Z !== true && T && v(V, T)) { return } F.data(this.container, "select2-last-term", V); if (Z !== true && (this.showSearchInput === false || !this.opened())) { return } function Y() { ad.removeClass("select2-active"); ac.positionDropdown() } function S(ae) { X.html(ae); Y() } ab = ++this.queryCount; var U = this.getMaximumSelectionSize(); if (U >= 1) { W = this.data(); if (F.isArray(W) && W.length >= U && A(R.formatSelectionTooBig, "formatSelectionTooBig")) { S("<li class='select2-selection-limit'>" + R.formatSelectionTooBig(U) + "</li>"); return } } if (ad.val().length < R.minimumInputLength) { if (A(R.formatInputTooShort, "formatInputTooShort")) { S("<li class='select2-no-results'>" + R.formatInputTooShort(ad.val(), R.minimumInputLength) + "</li>") } else { S("") } if (Z && this.showSearch) { this.showSearch(true) } return } if (R.maximumInputLength && ad.val().length > R.maximumInputLength) { if (A(R.formatInputTooLong, "formatInputTooLong")) { S("<li class='select2-no-results'>" + R.formatInputTooLong(ad.val(), R.maximumInputLength) + "</li>") } else { S("") } return } if (R.formatSearching && this.findHighlightableChoices().length === 0) { S("<li class='select2-searching'>" + R.formatSearching() + "</li>") } ad.addClass("select2-active"); this.removeHighlight(); aa = this.tokenize(); if (aa != o && aa != null) { ad.val(aa) } this.resultsPage = 1; R.query({ element: R.element, term: ad.val(), page: this.resultsPage, context: null, matcher: R.matcher, callback: this.bind(function (af) { var ae; if (ab != this.queryCount) { return } if (!this.opened()) { this.search.removeClass("select2-active"); return } this.context = (af.context === o) ? null : af.context; if (this.opts.createSearchChoice && ad.val() !== "") { ae = this.opts.createSearchChoice.call(ac, ad.val(), af.results); if (ae !== o && ae !== null && ac.id(ae) !== o && ac.id(ae) !== null) { if (F(af.results).filter(function () { return v(ac.id(this), ac.id(ae)) }).length === 0) { af.results.unshift(ae) } } } if (af.results.length === 0 && A(R.formatNoMatches, "formatNoMatches")) { S("<li class='select2-no-results'>" + R.formatNoMatches(ad.val()) + "</li>"); return } X.empty(); ac.opts.populateResults.call(this, X, af.results, { term: ad.val(), page: this.resultsPage, context: null }); if (af.more === true && A(R.formatLoadMore, "formatLoadMore")) { X.append("<li class='select2-more-results'>" + ac.opts.escapeMarkup(R.formatLoadMore(this.resultsPage)) + "</li>"); window.setTimeout(function () { ac.loadMoreIfNeeded() }, 10) } this.postprocessResults(af, Z); Y(); this.opts.element.trigger({ type: "select2-loaded", items: af }) }) }) }, cancel: function () { this.close() }, blur: function () { if (this.opts.selectOnBlur) { this.selectHighlighted({ noFocus: true }) } this.close(); this.container.removeClass("select2-container-active"); if (this.search[0] === document.activeElement) { this.search.blur() } this.clearSearch(); this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus") }, focusSearch: function () { K(this.search) }, selectHighlighted: function (S) { var R = this.highlight(), T = this.results.find(".select2-highlighted"), U = T.closest(".select2-result").data("select2-data"); if (U) { this.highlight(R); this.onSelect(U, S) } else { if (S && S.noFocus) { this.close() } } }, getPlaceholder: function () { var R; return this.opts.element.attr("placeholder") || this.opts.element.attr("data-placeholder") || this.opts.element.data("placeholder") || this.opts.placeholder || ((R = this.getPlaceholderOption()) !== o ? R.text() : o) }, getPlaceholderOption: function () { if (this.select) { var R = this.select.children().first(); if (this.opts.placeholderOption !== o) { return (this.opts.placeholderOption === "first" && R) || (typeof this.opts.placeholderOption === "function" && this.opts.placeholderOption(this.select)) } else { if (R.text() === "" && R.val() === "") { return R } } } }, initContainerWidth: function () { function S() { var W, U, X, V, T; if (this.opts.width === "off") { return null } else { if (this.opts.width === "element") { return this.opts.element.outerWidth(false) === 0 ? "auto" : this.opts.element.outerWidth(false) + "px" } else { if (this.opts.width === "copy" || this.opts.width === "resolve") { W = this.opts.element.attr("style"); if (W !== o) { U = W.split(";"); for (V = 0, T = U.length; V < T; V = V + 1) { X = U[V].replace(/\s/g, "").match(/[^-]width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i); if (X !== null && X.length >= 1) { return X[1] } } } if (this.opts.width === "resolve") { W = this.opts.element.css("width"); if (W.indexOf("%") > 0) { return W } return (this.opts.element.outerWidth(false) === 0 ? "auto" : this.opts.element.outerWidth(false) + "px") } return null } else { if (F.isFunction(this.opts.width)) { return this.opts.width() } else { return this.opts.width } } } } } var R = S.call(this); if (R !== null) { this.container.css("width", R) } } }); z = N(P, { createContainer: function () { var R = F(document.createElement("div")).attr({ "class": "select2-container" }).html(["<a href='javascript:void(0)' onclick='return false;' class='select2-choice' tabindex='-1'>", "   <span class='select2-chosen'>&nbsp;</span><abbr class='select2-search-choice-close'></abbr>", "   <span class='select2-arrow'><b></b></span>", "</a>", "<input class='select2-focusser select2-offscreen' type='text'/>", "<div class='select2-drop select2-display-none'>", "   <div class='select2-search'>", "       <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'/>", "   </div>", "   <ul class='select2-results'>", "   </ul>", "</div>"].join("")); return R }, enableInterface: function () { if (this.parent.enableInterface.apply(this, arguments)) { this.focusser.prop("disabled", !this.isInterfaceEnabled()) } }, opening: function () { var T, S, R; if (this.opts.minimumResultsForSearch >= 0) { this.showSearch(true) } this.parent.opening.apply(this, arguments); if (this.showSearchInput !== false) { this.search.val(this.focusser.val()) } this.search.focus(); T = this.search.get(0); if (T.createTextRange) { S = T.createTextRange(); S.collapse(false); S.select() } else { if (T.setSelectionRange) { R = this.search.val().length; T.setSelectionRange(R, R) } } if (this.search.val() === "") { if (this.nextSearchTerm != o) { this.search.val(this.nextSearchTerm); this.search.select() } } this.focusser.prop("disabled", true).val(""); this.updateResults(true); this.opts.element.trigger(F.Event("select2-open")) }, close: function (R) { if (!this.opened()) { return } this.parent.close.apply(this, arguments); R = R || { focus: true }; this.focusser.removeAttr("disabled"); if (R.focus) { this.focusser.focus() } }, focus: function () { if (this.opened()) { this.close() } else { this.focusser.removeAttr("disabled"); this.focusser.focus() } }, isFocused: function () { return this.container.hasClass("select2-container-active") }, cancel: function () { this.parent.cancel.apply(this, arguments); this.focusser.removeAttr("disabled"); this.focusser.focus() }, destroy: function () { F("label[for='" + this.focusser.attr("id") + "']").attr("for", this.opts.element.attr("id")); this.parent.destroy.apply(this, arguments) }, initContainer: function () { var S, R = this.container, T = this.dropdown; if (this.opts.minimumResultsForSearch < 0) { this.showSearch(false) } else { this.showSearch(true) } this.selection = S = R.find(".select2-choice"); this.focusser = R.find(".select2-focusser"); this.focusser.attr("id", "s2id_autogen" + a()); F("label[for='" + this.opts.element.attr("id") + "']").attr("for", this.focusser.attr("id")); this.focusser.attr("tabindex", this.elementTabIndex); this.search.on("keydown", this.bind(function (U) { if (!this.isInterfaceEnabled()) { return } if (U.which === M.PAGE_UP || U.which === M.PAGE_DOWN) { C(U); return } switch (U.which) { case M.UP: case M.DOWN: this.moveHighlight((U.which === M.UP) ? -1 : 1); C(U); return; case M.ENTER: this.selectHighlighted(); C(U); return; case M.TAB: if (this.opts.selectOnBlur) { this.selectHighlighted({ noFocus: true }) } return; case M.ESC: this.cancel(U); C(U); return } })); this.search.on("blur", this.bind(function (U) { if (document.activeElement === this.body().get(0)) { window.setTimeout(this.bind(function () { this.search.focus() }), 0) } })); this.focusser.on("keydown", this.bind(function (U) { if (!this.isInterfaceEnabled()) { return } if (U.which === M.TAB || M.isControl(U) || M.isFunctionKey(U) || U.which === M.ESC) { return } if (this.opts.openOnEnter === false && U.which === M.ENTER) { C(U); return } if (U.which == M.DOWN || U.which == M.UP || (U.which == M.ENTER && this.opts.openOnEnter)) { if (U.altKey || U.ctrlKey || U.shiftKey || U.metaKey) { return } this.open(); C(U); return } if (U.which == M.DELETE || U.which == M.BACKSPACE) { if (this.opts.allowClear) { this.clear() } C(U); return } })); H(this.focusser); this.focusser.on("keyup-change input", this.bind(function (U) { if (this.opts.minimumResultsForSearch >= 0) { U.stopPropagation(); if (this.opened()) { return } this.open() } })); S.on("mousedown", "abbr", this.bind(function (U) { if (!this.isInterfaceEnabled()) { return } this.clear(); b(U); this.close(); this.selection.focus() })); S.on("mousedown", this.bind(function (U) { if (!this.container.hasClass("select2-container-active")) { this.opts.element.trigger(F.Event("select2-focus")) } if (this.opened()) { this.close() } else { if (this.isInterfaceEnabled()) { this.open() } } C(U) })); T.on("mousedown", this.bind(function () { this.search.focus() })); S.on("focus", this.bind(function (U) { C(U) })); this.focusser.on("focus", this.bind(function () { if (!this.container.hasClass("select2-container-active")) { this.opts.element.trigger(F.Event("select2-focus")) } this.container.addClass("select2-container-active") })).on("blur", this.bind(function () { if (!this.opened()) { this.container.removeClass("select2-container-active"); this.opts.element.trigger(F.Event("select2-blur")) } })); this.search.on("focus", this.bind(function () { if (!this.container.hasClass("select2-container-active")) { this.opts.element.trigger(F.Event("select2-focus")) } this.container.addClass("select2-container-active") })); this.initContainerWidth(); this.opts.element.addClass("select2-offscreen"); this.setPlaceholder() }, clear: function (S) { var T = this.selection.data("select2-data"); if (T) { var R = this.getPlaceholderOption(); this.opts.element.val(R ? R.val() : ""); this.selection.find(".select2-chosen").empty(); this.selection.removeData("select2-data"); this.setPlaceholder(); if (S !== false) { this.opts.element.trigger({ type: "select2-removed", val: this.id(T), choice: T }); this.triggerChange({ removed: T }) } } }, initSelection: function () { var S; if (this.isPlaceholderOptionSelected()) { this.updateSelection(null); this.close(); this.setPlaceholder() } else { var R = this; this.opts.initSelection.call(null, this.opts.element, function (T) { if (T !== o && T !== null) { R.updateSelection(T); R.close(); R.setPlaceholder() } }) } }, isPlaceholderOptionSelected: function () { var R; if (!this.opts.placeholder) { return false } return ((R = this.getPlaceholderOption()) !== o && R.is(":selected")) || (this.opts.element.val() === "") || (this.opts.element.val() === o) || (this.opts.element.val() === null) }, prepareOpts: function () { var S = this.parent.prepareOpts.apply(this, arguments), R = this; if (S.element.get(0).tagName.toLowerCase() === "select") { S.initSelection = function (T, V) { var U = T.find(":selected"); V(R.optionToData(U)) } } else { if ("data" in S) { S.initSelection = S.initSelection || function (U, W) { var V = U.val(); var T = null; S.query({ matcher: function (X, aa, Y) { var Z = v(V, S.id(Y)); if (Z) { T = Y } return Z }, callback: !F.isFunction(W) ? F.noop : function () { W(T) } }) } } } return S }, getPlaceholder: function () { if (this.select) { if (this.getPlaceholderOption() === o) { return o } } return this.parent.getPlaceholder.apply(this, arguments) }, setPlaceholder: function () { var R = this.getPlaceholder(); if (this.isPlaceholderOptionSelected() && R !== o) { if (this.select && this.getPlaceholderOption() === o) { return } this.selection.find(".select2-chosen").html(this.opts.escapeMarkup(R)); this.selection.addClass("select2-default"); this.container.removeClass("select2-allowclear") } }, postprocessResults: function (W, S, V) { var U = 0, R = this, X = true; this.findHighlightableChoices().each2(function (Y, Z) { if (v(R.id(Z.data("select2-data")), R.opts.element.val())) { U = Y; return false } }); if (V !== false) { if (S === true && U >= 0) { this.highlight(U) } else { this.highlight(0) } } if (S === true) { var T = this.opts.minimumResultsForSearch; if (T >= 0) { this.showSearch(t(W.results) >= T) } } }, showSearch: function (R) { if (this.showSearchInput === R) { return } this.showSearchInput = R; this.dropdown.find(".select2-search").toggleClass("select2-search-hidden", !R); this.dropdown.find(".select2-search").toggleClass("select2-offscreen", !R); F(this.dropdown, this.container).toggleClass("select2-with-searchbox", R) }, onSelect: function (T, S) { if (!this.triggerSelect(T)) { return } var R = this.opts.element.val(), U = this.data(); this.opts.element.val(this.id(T)); this.updateSelection(T); this.opts.element.trigger({ type: "select2-selected", val: this.id(T), choice: T }); this.nextSearchTerm = this.opts.nextSearchTerm(T, this.search.val()); this.close(); if (!S || !S.noFocus) { this.selection.focus() } if (!v(R, this.id(T))) { this.triggerChange({ added: T, removed: U }) } }, updateSelection: function (U) { var S = this.selection.find(".select2-chosen"), T, R; this.selection.data("select2-data", U); S.empty(); if (U !== null) { T = this.opts.formatSelection(U, S, this.opts.escapeMarkup) } if (T !== o) { S.append(T) } R = this.opts.formatSelectionCssClass(U, S); if (R !== o) { S.addClass(R) } this.selection.removeClass("select2-default"); if (this.opts.allowClear && this.getPlaceholder() !== o) { this.container.addClass("select2-allowclear") } }, val: function () { var V, S = false, T = null, R = this, U = this.data(); if (arguments.length === 0) { return this.opts.element.val() } V = arguments[0]; if (arguments.length > 1) { S = arguments[1] } if (this.select) { this.select.val(V).find(":selected").each2(function (W, X) { T = R.optionToData(X); return false }); this.updateSelection(T); this.setPlaceholder(); if (S) { this.triggerChange({ added: T, removed: U }) } } else { if (!V && V !== 0) { this.clear(S); return } if (this.opts.initSelection === o) { throw new Error("cannot call val() if initSelection() is not defined") } this.opts.element.val(V); this.opts.initSelection(this.opts.element, function (W) { R.opts.element.val(!W ? "" : R.id(W)); R.updateSelection(W); R.setPlaceholder(); if (S) { R.triggerChange({ added: W, removed: U }) } }) } }, clearSearch: function () { this.search.val(""); this.focusser.val("") }, data: function (T) { var S, R = false; if (arguments.length === 0) { S = this.selection.data("select2-data"); if (S == o) { S = null } return S } else { if (arguments.length > 1) { R = arguments[1] } if (!T) { this.clear(R) } else { S = this.data(); this.opts.element.val(!T ? "" : this.id(T)); this.updateSelection(T); if (R) { this.triggerChange({ added: T, removed: S }) } } } } }); c = N(P, { createContainer: function () { var R = F(document.createElement("div")).attr({ "class": "select2-container select2-container-multi" }).html(["<ul class='select2-choices'>", "  <li class='select2-search-field'>", "    <input type='text' autocomplete='off' autocorrect='off' autocapitalize='off' spellcheck='false' class='select2-input'>", "  </li>", "</ul>", "<div class='select2-drop select2-drop-multi select2-display-none'>", "   <ul class='select2-results'>", "   </ul>", "</div>"].join("")); return R }, prepareOpts: function () { var S = this.parent.prepareOpts.apply(this, arguments), R = this; if (S.element.get(0).tagName.toLowerCase() === "select") { S.initSelection = function (T, V) { var U = []; T.find(":selected").each2(function (W, X) { U.push(R.optionToData(X)) }); V(U) } } else { if ("data" in S) { S.initSelection = S.initSelection || function (T, W) { var U = j(T.val(), S.separator); var V = []; S.query({ matcher: function (X, aa, Y) { var Z = F.grep(U, function (ab) { return v(ab, S.id(Y)) }).length; if (Z) { V.push(Y) } return Z }, callback: !F.isFunction(W) ? F.noop : function () { var X = []; for (var aa = 0; aa < U.length; aa++) { var ab = U[aa]; for (var Z = 0; Z < V.length; Z++) { var Y = V[Z]; if (v(ab, S.id(Y))) { X.push(Y); V.splice(Z, 1); break } } } W(X) } }) } } } return S }, selectChoice: function (R) { var S = this.container.find(".select2-search-choice-focus"); if (S.length && R && R[0] == S[0]) { } else { if (S.length) { this.opts.element.trigger("choice-deselected", S) } S.removeClass("select2-search-choice-focus"); if (R && R.length) { this.close(); R.addClass("select2-search-choice-focus"); this.opts.element.trigger("choice-selected", R) } } }, destroy: function () { F("label[for='" + this.search.attr("id") + "']").attr("for", this.opts.element.attr("id")); this.parent.destroy.apply(this, arguments) }, initContainer: function () { var R = ".select2-choices", S; this.searchContainer = this.container.find(".select2-search-field"); this.selection = S = this.container.find(R); var T = this; this.selection.on("click", ".select2-search-choice", function (U) { T.search[0].focus(); T.selectChoice(F(this)) }); this.search.attr("id", "s2id_autogen" + a()); F("label[for='" + this.opts.element.attr("id") + "']").attr("for", this.search.attr("id")); this.search.on("input paste", this.bind(function () { if (!this.isInterfaceEnabled()) { return } if (!this.opened()) { this.open() } })); this.search.attr("tabindex", this.elementTabIndex); this.keydowns = 0; this.search.on("keydown", this.bind(function (Y) { if (!this.isInterfaceEnabled()) { return } ++this.keydowns; var W = S.find(".select2-search-choice-focus"); var X = W.prev(".select2-search-choice:not(.select2-locked)"); var V = W.next(".select2-search-choice:not(.select2-locked)"); var Z = f(this.search); if (W.length && (Y.which == M.LEFT || Y.which == M.RIGHT || Y.which == M.BACKSPACE || Y.which == M.DELETE || Y.which == M.ENTER)) { var U = W; if (Y.which == M.LEFT && X.length) { U = X } else { if (Y.which == M.RIGHT) { U = V.length ? V : null } else { if (Y.which === M.BACKSPACE) { this.unselect(W.first()); this.search.width(10); U = X.length ? X : V } else { if (Y.which == M.DELETE) { this.unselect(W.first()); this.search.width(10); U = V.length ? V : null } else { if (Y.which == M.ENTER) { U = null } } } } } this.selectChoice(U); C(Y); if (!U || !U.length) { this.open() } return } else { if (((Y.which === M.BACKSPACE && this.keydowns == 1) || Y.which == M.LEFT) && (Z.offset == 0 && !Z.length)) { this.selectChoice(S.find(".select2-search-choice:not(.select2-locked)").last()); C(Y); return } else { this.selectChoice(null) } } if (this.opened()) { switch (Y.which) { case M.UP: case M.DOWN: this.moveHighlight((Y.which === M.UP) ? -1 : 1); C(Y); return; case M.ENTER: this.selectHighlighted(); C(Y); return; case M.TAB: if (this.opts.selectOnBlur) { this.selectHighlighted({ noFocus: true }) } this.close(); return; case M.ESC: this.cancel(Y); C(Y); return } } if (Y.which === M.TAB || M.isControl(Y) || M.isFunctionKey(Y) || Y.which === M.BACKSPACE || Y.which === M.ESC) { return } if (Y.which === M.ENTER) { if (this.opts.openOnEnter === false) { return } else { if (Y.altKey || Y.ctrlKey || Y.shiftKey || Y.metaKey) { return } } } this.open(); if (Y.which === M.PAGE_UP || Y.which === M.PAGE_DOWN) { C(Y) } if (Y.which === M.ENTER) { C(Y) } })); this.search.on("keyup", this.bind(function (U) { this.keydowns = 0; this.resizeSearch() })); this.search.on("blur", this.bind(function (U) { this.container.removeClass("select2-container-active"); this.search.removeClass("select2-focused"); this.selectChoice(null); if (!this.opened()) { this.clearSearch() } U.stopImmediatePropagation(); this.opts.element.trigger(F.Event("select2-blur")) })); this.container.on("click", R, this.bind(function (U) { if (!this.isInterfaceEnabled()) { return } if (F(U.target).closest(".select2-search-choice").length > 0) { return } this.selectChoice(null); this.clearPlaceholder(); if (!this.container.hasClass("select2-container-active")) { this.opts.element.trigger(F.Event("select2-focus")) } this.open(); this.focusSearch(); U.preventDefault() })); this.container.on("focus", R, this.bind(function () { if (!this.isInterfaceEnabled()) { return } if (!this.container.hasClass("select2-container-active")) { this.opts.element.trigger(F.Event("select2-focus")) } this.container.addClass("select2-container-active"); this.dropdown.addClass("select2-drop-active"); this.clearPlaceholder() })); this.initContainerWidth(); this.opts.element.addClass("select2-offscreen"); this.clearSearch() }, enableInterface: function () { if (this.parent.enableInterface.apply(this, arguments)) { this.search.prop("disabled", !this.isInterfaceEnabled()) } }, initSelection: function () { var S; if (this.opts.element.val() === "" && this.opts.element.text() === "") { this.updateSelection([]); this.close(); this.clearSearch() } if (this.select || this.opts.element.val() !== "") { var R = this; this.opts.initSelection.call(null, this.opts.element, function (T) { if (T !== o && T !== null) { R.updateSelection(T); R.close(); R.clearSearch() } }) } }, clearSearch: function () { var S = this.getPlaceholder(), R = this.getMaxSearchWidth(); if (S !== o && this.getVal().length === 0 && this.search.hasClass("select2-focused") === false) { this.search.val(S).addClass("select2-default"); this.search.width(R > 0 ? R : this.container.css("width")) } else { this.search.val("").width(10) } }, clearPlaceholder: function () { if (this.search.hasClass("select2-default")) { this.search.val("").removeClass("select2-default") } }, opening: function () { this.clearPlaceholder(); this.resizeSearch(); this.parent.opening.apply(this, arguments); this.focusSearch(); this.updateResults(true); this.search.focus(); this.opts.element.trigger(F.Event("select2-open")) }, close: function () { if (!this.opened()) { return } this.parent.close.apply(this, arguments) }, focus: function () { this.close(); this.search.focus() }, isFocused: function () { return this.search.hasClass("select2-focused") }, updateSelection: function (U) { var T = [], S = [], R = this; F(U).each(function () { if (s(R.id(this), T) < 0) { T.push(R.id(this)); S.push(this) } }); U = S; this.selection.find(".select2-search-choice").remove(); F(U).each(function () { R.addSelectedChoice(this) }); R.postprocessResults() }, tokenize: function () { var R = this.search.val(); R = this.opts.tokenizer.call(this, R, this.data(), this.bind(this.onSelect), this.opts); if (R != null && R != o) { this.search.val(R); if (R.length > 0) { this.open() } } }, onSelect: function (S, R) { if (!this.triggerSelect(S)) { return } this.addSelectedChoice(S); this.opts.element.trigger({ type: "selected", val: this.id(S), choice: S }); if (this.select || !this.opts.closeOnSelect) { this.postprocessResults(S, false, this.opts.closeOnSelect === true) } if (this.opts.closeOnSelect) { this.close(); this.search.width(10) } else { if (this.countSelectableResults() > 0) { this.search.width(10); this.resizeSearch(); if (this.getMaximumSelectionSize() > 0 && this.val().length >= this.getMaximumSelectionSize()) { this.updateResults(true) } this.positionDropdown() } else { this.close(); this.search.width(10) } } this.triggerChange({ added: S }); if (!R || !R.noFocus) { this.focusSearch() } }, cancel: function () { this.close(); this.focusSearch() }, addSelectedChoice: function (V) { var X = !V.locked, T = F("<li class='select2-search-choice'>    <div></div>    <a href='#' onclick='return false;' class='select2-search-choice-close' tabindex='-1'></a></li>"), Y = F("<li class='select2-search-choice select2-locked'><div></div></li>"); var U = X ? T : Y, R = this.id(V), S = this.getVal(), W, Z; W = this.opts.formatSelection(V, U.find("div"), this.opts.escapeMarkup); if (W != o) { U.find("div").replaceWith("<div>" + W + "</div>") } Z = this.opts.formatSelectionCssClass(V, U.find("div")); if (Z != o) { U.addClass(Z) } if (X) { U.find(".select2-search-choice-close").on("mousedown", C).on("click dblclick", this.bind(function (aa) { if (!this.isInterfaceEnabled()) { return } F(aa.target).closest(".select2-search-choice").fadeOut("fast", this.bind(function () { this.unselect(F(aa.target)); this.selection.find(".select2-search-choice-focus").removeClass("select2-search-choice-focus"); this.close(); this.focusSearch() })).dequeue(); C(aa) })).on("focus", this.bind(function () { if (!this.isInterfaceEnabled()) { return } this.container.addClass("select2-container-active"); this.dropdown.addClass("select2-drop-active") })) } U.data("select2-data", V); U.insertBefore(this.searchContainer); S.push(R); this.setVal(S) }, unselect: function (S) { var U = this.getVal(), T, R; S = S.closest(".select2-search-choice"); if (S.length === 0) { throw "Invalid argument: " + S + ". Must be .select2-search-choice" } T = S.data("select2-data"); if (!T) { return } R = s(this.id(T), U); if (R >= 0) { U.splice(R, 1); this.setVal(U); if (this.select) { this.postprocessResults() } } S.remove(); this.opts.element.trigger({ type: "removed", val: this.id(T), choice: T }); this.triggerChange({ removed: T }) }, postprocessResults: function (V, S, U) { var W = this.getVal(), X = this.results.find(".select2-result"), T = this.results.find(".select2-result-with-children"), R = this; X.each2(function (Z, Y) { var aa = R.id(Y.data("select2-data")); if (s(aa, W) >= 0) { Y.addClass("select2-selected"); Y.find(".select2-result-selectable").addClass("select2-selected") } }); T.each2(function (Z, Y) { if (!Y.is(".select2-result-selectable") && Y.find(".select2-result-selectable:not(.select2-selected)").length === 0) { Y.addClass("select2-selected") } }); if (this.highlight() == -1 && U !== false) { R.highlight(0) } if (!this.opts.createSearchChoice && !X.filter(".select2-result:not(.select2-selected)").length > 0) { if (!V || V && !V.more && this.results.find(".select2-no-results").length === 0) { if (A(R.opts.formatNoMatches, "formatNoMatches")) { this.results.append("<li class='select2-no-results'>" + R.opts.formatNoMatches(R.search.val()) + "</li>") } } } }, getMaxSearchWidth: function () { return this.selection.width() - h(this.search) }, resizeSearch: function () { var W, U, T, R, S, V = h(this.search); W = p(this.search) + 10; U = this.search.offset().left; T = this.selection.width(); R = this.selection.offset().left; S = T - (U - R) - V; if (S < W) { S = T - V } if (S < 40) { S = T - V } if (S <= 0) { S = W } this.search.width(S) }, getVal: function () { var R; if (this.select) { R = this.select.val(); return R === null ? [] : R } else { R = this.opts.element.val(); return j(R, this.opts.separator) } }, setVal: function (S) { var R; if (this.select) { this.select.val(S) } else { R = []; F(S).each(function () { if (s(this, R) < 0) { R.push(this) } }); this.opts.element.val(R.length === 0 ? "" : R.join(this.opts.separator)) } }, buildChangeDetails: function (R, U) { var U = U.slice(0), R = R.slice(0); for (var T = 0; T < U.length; T++) { for (var S = 0; S < R.length; S++) { if (v(this.opts.id(U[T]), this.opts.id(R[S]))) { U.splice(T, 1); T--; R.splice(S, 1); S-- } } } return { added: U, removed: R } }, val: function (V, S) { var U, R = this, T; if (arguments.length === 0) { return this.getVal() } U = this.data(); if (!U.length) { U = [] } if (!V && V !== 0) { this.opts.element.val(""); this.updateSelection([]); this.clearSearch(); if (S) { this.triggerChange({ added: this.data(), removed: U }) } return } this.setVal(V); if (this.select) { this.opts.initSelection(this.select, this.bind(this.updateSelection)); if (S) { this.triggerChange(this.buildChangeDetails(U, this.data())) } } else { if (this.opts.initSelection === o) { throw new Error("val() cannot be called if initSelection() is not defined") } this.opts.initSelection(this.opts.element, function (X) { var W = F.map(X, R.id); R.setVal(W); R.updateSelection(X); R.clearSearch(); if (S) { R.triggerChange(R.buildChangeDetails(U, this.data())) } }) } this.clearSearch() }, onSortStart: function () { if (this.select) { throw new Error("Sorting of elements is not supported when attached to <select>. Attach to <input type='hidden'/> instead.") } this.search.width(0); this.searchContainer.hide() }, onSortEnd: function () { var S = [], R = this; this.searchContainer.show(); this.searchContainer.appendTo(this.searchContainer.parent()); this.resizeSearch(); this.selection.find(".select2-search-choice").each(function () { S.push(R.opts.id(F(this).data("select2-data"))) }); this.setVal(S); this.triggerChange() }, data: function (T, U) { var S = this, V, R; if (arguments.length === 0) { return this.selection.find(".select2-search-choice").map(function () { return F(this).data("select2-data") }).get() } else { R = this.data(); if (!T) { T = [] } V = F.map(T, function (W) { return S.opts.id(W) }); this.setVal(V); this.updateSelection(T); this.clearSearch(); if (U) { this.triggerChange(this.buildChangeDetails(R, this.data())) } } } }); F.fn.select2 = function () { var W = Array.prototype.slice.call(arguments, 0), S, V, R, Y, aa, Z = ["val", "destroy", "opened", "open", "close", "focus", "isFocused", "container", "dropdown", "onSortStart", "onSortEnd", "enable", "disable", "readonly", "positionDropdown", "data", "search"], X = ["opened", "isFocused", "container", "dropdown"], T = ["val", "data"], U = { search: "externalSearch" }; this.each(function () { if (W.length === 0 || typeof (W[0]) === "object") { S = W.length === 0 ? {} : F.extend({}, W[0]); S.element = F(this); if (S.element.get(0).tagName.toLowerCase() === "select") { aa = S.element.prop("multiple") } else { aa = S.multiple || false; if ("tags" in S) { S.multiple = aa = true } } V = aa ? new c() : new z(); V.init(S) } else { if (typeof (W[0]) === "string") { if (s(W[0], Z) < 0) { throw "Unknown method: " + W[0] } Y = o; V = F(this).data("select2"); if (V === o) { return } R = W[0]; if (R === "container") { Y = V.container } else { if (R === "dropdown") { Y = V.dropdown } else { if (U[R]) { R = U[R] } Y = V[R].apply(V, W.slice(1)) } } if (s(W[0], X) >= 0 || (s(W[0], T) && W.length == 1)) { return false } } else { throw "Invalid arguments to select2 plugin: " + W } } }); return (Y === o) ? this : Y }; F.fn.select2.defaults = { width: "copy", loadMorePadding: 0, closeOnSelect: true, openOnEnter: true, containerCss: {}, dropdownCss: {}, containerCssClass: "", dropdownCssClass: "", formatResult: function (S, T, V, R) { var U = []; w(S.text, V.term, U, R); return U.join("") }, formatSelection: function (T, S, R) { return T ? R(T.text) : o }, sortResults: function (S, R, T) { return S }, formatResultCssClass: function (R) { return o }, formatSelectionCssClass: function (S, R) { return o }, formatNoMatches: function () { return "No matches found" }, formatInputTooShort: function (R, S) { var T = S - R.length; return "Please enter " + T + " more character" + (T == 1 ? "" : "s") }, formatInputTooLong: function (S, R) { var T = S.length - R; return "Please delete " + T + " character" + (T == 1 ? "" : "s") }, formatSelectionTooBig: function (R) { return "You can only select " + R + " item" + (R == 1 ? "" : "s") }, formatLoadMore: function (R) { return "Loading more results..." }, formatSearching: function () { return "Searching..." }, minimumResultsForSearch: 0, minimumInputLength: 0, maximumInputLength: null, maximumSelectionSize: 0, id: function (R) { return R.id }, matcher: function (R, S) { return e("" + S).toUpperCase().indexOf(e("" + R).toUpperCase()) >= 0 }, separator: ",", tokenSeparators: [], tokenizer: g, escapeMarkup: I, blurOnChange: false, selectOnBlur: false, adaptContainerCssClass: function (R) { return R }, adaptDropdownCssClass: function (R) { return null }, nextSearchTerm: function (R, S) { return o } }; F.fn.select2.ajaxDefaults = { transport: F.ajax, params: { type: "GET", cache: false, dataType: "json" } }; window.Select2 = { query: { ajax: G, local: J, tags: B }, util: { debounce: l, markMatch: w, escapeMarkup: I, stripDiacritics: e }, "class": { "abstract": P, single: z, multi: c } } }(jQuery));
/*!
jQuery Waypoints - v1.1.7
Copyright (c) 2011-2012 Caleb Troughton
Dual licensed under the MIT license and GPL license.
https://github.com/imakewebthings/jquery-waypoints/blob/master/MIT-license.txt
https://github.com/imakewebthings/jquery-waypoints/blob/master/GPL-license.txt
*/
(function ($, l, o, j, d) { var e = $(j), g = "waypoint.reached", b = function (q, p) { q.element.trigger(g, p); if (q.options.triggerOnce) { q.element[l]("destroy") } }, h = function (r, q) { if (!q) { return -1 } var p = q.waypoints.length - 1; while (p >= 0 && q.waypoints[p].element[0] !== r[0]) { p -= 1 } return p }, f = [], n = function (p) { $.extend(this, { element: $(p), oldScroll: 0, waypoints: [], didScroll: false, didResize: false, doScroll: $.proxy(function () { var s = this.element.scrollTop(), r = s > this.oldScroll, u = this, t = $.grep(this.waypoints, function (w, v) { return r ? (w.offset > u.oldScroll && w.offset <= s) : (w.offset <= u.oldScroll && w.offset > s) }), q = t.length; if (!this.oldScroll || !s) { $[o]("refresh") } this.oldScroll = s; if (!q) { return } if (!r) { t.reverse() } $.each(t, function (w, v) { if (v.options.continuous || w === q - 1) { b(v, [r ? "down" : "up"]) } }) }, this) }); $(p).bind("scroll.waypoints", $.proxy(function () { if (!this.didScroll) { this.didScroll = true; j.setTimeout($.proxy(function () { this.doScroll(); this.didScroll = false }, this), $[o].settings.scrollThrottle) } }, this)).bind("resize.waypoints", $.proxy(function () { if (!this.didResize) { this.didResize = true; j.setTimeout($.proxy(function () { $[o]("refresh"); this.didResize = false }, this), $[o].settings.resizeThrottle) } }, this)); e.load($.proxy(function () { this.doScroll() }, this)) }, k = function (p) { var q = null; $.each(f, function (r, s) { if (s.element[0] === p) { q = s; return false } }); return q }, c = { init: function (q, p) { this.each(function () { var w = $.fn[l].defaults.context, s, v = $(this); if (p && p.context) { w = p.context } if (!$.isWindow(w)) { w = v.closest(w)[0] } s = k(w); if (!s) { s = new n(w); f.push(s) } var r = h(v, s), u = r < 0 ? $.fn[l].defaults : s.waypoints[r].options, t = $.extend({}, u, p); t.offset = t.offset === "bottom-in-view" ? function () { var x = $.isWindow(w) ? $[o]("viewportHeight") : $(w).height(); return x - $(this).outerHeight() } : t.offset; t.offset = t.offset === "before-bottom-in-view" ? function () { var x = $.isWindow(w) ? $[o]("viewportHeight") : $(w).height(); return x - $(this).outerHeight() + 700 } : t.offset; if (r < 0) { s.waypoints.push({ element: v, offset: null, options: t }) } else { s.waypoints[r].options = t } if (q) { v.bind(g, q) } if (p && p.handler) { v.bind(g, p.handler) } }); $[o]("refresh"); return this }, remove: function () { return this.each(function (q, r) { var p = $(r); $.each(f, function (t, u) { var s = h(p, u); if (s >= 0) { u.waypoints.splice(s, 1); if (!u.waypoints.length) { u.element.unbind("scroll.waypoints resize.waypoints"); f.splice(t, 1) } } }) }) }, destroy: function () { return this.unbind(g)[l]("remove") } }, a = { refresh: function () { $.each(f, function (t, u) { var s = $.isWindow(u.element[0]), p = s ? 0 : u.element.offset().top, r = s ? $[o]("viewportHeight") : u.element.height(), q = s ? 0 : u.element.scrollTop(); $.each(u.waypoints, function (w, z) { if (!z) { return } var v = z.options.offset, y = z.offset; if (typeof z.options.offset === "function") { v = z.options.offset.apply(z.element) } else { if (typeof z.options.offset === "string") { var x = parseFloat(z.options.offset); v = z.options.offset.indexOf("%") ? Math.ceil(r * (x / 100)) : x } } z.offset = z.element.offset().top - p + q - v; if (z.options.onlyOnScroll) { return } if (y !== null && u.oldScroll > y && u.oldScroll <= z.offset) { b(z, ["up"]) } else { if (y !== null && u.oldScroll < y && u.oldScroll >= z.offset) { b(z, ["down"]) } else { if (!y && u.element.scrollTop() > z.offset) { b(z, ["down"]) } } } }); u.waypoints.sort(function (w, v) { return w.offset - v.offset }) }) }, viewportHeight: function () { return (j.innerHeight ? j.innerHeight : e.height()) }, aggregate: function () { var p = $(); $.each(f, function (q, r) { $.each(r.waypoints, function (s, t) { p = p.add(t.element) }) }); return p } }; $.fn[l] = function (p) { if (c[p]) { return c[p].apply(this, Array.prototype.slice.call(arguments, 1)) } else { if (typeof p === "function" || !p) { return c.init.apply(this, arguments) } else { if (typeof p === "object") { return c.init.apply(this, [null, p]) } else { $.error("Method " + p + " does not exist on jQuery " + l) } } } }; $.fn[l].defaults = { continuous: true, offset: 0, triggerOnce: false, context: j }; $[o] = function (p) { if (a[p]) { return a[p].apply(this) } else { return a.aggregate() } }; $[o].settings = { resizeThrottle: 200, scrollThrottle: 100 }; e.load(function () { $[o]("refresh") }) })(jQuery, "waypoint", "waypoints", window); typeof JSON != "object" && (JSON = {}), function () { function f(e) { return e < 10 ? "0" + e : e } function quote(e) { return escapable.lastIndex = 0, escapable.test(e) ? '"' + e.replace(escapable, function (e) { var t = meta[e]; return typeof t == "string" ? t : "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + e + '"' } function str(e, t) { var n, r, i, s, o = gap, u, a = t[e]; a && typeof a == "object" && typeof a.toJSON == "function" && (a = a.toJSON(e)), typeof rep == "function" && (a = rep.call(t, e, a)); switch (typeof a) { case "string": return quote(a); case "number": return isFinite(a) ? String(a) : "null"; case "boolean": case "null": return String(a); case "object": if (!a) { return "null" } gap += indent, u = []; if (Object.prototype.toString.apply(a) === "[object Array]") { s = a.length; for (n = 0; n < s; n += 1) { u[n] = str(n, a) || "null" } return i = u.length === 0 ? "[]" : gap ? "[\n" + gap + u.join(",\n" + gap) + "\n" + o + "]" : "[" + u.join(",") + "]", gap = o, i } if (rep && typeof rep == "object") { s = rep.length; for (n = 0; n < s; n += 1) { typeof rep[n] == "string" && (r = rep[n], i = str(r, a), i && u.push(quote(r) + (gap ? ": " : ":") + i)) } } else { for (r in a) { Object.prototype.hasOwnProperty.call(a, r) && (i = str(r, a), i && u.push(quote(r) + (gap ? ": " : ":") + i)) } } return i = u.length === 0 ? "{}" : gap ? "{\n" + gap + u.join(",\n" + gap) + "\n" + o + "}" : "{" + u.join(",") + "}", gap = o, i } } typeof Date.prototype.toJSON != "function" && (Date.prototype.toJSON = function (e) { return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null }, String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function (e) { return this.valueOf() }); var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "	": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep; typeof JSON.stringify != "function" && (JSON.stringify = function (e, t, n) { var r; gap = "", indent = ""; if (typeof n == "number") { for (r = 0; r < n; r += 1) { indent += " " } } else { typeof n == "string" && (indent = n) } rep = t; if (!t || typeof t == "function" || typeof t == "object" && typeof t.length == "number") { return str("", { "": e }) } throw new Error("JSON.stringify") }), typeof JSON.parse != "function" && (JSON.parse = function (text, reviver) { function walk(e, t) { var n, r, i = e[t]; if (i && typeof i == "object") { for (n in i) { Object.prototype.hasOwnProperty.call(i, n) && (r = walk(i, n), r !== undefined ? i[n] = r : delete i[n]) } } return reviver.call(e, t, i) } var j; text = String(text), cx.lastIndex = 0, cx.test(text) && (text = text.replace(cx, function (e) { return "\\u" + ("0000" + e.charCodeAt(0).toString(16)).slice(-4) })); if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) { return j = eval("(" + text + ")"), typeof reviver == "function" ? walk({ "": j }, "") : j } throw new SyntaxError("JSON.parse") }) }(), function (b, a) { var c = b.History = b.History || {}; if (typeof c.Adapter != "undefined") { throw new Error("History.js Adapter has already been loaded...") } c.Adapter = { handlers: {}, _uid: 1, uid: function (d) { return d._uid || (d._uid = c.Adapter._uid++) }, bind: function (h, f, g) { var d = c.Adapter.uid(h); c.Adapter.handlers[d] = c.Adapter.handlers[d] || {}, c.Adapter.handlers[d][f] = c.Adapter.handlers[d][f] || [], c.Adapter.handlers[d][f].push(g), h["on" + f] = function (k, j) { return function (e) { c.Adapter.trigger(k, j, e) } }(h, f) }, trigger: function (j, f, h) { h = h || {}; var d = c.Adapter.uid(j), g, k; c.Adapter.handlers[d] = c.Adapter.handlers[d] || {}, c.Adapter.handlers[d][f] = c.Adapter.handlers[d][f] || []; for (g = 0, k = c.Adapter.handlers[d][f].length; g < k; ++g) { c.Adapter.handlers[d][f][g].apply(this, [h]) } }, extractEventData: function (f, g) { var d = g && g[f] || a; return d }, onDomLoad: function (d) { var e = b.setTimeout(function () { d() }, 2000); b.onload = function () { clearTimeout(e), d() } } }, typeof c.init != "undefined" && c.init() }(window), function (f, b) { var h = f.document, d = f.setTimeout || d, a = f.clearTimeout || a, c = f.setInterval || c, g = f.History = f.History || {}; if (typeof g.initHtml4 != "undefined") { throw new Error("History.js HTML4 Support has already been loaded...") } g.initHtml4 = function () { if (typeof g.initHtml4.initialized != "undefined") { return !1 } g.initHtml4.initialized = !0, g.enabled = !0, g.savedHashes = [], g.isLastHash = function (k) { var j = g.getHashByIndex(), l; return l = k === j, l }, g.isHashEqual = function (k, j) { return k = encodeURIComponent(k).replace(/%25/g, "%"), j = encodeURIComponent(j).replace(/%25/g, "%"), k === j }, g.saveHash = function (j) { return g.isLastHash(j) ? !1 : (g.savedHashes.push(j), !0) }, g.getHashByIndex = function (k) { var j = null; return typeof k == "undefined" ? j = g.savedHashes[g.savedHashes.length - 1] : k < 0 ? j = g.savedHashes[g.savedHashes.length + k] : j = g.savedHashes[k], j }, g.discardedHashes = {}, g.discardedStates = {}, g.discardState = function (o, k, p) { var l = g.getHashByState(o), j; return j = { discardedState: o, backState: p, forwardState: k }, g.discardedStates[l] = j, !0 }, g.discardHash = function (l, j, o) { var k = { discardedHash: l, backState: o, forwardState: j }; return g.discardedHashes[l] = k, !0 }, g.discardedState = function (k) { var j = g.getHashByState(k), l; return l = g.discardedStates[j] || !1, l }, g.discardedHash = function (k) { var j = g.discardedHashes[k] || !1; return j }, g.recycleState = function (k) { var j = g.getHashByState(k); return g.discardedState(k) && delete g.discardedStates[j], !0 }, g.emulated.hashChange && (g.hashChangeInit = function () { g.checkerFunction = null; var l = "", n, k, j, e, o = Boolean(g.getHash()); return g.isInternetExplorer() ? (n = "historyjs-iframe", k = h.createElement("iframe"), k.setAttribute("id", n), k.setAttribute("src", "#"), k.style.display = "none", h.body.appendChild(k), k.contentWindow.document.open(), k.contentWindow.document.close(), j = "", e = !1, g.checkerFunction = function () { if (e) { return !1 } e = !0; var q = g.getHash(), p = g.getHash(k.contentWindow.document); return q !== l ? (l = q, p !== q && (j = p = q, k.contentWindow.document.open(), k.contentWindow.document.close(), k.contentWindow.document.location.hash = g.escapeHash(q)), g.Adapter.trigger(f, "hashchange")) : p !== j && (j = p, o && p === "" ? g.back() : g.setHash(p, !1)), e = !1, !0 }) : g.checkerFunction = function () { var p = g.getHash() || ""; return p !== l && (l = p, g.Adapter.trigger(f, "hashchange")), !0 }, g.intervalList.push(c(g.checkerFunction, g.options.hashChangeInterval)), !0 }, g.Adapter.onDomLoad(g.hashChangeInit)), g.emulated.pushState && (g.onHashChange = function (l) { var q = l && l.newURL || g.getLocationHref(), p = g.getHashByUrl(q), k = null, o = null, j = null, e; return g.isLastHash(p) ? (g.busy(!1), !1) : (g.doubleCheckComplete(), g.saveHash(p), p && g.isTraditionalAnchor(p) ? (g.Adapter.trigger(f, "anchorchange"), g.busy(!1), !1) : (k = g.extractState(g.getFullUrl(p || g.getLocationHref()), !0), g.isLastSavedState(k) ? (g.busy(!1), !1) : (o = g.getHashByState(k), e = g.discardedState(k), e ? (g.getHashByIndex(-2) === g.getHashByState(e.forwardState) ? g.back(!1) : g.forward(!1), !1) : (g.pushState(k.data, k.title, encodeURI(k.url), !1), !0)))) }, g.Adapter.bind(f, "hashchange", g.onHashChange), g.pushState = function (x, j, e, o) { e = encodeURI(e).replace(/%25/g, "%"); if (g.getHashByUrl(e)) { throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).") } if (o !== !1 && g.busy()) { return g.pushQueue({ scope: g, callback: g.pushState, args: arguments, queue: o }), !1 } g.busy(!0); var y = g.createStateObject(x, j, e), w = g.getHashByState(y), v = g.getState(!1), p = g.getHashByState(v), k = g.getHash(), q = g.expectedStateId == y.id; return g.storeState(y), g.expectedStateId = y.id, g.recycleState(y), g.setTitle(y), w === p ? (g.busy(!1), !1) : (g.saveState(y), q || g.Adapter.trigger(f, "statechange"), !g.isHashEqual(w, k) && !g.isHashEqual(w, g.getShortUrl(g.getLocationHref())) && g.setHash(w, !1), g.busy(!1), !0) }, g.replaceState = function (w, j, e, o) { e = encodeURI(e).replace(/%25/g, "%"); if (g.getHashByUrl(e)) { throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).") } if (o !== !1 && g.busy()) { return g.pushQueue({ scope: g, callback: g.replaceState, args: arguments, queue: o }), !1 } g.busy(!0); var x = g.createStateObject(w, j, e), v = g.getHashByState(x), q = g.getState(!1), p = g.getHashByState(q), k = g.getStateByIndex(-2); return g.discardState(q, x, k), v === p ? (g.storeState(x), g.expectedStateId = x.id, g.recycleState(x), g.setTitle(x), g.saveState(x), g.Adapter.trigger(f, "statechange"), g.busy(!1)) : g.pushState(x.data, x.title, x.url, !1), !0 }), g.emulated.pushState && g.getHash() && !g.emulated.hashChange && g.Adapter.onDomLoad(function () { g.Adapter.trigger(f, "hashchange") }) }, typeof g.init != "undefined" && g.init() }(window), function (y, D) { var k = y.console || D, b = y.document, v = y.navigator, E = !1, j = y.setTimeout, C = y.clearTimeout, B = y.setInterval, x = y.clearInterval, q = y.JSON, A = y.alert, w = y.History = y.History || {}, g = y.history; try { E = y.sessionStorage, E.setItem("TEST", "1"), E.removeItem("TEST") } catch (z) { E = !1 } q.stringify = q.stringify || q.encode, q.parse = q.parse || q.decode; if (typeof w.init != "undefined") { throw new Error("History.js Core has already been loaded...") } w.init = function (a) { return typeof w.Adapter == "undefined" ? !1 : (typeof w.initCore != "undefined" && w.initCore(), typeof w.initHtml4 != "undefined" && w.initHtml4(), !0) }, w.initCore = function (e) { if (typeof w.initCore.initialized != "undefined") { return !1 } w.initCore.initialized = !0, w.options = w.options || {}, w.options.hashChangeInterval = w.options.hashChangeInterval || 100, w.options.safariPollInterval = w.options.safariPollInterval || 500, w.options.doubleCheckInterval = w.options.doubleCheckInterval || 500, w.options.disableSuid = w.options.disableSuid || !1, w.options.storeInterval = w.options.storeInterval || 1000, w.options.busyDelay = w.options.busyDelay || 250, w.options.debug = w.options.debug || !1, w.options.initialTitle = w.options.initialTitle || b.title, w.options.html4Mode = w.options.html4Mode || !1, w.options.delayInit = w.options.delayInit || !1, w.intervalList = [], w.clearAllIntervals = function () { var f, d = w.intervalList; if (typeof d != "undefined" && d !== null) { for (f = 0; f < d.length; f++) { x(d[f]) } w.intervalList = null } }, w.debug = function () { (w.options.debug || !1) && w.log.apply(w, arguments) }, w.log = function () { var F = typeof k != "undefined" && typeof k.log != "undefined" && typeof k.log.apply != "undefined", n = b.getElementById("log"), l, p, G, h, d; F ? (h = Array.prototype.slice.call(arguments), l = h.shift(), typeof k.debug != "undefined" ? k.debug.apply(k, [l, h]) : k.log.apply(k, [l, h])) : l = "\n" + arguments[0] + "\n"; for (p = 1, G = arguments.length; p < G; ++p) { d = arguments[p]; if (typeof d == "object" && typeof q != "undefined") { try { d = q.stringify(d) } catch (r) { } } l += "\n" + d + "\n" } return n ? (n.value += l + "\n-----\n", n.scrollTop = n.scrollHeight - n.clientHeight) : F || A(l), !0 }, w.getInternetExplorerMajorVersion = function () { var d = w.getInternetExplorerMajorVersion.cached = typeof w.getInternetExplorerMajorVersion.cached != "undefined" ? w.getInternetExplorerMajorVersion.cached : function () { var h = 3, f = b.createElement("div"), l = f.getElementsByTagName("i"); while ((f.innerHTML = "<!--[if gt IE " + ++h + "]><i></i><![endif]-->") && l[0]) { } return h > 4 ? h : !1 }(); return d }, w.isInternetExplorer = function () { var d = w.isInternetExplorer.cached = typeof w.isInternetExplorer.cached != "undefined" ? w.isInternetExplorer.cached : Boolean(w.getInternetExplorerMajorVersion()); return d }, w.options.html4Mode ? w.emulated = { pushState: !0, hashChange: !0 } : w.emulated = { pushState: !Boolean(y.history && y.history.pushState && y.history.replaceState && !/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(v.userAgent) && !/AppleWebKit\/5([0-2]|3[0-2])/i.test(v.userAgent)), hashChange: Boolean(!("onhashchange" in y || "onhashchange" in b) || w.isInternetExplorer() && w.getInternetExplorerMajorVersion() < 8) }, w.enabled = !w.emulated.pushState, w.bugs = { setHash: Boolean(!w.emulated.pushState && v.vendor === "Apple Computer, Inc." && /AppleWebKit\/5([0-2]|3[0-3])/.test(v.userAgent)), safariPoll: Boolean(!w.emulated.pushState && v.vendor === "Apple Computer, Inc." && /AppleWebKit\/5([0-2]|3[0-3])/.test(v.userAgent)), ieDoubleCheck: Boolean(w.isInternetExplorer() && w.getInternetExplorerMajorVersion() < 8), hashEscape: Boolean(w.isInternetExplorer() && w.getInternetExplorerMajorVersion() < 7) }, w.isEmptyObject = function (f) { for (var d in f) { if (f.hasOwnProperty(d)) { return !1 } } return !0 }, w.cloneObject = function (f) { var d, h; return f ? (d = q.stringify(f), h = q.parse(d)) : h = {}, h }, w.getRootUrl = function () { var d = b.location.protocol + "//" + (b.location.hostname || b.location.host); if (b.location.port || !1) { d += ":" + b.location.port } return d += "/", d }, w.getBaseHref = function () { var f = b.getElementsByTagName("base"), d = null, h = ""; return f.length === 1 && (d = f[0], h = d.href.replace(/[^\/]+$/, "")), h = h.replace(/\/+$/, ""), h && (h += "/"), h }, w.getBaseUrl = function () { var d = w.getBaseHref() || w.getBasePageUrl() || w.getRootUrl(); return d }, w.getPageUrl = function () { var f = w.getState(!1, !1), d = (f || {}).url || w.getLocationHref(), h; return h = d.replace(/\/+$/, "").replace(/[^\/]+$/, function (o, l, p) { return /\./.test(o) ? o : o + "/" }), h }, w.getBasePageUrl = function () { var d = w.getLocationHref().replace(/[#\?].*/, "").replace(/[^\/]+$/, function (h, f, l) { return /[^\/]$/.test(h) ? "" : h }).replace(/\/+$/, "") + "/"; return d }, w.getFullUrl = function (h, d) { var l = h, f = h.substring(0, 1); return d = typeof d == "undefined" ? !0 : d, /[a-z]+\:\/\//.test(h) || (f === "/" ? l = w.getRootUrl() + h.replace(/^\/+/, "") : f === "#" ? l = w.getPageUrl().replace(/#.*/, "") + h : f === "?" ? l = w.getPageUrl().replace(/[\?#].*/, "") + h : d ? l = w.getBaseUrl() + h.replace(/^(\.\/)+/, "") : l = w.getBasePageUrl() + h.replace(/^(\.\/)+/, "")), l.replace(/\#$/, "") }, w.getShortUrl = function (h) { var d = h, l = w.getBaseUrl(), f = w.getRootUrl(); return w.emulated.pushState && (d = d.replace(l, "")), d = d.replace(f, "/"), w.isTraditionalAnchor(d) && (d = "./" + d), d = d.replace(/^(\.\/)+/g, "./").replace(/\#$/, ""), d }, w.getLocationHref = function (d) { return d = d || b, d.URL === d.location.href ? d.location.href : d.location.href === decodeURIComponent(d.URL) ? d.URL : d.location.hash && decodeURIComponent(d.location.href.replace(/^[^#]+/, "")) === d.location.hash ? d.location.href : d.URL.indexOf("#") == -1 && d.location.href.indexOf("#") != -1 ? d.location.href : d.URL || d.location.href }, w.store = {}, w.idToState = w.idToState || {}, w.stateToId = w.stateToId || {}, w.urlToId = w.urlToId || {}, w.storedStates = w.storedStates || [], w.savedStates = w.savedStates || [], w.normalizeStore = function () { w.store.idToState = w.store.idToState || {}, w.store.urlToId = w.store.urlToId || {}, w.store.stateToId = w.store.stateToId || {} }, w.getState = function (f, d) { typeof f == "undefined" && (f = !0), typeof d == "undefined" && (d = !0); var h = w.getLastSavedState(); return !h && d && (h = w.createStateObject()), f && (h = w.cloneObject(h), h.url = h.cleanUrl || h.url), h }, w.getIdByState = function (f) { var d = w.extractId(f.url), h; if (!d) { h = w.getStateString(f); if (typeof w.stateToId[h] != "undefined") { d = w.stateToId[h] } else { if (typeof w.store.stateToId[h] != "undefined") { d = w.store.stateToId[h] } else { for (; ;) { d = (new Date).getTime() + String(Math.random()).replace(/\D/g, ""); if (typeof w.idToState[d] == "undefined" && typeof w.store.idToState[d] == "undefined") { break } } w.stateToId[h] = d, w.idToState[d] = f } } } return d }, w.normalizeState = function (f) { var d, h; if (!f || typeof f != "object") { f = {} } if (typeof f.normalized != "undefined") { return f } if (!f.data || typeof f.data != "object") { f.data = {} } return d = {}, d.normalized = !0, d.title = f.title || "", d.url = w.getFullUrl(f.url ? f.url : w.getLocationHref()), d.hash = w.getShortUrl(d.url), d.data = w.cloneObject(f.data), d.id = w.getIdByState(d), d.cleanUrl = d.url.replace(/\??\&_suid.*/, ""), d.url = d.cleanUrl, h = !w.isEmptyObject(d.data), (d.title || h) && w.options.disableSuid !== !0 && (d.hash = w.getShortUrl(d.url).replace(/\??\&_suid.*/, ""), /\?/.test(d.hash) || (d.hash += "?"), d.hash += "&_suid=" + d.id), d.hashedUrl = w.getFullUrl(d.hash), (w.emulated.pushState || w.bugs.safariPoll) && w.hasUrlDuplicate(d) && (d.url = d.hashedUrl), d }, w.createStateObject = function (h, d, l) { var f = { data: h, title: d, url: l }; return f = w.normalizeState(f), f }, w.getStateById = function (d) { d = String(d); var f = w.idToState[d] || w.store.idToState[d] || D; return f }, w.getStateString = function (h) { var d, l, f; return d = w.normalizeState(h), l = { data: d.data, title: h.title, url: h.url }, f = q.stringify(l), f }, w.getStateId = function (f) { var d, h; return d = w.normalizeState(f), h = d.id, h }, w.getHashByState = function (f) { var d, h; return d = w.normalizeState(f), h = d.hash, h }, w.extractId = function (l) { var f, o, h, d; return l.indexOf("#") != -1 ? d = l.split("#")[0] : d = l, o = /(.*)\&_suid=([0-9]+)$/.exec(d), h = o ? o[1] || l : l, f = o ? String(o[2] || "") : "", f || !1 }, w.isTraditionalAnchor = function (f) { var d = !/[\/\?\.]/.test(f); return d }, w.extractState = function (l, f) { var o = null, h, d; return f = f || !1, h = w.extractId(l), h && (o = w.getStateById(h)), o || (d = w.getFullUrl(l), h = w.getIdByUrl(d) || !1, h && (o = w.getStateById(h)), !o && f && !w.isTraditionalAnchor(l) && (o = w.createStateObject(null, null, d))), o }, w.getIdByUrl = function (d) { var f = w.urlToId[d] || w.store.urlToId[d] || D; return f }, w.getLastSavedState = function () { return w.savedStates[w.savedStates.length - 1] || D }, w.getLastStoredState = function () { return w.storedStates[w.storedStates.length - 1] || D }, w.hasUrlDuplicate = function (f) { var d = !1, h; return h = w.extractState(f.url), d = h && h.id !== f.id, d }, w.storeState = function (d) { return w.urlToId[d.url] = d.id, w.storedStates.push(w.cloneObject(d)), d }, w.isLastSavedState = function (l) { var f = !1, o, h, d; return w.savedStates.length && (o = l.id, h = w.getLastSavedState(), d = h.id, f = o === d), f }, w.saveState = function (d) { return w.isLastSavedState(d) ? !1 : (w.savedStates.push(w.cloneObject(d)), !0) }, w.getStateByIndex = function (f) { var d = null; return typeof f == "undefined" ? d = w.savedStates[w.savedStates.length - 1] : f < 0 ? d = w.savedStates[w.savedStates.length + f] : d = w.savedStates[f], d }, w.getCurrentIndex = function () { var d = null; return w.savedStates.length < 1 ? d = 0 : d = w.savedStates.length - 1, d }, w.getHash = function (f) { var d = w.getLocationHref(f), h; return h = w.getHashByUrl(d), h }, w.unescapeHash = function (f) { var d = w.normalizeHash(f); return d = decodeURIComponent(d), d }, w.normalizeHash = function (f) { var d = f.replace(/[^#]*#/, "").replace(/#.*/, ""); return d }, w.setHash = function (h, f) { var l, d; return f !== !1 && w.busy() ? (w.pushQueue({ scope: w, callback: w.setHash, args: arguments, queue: f }), !1) : (w.busy(!0), l = w.extractState(h, !0), l && !w.emulated.pushState ? w.pushState(l.data, l.title, l.url, !1) : w.getHash() !== h && (w.bugs.setHash ? (d = w.getPageUrl(), w.pushState(null, null, d + "#" + h, !1)) : b.location.hash = h), w) }, w.escapeHash = function (d) { var f = w.normalizeHash(d); return f = y.encodeURIComponent(f), w.bugs.hashEscape || (f = f.replace(/\%21/g, "!").replace(/\%26/g, "&").replace(/\%3D/g, "=").replace(/\%3F/g, "?")), f }, w.getHashByUrl = function (f) { var d = String(f).replace(/([^#]*)#?([^#]*)#?(.*)/, "$2"); return d = w.unescapeHash(d), d }, w.setTitle = function (h) { var f = h.title, l; f || (l = w.getStateByIndex(0), l && l.url === h.url && (f = l.title || w.options.initialTitle)); try { b.getElementsByTagName("title")[0].innerHTML = f.replace("<", "&lt;").replace(">", "&gt;").replace(" & ", " &amp; ") } catch (d) { } return b.title = f, w }, w.queues = [], w.busy = function (f) { typeof f != "undefined" ? w.busy.flag = f : typeof w.busy.flag == "undefined" && (w.busy.flag = !1); if (!w.busy.flag) { C(w.busy.timeout); var d = function () { var l, o, h; if (w.busy.flag) { return } for (l = w.queues.length - 1; l >= 0; --l) { o = w.queues[l]; if (o.length === 0) { continue } h = o.shift(), w.fireQueueItem(h), w.busy.timeout = j(d, w.options.busyDelay) } }; w.busy.timeout = j(d, w.options.busyDelay) } return w.busy.flag }, w.busy.flag = !1, w.fireQueueItem = function (d) { return d.callback.apply(d.scope || w, d.args || []) }, w.pushQueue = function (d) { return w.queues[d.queue || 0] = w.queues[d.queue || 0] || [], w.queues[d.queue || 0].push(d), w }, w.queue = function (f, d) { return typeof f == "function" && (f = { callback: f }), typeof d != "undefined" && (f.queue = d), w.busy() ? w.pushQueue(f) : w.fireQueueItem(f), w }, w.clearQueue = function () { return w.busy.flag = !1, w.queues = [], w }, w.stateChanged = !1, w.doubleChecker = !1, w.doubleCheckComplete = function () { return w.stateChanged = !0, w.doubleCheckClear(), w }, w.doubleCheckClear = function () { return w.doubleChecker && (C(w.doubleChecker), w.doubleChecker = !1), w }, w.doubleCheck = function (d) { return w.stateChanged = !1, w.doubleCheckClear(), w.bugs.ieDoubleCheck && (w.doubleChecker = j(function () { return w.doubleCheckClear(), w.stateChanged || d(), !0 }, w.options.doubleCheckInterval)), w }, w.safariStatePoll = function () { var d = w.extractState(w.getLocationHref()), f; if (!w.isLastSavedState(d)) { return f = d, f || (f = w.createStateObject()), w.Adapter.trigger(y, "popstate"), w } return }, w.back = function (d) { return d !== !1 && w.busy() ? (w.pushQueue({ scope: w, callback: w.back, args: arguments, queue: d }), !1) : (w.busy(!0), w.doubleCheck(function () { w.back(!1) }), g.go(-1), !0) }, w.forward = function (d) { return d !== !1 && w.busy() ? (w.pushQueue({ scope: w, callback: w.forward, args: arguments, queue: d }), !1) : (w.busy(!0), w.doubleCheck(function () { w.forward(!1) }), g.go(1), !0) }, w.go = function (f, d) { var h; if (f > 0) { for (h = 1; h <= f; ++h) { w.forward(d) } } else { if (!(f < 0)) { throw new Error("History.go: History.go requires a positive or negative integer passed.") } for (h = -1; h >= f; --h) { w.back(d) } } return w }; if (w.emulated.pushState) { var c = function () { }; w.pushState = w.pushState || c, w.replaceState = w.replaceState || c } else { w.onPopState = function (f, u) { var l = !1, d = !1, h, p; return w.doubleCheckComplete(), h = w.getHash(), h ? (p = w.extractState(h || w.getLocationHref(), !0), p ? w.replaceState(p.data, p.title, p.url, !1) : (w.Adapter.trigger(y, "anchorchange"), w.busy(!1)), w.expectedStateId = !1, !1) : (l = w.Adapter.extractEventData("state", f, u) || !1, l ? d = w.getStateById(l) : w.expectedStateId ? d = w.getStateById(w.expectedStateId) : d = w.extractState(w.getLocationHref()), d || (d = w.createStateObject(null, null, w.getLocationHref())), w.expectedStateId = !1, w.isLastSavedState(d) ? (w.busy(!1), !1) : (w.storeState(d), w.saveState(d), w.setTitle(d), w.Adapter.trigger(y, "statechange"), w.busy(!1), !0)) }, w.Adapter.bind(y, "popstate", w.onPopState), w.pushState = function (f, o, l, d) { if (w.getHashByUrl(l) && w.emulated.pushState) { throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).") } if (d !== !1 && w.busy()) { return w.pushQueue({ scope: w, callback: w.pushState, args: arguments, queue: d }), !1 } w.busy(!0); var h = w.createStateObject(f, o, l); return w.isLastSavedState(h) ? w.busy(!1) : (w.storeState(h), w.expectedStateId = h.id, g.pushState(h.id, h.title, h.url), w.Adapter.trigger(y, "popstate")), !0 }, w.replaceState = function (f, o, l, d) { if (w.getHashByUrl(l) && w.emulated.pushState) { throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).") } if (d !== !1 && w.busy()) { return w.pushQueue({ scope: w, callback: w.replaceState, args: arguments, queue: d }), !1 } w.busy(!0); var h = w.createStateObject(f, o, l); return w.isLastSavedState(h) ? w.busy(!1) : (w.storeState(h), w.expectedStateId = h.id, g.replaceState(h.id, h.title, h.url), w.Adapter.trigger(y, "popstate")), !0 } } if (E) { try { w.store = q.parse(E.getItem("History.store")) || {} } catch (a) { w.store = {} } w.normalizeStore() } else { w.store = {}, w.normalizeStore() } w.Adapter.bind(y, "unload", w.clearAllIntervals), w.saveState(w.storeState(w.extractState(w.getLocationHref(), !0))), E && (w.onUnload = function () { var l, f, o; try { l = q.parse(E.getItem("History.store")) || {} } catch (h) { l = {} } l.idToState = l.idToState || {}, l.urlToId = l.urlToId || {}, l.stateToId = l.stateToId || {}; for (f in w.idToState) { if (!w.idToState.hasOwnProperty(f)) { continue } l.idToState[f] = w.idToState[f] } for (f in w.urlToId) { if (!w.urlToId.hasOwnProperty(f)) { continue } l.urlToId[f] = w.urlToId[f] } for (f in w.stateToId) { if (!w.stateToId.hasOwnProperty(f)) { continue } l.stateToId[f] = w.stateToId[f] } w.store = l, w.normalizeStore(), o = q.stringify(l); try { E.setItem("History.store", o) } catch (d) { if (d.code !== DOMException.QUOTA_EXCEEDED_ERR) { throw d } E.length && (E.removeItem("History.store"), E.setItem("History.store", o)) } }, w.intervalList.push(B(w.onUnload, w.options.storeInterval)), w.Adapter.bind(y, "beforeunload", w.onUnload), w.Adapter.bind(y, "unload", w.onUnload)); if (!w.emulated.pushState) { w.bugs.safariPoll && w.intervalList.push(B(w.safariStatePoll, w.options.safariPollInterval)); if (v.vendor === "Apple Computer, Inc." || (v.appCodeName || "") === "Mozilla") { w.Adapter.bind(y, "hashchange", function () { w.Adapter.trigger(y, "popstate") }), w.getHash() && w.Adapter.onDomLoad(function () { w.Adapter.trigger(y, "hashchange") }) } } }, (!w.options || !w.options.delayInit) && w.init() }(window); (function (a) { if (typeof define === "function" && define.amd) { define(a) } else { window.purl = a() } })(function () { var h = { a: "href", img: "src", form: "action", base: "href", script: "src", iframe: "src", link: "href", embed: "src", object: "data" }, p = ["source", "protocol", "authority", "userInfo", "user", "password", "host", "port", "relative", "path", "directory", "file", "query", "fragment"], c = { anchor: "fragment" }, a = { strict: /^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/, loose: /^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*):?([^:@]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/ }, f = /^[0-9]+$/; function e(t, w) { var y = decodeURI(t), v = a[w || false ? "strict" : "loose"].exec(y), x = { attr: {}, param: {}, seg: {} }, u = 14; while (u--) { x.attr[p[u]] = v[u] || "" } x.param.query = j(x.attr.query); x.param.fragment = j(x.attr.fragment); x.seg.path = x.attr.path.replace(/^\/+|\/+$/g, "").split("/"); x.seg.fragment = x.attr.fragment.replace(/^\/+|\/+$/g, "").split("/"); x.attr.base = x.attr.host ? (x.attr.protocol ? x.attr.protocol + "://" + x.attr.host : x.attr.host) + (x.attr.port ? ":" + x.attr.port : "") : ""; return x } function b(u) { var t = u.tagName; if (typeof t !== "undefined") { return h[t.toLowerCase()] } return t } function s(x, w) { if (x[w].length === 0) { return x[w] = {} } var v = {}; for (var u in x[w]) { v[u] = x[w][u] } x[w] = v; return v } function d(x, v, u, y) { var t = x.shift(); if (!t) { if (g(v[u])) { v[u].push(y) } else { if ("object" == typeof v[u]) { v[u] = y } else { if ("undefined" == typeof v[u]) { v[u] = y } else { v[u] = [v[u], y] } } } } else { var w = v[u] = v[u] || []; if ("]" == t) { if (g(w)) { if ("" !== y) { w.push(y) } } else { if ("object" == typeof w) { w[r(w).length] = y } else { w = v[u] = [v[u], y] } } } else { if (~t.indexOf("]")) { t = t.substr(0, t.length - 1); if (!f.test(t) && g(w)) { w = s(v, u) } d(x, w, t, y) } else { if (!f.test(t) && g(w)) { w = s(v, u) } d(x, w, t, y) } } } } function l(x, w, z) { if (~w.indexOf("]")) { var y = w.split("["); d(y, x, "base", z) } else { if (!f.test(w) && g(x.base)) { var v = {}; for (var u in x.base) { v[u] = x.base[u] } x.base = v } if (w !== "") { n(x.base, w, z) } } return x } function j(t) { return k(String(t).split(/&|;/), function (u, z) { try { z = decodeURIComponent(z.replace(/\+/g, " ")) } catch (w) { } var A = z.indexOf("="), y = q(z), v = z.substr(0, y || A), x = z.substr(y || A, z.length); x = x.substr(x.indexOf("=") + 1, x.length); if (v === "") { v = z; x = "" } return l(u, v, x) }, { base: {} }).base } function n(w, u, x) { var t = w[u]; if (typeof t === "undefined") { w[u] = x } else { if (g(t)) { t.push(x) } else { w[u] = [t, x] } } } function q(w) { var t = w.length, v, x; for (var u = 0; u < t; ++u) { x = w[u]; if ("]" == x) { v = false } if ("[" == x) { v = true } if ("=" == x && !v) { return u } } } function k(x, u) { var v = 0, t = x.length >> 0, w = arguments[2]; while (v < t) { if (v in x) { w = u.call(undefined, w, x[v], v, x) } ++v } return w } function g(t) { return Object.prototype.toString.call(t) === "[object Array]" } function r(u) { var t = []; for (var v in u) { if (u.hasOwnProperty(v)) { t.push(v) } } return t } function o(t, u) { if (arguments.length === 1 && t === true) { u = true; t = undefined } u = u || false; t = t || window.location.toString(); return { data: e(t, u), attr: function (v) { v = c[v] || v; return typeof v !== "undefined" ? this.data.attr[v] : this.data.attr }, param: function (v) { return typeof v !== "undefined" ? this.data.param.query[v] : this.data.param.query }, fparam: function (v) { return typeof v !== "undefined" ? this.data.param.fragment[v] : this.data.param.fragment }, segment: function (v) { if (typeof v === "undefined") { return this.data.seg.path } else { v = v < 0 ? this.data.seg.path.length + v : v - 1; return this.data.seg.path[v] } }, fsegment: function (v) { if (typeof v === "undefined") { return this.data.seg.fragment } else { v = v < 0 ? this.data.seg.fragment.length + v : v - 1; return this.data.seg.fragment[v] } } } } o.jQuery = function (t) { if (t != null) { t.fn.url = function (v) { var u = ""; if (this.length) { u = t(this).attr(b(this[0])) || "" } return o(u, v) }; t.url = o } }; o.jQuery(window.jQuery); return o }); (function () { var Faye = { VERSION: "1.0.0", BAYEUX_VERSION: "1.0", ID_LENGTH: 160, JSONP_CALLBACK: "jsonpcallback", CONNECTION_TYPES: ["long-polling", "cross-origin-long-polling", "callback-polling", "websocket", "eventsource", "in-process"], MANDATORY_CONNECTION_TYPES: ["long-polling", "callback-polling", "in-process"], ENV: (typeof window !== "undefined") ? window : global, extend: function (dest, source, overwrite) { if (!source) { return dest } for (var key in source) { if (!source.hasOwnProperty(key)) { continue } if (dest.hasOwnProperty(key) && overwrite === false) { continue } if (dest[key] !== source[key]) { dest[key] = source[key] } } return dest }, random: function (bitlength) { bitlength = bitlength || this.ID_LENGTH; return csprng(bitlength, 36) }, clientIdFromMessages: function (messages) { var connect = this.filter([].concat(messages), function (message) { return message.channel === "/meta/connect" }); return connect[0] && connect[0].clientId }, copyObject: function (object) { var clone, i, key; if (object instanceof Array) { clone = []; i = object.length; while (i--) { clone[i] = Faye.copyObject(object[i]) } return clone } else { if (typeof object === "object") { clone = (object === null) ? null : {}; for (key in object) { clone[key] = Faye.copyObject(object[key]) } return clone } else { return object } } }, commonElement: function (lista, listb) { for (var i = 0, n = lista.length; i < n; i++) { if (this.indexOf(listb, lista[i]) !== -1) { return lista[i] } } return null }, indexOf: function (list, needle) { if (list.indexOf) { return list.indexOf(needle) } for (var i = 0, n = list.length; i < n; i++) { if (list[i] === needle) { return i } } return -1 }, map: function (object, callback, context) { if (object.map) { return object.map(callback, context) } var result = []; if (object instanceof Array) { for (var i = 0, n = object.length; i < n; i++) { result.push(callback.call(context || null, object[i], i)) } } else { for (var key in object) { if (!object.hasOwnProperty(key)) { continue } result.push(callback.call(context || null, key, object[key])) } } return result }, filter: function (array, callback, context) { if (array.filter) { return array.filter(callback, context) } var result = []; for (var i = 0, n = array.length; i < n; i++) { if (callback.call(context || null, array[i], i)) { result.push(array[i]) } } return result }, asyncEach: function (list, iterator, callback, context) { var n = list.length, i = -1, calls = 0, looping = false; var iterate = function () { calls -= 1; i += 1; if (i === n) { return callback && callback.call(context) } iterator(list[i], resume) }; var loop = function () { if (looping) { return } looping = true; while (calls > 0) { iterate() } looping = false }; var resume = function () { calls += 1; loop() }; resume() }, toJSON: function (object) { if (!this.stringify) { return JSON.stringify(object) } return this.stringify(object, function (key, value) { return (this[key] instanceof Array) ? this[key] : value }) } }; if (typeof module !== "undefined") { module.exports = Faye } else { if (typeof window !== "undefined") { window.Faye = Faye } } Faye.Class = function (parent, methods) { if (typeof parent !== "function") { methods = parent; parent = Object } var klass = function () { if (!this.initialize) { return this } return this.initialize.apply(this, arguments) || this }; var bridge = function () { }; bridge.prototype = parent.prototype; klass.prototype = new bridge(); Faye.extend(klass.prototype, methods); return klass }; (function () { var EventEmitter = Faye.EventEmitter = function () { }; var isArray = typeof Array.isArray === "function" ? Array.isArray : function (xs) { return Object.prototype.toString.call(xs) === "[object Array]" }; function indexOf(xs, x) { if (xs.indexOf) { return xs.indexOf(x) } for (var i = 0; i < xs.length; i++) { if (x === xs[i]) { return i } } return -1 } EventEmitter.prototype.emit = function (type) { if (type === "error") { if (!this._events || !this._events.error || (isArray(this._events.error) && !this._events.error.length)) { if (arguments[1] instanceof Error) { throw arguments[1] } else { throw new Error("Uncaught, unspecified 'error' event.") } return false } } if (!this._events) { return false } var handler = this._events[type]; if (!handler) { return false } if (typeof handler == "function") { switch (arguments.length) { case 1: handler.call(this); break; case 2: handler.call(this, arguments[1]); break; case 3: handler.call(this, arguments[1], arguments[2]); break; default: var args = Array.prototype.slice.call(arguments, 1); handler.apply(this, args) }return true } else { if (isArray(handler)) { var args = Array.prototype.slice.call(arguments, 1); var listeners = handler.slice(); for (var i = 0, l = listeners.length; i < l; i++) { listeners[i].apply(this, args) } return true } else { return false } } }; EventEmitter.prototype.addListener = function (type, listener) { if ("function" !== typeof listener) { throw new Error("addListener only takes instances of Function") } if (!this._events) { this._events = {} } this.emit("newListener", type, listener); if (!this._events[type]) { this._events[type] = listener } else { if (isArray(this._events[type])) { this._events[type].push(listener) } else { this._events[type] = [this._events[type], listener] } } return this }; EventEmitter.prototype.on = EventEmitter.prototype.addListener; EventEmitter.prototype.once = function (type, listener) { var self = this; self.on(type, function g() { self.removeListener(type, g); listener.apply(this, arguments) }); return this }; EventEmitter.prototype.removeListener = function (type, listener) { if ("function" !== typeof listener) { throw new Error("removeListener only takes instances of Function") } if (!this._events || !this._events[type]) { return this } var list = this._events[type]; if (isArray(list)) { var i = indexOf(list, listener); if (i < 0) { return this } list.splice(i, 1); if (list.length == 0) { delete this._events[type] } } else { if (this._events[type] === listener) { delete this._events[type] } } return this }; EventEmitter.prototype.removeAllListeners = function (type) { if (arguments.length === 0) { this._events = {}; return this } if (type && this._events && this._events[type]) { this._events[type] = null } return this }; EventEmitter.prototype.listeners = function (type) { if (!this._events) { this._events = {} } if (!this._events[type]) { this._events[type] = [] } if (!isArray(this._events[type])) { this._events[type] = [this._events[type]] } return this._events[type] } })(); Faye.Namespace = Faye.Class({ initialize: function () { this._used = {} }, exists: function (id) { return this._used.hasOwnProperty(id) }, generate: function () { var name = Faye.random(); while (this._used.hasOwnProperty(name)) { name = Faye.random() } return this._used[name] = name }, release: function (id) { delete this._used[id] } }); (function () { var timeout = setTimeout; var defer; if (typeof setImmediate === "function") { defer = function (fn) { setImmediate(fn) } } else { if (typeof process === "object" && process.nextTick) { defer = function (fn) { process.nextTick(fn) } } else { defer = function (fn) { timeout(fn, 0) } } } var PENDING = 0, FULFILLED = 1, REJECTED = 2; var FORWARD = function (x) { return x }, BREAK = function (x) { throw x }; var Promise = function (task) { this._state = PENDING; this._callbacks = []; this._errbacks = []; if (typeof task !== "function") { return } var self = this; task(function (value) { fulfill(self, value) }, function (reason) { reject(self, reason) }) }; Promise.prototype.then = function (callback, errback) { var self = this; return new Promise(function (fulfill, reject) { var next = { fulfill: fulfill, reject: reject }; registerCallback(self, callback, next); registerErrback(self, errback, next) }) }; var registerCallback = function (promise, callback, next) { if (typeof callback !== "function") { callback = FORWARD } var handler = function (value) { invoke(callback, value, next) }; if (promise._state === PENDING) { promise._callbacks.push(handler) } else { if (promise._state === FULFILLED) { defer(function () { handler(promise._value) }) } } }; var registerErrback = function (promise, errback, next) { if (typeof errback !== "function") { errback = BREAK } var handler = function (reason) { invoke(errback, reason, next) }; if (promise._state === PENDING) { promise._errbacks.push(handler) } else { if (promise._state === REJECTED) { defer(function () { handler(promise._reason) }) } } }; var invoke = function (fn, value, next) { try { var outcome = fn(value); if (outcome && typeof outcome.then === "function") { outcome.then(next.fulfill, next.reject) } else { next.fulfill(outcome) } } catch (error) { next.reject(error) } }; var fulfill = Promise.fulfill = function (promise, value) { if (promise._state !== PENDING) { return } promise._state = FULFILLED; promise._value = value; promise._errbacks = []; var callbacks = promise._callbacks, cb; while (cb = callbacks.shift()) { cb(value) } }; var reject = Promise.reject = function (promise, reason) { if (promise._state !== PENDING) { return } promise._state = REJECTED; promise._reason = reason; promise._callbacks = []; var errbacks = promise._errbacks, eb; while (eb = errbacks.shift()) { eb(reason) } }; Promise.defer = defer; Promise.pending = function () { var tuple = {}; tuple.promise = new Promise(function (fulfill, reject) { tuple.fulfill = fulfill; tuple.reject = reject }); return tuple }; Promise.fulfilled = function (value) { return new Promise(function (fulfill, reject) { fulfill(value) }) }; Promise.rejected = function (reason) { return new Promise(function (fulfill, reject) { reject(reason) }) }; if (typeof Faye === "undefined") { module.exports = Promise } else { Faye.Promise = Promise } })(); Faye.Set = Faye.Class({ initialize: function () { this._index = {} }, add: function (item) { var key = (item.id !== undefined) ? item.id : item; if (this._index.hasOwnProperty(key)) { return false } this._index[key] = item; return true }, forEach: function (block, context) { for (var key in this._index) { if (this._index.hasOwnProperty(key)) { block.call(context, this._index[key]) } } }, isEmpty: function () { for (var key in this._index) { if (this._index.hasOwnProperty(key)) { return false } } return true }, member: function (item) { for (var key in this._index) { if (this._index[key] === item) { return true } } return false }, remove: function (item) { var key = (item.id !== undefined) ? item.id : item; var removed = this._index[key]; delete this._index[key]; return removed }, toArray: function () { var array = []; this.forEach(function (item) { array.push(item) }); return array } }); Faye.URI = { isURI: function (uri) { return uri && uri.protocol && uri.host && uri.path }, isSameOrigin: function (uri) { var location = Faye.ENV.location; return uri.protocol === location.protocol && uri.hostname === location.hostname && uri.port === location.port }, parse: function (url) { if (typeof url !== "string") { return url } var uri = {}, parts, query, pairs, i, n, data; var consume = function (name, pattern) { url = url.replace(pattern, function (match) { uri[name] = match; return "" }); uri[name] = uri[name] || "" }; consume("protocol", /^[a-z]+\:/i); consume("host", /^\/\/[^\/\?#]+/); if (!/^\//.test(url) && !uri.host) { url = Faye.ENV.location.pathname.replace(/[^\/]*$/, "") + url } consume("pathname", /^[^\?#]*/); consume("search", /^\?[^#]*/); consume("hash", /^#.*/); uri.protocol = uri.protocol || Faye.ENV.location.protocol; if (uri.host) { uri.host = uri.host.substr(2); parts = uri.host.split(":"); uri.hostname = parts[0]; uri.port = parts[1] || "" } else { uri.host = Faye.ENV.location.host; uri.hostname = Faye.ENV.location.hostname; uri.port = Faye.ENV.location.port } uri.pathname = uri.pathname || "/"; uri.path = uri.pathname + uri.search; query = uri.search.replace(/^\?/, ""); pairs = query ? query.split("&") : []; data = {}; for (i = 0, n = pairs.length; i < n; i++) { parts = pairs[i].split("="); data[decodeURIComponent(parts[0] || "")] = decodeURIComponent(parts[1] || "") } uri.query = data; uri.href = this.stringify(uri); return uri }, stringify: function (uri) { var string = uri.protocol + "//" + uri.hostname; if (uri.port) { string += ":" + uri.port } string += uri.pathname + this.queryString(uri.query) + (uri.hash || ""); return string }, queryString: function (query) { var pairs = []; for (var key in query) { if (!query.hasOwnProperty(key)) { continue } pairs.push(encodeURIComponent(key) + "=" + encodeURIComponent(query[key])) } if (pairs.length === 0) { return "" } return "?" + pairs.join("&") } }; Faye.Error = Faye.Class({ initialize: function (code, params, message) { this.code = code; this.params = Array.prototype.slice.call(params); this.message = message }, toString: function () { return this.code + ":" + this.params.join(",") + ":" + this.message } }); Faye.Error.parse = function (message) { message = message || ""; if (!Faye.Grammar.ERROR.test(message)) { return new this(null, [], message) } var parts = message.split(":"), code = parseInt(parts[0]), params = parts[1].split(","), message = parts[2]; return new this(code, params, message) }; Faye.Error.versionMismatch = function () { return new this(300, arguments, "Version mismatch").toString() }; Faye.Error.conntypeMismatch = function () { return new this(301, arguments, "Connection types not supported").toString() }; Faye.Error.extMismatch = function () { return new this(302, arguments, "Extension mismatch").toString() }; Faye.Error.badRequest = function () { return new this(400, arguments, "Bad request").toString() }; Faye.Error.clientUnknown = function () { return new this(401, arguments, "Unknown client").toString() }; Faye.Error.parameterMissing = function () { return new this(402, arguments, "Missing required parameter").toString() }; Faye.Error.channelForbidden = function () { return new this(403, arguments, "Forbidden channel").toString() }; Faye.Error.channelUnknown = function () { return new this(404, arguments, "Unknown channel").toString() }; Faye.Error.channelInvalid = function () { return new this(405, arguments, "Invalid channel").toString() }; Faye.Error.extUnknown = function () { return new this(406, arguments, "Unknown extension").toString() }; Faye.Error.publishFailed = function () { return new this(407, arguments, "Failed to publish").toString() }; Faye.Error.serverError = function () { return new this(500, arguments, "Internal server error").toString() }; Faye.Deferrable = { then: function (callback, errback) { var self = this; if (!this._promise) { this._promise = new Faye.Promise(function (fulfill, reject) { self._fulfill = fulfill; self._reject = reject }) } if (arguments.length === 0) { return this._promise } else { return this._promise.then(callback, errback) } }, callback: function (callback, context) { return this.then(function (value) { callback.call(context, value) }) }, errback: function (callback, context) { return this.then(null, function (reason) { callback.call(context, reason) }) }, timeout: function (seconds, message) { this.then(); var self = this; this._timer = Faye.ENV.setTimeout(function () { self._reject(message) }, seconds * 1000) }, setDeferredStatus: function (status, value) { if (this._timer) { Faye.ENV.clearTimeout(this._timer) } var promise = this.then(); if (status === "succeeded") { this._fulfill(value) } else { if (status === "failed") { this._reject(value) } else { delete this._promise } } } }; Faye.Publisher = { countListeners: function (eventType) { return this.listeners(eventType).length }, bind: function (eventType, listener, context) { var slice = Array.prototype.slice, handler = function () { listener.apply(context, slice.call(arguments)) }; this._listeners = this._listeners || []; this._listeners.push([eventType, listener, context, handler]); return this.on(eventType, handler) }, unbind: function (eventType, listener, context) { this._listeners = this._listeners || []; var n = this._listeners.length, tuple; while (n--) { tuple = this._listeners[n]; if (tuple[0] !== eventType) { continue } if (listener && (tuple[1] !== listener || tuple[2] !== context)) { continue } this._listeners.splice(n, 1); this.removeListener(eventType, tuple[3]) } } }; Faye.extend(Faye.Publisher, Faye.EventEmitter.prototype); Faye.Publisher.trigger = Faye.Publisher.emit; Faye.Timeouts = { addTimeout: function (name, delay, callback, context) { this._timeouts = this._timeouts || {}; if (this._timeouts.hasOwnProperty(name)) { return } var self = this; this._timeouts[name] = Faye.ENV.setTimeout(function () { delete self._timeouts[name]; callback.call(context) }, 1000 * delay) }, removeTimeout: function (name) { this._timeouts = this._timeouts || {}; var timeout = this._timeouts[name]; if (!timeout) { return } clearTimeout(timeout); delete this._timeouts[name] } }; Faye.Logging = { LOG_LEVELS: { fatal: 4, error: 3, warn: 2, info: 1, debug: 0 }, writeLog: function (messageArgs, level) { if (!Faye.logger) { return } var messageArgs = Array.prototype.slice.apply(messageArgs), banner = "[Faye", klass = this.className, message = messageArgs.shift().replace(/\?/g, function () { try { return Faye.toJSON(messageArgs.shift()) } catch (e) { return "[Object]" } }); for (var key in Faye) { if (klass) { continue } if (typeof Faye[key] !== "function") { continue } if (this instanceof Faye[key]) { klass = key } } if (klass) { banner += "." + klass } banner += "] "; if (typeof Faye.logger[level] === "function") { Faye.logger[level](banner + message) } else { if (typeof Faye.logger === "function") { Faye.logger(banner + message) } } } }; (function () { for (var key in Faye.Logging.LOG_LEVELS) { (function (level, value) { Faye.Logging[level] = function () { this.writeLog(arguments, level) } })(key, Faye.Logging.LOG_LEVELS[key]) } })(); Faye.Grammar = { CHANNEL_NAME: /^\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*$/, CHANNEL_PATTERN: /^(\/(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)))+)*\/\*{1,2}$/, ERROR: /^([0-9][0-9][0-9]:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*(,(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)*:(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*|[0-9][0-9][0-9]::(((([a-z]|[A-Z])|[0-9])|(\-|\_|\!|\~|\(|\)|\$|\@)| |\/|\*|\.))*)$/, VERSION: /^([0-9])+(\.(([a-z]|[A-Z])|[0-9])(((([a-z]|[A-Z])|[0-9])|\-|\_))*)*$/ }; Faye.Extensible = { addExtension: function (extension) { this._extensions = this._extensions || []; this._extensions.push(extension); if (extension.added) { extension.added(this) } }, removeExtension: function (extension) { if (!this._extensions) { return } var i = this._extensions.length; while (i--) { if (this._extensions[i] !== extension) { continue } this._extensions.splice(i, 1); if (extension.removed) { extension.removed(this) } } }, pipeThroughExtensions: function (stage, message, request, callback, context) { this.debug("Passing through ? extensions: ?", stage, message); if (!this._extensions) { return callback.call(context, message) } var extensions = this._extensions.slice(); var pipe = function (message) { if (!message) { return callback.call(context, message) } var extension = extensions.shift(); if (!extension) { return callback.call(context, message) } var fn = extension[stage]; if (!fn) { return pipe(message) } if (fn.length >= 3) { extension[stage](message, request, pipe) } else { extension[stage](message, pipe) } }; pipe(message) } }; Faye.extend(Faye.Extensible, Faye.Logging); Faye.Channel = Faye.Class({ initialize: function (name) { this.id = this.name = name }, push: function (message) { this.trigger("message", message) }, isUnused: function () { return this.countListeners("message") === 0 } }); Faye.extend(Faye.Channel.prototype, Faye.Publisher); Faye.extend(Faye.Channel, { HANDSHAKE: "/meta/handshake", CONNECT: "/meta/connect", SUBSCRIBE: "/meta/subscribe", UNSUBSCRIBE: "/meta/unsubscribe", DISCONNECT: "/meta/disconnect", META: "meta", SERVICE: "service", expand: function (name) { var segments = this.parse(name), channels = ["/**", name]; var copy = segments.slice(); copy[copy.length - 1] = "*"; channels.push(this.unparse(copy)); for (var i = 1, n = segments.length; i < n; i++) { copy = segments.slice(0, i); copy.push("**"); channels.push(this.unparse(copy)) } return channels }, isValid: function (name) { return Faye.Grammar.CHANNEL_NAME.test(name) || Faye.Grammar.CHANNEL_PATTERN.test(name) }, parse: function (name) { if (!this.isValid(name)) { return null } return name.split("/").slice(1) }, unparse: function (segments) { return "/" + segments.join("/") }, isMeta: function (name) { var segments = this.parse(name); return segments ? (segments[0] === this.META) : null }, isService: function (name) { var segments = this.parse(name); return segments ? (segments[0] === this.SERVICE) : null }, isSubscribable: function (name) { if (!this.isValid(name)) { return null } return !this.isMeta(name) && !this.isService(name) }, Set: Faye.Class({ initialize: function () { this._channels = {} }, getKeys: function () { var keys = []; for (var key in this._channels) { keys.push(key) } return keys }, remove: function (name) { delete this._channels[name] }, hasSubscription: function (name) { return this._channels.hasOwnProperty(name) }, subscribe: function (names, callback, context) { if (!callback) { return } var name; for (var i = 0, n = names.length; i < n; i++) { name = names[i]; var channel = this._channels[name] = this._channels[name] || new Faye.Channel(name); channel.bind("message", callback, context) } }, unsubscribe: function (name, callback, context) { var channel = this._channels[name]; if (!channel) { return false } channel.unbind("message", callback, context); if (channel.isUnused()) { this.remove(name); return true } else { return false } }, distributeMessage: function (message) { var channels = Faye.Channel.expand(message.channel); for (var i = 0, n = channels.length; i < n; i++) { var channel = this._channels[channels[i]]; if (channel) { channel.trigger("message", message.data) } } } }) }); Faye.Envelope = Faye.Class({ initialize: function (message, timeout) { this.id = message.id; this.message = message; if (timeout !== undefined) { this.timeout(timeout / 1000, false) } } }); Faye.extend(Faye.Envelope.prototype, Faye.Deferrable); Faye.Publication = Faye.Class(Faye.Deferrable); Faye.Subscription = Faye.Class({ initialize: function (client, channels, callback, context) { this._client = client; this._channels = channels; this._callback = callback; this._context = context; this._cancelled = false }, cancel: function () { if (this._cancelled) { return } this._client.unsubscribe(this._channels, this._callback, this._context); this._cancelled = true }, unsubscribe: function () { this.cancel() } }); Faye.extend(Faye.Subscription.prototype, Faye.Deferrable); Faye.Client = Faye.Class({ UNCONNECTED: 1, CONNECTING: 2, CONNECTED: 3, DISCONNECTED: 4, HANDSHAKE: "handshake", RETRY: "retry", NONE: "none", CONNECTION_TIMEOUT: 60, DEFAULT_RETRY: 5, MAX_REQUEST_SIZE: 2048, DEFAULT_ENDPOINT: "/bayeux", INTERVAL: 0, initialize: function (endpoint, options) { this.info("New client created for ?", endpoint); this._options = options || {}; this.endpoint = Faye.URI.parse(endpoint || this.DEFAULT_ENDPOINT); this.endpoints = this._options.endpoints || {}; this.transports = {}; this.cookies = Faye.CookieJar && new Faye.CookieJar(); this.headers = {}; this.ca = this._options.ca; this._disabled = []; this._retry = this._options.retry || this.DEFAULT_RETRY; for (var key in this.endpoints) { this.endpoints[key] = Faye.URI.parse(this.endpoints[key]) } this.maxRequestSize = this.MAX_REQUEST_SIZE; this._state = this.UNCONNECTED; this._channels = new Faye.Channel.Set(); this._messageId = 0; this._responseCallbacks = {}; this._advice = { reconnect: this.RETRY, interval: 1000 * (this._options.interval || this.INTERVAL), timeout: 1000 * (this._options.timeout || this.CONNECTION_TIMEOUT) }; if (Faye.Event && Faye.ENV.onbeforeunload !== undefined) { Faye.Event.on(Faye.ENV, "beforeunload", function () { if (Faye.indexOf(this._disabled, "autodisconnect") < 0) { this.disconnect() } }, this) } }, disable: function (feature) { this._disabled.push(feature) }, setHeader: function (name, value) { this.headers[name] = value }, handshake: function (callback, context) { if (this._advice.reconnect === this.NONE) { return } if (this._state !== this.UNCONNECTED) { return } this._state = this.CONNECTING; var self = this; this.info("Initiating handshake with ?", Faye.URI.stringify(this.endpoint)); this._selectTransport(Faye.MANDATORY_CONNECTION_TYPES); this._send({ channel: Faye.Channel.HANDSHAKE, version: Faye.BAYEUX_VERSION, supportedConnectionTypes: [this._transport.connectionType] }, function (response) { if (response.successful) { this._state = this.CONNECTED; this._clientId = response.clientId; this._selectTransport(response.supportedConnectionTypes); this.info("Handshake successful: ?", this._clientId); this.subscribe(this._channels.getKeys(), true); if (callback) { Faye.Promise.defer(function () { callback.call(context) }) } } else { this.info("Handshake unsuccessful"); Faye.ENV.setTimeout(function () { self.handshake(callback, context) }, this._advice.interval); this._state = this.UNCONNECTED } }, this) }, connect: function (callback, context) { if (this._advice.reconnect === this.NONE) { return } if (this._state === this.DISCONNECTED) { return } if (this._state === this.UNCONNECTED) { return this.handshake(function () { this.connect(callback, context) }, this) } this.callback(callback, context); if (this._state !== this.CONNECTED) { return } this.info("Calling deferred actions for ?", this._clientId); this.setDeferredStatus("succeeded"); this.setDeferredStatus("unknown"); if (this._connectRequest) { return } this._connectRequest = true; this.info("Initiating connection for ?", this._clientId); this._send({ channel: Faye.Channel.CONNECT, clientId: this._clientId, connectionType: this._transport.connectionType }, this._cycleConnection, this) }, disconnect: function () { if (this._state !== this.CONNECTED) { return } this._state = this.DISCONNECTED; this.info("Disconnecting ?", this._clientId); this._send({ channel: Faye.Channel.DISCONNECT, clientId: this._clientId }, function (response) { if (!response.successful) { return } this._transport.close(); delete this._transport }, this); this.info("Clearing channel listeners for ?", this._clientId); this._channels = new Faye.Channel.Set() }, subscribe: function (channel, callback, context) { if (channel instanceof Array) { return Faye.map(channel, function (c) { return this.subscribe(c, callback, context) }, this) } var subscription = new Faye.Subscription(this, channel, callback, context), force = (callback === true), hasSubscribe = this._channels.hasSubscription(channel); if (hasSubscribe && !force) { this._channels.subscribe([channel], callback, context); subscription.setDeferredStatus("succeeded"); return subscription } this.connect(function () { this.info("Client ? attempting to subscribe to ?", this._clientId, channel); if (!force) { this._channels.subscribe([channel], callback, context) } this._send({ channel: Faye.Channel.SUBSCRIBE, clientId: this._clientId, subscription: channel }, function (response) { if (!response.successful) { subscription.setDeferredStatus("failed", Faye.Error.parse(response.error)); return this._channels.unsubscribe(channel, callback, context) } var channels = [].concat(response.subscription); this.info("Subscription acknowledged for ? to ?", this._clientId, channels); subscription.setDeferredStatus("succeeded") }, this) }, this); return subscription }, unsubscribe: function (channel, callback, context) { if (channel instanceof Array) { return Faye.map(channel, function (c) { return this.unsubscribe(c, callback, context) }, this) } var dead = this._channels.unsubscribe(channel, callback, context); if (!dead) { return } this.connect(function () { this.info("Client ? attempting to unsubscribe from ?", this._clientId, channel); this._send({ channel: Faye.Channel.UNSUBSCRIBE, clientId: this._clientId, subscription: channel }, function (response) { if (!response.successful) { return } var channels = [].concat(response.subscription); this.info("Unsubscription acknowledged for ? from ?", this._clientId, channels) }, this) }, this) }, publish: function (channel, data) { var publication = new Faye.Publication(); this.connect(function () { this.info("Client ? queueing published message to ?: ?", this._clientId, channel, data); this._send({ channel: channel, data: data, clientId: this._clientId }, function (response) { if (response.successful) { publication.setDeferredStatus("succeeded") } else { publication.setDeferredStatus("failed", Faye.Error.parse(response.error)) } }, this) }, this); return publication }, receiveMessage: function (message) { var id = message.id, timeout, callback; if (message.successful !== undefined) { callback = this._responseCallbacks[id]; delete this._responseCallbacks[id] } this.pipeThroughExtensions("incoming", message, null, function (message) { if (!message) { return } if (message.advice) { this._handleAdvice(message.advice) } this._deliverMessage(message); if (callback) { callback[0].call(callback[1], message) } }, this); if (this._transportUp === true) { return } this._transportUp = true; this.trigger("transport:up") }, messageError: function (messages, immediate) { var retry = this._retry, self = this, id, message, timeout; for (var i = 0, n = messages.length; i < n; i++) { message = messages[i]; id = message.id; if (immediate) { this._transportSend(message) } else { Faye.ENV.setTimeout(function () { self._transportSend(message) }, retry * 1000) } } if (immediate || this._transportUp === false) { return } this._transportUp = false; this.trigger("transport:down") }, _selectTransport: function (transportTypes) { Faye.Transport.get(this, transportTypes, this._disabled, function (transport) { this.debug("Selected ? transport for ?", transport.connectionType, Faye.URI.stringify(transport.endpoint)); if (transport === this._transport) { return } if (this._transport) { this._transport.close() } this._transport = transport }, this) }, _send: function (message, callback, context) { if (!this._transport) { return } message.id = message.id || this._generateMessageId(); this.pipeThroughExtensions("outgoing", message, null, function (message) { if (!message) { return } if (callback) { this._responseCallbacks[message.id] = [callback, context] } this._transportSend(message) }, this) }, _transportSend: function (message) { if (!this._transport) { return } var timeout = 1.2 * (this._advice.timeout || this._retry * 1000), envelope = new Faye.Envelope(message, timeout); envelope.errback(function (immediate) { this.messageError([message], immediate) }, this); this._transport.send(envelope) }, _generateMessageId: function () { this._messageId += 1; if (this._messageId >= Math.pow(2, 32)) { this._messageId = 0 } return this._messageId.toString(36) }, _handleAdvice: function (advice) { Faye.extend(this._advice, advice); if (this._advice.reconnect === this.HANDSHAKE && this._state !== this.DISCONNECTED) { this._state = this.UNCONNECTED; this._clientId = null; this._cycleConnection() } }, _deliverMessage: function (message) { if (!message.channel || message.data === undefined) { return } this.info("Client ? calling listeners for ? with ?", this._clientId, message.channel, message.data); this._channels.distributeMessage(message) }, _cycleConnection: function () { if (this._connectRequest) { this._connectRequest = null; this.info("Closed connection for ?", this._clientId) } var self = this; Faye.ENV.setTimeout(function () { self.connect() }, this._advice.interval) } }); Faye.extend(Faye.Client.prototype, Faye.Deferrable); Faye.extend(Faye.Client.prototype, Faye.Publisher); Faye.extend(Faye.Client.prototype, Faye.Logging); Faye.extend(Faye.Client.prototype, Faye.Extensible); Faye.Transport = Faye.extend(Faye.Class({ MAX_DELAY: 0, batching: true, initialize: function (client, endpoint) { this._client = client; this.endpoint = endpoint; this._outbox = [] }, close: function () { }, encode: function (envelopes) { return "" }, send: function (envelope) { var message = envelope.message; this.debug("Client ? sending message to ?: ?", this._client._clientId, Faye.URI.stringify(this.endpoint), message); if (!this.batching) { return this.request([envelope]) } this._outbox.push(envelope); if (message.channel === Faye.Channel.HANDSHAKE) { return this.addTimeout("publish", 0.01, this.flush, this) } if (message.channel === Faye.Channel.CONNECT) { this._connectMessage = message } this.flushLargeBatch(); this.addTimeout("publish", this.MAX_DELAY, this.flush, this) }, flush: function () { this.removeTimeout("publish"); if (this._outbox.length > 1 && this._connectMessage) { this._connectMessage.advice = { timeout: 0 } } this.request(this._outbox); this._connectMessage = null; this._outbox = [] }, flushLargeBatch: function () { var string = this.encode(this._outbox); if (string.length < this._client.maxRequestSize) { return } var last = this._outbox.pop(); this.flush(); if (last) { this._outbox.push(last) } }, receive: function (envelopes, responses) { var n = envelopes.length; while (n--) { envelopes[n].setDeferredStatus("succeeded") } responses = [].concat(responses); this.debug("Client ? received from ?: ?", this._client._clientId, Faye.URI.stringify(this.endpoint), responses); for (var i = 0, n = responses.length; i < n; i++) { this._client.receiveMessage(responses[i]) } }, handleError: function (envelopes, immediate) { var n = envelopes.length; while (n--) { envelopes[n].setDeferredStatus("failed", immediate) } }, _getCookies: function () { var cookies = this._client.cookies; if (!cookies) { return "" } return cookies.getCookies({ domain: this.endpoint.hostname, path: this.endpoint.path, secure: this.endpoint.protocol === "https:" }).toValueString() }, _storeCookies: function (setCookie) { if (!setCookie || !this._client.cookies) { return } setCookie = [].concat(setCookie); var cookie; for (var i = 0, n = setCookie.length; i < n; i++) { cookie = this._client.cookies.setCookie(setCookie[i]); cookie = cookie[0] || cookie; cookie.domain = cookie.domain || this.endpoint.hostname } } }), { get: function (client, allowed, disabled, callback, context) { var endpoint = client.endpoint; Faye.asyncEach(this._transports, function (pair, resume) { var connType = pair[0], klass = pair[1], connEndpoint = client.endpoints[connType] || endpoint; if (Faye.indexOf(disabled, connType) >= 0) { return resume() } if (Faye.indexOf(allowed, connType) < 0) { klass.isUsable(client, connEndpoint, function () { }); return resume() } klass.isUsable(client, connEndpoint, function (isUsable) { if (!isUsable) { return resume() } var transport = klass.hasOwnProperty("create") ? klass.create(client, connEndpoint) : new klass(client, connEndpoint); callback.call(context, transport) }) }, function () { throw new Error("Could not find a usable connection type for " + Faye.URI.stringify(endpoint)) }) }, register: function (type, klass) { this._transports.push([type, klass]); klass.prototype.connectionType = type }, _transports: [] }); Faye.extend(Faye.Transport.prototype, Faye.Logging); Faye.extend(Faye.Transport.prototype, Faye.Timeouts); Faye.Event = { _registry: [], on: function (element, eventName, callback, context) { var wrapped = function () { callback.call(context) }; if (element.addEventListener) { element.addEventListener(eventName, wrapped, false) } else { element.attachEvent("on" + eventName, wrapped) } this._registry.push({ _element: element, _type: eventName, _callback: callback, _context: context, _handler: wrapped }) }, detach: function (element, eventName, callback, context) { var i = this._registry.length, register; while (i--) { register = this._registry[i]; if ((element && element !== register._element) || (eventName && eventName !== register._type) || (callback && callback !== register._callback) || (context && context !== register._context)) { continue } if (register._element.removeEventListener) { register._element.removeEventListener(register._type, register._handler, false) } else { register._element.detachEvent("on" + register._type, register._handler) } this._registry.splice(i, 1); register = null } } }; if (Faye.ENV.onunload !== undefined) { Faye.Event.on(Faye.ENV, "unload", Faye.Event.detach, Faye.Event) } if (typeof JSON !== "object") { JSON = {} } (function () { function f(n) { return n < 10 ? "0" + n : n } if (typeof Date.prototype.toJSON !== "function") { Date.prototype.toJSON = function () { return isFinite(this.valueOf()) ? this.getUTCFullYear() + "-" + f(this.getUTCMonth() + 1) + "-" + f(this.getUTCDate()) + "T" + f(this.getUTCHours()) + ":" + f(this.getUTCMinutes()) + ":" + f(this.getUTCSeconds()) + "Z" : null }; String.prototype.toJSON = Number.prototype.toJSON = Boolean.prototype.toJSON = function () { return this.valueOf() } } var cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g, gap, indent, meta = { "\b": "\\b", "\t": "\\t", "\n": "\\n", "\f": "\\f", "\r": "\\r", '"': '\\"', "\\": "\\\\" }, rep; function quote(string) { escapable.lastIndex = 0; return escapable.test(string) ? '"' + string.replace(escapable, function (a) { var c = meta[a]; return typeof c === "string" ? c : "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4) }) + '"' : '"' + string + '"' } function str(key, holder) { var i, k, v, length, mind = gap, partial, value = holder[key]; if (value && typeof value === "object" && typeof value.toJSON === "function") { value = value.toJSON(key) } if (typeof rep === "function") { value = rep.call(holder, key, value) } switch (typeof value) { case "string": return quote(value); case "number": return isFinite(value) ? String(value) : "null"; case "boolean": case "null": return String(value); case "object": if (!value) { return "null" } gap += indent; partial = []; if (Object.prototype.toString.apply(value) === "[object Array]") { length = value.length; for (i = 0; i < length; i += 1) { partial[i] = str(i, value) || "null" } v = partial.length === 0 ? "[]" : gap ? "[\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "]" : "[" + partial.join(",") + "]"; gap = mind; return v } if (rep && typeof rep === "object") { length = rep.length; for (i = 0; i < length; i += 1) { if (typeof rep[i] === "string") { k = rep[i]; v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v) } } } } else { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = str(k, value); if (v) { partial.push(quote(k) + (gap ? ": " : ":") + v) } } } } v = partial.length === 0 ? "{}" : gap ? "{\n" + gap + partial.join(",\n" + gap) + "\n" + mind + "}" : "{" + partial.join(",") + "}"; gap = mind; return v } } Faye.stringify = function (value, replacer, space) { var i; gap = ""; indent = ""; if (typeof space === "number") { for (i = 0; i < space; i += 1) { indent += " " } } else { if (typeof space === "string") { indent = space } } rep = replacer; if (replacer && typeof replacer !== "function" && (typeof replacer !== "object" || typeof replacer.length !== "number")) { throw new Error("JSON.stringify") } return str("", { "": value }) }; if (typeof JSON.stringify !== "function") { JSON.stringify = Faye.stringify } if (typeof JSON.parse !== "function") { JSON.parse = function (text, reviver) { var j; function walk(holder, key) { var k, v, value = holder[key]; if (value && typeof value === "object") { for (k in value) { if (Object.prototype.hasOwnProperty.call(value, k)) { v = walk(value, k); if (v !== undefined) { value[k] = v } else { delete value[k] } } } } return reviver.call(holder, key, value) } text = String(text); cx.lastIndex = 0; if (cx.test(text)) { text = text.replace(cx, function (a) { return "\\u" + ("0000" + a.charCodeAt(0).toString(16)).slice(-4) }) } if (/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, "@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, "]").replace(/(?:^|:|,)(?:\s*\[)+/g, ""))) { j = eval("(" + text + ")"); return typeof reviver === "function" ? walk({ "": j }, "") : j } throw new SyntaxError("JSON.parse") } } }()); Faye.Transport.WebSocket = Faye.extend(Faye.Class(Faye.Transport, { UNCONNECTED: 1, CONNECTING: 2, CONNECTED: 3, batching: false, isUsable: function (callback, context) { this.callback(function () { callback.call(context, true) }); this.errback(function () { callback.call(context, false) }); this.connect() }, request: function (envelopes) { this.callback(function (socket) { if (!socket) { return } for (var i = 0, n = envelopes.length; i < n; i++) { this._pending.add(envelopes[i]) } var messages = Faye.map(envelopes, function (e) { return e.message }); socket.send(Faye.toJSON(messages)) }, this); this.connect() }, connect: function () { if (Faye.Transport.WebSocket._unloaded) { return } this._state = this._state || this.UNCONNECTED; if (this._state !== this.UNCONNECTED) { return } this._state = this.CONNECTING; var socket = this._createSocket(); if (!socket) { return this.setDeferredStatus("failed") } var self = this; socket.onopen = function () { if (socket.headers) { self._storeCookies(socket.headers["set-cookie"]) } self._socket = socket; self._pending = new Faye.Set(); self._state = self.CONNECTED; self._everConnected = true; self._ping(); self.setDeferredStatus("succeeded", socket) }; var closed = false; socket.onclose = socket.onerror = function () { if (closed) { return } closed = true; var wasConnected = (self._state === self.CONNECTED); socket.onopen = socket.onclose = socket.onerror = socket.onmessage = null; delete self._socket; self._state = self.UNCONNECTED; self.removeTimeout("ping"); self.setDeferredStatus("unknown"); var pending = self._pending ? self._pending.toArray() : []; delete self._pending; if (wasConnected) { self.handleError(pending, true) } else { if (self._everConnected) { self.handleError(pending) } else { self.setDeferredStatus("failed") } } }; socket.onmessage = function (event) { var messages = JSON.parse(event.data), envelopes = [], envelope; if (!messages) { return } messages = [].concat(messages); for (var i = 0, n = messages.length; i < n; i++) { if (messages[i].successful === undefined) { continue } envelope = self._pending.remove(messages[i]); if (envelope) { envelopes.push(envelope) } } self.receive(envelopes, messages) } }, close: function () { if (!this._socket) { return } this._socket.close() }, _createSocket: function () { var url = Faye.Transport.WebSocket.getSocketUrl(this.endpoint), options = { headers: Faye.copyObject(this._client.headers), ca: this._client.ca }; options.headers.Cookie = this._getCookies(); if (Faye.WebSocket) { return new Faye.WebSocket.Client(url, [], options) } if (Faye.ENV.MozWebSocket) { return new MozWebSocket(url) } if (Faye.ENV.WebSocket) { return new WebSocket(url) } }, _ping: function () { if (!this._socket) { return } this._socket.send("[]"); this.addTimeout("ping", this._client._advice.timeout / 2000, this._ping, this) } }), { PROTOCOLS: { "http:": "ws:", "https:": "wss:" }, create: function (client, endpoint) { var sockets = client.transports.websocket = client.transports.websocket || {}; sockets[endpoint.href] = sockets[endpoint.href] || new this(client, endpoint); return sockets[endpoint.href] }, getSocketUrl: function (endpoint) { endpoint = Faye.copyObject(endpoint); endpoint.protocol = this.PROTOCOLS[endpoint.protocol]; return Faye.URI.stringify(endpoint) }, isUsable: function (client, endpoint, callback, context) { this.create(client, endpoint).isUsable(callback, context) } }); Faye.extend(Faye.Transport.WebSocket.prototype, Faye.Deferrable); Faye.Transport.register("websocket", Faye.Transport.WebSocket); if (Faye.Event) { Faye.Event.on(Faye.ENV, "beforeunload", function () { Faye.Transport.WebSocket._unloaded = true }) } Faye.Transport.EventSource = Faye.extend(Faye.Class(Faye.Transport, { initialize: function (client, endpoint) { Faye.Transport.prototype.initialize.call(this, client, endpoint); if (!Faye.ENV.EventSource) { return this.setDeferredStatus("failed") } this._xhr = new Faye.Transport.XHR(client, endpoint); endpoint = Faye.copyObject(endpoint); endpoint.pathname += "/" + client._clientId; var socket = new EventSource(Faye.URI.stringify(endpoint)), self = this; socket.onopen = function () { self._everConnected = true; self.setDeferredStatus("succeeded") }; socket.onerror = function () { if (self._everConnected) { self._client.messageError([]) } else { self.setDeferredStatus("failed"); socket.close() } }; socket.onmessage = function (event) { self.receive([], JSON.parse(event.data)) }; this._socket = socket }, close: function () { if (!this._socket) { return } this._socket.onopen = this._socket.onerror = this._socket.onmessage = null; this._socket.close(); delete this._socket }, isUsable: function (callback, context) { this.callback(function () { callback.call(context, true) }); this.errback(function () { callback.call(context, false) }) }, encode: function (envelopes) { return this._xhr.encode(envelopes) }, request: function (envelopes) { this._xhr.request(envelopes) } }), { isUsable: function (client, endpoint, callback, context) { var id = client._clientId; if (!id) { return callback.call(context, false) } Faye.Transport.XHR.isUsable(client, endpoint, function (usable) { if (!usable) { return callback.call(context, false) } this.create(client, endpoint).isUsable(callback, context) }, this) }, create: function (client, endpoint) { var sockets = client.transports.eventsource = client.transports.eventsource || {}, id = client._clientId; endpoint = Faye.copyObject(endpoint); endpoint.pathname += "/" + (id || ""); var url = Faye.URI.stringify(endpoint); sockets[url] = sockets[url] || new this(client, endpoint); return sockets[url] } }); Faye.extend(Faye.Transport.EventSource.prototype, Faye.Deferrable); Faye.Transport.register("eventsource", Faye.Transport.EventSource); Faye.Transport.XHR = Faye.extend(Faye.Class(Faye.Transport, { encode: function (envelopes) { var messages = Faye.map(envelopes, function (e) { return e.message }); return Faye.toJSON(messages) }, request: function (envelopes) { var path = this.endpoint.path, xhr = Faye.ENV.ActiveXObject ? new ActiveXObject("Microsoft.XMLHTTP") : new XMLHttpRequest(), self = this; xhr.open("POST", path, true); xhr.setRequestHeader("Content-Type", "application/json"); xhr.setRequestHeader("Pragma", "no-cache"); xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest"); var headers = this._client.headers; for (var key in headers) { if (!headers.hasOwnProperty(key)) { continue } xhr.setRequestHeader(key, headers[key]) } var abort = function () { xhr.abort() }; Faye.Event.on(Faye.ENV, "beforeunload", abort); xhr.onreadystatechange = function () { if (!xhr || xhr.readyState !== 4) { return } var parsedMessage = null, status = xhr.status, text = xhr.responseText, successful = (status >= 200 && status < 300) || status === 304 || status === 1223; Faye.Event.detach(Faye.ENV, "beforeunload", abort); xhr.onreadystatechange = function () { }; xhr = null; if (!successful) { return self.handleError(envelopes) } try { parsedMessage = JSON.parse(text) } catch (e) { } if (parsedMessage) { self.receive(envelopes, parsedMessage) } else { self.handleError(envelopes) } }; xhr.send(this.encode(envelopes)) } }), { isUsable: function (client, endpoint, callback, context) { callback.call(context, Faye.URI.isSameOrigin(endpoint)) } }); Faye.Transport.register("long-polling", Faye.Transport.XHR); Faye.Transport.CORS = Faye.extend(Faye.Class(Faye.Transport, { encode: function (envelopes) { var messages = Faye.map(envelopes, function (e) { return e.message }); return "message=" + encodeURIComponent(Faye.toJSON(messages)) }, request: function (envelopes) { var xhrClass = Faye.ENV.XDomainRequest ? XDomainRequest : XMLHttpRequest, xhr = new xhrClass(), headers = this._client.headers, self = this, key; xhr.open("POST", Faye.URI.stringify(this.endpoint), true); if (xhr.setRequestHeader) { xhr.setRequestHeader("Pragma", "no-cache"); for (key in headers) { if (!headers.hasOwnProperty(key)) { continue } xhr.setRequestHeader(key, headers[key]) } } var cleanUp = function () { if (!xhr) { return false } xhr.onload = xhr.onerror = xhr.ontimeout = xhr.onprogress = null; xhr = null }; xhr.onload = function () { var parsedMessage = null; try { parsedMessage = JSON.parse(xhr.responseText) } catch (e) { } cleanUp(); if (parsedMessage) { self.receive(envelopes, parsedMessage) } else { self.handleError(envelopes) } }; xhr.onerror = xhr.ontimeout = function () { cleanUp(); self.handleError(envelopes) }; xhr.onprogress = function () { }; xhr.send(this.encode(envelopes)) } }), { isUsable: function (client, endpoint, callback, context) { if (Faye.URI.isSameOrigin(endpoint)) { return callback.call(context, false) } if (Faye.ENV.XDomainRequest) { return callback.call(context, endpoint.protocol === Faye.ENV.location.protocol) } if (Faye.ENV.XMLHttpRequest) { var xhr = new Faye.ENV.XMLHttpRequest(); return callback.call(context, xhr.withCredentials !== undefined) } return callback.call(context, false) } }); Faye.Transport.register("cross-origin-long-polling", Faye.Transport.CORS); Faye.Transport.JSONP = Faye.extend(Faye.Class(Faye.Transport, { encode: function (envelopes) { var messages = Faye.map(envelopes, function (e) { return e.message }); var url = Faye.copyObject(this.endpoint); url.query.message = Faye.toJSON(messages); url.query.jsonp = "__jsonp" + Faye.Transport.JSONP._cbCount + "__"; return Faye.URI.stringify(url) }, request: function (envelopes) { var messages = Faye.map(envelopes, function (e) { return e.message }), head = document.getElementsByTagName("head")[0], script = document.createElement("script"), callbackName = Faye.Transport.JSONP.getCallbackName(), endpoint = Faye.copyObject(this.endpoint), self = this; endpoint.query.message = Faye.toJSON(messages); endpoint.query.jsonp = callbackName; Faye.ENV[callbackName] = function (data) { if (!Faye.ENV[callbackName]) { return false } Faye.ENV[callbackName] = undefined; try { delete Faye.ENV[callbackName] } catch (e) { } script.parentNode.removeChild(script); self.receive(envelopes, data) }; script.type = "text/javascript"; script.src = Faye.URI.stringify(endpoint); head.appendChild(script) } }), { _cbCount: 0, getCallbackName: function () { this._cbCount += 1; return "__jsonp" + this._cbCount + "__" }, isUsable: function (client, endpoint, callback, context) { callback.call(context, true) } }); Faye.Transport.register("callback-polling", Faye.Transport.JSONP) })(); Mithril = m = new function app(I, g) { var T = {}.toString; var z = /(?:(^|#|\.)([^#\.\[\]]+))|(\[.+?\])/g, P = /\[(.+?)(?:=("|'|)(.*?)\2)?\]/; function M() { var Y = arguments; var ac = Y[1] !== g && T.call(Y[1]) == "[object Object]" && !("tag" in Y[1]) && !("subtree" in Y[1]); var aa = ac ? Y[1] : {}; var V = "class" in aa ? "class" : "className"; var ab = { tag: "div", attrs: {} }; var X, U = []; while (X = z.exec(Y[0])) { if (X[1] == "") { ab.tag = X[2] } else { if (X[1] == "#") { ab.attrs.id = X[2] } else { if (X[1] == ".") { U.push(X[2]) } else { if (X[3][0] == "[") { var W = P.exec(X[3]); ab.attrs[W[1]] = W[3] || (W[2] ? "" : true) } } } } } if (U.length > 0) { ab.attrs[V] = U.join(" ") } ab.children = ac ? Y[2] : Y[1]; for (var Z in aa) { if (Z == V) { ab.attrs[Z] = (ab.attrs[Z] || "") + " " + aa[Z] } else { ab.attrs[Z] = aa[Z] } } return ab } function F(aq, az, au, W, aE, X, av, ao, aA, aB, ae) { if (aE === g || aE === null) { aE = "" } if (aE.subtree === "retain") { return X } var ak = T.call(X), ac = T.call(aE); if (X === g || X === null || ak != ac) { if (X !== null && X !== g) { if (au && au.nodes) { var ay = ao - W; var af = ay + (ac == "[object Array]" ? aE : X.nodes).length; E(au.nodes.slice(ay, af), au.slice(ay, af)) } else { E(X.nodes, X) } } X = new aE.constructor; X.nodes = [] } if (ac == "[object Array]") { aE = s(aE); var aw = [], aF = X.length === aE.length, at = 0; var ad = 1, U = 2, ap = 3; var ah = {}, aa = [], aC = false; for (var aD = 0; aD < X.length; aD++) { if (X[aD] && X[aD].attrs && X[aD].attrs.key !== g) { aC = true; ah[X[aD].attrs.key] = { action: ad, index: aD } } } if (aC) { for (var aD = 0; aD < aE.length; aD++) { if (aE[aD] && aE[aD].attrs) { if (aE[aD].attrs.key !== g) { var ag = aE[aD].attrs.key; if (!ah[ag]) { ah[ag] = { action: U, index: aD } } else { ah[ag] = { action: ap, index: aD, from: ah[ag].index, element: aq.childNodes[ah[ag].index] } } } else { aa.push({ index: aD, element: aq.childNodes[aD] }) } } } var ax = Object.keys(ah).map(function (aG) { return ah[aG] }); var ai = ax.sort(function (aH, aG) { return aH.action - aG.action || aH.index - aG.index }); var ar = X.slice(); for (var aD = 0, V; V = ai[aD]; aD++) { if (V.action == ad) { E(X[V.index].nodes, X[V.index]); ar.splice(V.index, 1) } if (V.action == U) { var Z = I.document.createElement("div"); Z.key = aE[V.index].attrs.key; aq.insertBefore(Z, aq.childNodes[V.index]); ar.splice(V.index, 0, { attrs: { key: aE[V.index].attrs.key }, nodes: [Z] }) } if (V.action == ap) { if (aq.childNodes[V.index] !== V.element) { aq.insertBefore(V.element, aq.childNodes[V.index]) } ar[V.index] = X[V.from] } } for (var aD = 0; aD < aa.length; aD++) { var V = aa[aD]; aq.insertBefore(V.element, aq.childNodes[V.index]); ar[V.index] = X[V.index] } X = ar; X.nodes = []; for (var aD = 0, Y; Y = aq.childNodes[aD]; aD++) { X.nodes.push(Y) } } for (var aD = 0, am = 0; aD < aE.length; aD++) { var al = F(aq, az, X, ao, aE[aD], X[am], av, ao + at || at, aA, aB, ae); if (al === g) { continue } if (!al.nodes.intact) { aF = false } var aj = T.call(al) == "[object Array]"; at += aj ? al.length : 1; X[am++] = al } if (!aF) { for (var aD = 0; aD < aE.length; aD++) { if (X[aD] !== g) { aw = aw.concat(X[aD].nodes) } } for (var aD = 0, an; an = X.nodes[aD]; aD++) { if (an.parentNode !== null && aw.indexOf(an) < 0) { an.parentNode.removeChild(an) } } for (var aD = X.nodes.length, an; an = aw[aD]; aD++) { if (an.parentNode === null) { aq.appendChild(an) } } if (aE.length < X.length) { X.length = aE.length } X.nodes = aw } } else { if (aE !== g && ac == "[object Object]") { if (aE.tag != X.tag || Object.keys(aE.attrs).join() != Object.keys(X.attrs).join() || aE.attrs.id != X.attrs.id) { E(X.nodes); if (X.configContext && typeof X.configContext.onunload == "function") { X.configContext.onunload() } } if (typeof aE.tag != "string") { return } var an, ab = X.nodes.length === 0; if (aE.attrs.xmlns) { aB = aE.attrs.xmlns } else { if (aE.tag === "svg") { aB = "http://www.w3.org/2000/svg" } } if (ab) { an = aB === g ? I.document.createElement(aE.tag) : I.document.createElementNS(aB, aE.tag); X = { tag: aE.tag, children: aE.children !== g ? F(an, aE.tag, g, g, aE.children, X.children, true, 0, aE.attrs.contenteditable ? an : aA, aB, ae) : g, attrs: H(an, aE.tag, aE.attrs, {}, aB), nodes: [an] }; aq.insertBefore(an, aq.childNodes[ao] || null) } else { an = X.nodes[0]; H(an, aE.tag, aE.attrs, X.attrs, aB); X.children = F(an, aE.tag, g, g, aE.children, X.children, false, 0, aE.attrs.contenteditable ? an : aA, aB, ae); X.nodes.intact = true; if (av === true) { aq.insertBefore(an, aq.childNodes[ao] || null) } } if (typeof aE.attrs.config === "function") { ae.push(aE.attrs.config.bind(I, an, !ab, X.configContext = X.configContext || {}, X)) } } else { if (typeof ac != "function") { var aw; if (X.nodes.length === 0) { if (aE.$trusted) { aw = o(aq, ao, aE) } else { aw = [I.document.createTextNode(aE)]; aq.insertBefore(aw[0], aq.childNodes[ao] || null) } X = "string number boolean".indexOf(typeof aE) > -1 ? new aE.constructor(aE) : aE; X.nodes = aw } else { if (X.valueOf() !== aE.valueOf() || av === true) { aw = X.nodes; if (!aA || aA !== I.document.activeElement) { if (aE.$trusted) { E(aw, X); aw = o(aq, ao, aE) } else { if (az === "textarea") { aq.value = aE } else { if (aA) { aA.innerHTML = aE } else { if (aw[0].nodeType == 1 || aw.length > 1) { E(X.nodes, X); aw = [I.document.createTextNode(aE)] } aq.insertBefore(aw[0], aq.childNodes[ao] || null); aw[0].nodeValue = aE } } } } X = new aE.constructor(aE); X.nodes = aw } else { X.nodes.intact = true } } } } } return X } function H(X, ad, U, V, Y) { var W = {}; for (var ab in U) { var aa = U[ab]; var Z = V[ab]; if (!(ab in V) || (Z !== aa) || X === I.document.activeElement) { V[ab] = aa; if (ab === "config") { continue } else { if (typeof aa == "function" && ab.indexOf("on") == 0) { X[ab] = q(aa, X) } else { if (ab === "style" && typeof aa == "object") { for (var ac in aa) { if (Z === g || Z[ac] !== aa[ac]) { X.style[ac] = aa[ac] } } for (var ac in Z) { if (!(ac in aa)) { X.style[ac] = "" } } } else { if (Y !== g) { if (ab === "href") { X.setAttributeNS("http://www.w3.org/1999/xlink", "href", aa) } else { if (ab === "className") { X.setAttribute("class", aa) } else { X.setAttribute(ab, aa) } } } else { if (ab === "value" && ad === "input") { if (X.value !== aa) { X.value = aa } } else { if (ab in X && !(ab == "list" || ab == "style")) { X[ab] = aa } else { X.setAttribute(ab, aa) } } } } } } } } return V } function E(U, W) { for (var V = U.length - 1; V > -1; V--) { if (U[V] && U[V].parentNode) { U[V].parentNode.removeChild(U[V]); W = [].concat(W); if (W[V]) { b(W[V]) } } } if (U.length != 0) { U.length = 0 } } function b(V) { if (V.configContext && typeof V.configContext.onunload == "function") { V.configContext.onunload() } if (V.children) { if (T.call(V.children) == "[object Array]") { for (var U = 0; U < V.children.length; U++) { b(V.children[U]) } } else { if (V.children.tag) { b(V.children) } } } } function o(U, W, Z) { var Y = U.childNodes[W]; if (Y) { var X = Y.nodeType != 1; var aa = I.document.createElement("span"); if (X) { U.insertBefore(aa, Y); aa.insertAdjacentHTML("beforebegin", Z); U.removeChild(aa) } else { Y.insertAdjacentHTML("beforebegin", Z) } } else { U.insertAdjacentHTML("beforeend", Z) } var V = []; while (U.childNodes[W] !== Y) { V.push(U.childNodes[W]); W++ } return V } function s(X) { var V = []; for (var U = 0; U < X.length; U++) { var W = X[U]; if (T.call(W) == "[object Array]") { V.push.apply(V, s(W)) } else { V.push(W) } } return V } function q(W, U, V) { return function (X) { X = X || event; M.startComputation(); try { return W.call(U, X) } finally { if (!c) { c = -1 } M.endComputation() } } } var x; var a = { insertAdjacentHTML: function (U, V) { I.document.write(V); I.document.close() }, appendChild: function (U) { if (x === g) { x = I.document.createElement("html") } if (U.nodeName == "HTML") { x = U } else { x.appendChild(U) } if (I.document.documentElement && I.document.documentElement !== x) { I.document.replaceChild(x, I.document.documentElement) } else { I.document.appendChild(x) } }, insertBefore: function (U) { this.appendChild(U) }, childNodes: [] }; var O = [], d = {}; M.render = function (V, U) { var Y = []; if (!V) { throw new Error("Please ensure the DOM element exists before rendering a template into it.") } var Z = h(V); var X = V == I.document || V == I.document.documentElement ? a : V; if (d[Z] === g) { E(X.childNodes) } d[Z] = F(X, null, g, g, U, d[Z], false, 0, null, g, Y); for (var W = 0; W < Y.length; W++) { Y[W]() } }; function h(V) { var U = O.indexOf(V); return U < 0 ? O.push(V) - 1 : U } M.trust = function (U) { U = new String(U); U.$trusted = true; return U }; var n = [], w = [], p = [], c = 0, k = null, N = false; M.module = function (V, X) { var W = n.indexOf(V); if (W < 0) { W = n.length } var U = false; if (p[W] && typeof p[W].onunload == "function") { var Y = { preventDefault: function () { U = true } }; p[W].onunload(Y) } if (!U) { M.startComputation(); n[W] = V; w[W] = X; p[W] = new X.controller; M.endComputation() } }; M.redraw = function () { var U = I.cancelAnimationFrame || I.clearTimeout; var V = I.requestAnimationFrame || I.setTimeout; if (c) { U(c); c = V(e, 0) } else { e(); c = V(function () { c = null }, 0) } }; function e() { for (var U = 0; U < n.length; U++) { if (p[U]) { M.render(n[U], w[U].view(p[U])) } } if (k) { k(); k = null } c = null } var J = 0; M.startComputation = function () { J++ }; M.endComputation = function () { J = Math.max(J - 1, 0); if (J == 0) { M.redraw() } }; M.withAttr = function (V, U) { return function (X) { X = X || event; var W = X.currentTarget || this; U(V in W ? W[V] : W.getAttribute(V)) } }; var R = { pathname: "", hash: "#", search: "?" }; var A = function () { }, u = {}, l; M.route = function () { if (arguments.length === 0) { return l } else { if (arguments.length === 3 && typeof arguments[1] == "string") { var V = arguments[0], ab = arguments[1], W = arguments[2]; A = function (ac) { var ad = l = t(ac); if (!C(V, W, ad)) { M.route(ab, true) } }; var aa = M.route.mode == "hash" ? "onhashchange" : "onpopstate"; I[aa] = function () { if (l != t(I.location[M.route.mode])) { A(I.location[M.route.mode]) } }; k = r; I[aa]() } else { if (arguments[0].addEventListener) { var Z = arguments[0]; var Y = arguments[1]; if (Z.href.indexOf(R[M.route.mode]) < 0) { Z.href = I.location.pathname + R[M.route.mode] + Z.pathname } if (!Y) { Z.removeEventListener("click", S); Z.addEventListener("click", S) } } else { if (typeof arguments[0] == "string") { l = arguments[0]; var U = typeof arguments[1] == "object" ? y(arguments[1]) : null; if (U) { l += (l.indexOf("?") === -1 ? "?" : "&") + U } var X = (arguments.length == 3 ? arguments[2] : arguments[1]) === true; if (I.history.pushState) { k = function () { I.history[X ? "replaceState" : "pushState"](null, I.document.title, R[M.route.mode] + l); r() }; A(R[M.route.mode] + l) } else { I.location[M.route.mode] = l } } } } } }; M.route.param = function (U) { return u[U] }; M.route.mode = "search"; function t(U) { return U.slice(R[M.route.mode].length) } function C(U, W, Z) { u = {}; var X = Z.indexOf("?"); if (X !== -1) { u = L(Z.substr(X + 1, Z.length)); Z = Z.substr(0, X) } for (var V in W) { if (V == Z) { G(U); M.module(U, W[V]); return true } var Y = new RegExp("^" + V.replace(/:[^\/]+?\.{3}/g, "(.*?)").replace(/:[^\/]+/g, "([^\\/]+)") + "/?$"); if (Y.test(Z)) { G(U); Z.replace(Y, function () { var ac = V.match(/:[^\/]+/g) || []; var aa = [].slice.call(arguments, 1, -2); for (var ab = 0; ab < ac.length; ab++) { u[ac[ab].replace(/:|\./g, "")] = v(aa[ab]) } M.module(U, W[V]) }); return true } } } function G(U) { var V = h(U); E(U.childNodes, d[V]); d[V] = g } function S(U) { U = U || event; if (U.ctrlKey || U.metaKey || U.which == 2) { return } U.preventDefault(); M.route(U.currentTarget[M.route.mode].slice(R[M.route.mode].length)) } function r() { if (M.route.mode != "hash" && I.location.hash) { I.location.hash = I.location.hash } else { I.scrollTo(0, 0) } } function y(U, X) { var Y = []; for (var Z in U) { var V = X ? X + "[" + Z + "]" : Z, W = U[Z]; Y.push(typeof W == "object" ? y(W, V) : encodeURIComponent(V) + "=" + encodeURIComponent(W)) } return Y.join("&") } function L(Y) { var V = Y.split("&"), X = {}; for (var U = 0; U < V.length; U++) { var W = V[U].split("="); X[v(W[0])] = W[1] ? v(W[1]) : (W.length === 1 ? true : "") } return X } function v(U) { return decodeURIComponent(U.replace(/\+/g, " ")) } M.prop = function (U) { var V = function () { if (arguments.length) { U = arguments[0] } return U }; V.toJSON = function () { return U }; return V }; var j = {}; M.deferred = function () { var W = [], X = [], U = j, Y = j, Z = M.prop(); var V = { resolve: function (ab) { if (U === j) { Z(U = ab) } for (var aa = 0; aa < W.length; aa++) { W[aa](ab) } W.length = X.length = 0 }, reject: function (ab) { if (Y === j) { Y = ab } for (var aa = 0; aa < X.length; aa++) { X[aa](ab) } W.length = X.length = 0 }, promise: Z }; V.promise.resolvers = W; V.promise.then = function (ac, aa) { var ab = M.deferred(); if (!ac) { ac = K } if (!aa) { aa = K } function ad(af, ae) { return function (ah) { try { var ag = ae(ah); if (ag && typeof ag.then == "function") { ag.then(ab[af], aa) } else { ab[af](ag !== g ? ag : ah) } } catch (ai) { if (T.call(ai) == "[object Error]" && ai.constructor !== Error) { throw ai } else { ab.reject(ai) } } } } if (U !== j) { ad("resolve", ac)(U) } else { if (Y !== j) { ad("reject", aa)(Y) } else { W.push(ad("resolve", ac)); X.push(ad("reject", aa)) } } return ab.promise }; return V }; M.sync = function (V) { var aa = "resolve"; function Z(ac, ab) { return function (ad) { X[ac] = ad; if (!ab) { aa = "reject" } if (--Y == 0) { U.promise(X); U[aa](X) } return ad } } var U = M.deferred(); var Y = V.length; var X = new Array(Y); if (V.length > 0) { for (var W = 0; W < V.length; W++) { V[W].then(Z(W, true), Z(W, false)) } } else { U.resolve() } return U.promise }; function K(U) { return U } function B(U) { var W = new I.XMLHttpRequest; W.open(U.method, U.url, true, U.user, U.password); W.onreadystatechange = function () { if (W.readyState === 4) { if (W.status >= 200 && W.status < 300) { U.onload({ type: "load", target: W }) } else { U.onerror({ type: "error", target: W }) } } }; if (U.serialize == JSON.stringify && U.method != "GET") { W.setRequestHeader("Content-Type", "application/json; charset=utf-8") } if (typeof U.config == "function") { var V = U.config(W, U); if (V !== g) { W = V } } W.send(U.method == "GET" ? "" : U.data); return W } function f(W, V, U) { if (V && Object.keys(V).length > 0) { if (W.method == "GET") { W.url = W.url + (W.url.indexOf("?") < 0 ? "?" : "&") + y(V) } else { W.data = U(V) } } return W } function D(U, X) { var Y = U.match(/:[a-z]\w+/gi); if (Y && X) { for (var W = 0; W < Y.length; W++) { var V = Y[W].slice(1); U = U.replace(Y[W], X[V]); delete X[V] } } return U } M.request = function (Y) { if (Y.background !== true) { M.startComputation() } var V = M.deferred(); var W = Y.serialize = Y.serialize || JSON.stringify; var U = Y.deserialize = Y.deserialize || JSON.parse; var X = Y.extract || function (Z) { return Z.responseText.length === 0 && U === JSON.parse ? null : Z.responseText }; Y.url = D(Y.url, Y.data); Y = f(Y, Y.data, W); Y.onload = Y.onerror = function (ac) { try { ac = ac || event; var Z = (ac.type == "load" ? Y.unwrapSuccess : Y.unwrapError) || K; var aa = Z(U(X(ac.target, Y))); if (ac.type == "load") { if (T.call(aa) == "[object Array]" && Y.type) { for (var ab = 0; ab < aa.length; ab++) { aa[ab] = new Y.type(aa[ab]) } } else { if (Y.type) { aa = new Y.type(aa) } } } V[ac.type == "load" ? "resolve" : "reject"](aa) } catch (ac) { if (ac instanceof SyntaxError) { throw new SyntaxError("Could not parse HTTP response. See http://lhorie.github.io/mithril/mithril.request.html#using-variable-data-formats") } else { if (T.call(ac) == "[object Error]" && ac.constructor !== Error) { throw ac } else { V.reject(ac) } } } if (Y.background !== true) { M.endComputation() } }; B(Y); return V.promise }; M.deps = function (U) { return I = U }; M.deps.factory = app; return M }(typeof window != "undefined" ? window : {}); if (typeof module != "undefined" && module !== null) { module.exports = m } if (typeof define == "function" && define.amd) { define(function () { return m }) }
/*!
 *
 * Copyright 2009-2012 Kris Kowal under the terms of the MIT
 * license found at http://github.com/kriskowal/q/raw/master/LICENSE
 *
 * With parts by Tyler Close
 * Copyright 2007-2009 Tyler Close under the terms of the MIT X license found
 * at http://www.opensource.org/licenses/mit-license.html
 * Forked at ref_send.js version: 2009-05-11
 *
 * With parts by Mark Miller
 * Copyright (C) 2011 Google Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */
(function (a) { if (typeof bootstrap === "function") { bootstrap("promise", a) } else { if (typeof exports === "object" && typeof module === "object") { module.exports = a() } else { if (typeof define === "function" && define.amd) { define(a) } else { if (typeof ses !== "undefined") { if (!ses.ok()) { return } else { ses.makeQ = a } } else { if (typeof self !== "undefined") { self.Q = a() } else { throw new Error("This environment was not anticiapted by Q. Please file a bug.") } } } } } })(function () { var G = false; try { throw new Error() } catch (aj) { G = !!aj.stack } var w = Y(); var k; var af = function () { }; var ak = (function () { var ar = { task: void 0, next: null }; var aq = ar; var au = false; var an = void 0; var ap = false; function e() { while (ar.next) { ar = ar.next; var av = ar.task; ar.task = void 0; var aw = ar.domain; if (aw) { ar.domain = void 0; aw.enter() } try { av() } catch (ax) { if (ap) { if (aw) { aw.exit() } setTimeout(e, 0); if (aw) { aw.enter() } throw ax } else { setTimeout(function () { throw ax }, 0) } } if (aw) { aw.exit() } } au = false } ak = function (av) { aq = aq.next = { task: av, domain: ap && process.domain, next: null }; if (!au) { au = true; an() } }; if (typeof process !== "undefined" && process.nextTick) { ap = true; an = function () { process.nextTick(e) } } else { if (typeof setImmediate === "function") { if (typeof window !== "undefined") { an = setImmediate.bind(window, e) } else { an = function () { setImmediate(e) } } } else { if (typeof MessageChannel !== "undefined") { var at = new MessageChannel(); at.port1.onmessage = function () { an = ao; at.port1.onmessage = e; e() }; var ao = function () { at.port2.postMessage(0) }; an = function () { setTimeout(e, 0); ao() } } else { an = function () { setTimeout(e, 0) } } } } return ak })(); var a = Function.call; function r(e) { return function () { return a.apply(e, arguments) } } var ad = r(Array.prototype.slice); var c = r(Array.prototype.reduce || function (ap, ao) { var e = 0, an = this.length; if (arguments.length === 1) { do { if (e in this) { ao = this[e++]; break } if (++e >= an) { throw new TypeError() } } while (1) } for (; e < an; e++) { if (e in this) { ao = ap(ao, this[e], e) } } return ao }); var T = r(Array.prototype.indexOf || function (an) { for (var e = 0; e < this.length; e++) { if (this[e] === an) { return e } } return -1 }); var b = r(Array.prototype.map || function (ap, an) { var e = this; var ao = []; c(e, function (at, ar, aq) { ao.push(ap.call(an, ar, aq, e)) }, void 0); return ao }); var J = Object.create || function (an) { function e() { } e.prototype = an; return new e() }; var C = r(Object.prototype.hasOwnProperty); var I = Object.keys || function (e) { var ao = []; for (var an in e) { if (C(e, an)) { ao.push(an) } } return ao }; var am = r(Object.prototype.toString); function X(e) { return e === Object(e) } function y(e) { return (am(e) === "[object StopIteration]" || e instanceof K) } var K; if (typeof ReturnValue !== "undefined") { K = ReturnValue } else { K = function (e) { this.value = e } } var aa = "From previous event:"; function o(e, aq) { if (G && aq.stack && typeof e === "object" && e !== null && e.stack && e.stack.indexOf(aa) === -1) { var ao = []; for (var ap = aq; !!ap; ap = ap.source) { if (ap.stack) { ao.unshift(ap.stack) } } ao.unshift(e.stack); var an = ao.join("\n" + aa + "\n"); e.stack = M(an) } } function M(ap) { var an = ap.split("\n"); var aq = []; for (var ao = 0; ao < an.length; ++ao) { var e = an[ao]; if (!g(e) && !ab(e) && e) { aq.push(e) } } return aq.join("\n") } function ab(e) { return e.indexOf("(module.js:") !== -1 || e.indexOf("(node.js:") !== -1 } function ah(e) { var ap = /at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e); if (ap) { return [ap[1], Number(ap[2])] } var ao = /at ([^ ]+):(\d+):(?:\d+)$/.exec(e); if (ao) { return [ao[1], Number(ao[2])] } var an = /.*@(.+):(\d+)$/.exec(e); if (an) { return [an[1], Number(an[2])] } } function g(an) { var ao = ah(an); if (!ao) { return false } var ap = ao[0]; var e = ao[1]; return ap === k && e >= w && e <= u } function Y() { if (!G) { return } try { throw new Error() } catch (aq) { var an = aq.stack.split("\n"); var ao = an[0].indexOf("@") > 0 ? an[1] : an[2]; var ap = ah(ao); if (!ap) { return } k = ap[0]; return ap[1] } } function E(ao, e, an) { return function () { if (typeof console !== "undefined" && typeof console.warn === "function") { console.warn(e + " is deprecated, use " + an + " instead.", new Error("").stack) } return ao.apply(ao, arguments) } } function n(e) { if (e instanceof P) { return e } if (O(e)) { return N(e) } else { return B(e) } } n.resolve = n; n.nextTick = ak; n.longStackSupport = false; if (typeof process === "object" && process && process.env && process.env.Q_DEBUG) { n.longStackSupport = true } n.defer = h; function h() { var ap = [], ar = [], aq; var an = J(h.prototype); var au = J(P.prototype); au.promiseDispatch = function (aw, ax, av) { var e = ad(arguments); if (ap) { ap.push(e); if (ax === "when" && av[1]) { ar.push(av[1]) } } else { n.nextTick(function () { aq.promiseDispatch.apply(aq, e) }) } }; au.valueOf = function () { if (ap) { return au } var e = L(aq); if (A(e)) { aq = e } return e }; au.inspect = function () { if (!aq) { return { state: "pending" } } return aq.inspect() }; if (n.longStackSupport && G) { try { throw new Error() } catch (at) { au.stack = at.stack.substring(at.stack.indexOf("\n") + 1) } } function ao(e) { aq = e; au.source = e; c(ap, function (aw, av) { n.nextTick(function () { e.promiseDispatch.apply(e, av) }) }, void 0); ap = void 0; ar = void 0 } an.promise = au; an.resolve = function (e) { if (aq) { return } ao(n(e)) }; an.fulfill = function (e) { if (aq) { return } ao(B(e)) }; an.reject = function (e) { if (aq) { return } ao(F(e)) }; an.notify = function (e) { if (aq) { return } c(ar, function (aw, av) { n.nextTick(function () { av(e) }) }, void 0) }; return an } h.prototype.makeNodeResolver = function () { var e = this; return function (an, ao) { if (an) { e.reject(an) } else { if (arguments.length > 2) { e.resolve(ad(arguments, 1)) } else { e.resolve(ao) } } } }; n.Promise = V; n.promise = V; function V(ao) { if (typeof ao !== "function") { throw new TypeError("resolver must be a function.") } var e = h(); try { ao(e.resolve, e.reject, e.notify) } catch (an) { e.reject(an) } return e.promise } V.race = p; V.all = z; V.reject = F; V.resolve = n; n.passByCopy = function (e) { return e }; P.prototype.passByCopy = function () { return this }; n.join = function (e, an) { return n(e).join(an) }; P.prototype.join = function (e) { return n([this, e]).spread(function (an, ao) { if (an === ao) { return an } else { throw new Error("Can't join: not the same: " + an + " " + ao) } }) }; n.race = p; function p(e) { return V(function (aq, ap) { for (var ao = 0, an = e.length; ao < an; ao++) { n(e[ao]).then(aq, ap) } }) } P.prototype.race = function () { return this.then(n.race) }; n.makePromise = P; function P(an, aq, ap) { if (aq === void 0) { aq = function (ar) { return F(new Error("Promise does not support operation: " + ar)) } } if (ap === void 0) { ap = function () { return { state: "unknown" } } } var ao = J(P.prototype); ao.promiseDispatch = function (av, aw, at) { var ar; try { if (an[aw]) { ar = an[aw].apply(ao, at) } else { ar = aq.call(ao, aw, at) } } catch (au) { ar = F(au) } if (av) { av(ar) } }; ao.inspect = ap; if (ap) { var e = ap(); if (e.state === "rejected") { ao.exception = e.reason } ao.valueOf = function () { var ar = ap(); if (ar.state === "pending" || ar.state === "rejected") { return ao } return ar.value } } return ao } P.prototype.toString = function () { return "[object Promise]" }; P.prototype.then = function (aq, ar, an) { var at = this; var au = h(); var ao = false; function ap(ax) { try { return typeof aq === "function" ? aq(ax) : ax } catch (aw) { return F(aw) } } function av(aw) { if (typeof ar === "function") { o(aw, at); try { return ar(aw) } catch (ax) { return F(ax) } } return F(aw) } function e(aw) { return typeof an === "function" ? an(aw) : aw } n.nextTick(function () { at.promiseDispatch(function (aw) { if (ao) { return } ao = true; au.resolve(ap(aw)) }, "when", [function (aw) { if (ao) { return } ao = true; au.resolve(av(aw)) }]) }); at.promiseDispatch(void 0, "when", [void 0, function (aw) { var ay; var az = false; try { ay = e(aw) } catch (ax) { az = true; if (n.onerror) { n.onerror(ax) } else { throw ax } } if (!az) { au.notify(ay) } }]); return au.promise }; n.tap = function (e, an) { return n(e).tap(an) }; P.prototype.tap = function (e) { e = n(e); return this.then(function (an) { return e.fcall(an).thenResolve(an) }) }; n.when = R; function R(ao, e, an, ap) { return n(ao).then(e, an, ap) } P.prototype.thenResolve = function (e) { return this.then(function () { return e }) }; n.thenResolve = function (an, e) { return n(an).thenResolve(e) }; P.prototype.thenReject = function (e) { return this.then(function () { throw e }) }; n.thenReject = function (an, e) { return n(an).thenReject(e) }; n.nearer = L; function L(an) { if (A(an)) { var e = an.inspect(); if (e.state === "fulfilled") { return e.value } } return an } n.isPromise = A; function A(e) { return e instanceof P } n.isPromiseAlike = O; function O(e) { return X(e) && typeof e.then === "function" } n.isPending = ae; function ae(e) { return A(e) && e.inspect().state === "pending" } P.prototype.isPending = function () { return this.inspect().state === "pending" }; n.isFulfilled = S; function S(e) { return !A(e) || e.inspect().state === "fulfilled" } P.prototype.isFulfilled = function () { return this.inspect().state === "fulfilled" }; n.isRejected = W; function W(e) { return A(e) && e.inspect().state === "rejected" } P.prototype.isRejected = function () { return this.inspect().state === "rejected" }; var ac = []; var al = []; var q = true; function ai() { ac.length = 0; al.length = 0; if (!q) { q = true } } function D(an, e) { if (!q) { return } al.push(an); if (e && typeof e.stack !== "undefined") { ac.push(e.stack) } else { ac.push("(no stack) " + e) } } function l(an) { if (!q) { return } var e = T(al, an); if (e !== -1) { al.splice(e, 1); ac.splice(e, 1) } } n.resetUnhandledRejections = ai; n.getUnhandledReasons = function () { return ac.slice() }; n.stopUnhandledRejectionTracking = function () { ai(); q = false }; ai(); n.reject = F; function F(an) { var e = P({ when: function (aq) { if (aq) { l(this) } return aq ? aq(an) : this } }, function ap() { return this }, function ao() { return { state: "rejected", reason: an } }); D(e, an); return e } n.fulfill = B; function B(e) { return P({ when: function () { return e }, get: function (ao) { return e[ao] }, set: function (ao, ap) { e[ao] = ap }, "delete": function (ao) { delete e[ao] }, post: function (ap, ao) { if (ap === null || ap === void 0) { return e.apply(void 0, ao) } else { return e[ap].apply(e, ao) } }, apply: function (ap, ao) { return e.apply(ap, ao) }, keys: function () { return I(e) } }, void 0, function an() { return { state: "fulfilled", value: e } }) } function N(an) { var e = h(); n.nextTick(function () { try { an.then(e.resolve, e.reject, e.notify) } catch (ao) { e.reject(ao) } }); return e.promise } n.master = x; function x(e) { return P({ isDef: function () { } }, function an(ap, ao) { return Z(e, ap, ao) }, function () { return n(e).inspect() }) } n.spread = f; function f(ao, e, an) { return n(ao).spread(e, an) } P.prototype.spread = function (e, an) { return this.all().then(function (ao) { return e.apply(void 0, ao) }, an) }; n.async = U; function U(e) { return function () { function ao(av, at) { var ar; if (typeof StopIteration === "undefined") { try { ar = ap[av](at) } catch (au) { return F(au) } if (ar.done) { return n(ar.value) } else { return R(ar.value, aq, an) } } else { try { ar = ap[av](at) } catch (au) { if (y(au)) { return n(au.value) } else { return F(au) } } return R(ar, aq, an) } } var ap = e.apply(this, arguments); var aq = ao.bind(ao, "next"); var an = ao.bind(ao, "throw"); return aq() } } n.spawn = t; function t(e) { n.done(n.async(e)()) } n["return"] = j; function j(e) { throw new K(e) } n.promised = s; function s(e) { return function () { return f([this, z(arguments)], function (an, ao) { return e.apply(an, ao) }) } } n.dispatch = Z; function Z(an, ao, e) { return n(an).dispatch(ao, e) } P.prototype.dispatch = function (ap, ao) { var an = this; var e = h(); n.nextTick(function () { an.promiseDispatch(e.resolve, ap, ao) }); return e.promise }; n.get = function (e, an) { return n(e).dispatch("get", [an]) }; P.prototype.get = function (e) { return this.dispatch("get", [e]) }; n.set = function (e, an, ao) { return n(e).dispatch("set", [an, ao]) }; P.prototype.set = function (e, an) { return this.dispatch("set", [e, an]) }; n.del = n["delete"] = function (e, an) { return n(e).dispatch("delete", [an]) }; P.prototype.del = P.prototype["delete"] = function (e) { return this.dispatch("delete", [e]) }; n.mapply = n.post = function (ao, an, e) { return n(ao).dispatch("post", [an, e]) }; P.prototype.mapply = P.prototype.post = function (an, e) { return this.dispatch("post", [an, e]) }; n.send = n.mcall = n.invoke = function (an, e) { return n(an).dispatch("post", [e, ad(arguments, 2)]) }; P.prototype.send = P.prototype.mcall = P.prototype.invoke = function (e) { return this.dispatch("post", [e, ad(arguments, 1)]) }; n.fapply = function (an, e) { return n(an).dispatch("apply", [void 0, e]) }; P.prototype.fapply = function (e) { return this.dispatch("apply", [void 0, e]) }; n["try"] = n.fcall = function (e) { return n(e).dispatch("apply", [void 0, ad(arguments, 1)]) }; P.prototype.fcall = function () { return this.dispatch("apply", [void 0, ad(arguments)]) }; n.fbind = function (an) { var ap = n(an); var e = ad(arguments, 1); return function ao() { return ap.dispatch("apply", [this, e.concat(ad(arguments))]) } }; P.prototype.fbind = function () { var ao = this; var e = ad(arguments); return function an() { return ao.dispatch("apply", [this, e.concat(ad(arguments))]) } }; n.keys = function (e) { return n(e).dispatch("keys", []) }; P.prototype.keys = function () { return this.dispatch("keys", []) }; n.all = z; function z(e) { return R(e, function (ap) { var ao = 0; var an = h(); c(ap, function (au, at, ar) { var aq; if (A(at) && (aq = at.inspect()).state === "fulfilled") { ap[ar] = aq.value } else { ++ao; R(at, function (av) { ap[ar] = av; if (--ao === 0) { an.resolve(ap) } }, an.reject, function (av) { an.notify({ index: ar, value: av }) }) } }, void 0); if (ao === 0) { an.resolve(ap) } return an.promise }) } P.prototype.all = function () { return z(this) }; n.allResolved = E(d, "allResolved", "allSettled"); function d(e) { return R(e, function (an) { an = b(an, n); return R(z(b(an, function (ao) { return R(ao, af, af) })), function () { return an }) }) } P.prototype.allResolved = function () { return d(this) }; n.allSettled = v; function v(e) { return n(e).allSettled() } P.prototype.allSettled = function () { return this.then(function (e) { return z(b(e, function (ao) { ao = n(ao); function an() { return ao.inspect() } return ao.then(an, an) })) }) }; n.fail = n["catch"] = function (e, an) { return n(e).then(void 0, an) }; P.prototype.fail = P.prototype["catch"] = function (e) { return this.then(void 0, e) }; n.progress = H; function H(e, an) { return n(e).then(void 0, void 0, an) } P.prototype.progress = function (e) { return this.then(void 0, void 0, e) }; n.fin = n["finally"] = function (e, an) { return n(e)["finally"](an) }; P.prototype.fin = P.prototype["finally"] = function (e) { e = n(e); return this.then(function (an) { return e.fcall().then(function () { return an }) }, function (an) { return e.fcall().then(function () { throw an }) }) }; n.done = function (ao, e, ap, an) { return n(ao).done(e, ap, an) }; P.prototype.done = function (e, ap, ao) { var an = function (ar) { n.nextTick(function () { o(ar, aq); if (n.onerror) { n.onerror(ar) } else { throw ar } }) }; var aq = e || ap || ao ? this.then(e, ap, ao) : this; if (typeof process === "object" && process && process.domain) { an = process.domain.bind(an) } aq.then(void 0, an) }; n.timeout = function (ao, an, e) { return n(ao).timeout(an, e) }; P.prototype.timeout = function (ao, an) { var e = h(); var ap = setTimeout(function () { if (!an || "string" === typeof an) { an = new Error(an || "Timed out after " + ao + " ms"); an.code = "ETIMEDOUT" } e.reject(an) }, ao); this.then(function (aq) { clearTimeout(ap); e.resolve(aq) }, function (aq) { clearTimeout(ap); e.reject(aq) }, e.notify); return e.promise }; n.delay = function (e, an) { if (an === void 0) { an = e; e = void 0 } return n(e).delay(an) }; P.prototype.delay = function (e) { return this.then(function (ao) { var an = h(); setTimeout(function () { an.resolve(ao) }, e); return an.promise }) }; n.nfapply = function (an, e) { return n(an).nfapply(e) }; P.prototype.nfapply = function (an) { var e = h(); var ao = ad(an); ao.push(e.makeNodeResolver()); this.fapply(ao).fail(e.reject); return e.promise }; n.nfcall = function (an) { var e = ad(arguments, 1); return n(an).nfapply(e) }; P.prototype.nfcall = function () { var an = ad(arguments); var e = h(); an.push(e.makeNodeResolver()); this.fapply(an).fail(e.reject); return e.promise }; n.nfbind = n.denodeify = function (an) { var e = ad(arguments, 1); return function () { var ap = e.concat(ad(arguments)); var ao = h(); ap.push(ao.makeNodeResolver()); n(an).fapply(ap).fail(ao.reject); return ao.promise } }; P.prototype.nfbind = P.prototype.denodeify = function () { var e = ad(arguments); e.unshift(this); return n.denodeify.apply(void 0, e) }; n.nbind = function (ao, e) { var an = ad(arguments, 2); return function () { var ar = an.concat(ad(arguments)); var ap = h(); ar.push(ap.makeNodeResolver()); function aq() { return ao.apply(e, arguments) } n(aq).fapply(ar).fail(ap.reject); return ap.promise } }; P.prototype.nbind = function () { var e = ad(arguments, 0); e.unshift(this); return n.nbind.apply(void 0, e) }; n.nmapply = n.npost = function (ao, an, e) { return n(ao).npost(an, e) }; P.prototype.nmapply = P.prototype.npost = function (ao, an) { var ap = ad(an || []); var e = h(); ap.push(e.makeNodeResolver()); this.dispatch("post", [ao, ap]).fail(e.reject); return e.promise }; n.nsend = n.nmcall = n.ninvoke = function (ao, an) { var ap = ad(arguments, 2); var e = h(); ap.push(e.makeNodeResolver()); n(ao).dispatch("post", [an, ap]).fail(e.reject); return e.promise }; P.prototype.nsend = P.prototype.nmcall = P.prototype.ninvoke = function (an) { var ao = ad(arguments, 1); var e = h(); ao.push(e.makeNodeResolver()); this.dispatch("post", [an, ao]).fail(e.reject); return e.promise }; n.nodeify = ag; function ag(an, e) { return n(an).nodeify(e) } P.prototype.nodeify = function (e) { if (e) { this.then(function (an) { n.nextTick(function () { e(null, an) }) }, function (an) { n.nextTick(function () { e(an) }) }) } else { return this } }; var u = Y(); return n }); (function (a) { a.fn.autogrow = function (b) { return this.filter("textarea").each(function () { var d = this; var g = a(d); var f = g.height(); var c = g.hasClass("autogrow-short") ? 0 : parseInt(g.css("lineHeight")) || 0; var e = a.extend({ preGrowCallback: null, postGrowCallback: null }, b); var j = a("<div></div>").css({ position: "absolute", top: -10000, left: -10000, width: g.width(), fontSize: g.css("fontSize"), fontFamily: g.css("fontFamily"), fontWeight: g.css("fontWeight"), lineHeight: g.css("lineHeight"), resize: "none", "word-wrap": "break-word" }).appendTo(document.body); var h = function (l) { var o = function (p, t) { for (var q = 0, s = ""; q < t; q++) { s += p } return s }; var n = d.value.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/\n$/, "<br/>&#xa0;").replace(/\n/g, "<br/>").replace(/ {2,}/g, function (p) { return o("&#xa0;", p.length - 1) + " " }); if (l && l.data && l.data.event === "keydown" && l.keyCode === 13) { n += "<br />" } j.css("width", g.width()); j.html(n + (c === 0 ? "..." : "")); var k = Math.max(j.height() + c, f); if (e.preGrowCallback != null) { k = e.preGrowCallback(g, j, k, f) } g.height(k); if (e.postGrowCallback != null) { e.postGrowCallback(g) } }; g.change(h).keyup(h).keydown({ event: "keydown" }, h); a(window).resize(h); h() }) } })(jQuery); (function (g) { function d() { var k = document.createElement("input"), a = "onpaste"; return k.setAttribute(a, ""), "function" == typeof k[a] ? "paste" : "input" } var j, b = d() + ".mask", f = navigator.userAgent, c = /iphone/i.test(f), h = /android/i.test(f); g.mask = { definitions: { 9: "[0-9]", a: "[A-Za-z]", "*": "[A-Za-z0-9]" }, dataName: "rawMaskFn", placeholder: "_" }, g.fn.extend({ caret: function (k, a) { var l; if (0 !== this.length && !this.is(":hidden")) { return "number" == typeof k ? (a = "number" == typeof a ? a : k, this.each(function () { this.setSelectionRange ? this.setSelectionRange(k, a) : this.createTextRange && (l = this.createTextRange(), l.collapse(!0), l.moveEnd("character", a), l.moveStart("character", k), l.select()) })) : (this[0].setSelectionRange ? (k = this[0].selectionStart, a = this[0].selectionEnd) : document.selection && document.selection.createRange && (l = document.selection.createRange(), k = 0 - l.duplicate().moveStart("character", -100000), a = k + l.text.length), { begin: k, end: a }) } }, unmask: function () { return this.trigger("unmask") }, mask: function (k, p) { var v, a, o, e, q, n; return !k && this.length > 0 ? (v = g(this[0]), v.data(g.mask.dataName)()) : (p = g.extend({ placeholder: g.mask.placeholder, completed: null }, p), a = g.mask.definitions, o = [], e = n = k.length, q = null, g.each(k.split(""), function (r, l) { "?" == l ? (n-- , e = r) : a[l] ? (o.push(RegExp(a[l])), null === q && (q = o.length - 1)) : o.push(null) }), this.trigger("unmask").each(function () { function A(x) { for (; n > ++x && !o[x];) { } return x } function z(x) { for (; --x >= 0 && !o[x];) { } return x } function r(F, y) { var G, x; if (!(0 > F)) { for (G = F, x = A(y); n > G; G++) { if (o[G]) { if (!(n > x && o[G].test(u[x]))) { break } u[G] = u[x], u[x] = p.placeholder, x = A(x) } } C(), D.caret(Math.max(q, F)) } } function l(G) { var F, H, x, y; for (F = G, H = p.placeholder; n > F; F++) { if (o[F]) { if (x = A(F), y = u[F], u[F] = H, !(n > x && o[x].test(y))) { break } H = y } } } function w(G) { var y, H, x, F = G.which; 8 === F || 46 === F || c && 127 === F ? (y = D.caret(), H = y.begin, x = y.end, 0 === x - H && (H = 46 !== F ? z(H) : x = A(H - 1), x = 46 === F ? A(x) : x), s(H, x), r(H, x - 1), G.preventDefault()) : 27 == F && (D.val(t), D.caret(0, B()), G.preventDefault()) } function E(H) { var I, y, G, x = H.which, F = D.caret(); H.ctrlKey || H.altKey || H.metaKey || 32 > x || x && (0 !== F.end - F.begin && (s(F.begin, F.end), r(F.begin, F.end - 1)), I = A(F.begin - 1), n > I && (y = String.fromCharCode(x), o[I].test(y) && (l(I), u[I] = y, C(), G = A(I), h ? setTimeout(g.proxy(g.fn.caret, D, G), 0) : D.caret(G), p.completed && G >= n && p.completed.call(D))), H.preventDefault()) } function s(y, x) { var F; for (F = y; x > F && n > F; F++) { o[F] && (u[F] = p.placeholder) } } function C() { D.val(u.join("")) } function B(G) { var F, H, x = D.val(), y = -1; for (F = 0, pos = 0; n > F; F++) { if (o[F]) { for (u[F] = p.placeholder; pos++ < x.length;) { if (H = x.charAt(pos - 1), o[F].test(H)) { u[F] = H, y = F; break } } if (pos > x.length) { break } } else { u[F] === x.charAt(pos) && F !== e && (pos++ , y = F) } } return G ? C() : e > y + 1 ? (D.val(""), s(0, n)) : (C(), D.val(D.val().substring(0, y + 1))), e ? F : q } var D = g(this), u = g.map(k.split(""), function (x) { return "?" != x ? a[x] ? p.placeholder : x : void 0 }), t = D.val(); D.data(g.mask.dataName, function () { return g.map(u, function (y, x) { return o[x] && y != p.placeholder ? y : null }).join("") }), D.attr("readonly") || D.one("unmask", function () { D.unbind(".mask").removeData(g.mask.dataName) }).bind("focus.mask", function () { clearTimeout(j); var x; t = D.val(), x = B(), j = setTimeout(function () { C(), x == k.length ? D.caret(0, x) : D.caret(x) }, 10) }).bind("blur.mask", function () { B(), D.val() != t && D.change() }).bind("keydown.mask", w).bind("keypress.mask", E).bind(b, function () { setTimeout(function () { var x = B(!0); D.caret(x), p.completed && x == D.val().length && p.completed.call(D) }, 0) }), B() })) } }) })(jQuery);
/*!
 * Card Check
 *
 * A credit card validator and type guesser
 *
 * This is the standalone version of CardCheck.
 * It uses the jQuery methods $.extend and $.inArray
 *
 * For documentation, look in the iconset you downloaded or go to
 * http://eclarian.com/cardcheck/
 *
 * NOTE: This is not open source software and you must purchase
 * a license to legally use.
 *
 * @uses       jQuery
 * @author     Eclarian Dev Team <eclarian@eclarian.com>
 * @copyright  Eclarian LLC
 * @date       November 29, 2011
 * @updated    March 20, 2013
 * @version    2.0.0
 */
(function (b, g) { if (b.CardCheck) { return } var f = { cardNumber: null, allowSpaces: true, acceptedCards: ["visa", "mastercard", "amex", "diners", "jcb", "maestro"], niceNames: { visa: "Visa", mastercard: "Mastercard", amex: "American Express", discover: "Discover", diners: "Diners Club", jcb: "JCB", maestro: "Maestro" }, regExpNumCheck: "^[0-9]+$", regExpApprox: { visa: "^4", mastercard: "^5[1-5]", amex: "^(34|37)", discover: "^6011", diners: "^(30|36|38|39)", jcb: "^35", maestro: "^(5018|5020|5038|6304|6759|6761|6762|6763)" }, startNum: { visa: ["4"], mastercard: ["5"], amex: ["3"], discover: ["6"], diners: ["3"], jcb: ["3", "2", "1"], maestro: ["5", "6"] }, cardLength: { visa: [13, 16], mastercard: [16], amex: [15], discover: [16], diners: [14], jcb: [15, 16], maestro: [12, 13, 14, 15, 16, 17, 18, 19] } }, d = function (h) { return Math.min.apply(Math, h) }, a = function (h) { return Math.max.apply(Math, h) }, e = function (h) { if (this instanceof e) { this._callbacks = {}; this._settings = {}; if (typeof h === "number" || typeof h === "string") { return this.options().cardNumber(h) } else { return this.options(h) } } else { return new e(h) } }; e.prototype = { _cardNumber: null, _cardType: null, _isValid: undefined, _numCheck: null, cardNumber: function (h) { if (typeof h === "undefined") { return this._cardNumber } h = h.toString(); if (this._settings.allowSpaces === true) { h = h.replace(/\s/g, "") } if (this._cardNumber === h) { return this } this._cardNumber = h; return this.evaluate() }, cardType: function (h) { if (!this._cardType) { return null } return h ? this._settings.niceNames[this._cardType] : this._cardType }, niceName: function (h) { return this._settings.niceNames[h] ? this._settings.niceNames[h] : "" }, eachCard: function (l) { for (var j = 0; j < this._settings.acceptedCards.length; j++) { var k = this._settings.acceptedCards[j], h = l(k); if (h === false) { return false } } return this }, evaluate: function () { if (!this._numCheck) { this._numCheck = new RegExp(this._settings.regExpNumCheck) } if (!this._cardNumber) { this._switchState(null) } else { if (!this._cardNumber.match(this._numCheck)) { this._switchState(false) } else { var h = this; this.eachCard(function (k) { if (h._cardNumber.length === 1 && k in h._settings.startNum) { if (h._cardNumber === "3" || h._cardNumber === "6") { h._switchState(null); return true } else { if (g.inArray(h._cardNumber, h._settings.startNum[k]) !== -1) { h._switchState(null, k); return false } } } else { if (h._cardNumber.length === 2 && (h._cardNumber === "60" || h._cardNumber === "65")) { h._switchState(null, "discover"); return false } } var o, j = false, n = false, l = false; if (k in h._settings.cardLength && g.inArray(h._cardNumber.length, h._settings.cardLength[k]) !== -1) { j = true } else { if (h._cardNumber.length >= a(h._settings.cardLength[k])) { j = true; n = true; l = (h._cardNumber.length > a(h._settings.cardLength[k])) } else { if (h._isValid === true) { h._delayState(null) } } } if (k in h._settings.regExpApprox) { o = new RegExp(h._settings.regExpApprox[k]); if (h._cardNumber.match(o)) { if (j === false) { h._switchState(null, k); return false } if (h.luhnCheck(h._cardNumber) === true && !l) { h._switchState(true, k) } else { if (n) { h._switchState(false, k) } else { if (h._cardNumber.length < d(h._settings.cardLength[k])) { h._switchState(null, k) } } } return false } } }) } } return this }, luhnCheck: function (j) { var k = [[0, 2, 4, 6, 8, 1, 3, 5, 7, 9], [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]], h = 0; j.replace(/\D+/g, "").replace(/[\d]/g, function (q, l, n) { h += k[(n.length - l) & 1][parseInt(q, 10)] }); return (h % 10 === 0) && (h > 0) }, options: function (j) { var h, k = false; j = j || {}; if (j.cardNumber) { h = j.cardNumber; k = true; delete j.cardNumber } this._settings = g.extend({}, f, j); if (k) { this.cardNumber(h) } return this }, onToggle: function (h) { return this._setCallback("onToggle", h) }, onValid: function (h) { return this._setCallback("onValid", h) }, onValidation: function (h) { return this.onValid(h) }, onInvalid: function (h) { return this._setCallback("onInvalid", h) }, onError: function (h) { return this.onInvalid(h) }, onUnknown: function (h) { return this._setCallback("onUnknown", h) }, onGuess: function (h) { if (typeof h !== "function") { return this } return this.onUnknown(function (j) { if (j) { h(j) } }) }, onReset: function (h) { if (typeof h !== "function") { return this } return this.onUnknown(function (j) { if (!j) { h() } }) }, onCardChange: function (h) { return this._setCallback("onCardChange", h) }, onTypeUpdate: function (h) { return this.onCardChange(h) }, _setCallback: function (h, j) { if (typeof j !== "function") { return this } if (!this._callbacks[h]) { this._callbacks[h] = [] } this._callbacks[h].push(j); return this }, _runCallbacks: function (l, h, k) { var n = this._callbacks[l]; if (!n || n.length === 0) { return this } h = h || null; k = k || this; for (var j = 0; j < n.length; j++) { n[j].apply(k, h) } return this }, _setCardType: function (h) { if (this._cardType !== h) { this._runCallbacks("onCardChange", [h, this.niceName(h)]) } this._cardType = h; return this }, _delayState: function (k, h) { var j = this; setTimeout(function () { if (k !== j._isValid) { j._switchState(k, h) } }, 50); return this }, _switchState: function (j, h) { if (typeof h === "undefined") { h = null } if (j === this._isValid && this._cardType === h) { return this } this._setCardType(h); this._isValid = j; if (j === true) { this._runCallbacks("onValid", [h, this.niceName(h)]) } else { if (j === false) { this._runCallbacks("onInvalid") } else { if (j === null) { this._runCallbacks("onUnknown", [h, this.niceName(h)]) } } } this._runCallbacks("onToggle", [j, h, this.niceName(h)]); return this } }; b.CardCheck = e; var c = function (j, k, h) { if (typeof h.enableIcons !== "undefined" && h.enableIcons !== true) { this.disabled = true } this.$el = j; this.uniqueClass = k; this.acceptedCards = h.acceptedCards; this.iconLocation = h.iconLocation ? g(h.iconLocation) : j.parent(); this.iconDir = h.iconDir ? h.iconDir : "images/"; this.iconExt = h.iconExt ? h.iconExt : "png"; this.iconClass = h.iconClass ? h.iconClass : "card-icons"; this.createIcons(); this.icons = g("." + this.iconClass + this.uniqueClass); return this }; c.prototype = { createIcons: function () { if (this.disabled) { return this } var h = this; g.each(h.acceptedCards, function (j, l) { h.iconLocation.append(g("<div>").attr("id", "card-" + l + h.uniqueClass).attr("class", "creditcard-" + l).addClass(h.iconClass + h.uniqueClass)) }); return this }, showOnly: function (h) { if (this.disabled) { return this } var j = this; this.hideExcept(h, function (k) { j.showCard(k) }); return this }, showCard: function (h) { g("#card-" + h + this.uniqueClass).css("opacity", 1); return this }, showAll: function () { if (this.disabled) { return this } this.icons.css("opacity", 1); return this }, hideExcept: function (j, h) { if (this.disabled) { return this } h = h || function () { }; this.icons.not("#card-" + j + this.uniqueClass).fadeTo("fast", 0.1, function () { h(j) }); return this }, hideAll: function () { if (this.disabled) { return this } this.icons.fadeTo("fast", 0.1); return this } }; g.cardcheck = function (k, r) { if (!b.CardCheckInstances) { b.CardCheckInstances = {} } if (typeof k === "object" && "input" in k) { r = k; k = r.input } r = r || {}; var q = g(k), h = new e(r), p = Math.floor(Math.random() * 1000), o = new c(q, p, h._settings), n = function (s) { this.event = s; this.run = function (t) { q.trigger("cc:" + this.event, t) }; return this }, l = ["onToggle", "onValid", "onValidation", "onInvalid", "onError", "onUnknown", "onGuess", "onReset", "onCardChange", "onTypeUpdate"]; q.addClass("cardcheck-instance-" + p).data("cardcheck-instance", p); if (!b.CardCheckInstances[p]) { b.CardCheckInstances[p] = h } for (var j = 0; j < l.length; j++) { (function (t) { if (h[t]) { var s = new n(t); h[t](function () { s.run(arguments) }); if (r[t]) { h[t](r[t]) } } })(l[j]) } h.onInvalid(function () { o.hideAll() }).onValid(function (s) { o.showOnly(s) }).onGuess(function (s) { o.showOnly(s) }).onReset(function () { o.showAll() }); q.on("keyup.cardcheck change.cardcheck", function () { h.cardNumber(g(this).val()) }); q.trigger("cc:initialized", [o]); return q }; g.fn.cardcheck = function (j) { if (g(this).data("cardcheck-instance")) { var h = b.CardCheckInstances[g(this).data("cardcheck-instance")]; if (j === "instance") { return h } else { if (j === "evaluate") { h.evaluate(); return g(this) } } } else { if (j === "instance" || j === "evaluate") { return g(this) } } return this.each(function () { if (g(this).data("cardcheck") !== true) { return g.cardcheck(this, j).data("cardcheck", true) } }) } })(window, jQuery); (function (a, b, c) { b(document).ready(function () { b(".input-datepicker").datepicker(); b(".date .dropdown-menu a").click(function () { switch (b(this).data("time-period")) { case "today": var l = new Date(); var e = new Date(); break; case "last30days": var l = new Date(); var e = new Date(); l.setDate(l.getDate() - 30); break; case "last3months": var l = new Date(); var e = new Date(); l.setMonth(l.getMonth() - 3); break; case "last6months": var l = new Date(); var e = new Date(); l.setMonth(l.getMonth() - 6); break; case "allTime": var l = new Date(2007, 4, 1); var e = new Date(); break }var g = l.getDate(); var k = l.getMonth() + 1; var h = l.getFullYear(); var f = e.getDate(); var d = e.getMonth() + 1; var j = e.getFullYear(); if (g < 10) { g = "0" + g } if (k < 10) { k = "0" + k } if (f < 10) { f = "0" + f } if (d < 10) { d = "0" + d } b("#start-date").val(h + "-" + k + "-" + g); b("#end-date").val(j + "-" + d + "-" + f); b(".input-datepicker").datepicker("update"); b(".input-datepicker").closest("form").submit(); b(this).closest(".open").removeClass("open"); return false }) }) })(window, window.jQuery); (function ($) { var useBSNns; if (useBSNns) { if (typeof (bsn) == "undefined") { bsn = {} } _bsn = bsn } else { _bsn = this } if (typeof (_bsn.Autosuggest) == "undefined") { _bsn.Autosuggest = {} } _bsn.AutoSuggest = function (fldID, param) { if (!document.getElementById) { return false } this.fld = _bsn.DOM.getElement(fldID); if (!this.fld) { return false } this.sInput = ""; this.nInputChars = 0; this.aSuggestions = []; this.iHighlighted = 0; this.oP = (param) ? param : {}; if (!this.oP.minchars) { this.oP.minchars = 2 } if (!this.oP.method) { this.oP.meth = "get" } if (!this.oP.varname) { this.oP.varname = "input" } if (!this.oP.className) { this.oP.className = "autosuggest" } if (!this.oP.timeout) { this.oP.timeout = 3000 } if (!this.oP.delay) { this.oP.delay = 0 } if (!this.oP.offsety) { this.oP.offsety = 0 } if (!this.oP.shownoresults) { this.oP.shownoresults = false } if (!this.oP.noresults) { this.oP.noresults = "Sorry, no tags match" } if (!this.oP.maxheight && this.oP.maxheight !== 0) { this.oP.maxheight = 12 } if (!this.oP.cache && this.oP.cache != false) { this.oP.cache = true } var pointer = this; this.fld.onkeypress = function (ev) { return pointer.onKeyPress(ev) }; this.fld.onkeyup = function (ev) { return pointer.onKeyUp(ev) }; this.fld.setAttribute("autocomplete", "off") }; _bsn.AutoSuggest.prototype.onKeyPress = function (ev) { var key = (window.event) ? window.event.keyCode : ev.keyCode; var RETURN = 13; var TAB = 9; var ESC = 27; var bubble = true; switch (key) { case RETURN: this.setHighlightedValue(); bubble = false; this.clearSuggestions(); $("input.autocomplete:focus").parents("form").submit(); break; case ESC: this.clearSuggestions(); break }return bubble }; _bsn.AutoSuggest.prototype.onKeyUp = function (ev) { var key = (window.event) ? window.event.keyCode : ev.keyCode; var ARRUP = 38; var ARRDN = 40; var bubble = true; switch (key) { case ARRUP: this.changeHighlight(key); bubble = false; break; case ARRDN: this.changeHighlight(key); bubble = false; break; default: this.getSuggestions(this.fld.value) }return bubble }; _bsn.AutoSuggest.prototype.getSuggestions = function (val) { if (val == this.sInput) { return false } if (val.length < this.oP.minchars) { this.sInput = ""; return false } if (val.length > this.nInputChars && this.aSuggestions.length && this.oP.cache) { var arr = []; for (var i = 0; i < this.aSuggestions.length; i++) { if (this.aSuggestions[i].value.substr(0, val.length).toLowerCase() == val.toLowerCase()) { arr.push(this.aSuggestions[i]) } } this.sInput = val; this.nInputChars = val.length; this.aSuggestions = arr; this.createList(this.aSuggestions); return false } else { this.sInput = val; this.nInputChars = val.length; var pointer = this; clearTimeout(this.ajID); this.ajID = setTimeout(function () { pointer.doAjaxRequest() }, this.oP.delay) } return false }; _bsn.AutoSuggest.prototype.doAjaxRequest = function () { var pointer = this; var url = this.oP.script + this.oP.varname + "=" + escape(this.fld.value); var meth = this.oP.meth; var onSuccessFunc = function (req) { pointer.setSuggestions(req) }; var onErrorFunc = function (status) { }; var myAjax = new _bsn.Ajax(); myAjax.makeRequest(url, meth, onSuccessFunc, onErrorFunc) }; _bsn.AutoSuggest.prototype.setSuggestions = function (req) { this.aSuggestions = []; if (this.oP.json) { var jsondata = eval("(" + req.responseText + ")"); for (var i = 0; i < jsondata.results.length; i++) { this.aSuggestions.push({ id: jsondata.results[i].id, value: jsondata.results[i].value, info: jsondata.results[i].info }) } } else { var xml = req.responseXML; try { var results = xml.getElementsByTagName("results")[0].childNodes; for (var i = 0; i < results.length; i++) { if (results[i].hasChildNodes()) { this.aSuggestions.push({ id: results[i].getAttribute("id"), value: results[i].childNodes[0].nodeValue, info: results[i].getAttribute("info") }) } } } catch (err) { } } this.idAs = "as_" + this.fld.id; this.createList(this.aSuggestions) }; _bsn.AutoSuggest.prototype.createList = function (arr) { var pointer = this; _bsn.DOM.removeElement(this.idAs); this.killTimeout(); var div = _bsn.DOM.createElement("div", { id: this.idAs, className: this.oP.className }); var hcorner = _bsn.DOM.createElement("div", { className: "as_corner" }); var hbar = _bsn.DOM.createElement("div", { className: "as_bar" }); var header = _bsn.DOM.createElement("div", { className: "as_header" }); header.appendChild(hcorner); header.appendChild(hbar); div.appendChild(header); var ul = _bsn.DOM.createElement("ul", { id: "as_ul" }); var length; if (arr.length > this.oP.maxheight) { length = this.oP.maxheight } else { length = arr.length } for (var i = 0; i < length; i++) { function safeHtml(val) { return val.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;") } var val = arr[i].value; var st = val.toLowerCase().indexOf(this.sInput.toLowerCase()); var output = safeHtml(val.substring(0, st)) + "<em>" + safeHtml(val.substring(st, st + this.sInput.length)) + "</em>" + safeHtml(val.substring(st + this.sInput.length)); var span = _bsn.DOM.createElement("span", {}, output, true); if (arr[i].info != "") { var br = _bsn.DOM.createElement("br", {}); span.appendChild(br); var small = _bsn.DOM.createElement("small", {}, arr[i].info); span.appendChild(small) } var a = _bsn.DOM.createElement("a", { href: "#" }); var tl = _bsn.DOM.createElement("span", { className: "tl" }, " "); var tr = _bsn.DOM.createElement("span", { className: "tr" }, " "); a.appendChild(tl); a.appendChild(tr); a.appendChild(span); a.name = i + 1; a.onclick = function () { pointer.setHighlightedValue(); return false }; a.onmouseover = function () { pointer.setHighlight(this.name) }; var li = _bsn.DOM.createElement("li", {}, a); ul.appendChild(li) } if (arr.length == 0) { var li = _bsn.DOM.createElement("li", { className: "as_warning" }, this.oP.noresults); ul.appendChild(li) } div.appendChild(ul); var fcorner = _bsn.DOM.createElement("div", { className: "as_corner" }); var fbar = _bsn.DOM.createElement("div", { className: "as_bar" }); var footer = _bsn.DOM.createElement("div", { className: "as_footer" }); footer.appendChild(fcorner); footer.appendChild(fbar); div.appendChild(footer); var pos = _bsn.DOM.getPos(this.fld); div.style.left = pos.x + "px"; div.style.top = (pos.y + this.fld.offsetHeight + this.oP.offsety) + "px"; div.style.width = this.fld.offsetWidth + "px"; div.onmouseover = function () { pointer.killTimeout() }; div.onmouseout = function () { pointer.resetTimeout() }; document.getElementsByTagName("body")[0].appendChild(div); this.iHighlighted = 0; var pointer = this; this.toID = setTimeout(function () { pointer.clearSuggestions() }, this.oP.timeout) }; _bsn.AutoSuggest.prototype.changeHighlight = function (key) { var list = _bsn.DOM.getElement("as_ul"); if (!list) { return false } var n; if (key == 40) { n = this.iHighlighted + 1 } else { if (key == 38) { n = this.iHighlighted - 1 } } if (n > list.childNodes.length) { n = list.childNodes.length } if (n < 1) { n = 1 } this.setHighlight(n) }; _bsn.AutoSuggest.prototype.setHighlight = function (n) { var list = _bsn.DOM.getElement("as_ul"); if (!list) { return false } if (this.iHighlighted > 0) { this.clearHighlight() } this.iHighlighted = Number(n); list.childNodes[this.iHighlighted - 1].className = "as_highlight"; this.killTimeout() }; _bsn.AutoSuggest.prototype.clearHighlight = function () { var list = _bsn.DOM.getElement("as_ul"); if (!list) { return false } if (this.iHighlighted > 0) { list.childNodes[this.iHighlighted - 1].className = ""; this.iHighlighted = 0 } }; _bsn.AutoSuggest.prototype.setHighlightedValue = function () { if (this.iHighlighted) { this.sInput = this.fld.value = this.aSuggestions[this.iHighlighted - 1].value; this.fld.focus(); if (this.fld.selectionStart) { this.fld.setSelectionRange(this.sInput.length, this.sInput.length) } this.clearSuggestions(); if (typeof (this.oP.callback) == "function") { this.oP.callback(this.aSuggestions[this.iHighlighted - 1]) } } }; _bsn.AutoSuggest.prototype.killTimeout = function () { clearTimeout(this.toID) }; _bsn.AutoSuggest.prototype.resetTimeout = function () { clearTimeout(this.toID); var pointer = this; this.toID = setTimeout(function () { pointer.clearSuggestions() }, 1000) }; _bsn.AutoSuggest.prototype.clearSuggestions = function () { this.killTimeout(); var ele = _bsn.DOM.getElement(this.idAs); var pointer = this; if (ele) { var fade = new _bsn.Fader(ele, 1, 0, 250, function () { _bsn.DOM.removeElement(pointer.idAs) }) } }; if (typeof (_bsn.Ajax) == "undefined") { _bsn.Ajax = {} } _bsn.Ajax = function () { this.req = {}; this.isIE = false }; _bsn.Ajax.prototype.makeRequest = function (url, meth, onComp, onErr) { if (meth != "POST") { meth = "GET" } this.onComplete = onComp; this.onError = onErr; var pointer = this; if (window.XMLHttpRequest) { this.req = new XMLHttpRequest(); this.req.onreadystatechange = function () { pointer.processReqChange() }; this.req.open("GET", url, true); this.req.send(null) } else { if (window.ActiveXObject) { this.req = new ActiveXObject("Microsoft.XMLHTTP"); if (this.req) { this.req.onreadystatechange = function () { pointer.processReqChange() }; this.req.open(meth, url, true); this.req.send() } } } }; _bsn.Ajax.prototype.processReqChange = function () { if (this.req.readyState == 4) { if (this.req.status == 200) { this.onComplete(this.req) } else { this.onError(this.req.status) } } }; if (typeof (_bsn.DOM) == "undefined") { _bsn.DOM = {} } _bsn.DOM.createElement = function (type, attr, cont, html) { var ne = document.createElement(type); if (!ne) { return false } for (var a in attr) { ne[a] = attr[a] } if (typeof (cont) == "string" && !html) { ne.appendChild(document.createTextNode(cont)) } else { if (typeof (cont) == "string" && html) { ne.innerHTML = cont } else { if (typeof (cont) == "object") { ne.appendChild(cont) } } } return ne }; _bsn.DOM.clearElement = function (id) { var ele = this.getElement(id); if (!ele) { return false } while (ele.childNodes.length) { ele.removeChild(ele.childNodes[0]) } return true }; _bsn.DOM.removeElement = function (ele) { var e = this.getElement(ele); if (!e) { return false } else { if (e.parentNode.removeChild(e)) { return true } else { return false } } }; _bsn.DOM.replaceContent = function (id, cont, html) { var ele = this.getElement(id); if (!ele) { return false } this.clearElement(ele); if (typeof (cont) == "string" && !html) { ele.appendChild(document.createTextNode(cont)) } else { if (typeof (cont) == "string" && html) { ele.innerHTML = cont } else { if (typeof (cont) == "object") { ele.appendChild(cont) } } } }; _bsn.DOM.getElement = function (ele) { if (typeof (ele) == "undefined") { return false } else { if (typeof (ele) == "string") { var re = document.getElementById(ele); if (!re) { return false } else { if (typeof (re.appendChild) != "undefined") { return re } else { return false } } } else { if (typeof (ele.appendChild) != "undefined") { return ele } else { return false } } } }; _bsn.DOM.appendChildren = function (id, arr) { var ele = this.getElement(id); if (!ele) { return false } if (typeof (arr) != "object") { return false } for (var i = 0; i < arr.length; i++) { var cont = arr[i]; if (typeof (cont) == "string") { ele.appendChild(document.createTextNode(cont)) } else { if (typeof (cont) == "object") { ele.appendChild(cont) } } } }; _bsn.DOM.getPos = function (ele) { var ele = this.getElement(ele); var obj = ele; var curleft = 0; if (obj.offsetParent) { while (obj.offsetParent) { curleft += obj.offsetLeft; obj = obj.offsetParent } } else { if (obj.x) { curleft += obj.x } } var obj = ele; var curtop = 0; if (obj.offsetParent) { while (obj.offsetParent) { curtop += obj.offsetTop; obj = obj.offsetParent } } else { if (obj.y) { curtop += obj.y } } return { x: curleft, y: curtop } }; if (typeof (_bsn.Fader) == "undefined") { _bsn.Fader = {} } _bsn.Fader = function (ele, from, to, fadetime, callback) { if (!ele) { return false } this.ele = ele; this.from = from; this.to = to; this.callback = callback; this.nDur = fadetime; this.nInt = 50; this.nTime = 0; var p = this; this.nID = setInterval(function () { p._fade() }, this.nInt) }; _bsn.Fader.prototype._fade = function () { this.nTime += this.nInt; var ieop = Math.round(this._tween(this.nTime, this.from, this.to, this.nDur) * 100); var op = ieop / 100; if (this.ele.filters) { try { this.ele.filters.item("DXImageTransform.Microsoft.Alpha").opacity = ieop } catch (e) { this.ele.style.filter = "progid:DXImageTransform.Microsoft.Alpha(opacity=" + ieop + ")" } } else { this.ele.style.opacity = op } if (this.nTime == this.nDur) { clearInterval(this.nID); if (this.callback != undefined) { this.callback() } } }; _bsn.Fader.prototype._tween = function (t, b, c, d) { return b + ((c - b) * (t / d)) } })(jQuery);
/*! http://mths.be/placeholder v2.0.7 by @mathias */
; (function (s, q, o) { var x = "placeholder" in q.createElement("input"), u = "placeholder" in q.createElement("textarea"), p = o.fn, v = o.valHooks, l, n; if (x && u) { n = p.placeholder = function () { return this }; n.input = n.textarea = true } else { n = p.placeholder = function () { var a = this; a.filter((x ? "textarea" : ":input") + "[placeholder]").not(".placeholder").bind({ "focus.placeholder": w, "blur.placeholder": t }).data("placeholder-enabled", true).trigger("blur.placeholder"); return a }; n.input = x; n.textarea = u; l = { get: function (a) { var b = o(a); return b.data("placeholder-enabled") && b.hasClass("placeholder") ? "" : a.value }, set: function (a, c) { var b = o(a); if (!b.data("placeholder-enabled")) { return a.value = c } if (c == "") { a.value = c; if (a != q.activeElement) { t.call(a) } } else { if (b.hasClass("placeholder")) { w.call(a, true, c) || (a.value = c) } else { a.value = c } } return b } }; x || (v.input = l); u || (v.textarea = l); o(function () { o(q).delegate("form", "submit.placeholder", function () { var a = o(".placeholder", this).each(w); setTimeout(function () { a.each(t) }, 10) }) }); o(s).bind("beforeunload.placeholder", function () { o(".placeholder").each(function () { this.value = "" }) }) } function r(a) { var b = {}, c = /^jQuery\d+$/; o.each(a.attributes, function (d, e) { if (e.specified && !c.test(e.name)) { b[e.name] = e.value } }); return b } function w(a, d) { var b = this, c = o(b); if (b.value == c.attr("placeholder") && c.hasClass("placeholder")) { if (c.data("placeholder-password")) { c = c.hide().next().show().attr("id", c.removeAttr("id").data("placeholder-id")); if (a === true) { return c[0].value = d } c.focus() } else { b.value = ""; c.removeClass("placeholder"); b == q.activeElement && b.select() } } } function t() { var c, b = this, d = o(b), a = d, e = this.id; if (b.value == "") { if (b.type == "password") { if (!d.data("placeholder-textinput")) { try { c = d.clone().attr({ type: "text" }) } catch (f) { c = o("<input>").attr(o.extend(r(this), { type: "text" })) } c.removeAttr("name").data({ "placeholder-password": true, "placeholder-id": e }).bind("focus.placeholder", w); d.data({ "placeholder-textinput": c, "placeholder-id": e }).before(c) } d = d.removeAttr("id").hide().prev().attr("id", e).show() } d.addClass("placeholder"); d[0].value = d.attr("placeholder") } else { d.removeClass("placeholder") } } }(this, document, jQuery)); (function (a) { a.fn.shuffle = function () { return this.each(function () { var b = a(this).children().clone(true); return (b.length) ? a(this).html(a.shuffle(b)) : this }) }; a.shuffle = function (c) { for (var d, b, e = c.length; e; d = parseInt(Math.random() * e), b = c[--e], c[e] = c[d], c[d] = b) { } return c } })(jQuery); (function (a, b, c) { b(document).ready(function () { b(".js-sticky").sticky({ topSpacing: 60, className: "is-js-sticky", wrapperClassName: "js-sticky-wrapper" }) }) })(window, window.jQuery); (function (a, b, d) { b(a.document).ready(function () { b("table.table-actions input#checkall").change(function () { if (b(this).attr("checked")) { b("table.table-actions input:checkbox").attr("checked", true); b("table.table-actions tr").addClass("selected") } else { b("table.table-actions input:checkbox").attr("checked", false); b("table.table-actions tr").removeClass("selected") } c() }); b("table.table-actions input:checkbox:not(#checkall)").change(function () { if (b(this).is(":checked")) { b(this).parent().parent().addClass("selected") } else { b(this).parent().parent().removeClass("selected") } c() }) }); function c() { var e = b("table.table-actions input[type=checkbox]:not(#checkall):checked").size(); if (e == 0) { b("div.table-actions label").html("No elements selected."); b("div.table-actions button").attr("disabled", "disabled") } else { b("div.table-actions label").html(e + " element" + (e == 1 ? "" : "s") + " selected."); b("div.table-actions button").removeAttr("disabled") } } b.fn.tableAction = function (e) { return this.each(function () { b(this).click(function (f) { f.preventDefault(); var g = []; b("input[type=checkbox]:not(#checkall):checked").each(function () { g.push(b(this).attr("data-id")) }); if (g.length) { e(g) } return false }) }) } })(window, window.jQuery); (function (b, a, c, e) { function d(f) { f.addClass("pulsate"); setTimeout(function () { f.removeClass("pulsate") }, 1800) } c(a).on("click", ".js-icon-favorite", function (j) { j.preventDefault(); if (!b.USER) { nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: function () { location.reload() } })); return false } var k = c(this), f = k.closest(".icon"), g = f.attr("data-icon-id"), h = f.hasClass("favorited"); if (h) { f.removeClass("favorited"); c.pnotify({ pnotify_notice_icon: "", pnotify_delay: 2000, pnotify_history: false, pnotify_title: "Favorite removed", pnotify_text: "This icon is no longer visible under favorites." }); Nextfinder.tracking.trackEvent("Icon", "Favorite removed") } else { f.addClass("favorited"); c.pnotify({ pnotify_notice_icon: "", pnotify_delay: 2000, pnotify_history: false, pnotify_title: "Favorite saved", pnotify_text: 'You can find favorited icons under "Favorites"' }); d(c(".navbar-item.menuitem-favorites .icon")); Nextfinder.tracking.trackEvent("Icon", "Favorite") } c.ajax({ type: "POST", url: "/icons/" + g + (h ? "/unfavorite" : "/favorite"), dataType: "json", success: function (n, l, p, o) { }, error: function (n, l, p, o) { c.pnotify({ pnotify_notice_icon: "", pnotify_delay: 2000, pnotify_history: false, pnotify_title: "Failed to favorite icon", pnotify_text: "Something went wrong while trying to favorite the icon." }) } }); return false }); c(a).on("click", ".downloadlink", function (h) { var k = c(this), j = k.data("format"), g = k.attr("data-icon-id"); function f() { c.pnotify({ pnotify_notice_icon: "", pnotify_delay: 3000, pnotify_history: false, pnotify_title: "Downloading icon", pnotify_text: "Remember to check license information before using downloaded icons." }); d(c(".navbar-item.menuitem-downloads .icon")); Nextfinder.tracking.trackEvent("Icon", "Download", j.toLowerCase()) } Nextfinder.transport.get({ url: "/icons/" + g + "/check-download/" + j, success: function () { f(); location.href = k.attr("href") }, error: function (l, n) { if (l == "download_limit_reached") { nfx.app.modalStackController.present(new nfx.modules.DownloadLimitReachedModalModule({ downloadLimit: n.download_limit, dateResets: n.date_resets, isPerceptuallyUnlimited: n.is_perceptually_unlimited })) } else { if (l == "registration_required") { Nextfinder.tracking.trackEvent("User", "Free download limit", "Limit reached"); nfx.app.modalStackController.present(new nfx.modules.FreeDownloadPromptModalModule({ onAuthenticate: function () { location.reload() } })) } else { if (l == "pro_subscription_required") { Nextfinder.tracking.trackEvent("User", "Pro subscription required", j); nfx.app.modalStackController.present(new nfx.modules.FormatIsProOnlyPromptModalModule()) } else { nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", "Sorry, but it seems like something went wrong while trying to get the icon for you. Please try again or reload the page.") } } } } }); return false }); c(a).on("mouseenter", ".icon", function () { c(this).children(".btn").addClass("btn-primary") }); c(a).on("mouseleave", ".icon", function () { c(this).children(".btn").removeClass("btn-primary") }); c(a).on("click", '[data-action="buy-icon"]', function () { var f = c(this).closest(".icon"), g = c(this).attr("data-icon-id"); b.Nextfinder.commerce.purchase({ asset: { identifier: "icon", primary_key: g }, success: function () { var h = f.find("img"); h.attr("src", h.attr("data-private-src")); f.find('[data-action="buy-icon"]').remove(); f.find(".iconlinks").show(); f.addClass("purchased") } }); Nextfinder.tracking.trackEvent("Commerce", "Click to buy", "Icon", g, { icon_id: parseInt(g, 10) }) }); c(a).on("click", '[data-action="buy-iconset"]', function () { var j = c(this).attr("data-iconset-id"), f = c(this).attr("data-iconset-identifier"), g = (c(this).attr("data-reload-after-purchase") == "true"), h = (c(this).attr("data-redirect-after-purchase") == "true"); b.Nextfinder.commerce.purchase({ asset: { identifier: "package", primary_key: j }, success: function () { if (g) { location.reload(); return } else { if (h) { location.href = "/search/?q=iconset%3A" + escape(f); return } } c('.icon[data-iconset-id="' + j + '"]').each(function () { var k = c(this), l = k.find("img"); l.attr("src", l.attr("data-private-src")); k.find('[data-action="buy-icon"]').remove(); k.find(".iconlinks").show() }) } }); Nextfinder.tracking.trackEvent("Commerce", "Click to buy", "Icon set") }); c(a).on("click", "a.iconlink", function () { Nextfinder.tracking.trackEvent("Icon", "Click link") }); c(a).on("click", '[data-action="get-base64"]', function (f) { Nextfinder.icons.getBase64(this); f.preventDefault(); return false }); c(a).ready(function () { c(".largersize").hover(function () { id = c(this).attr("id").replace(/largersize-/, ""); obj = c("#hiddenicon-" + id); obj.show() }, function () { obj.hide() }) }) })(window, window.document, window.jQuery); (function (a, b, c) { b.fn.createModal = function (d) { var h = { id: c, title: "", action: "submit", actionLabel: "OK", cancelLabel: "Cancel", backdrop: true }; var e = b.extend({}, h, d); var g = (e.content !== c ? e.content : Handlebars.templates[e.template](e.context)); var f = b("<div" + (e.id !== c ? ' id="' + e.id + '"' : "") + ' class="modal hide" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"><div class="modal-header">' + (e.cancelLabel !== null ? '<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>' : "") + '<h1 id="myModalLabel">' + e.title + '</h1></div><div class="modal-body">' + g + '</div><div class="modal-footer">' + ((e.action !== c) && (e.action !== null) ? '<button class="btn btn-large btn-primary" data-action="' + e.action + '">' + e.actionLabel + "</button>" : "") + (e.cancelLabel !== null ? '<button class="btn btn-large" data-dismiss="modal" aria-hidden="true">' + e.cancelLabel + "</button>" : "") + "</div></div>"); f.appendTo(this); f.modal({ canHide: e.canHide, backdrop: e.backdrop }).on("hidden", function () { f.remove() }); if (e.hide !== c) { f.on("hide", e.hide) } return f }; b.fn.createFormModal = function (e, k) { var d = this; var j = { canHide: function () { return (!modalLocked) }, action: "submit" }; var f = b.extend({}, j, e); var h = b("body").createModal(e); var g = h.find("form"); g.ajaxifyForm({ beforeSubmit: function () { }, error: function () { }, success: function (l) { modalLocked = false; h.modal("hide"); k(l) } }); h.find('[data-action="submit"]').click(function () { g.submit() }); return h } })(window, window.jQuery); (function (b, a, c, d) { c(a).ready(function () { c(a).on("click", ".login-link", function () { nfx.app.modalStackController.present(new nfx.modules.LogInModalModule({ onAuthenticate: function () { location.reload() } })); return false }); c(a).on("click", ".signup-link", function () { nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: function () { location.reload() } })); return false }); c(a).on("click", 'a[data-require-user="true"]', function () { var e = c(this); nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: function () { location.href = e.attr("href") } })); return false }) }) })(window, window.document, window.jQuery); (function (b, a, c, d) { c(a).on("click", '[data-remote="true"]', function (h) { h.preventDefault(); var g = c(this); var k = g.data("method") || "post"; var f = g.data("confirm"); var e = g.data("location-on-success"); var j = ((g.data("reload-on-success")) || ((g.data("reload-on-success") == d) && (!e))); if (g.data("confirm") && !confirm(g.data("confirm"))) { return false } if (g.data("prompt") && prompt(g.data("prompt")) !== g.data("answer")) { return false } b.Nextfinder.transport.request({ method: k, url: g.attr("href"), success: function () { if (e) { location.href = e } else { if (j) { location.reload() } } }, error: function (l, n) { alert("An error occured") } }) }) })(window, window.document, window.jQuery); (function (a, b, c) { b.fn.ajaxifyForm = function (e) { var d = this; var h = {}; var f = b.extend({}, h, e); function j(o, s, l) { if (o.status == "success") { if (f.success) { f.success(o) } return } if (o.status != "error") { return } d.find("[name]").parent("span").removeClass("form-field-error"); d.find("ul.form-error-list").remove(); for (var k in o.errors) { var r = o.errors[k]; if (r.length == 0) { continue } var p = d.find('[name="' + k + '"]').parent("span").addClass("form-field-error"); if (p.length > 0) { var q = b('<ul class="form-error-list"></ul>'); for (var n in r) { q.append(b("<li />").html(r[n])) } q.insertAfter(p) } } if (f.error) { f.error(o.errors) } } function g() { if (f.error) { f.error() } } this.submit(function () { if (f.beforeSubmit) { f.beforeSubmit() } data = {}; d.find("[name]").each(function () { var l = b(this), k = l.attr("type"); if ((k != "checkbox") || (l.is(":checked"))) { data[l.attr("name")] = l.val() } }); b.ajax({ type: d.attr("method"), url: d.attr("action"), data: data, success: j, error: g }); return false }); return this } })(window, window.jQuery); (function (b, a, c, d) { c(a).on("click", "[mission-control-panel]", function (e) { e.preventDefault(); c.ajax({ type: "GET", url: "/missioncontrol/" + c(this).attr("mission-control-panel") + "/" + c(this).attr("mission-control-command"), dataType: "json", success: function (f) { if (f.reload === true) { location.reload() } }, error: function () { c.pnotify({ pnotify_notice_icon: "", pnotify_delay: 2000, pnotify_history: false, pnotify_title: "Houston, we have a problem!", pnotify_text: "Something went wrong while talking to mission control." }) } }) }); c(a).on("click", '[data-action="missioncontrol-inspect-performance"]', function (e) { e.preventDefault(); var f = c('<div class="missioncontrol-inspector"></div>').appendTo("body"); m.module(f[0], new nfx.modules.PerformanceInspectorModule({ queries: b.MISSIONCONTROL_DATABASE_QUERIES, cacheAccess: b.MISSIONCONTROL_CACHE_ACCESS })); c(a).on("keyup", function (g) { if (g.which == 27) { f.remove() } }) }) })(window, window.document, window.jQuery); (function (b, a, c, d) { c.fn.overlay = function (e) { return c('<div class="page-overlay"></div>').appendTo(this) }; c.fn.overlayLoader = function (g) { var h = c(this), e = (h.hasClass("page-overlay") ? h : h.overlay()); e.html('<h1 class="loader"><span class="spinner"></span>' + g + "</h1>"); var f = new Spinner({ lines: 13, length: 4, width: 3, radius: 6, corners: 1, rotate: 0, color: "#ffffff", speed: 1, trail: 60, shadow: false, hwaccel: true, className: "spinner", zIndex: 2000000000, top: "auto", left: "0" }).spin(e.find("span.spinner")[0]); return e } })(window, window.document, window.jQuery); (function (b, a, c, d) { c(a).ready(function () { c('[data-toggle="tooltip"]').tooltip() }) })(window, window.document, window.jQuery); function latest_blog_post() { var a = "http://blog.iconfinder.com/feed/"; var c = "helpers/templates/latest_post.html"; var b = new google.feeds.Feed(a); b.load(function (d) { if (!d.error) { var h = d.feed.entries[0]; var g = h.content; var e = { title: h.title, link: h.link, author: h.author }; var f = Handlebars.templates[c](e); $("#latest-post").html(f) } }) } (function (a, b, c) { b(document).on("focus", "input.error", function () { b("label.error").hide(); b(this).siblings("label.error").show() }); b(document).on("blur", "input.error", function () { b(this).siblings("label.error:visible").hide() }) })(window, window.jQuery); function decodeQueryParameters(a) { return (function (d) { if (d == "") { return {} } var c = {}; for (var e = 0; e < d.length; ++e) { var f = d[e].split("="); if (f.length != 2) { continue } c[f[0]] = decodeURIComponent(f[1].replace(/\+/g, " ")) } return c })(a.split("&")) } function getQueryParameters() { return decodeQueryParameters(window.location.search.substr(1)) } $(document).on("click", 'button[data-action="toggle-follow-user"]', function (c) { c.preventDefault(); var a = $(this), d = a.attr("data-username"), b = (a.attr("data-following") === "true"); if (!d) { return } if (!window.USER) { nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: function () { location.reload() } })); return } a.toggleClass("following", false); Nextfinder.transport.post({ url: "/profiles/ajax/" + d + (b ? "/unfollow" : "/follow"), success: function () { a.toggleClass("following", !b); a.html(!b ? '<i data-icon="L" class="icon"></i>Following' : '<i data-icon="J" class="icon"></i>Follow'); a.attr("data-following", (!b ? "true" : "false")) } }) }); (function (b, a, c, d) { c(a).on("click", '[data-action="mailing-list-subscribe"]', function (e) { e.preventDefault(); var f = parseInt(c(this).attr("data-mailing-list-id"), 10); nfx.app.modalStackController.present(new nfx.modules.MailingListSubscribeModalModule({ mailingListId: f })) }) })(window, window.document, window.jQuery); (function (a, b) { a.Nextfinder = {} })(window); (function (b, a, c, d) { var e = { loadModule: function (g, f) { var j = b.Nextfinder, f = (f === d ? "init" : f); if (g === "") { return } if (!j[g]) { return } var h = j[g][f]; if (!h) { return } if (h.create) { return h.create() } else { h() } }, load: function () { var f = a.body, h = f.getAttribute("data-application"), g = f.getAttribute("data-view"); b.Nextfinder.currentApplication = e.loadModule(h); b.Nextfinder.currentView = e.loadModule(h, g) } }; c(a).ready(e.load) })(window, window.document, window.jQuery); var Base64 = { _keyStr: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=", encode: function (c) { var a = ""; var k, h, f, j, g, e, d; var b = 0; c = Base64._utf8_encode(c); while (b < c.length) { k = c.charCodeAt(b++); h = c.charCodeAt(b++); f = c.charCodeAt(b++); j = k >> 2; g = ((k & 3) << 4) | (h >> 4); e = ((h & 15) << 2) | (f >> 6); d = f & 63; if (isNaN(h)) { e = d = 64 } else { if (isNaN(f)) { d = 64 } } a = a + this._keyStr.charAt(j) + this._keyStr.charAt(g) + this._keyStr.charAt(e) + this._keyStr.charAt(d) } return a }, _utf8_encode: function (b) { b = b.replace(/\r\n/g, "\n"); var a = ""; for (var e = 0; e < b.length; e++) { var d = b.charCodeAt(e); if (d < 128) { a += String.fromCharCode(d) } else { if ((d > 127) && (d < 2048)) { a += String.fromCharCode((d >> 6) | 192); a += String.fromCharCode((d & 63) | 128) } else { a += String.fromCharCode((d >> 12) | 224); a += String.fromCharCode(((d >> 6) & 63) | 128); a += String.fromCharCode((d & 63) | 128) } } } return a } }; (function (b, d) { var a = b.Nextfinder; a.Class = function () { }; var c = function () { var e = new this(); if (e.init) { e.init.apply(e, arguments) } return e }; a.Class.extend = function (h) { var j = this.prototype; var g = new this(); for (var f in h) { var k = h[f]; g[f] = ((typeof (k) == "function") && (typeof (j[f]) == "function") ? (function (n, l) { return function () { var p = this._super; this._super = j[n]; var o = l.apply(this, arguments); this._super = p; return o } })(f, k) : k) } function e() { } e.prototype = g; e.extend = arguments.callee; e.create = c; return e } })(window); (function (a, d, b, c) { d.formatting = { formatMoney: function (h, p, l, g) { var o = h, p = isNaN(p = Math.abs(p)) ? 2 : p, l = l == c ? "." : l, g = g == c ? "," : g, k = o < 0 ? "-" : "", f = parseInt(o = Math.abs(+o || 0).toFixed(p)) + "", e = (e = f.length) > 3 ? e % 3 : 0; return k + (e ? f.substr(0, e) + g : "") + f.substr(e).replace(/(\d{3})(?=\d)/g, "$1" + g) + (p ? l + Math.abs(o - f).toFixed(p).slice(2) : "") }, formatDate: function (f) { var g = new Date(f); var e = g.getDate(); var k = "January,February,March,April,May,June,July,August,September,October,November,December".split(",")[g.getMonth()]; var h = g.getFullYear(); function j(l) { if (l > 3 && l < 21) { return "th" } switch (l % 10) { case 1: return "st"; case 2: return "nd"; case 3: return "rd"; default: return "th" } } return k + " " + e + j(g) + ", " + h }, formatInt: function (h, g) { var o = h, l = isNaN(l = Math.abs(l)) ? 2 : l, g = g == c ? "," : g, k = o < 0 ? "-" : "", f = parseInt(o = Math.abs(+o || 0).toFixed(l)) + "", e = (e = f.length) > 3 ? e % 3 : 0; return k + (e ? f.substr(0, e) + g : "") + f.substr(e).replace(/(\d{3})(?=\d)/g, "$1" + g) } } })(window, window.Nextfinder, window.jQuery); Handlebars.registerHelper("format_size", function (a) { if (a < 1000) { return a + " B" } var c, b; if (a >= 1073741824) { c = 1073741824; b = "GiB" } else { if (a > 1048576) { c = 1048576; b = "MiB" } else { c = 1024; b = "KiB" } } return (parseFloat(a) / c).toPrecision(3) + " " + b }); Handlebars.registerHelper("percentage", function (a, b) { return parseInt(parseFloat(a) * 100 / parseFloat(b), 10) }); Handlebars.registerHelper("format_money", Nextfinder.formatting.formatMoney); Handlebars.registerHelper("verbal_join", function (a) { if (a.length == 0) { return "" } if (a.length == 1) { return a[0] } return a.slice(0, a.length - 1).join(", ") + " and " + a[a.length - 1] }); Handlebars.registerHelper("country_options", function (c) { var a = [["US", "United States of America"], ["AD", "Andorra"], ["AF", "Afghanistan"], ["DZ", "Algeria"], ["AG", "Antigua and Barbuda"], ["AI", "Anguilla"], ["AL", "Albania"], ["AM", "Armenia"], ["AO", "Angola"], ["AQ", "Antarctica"], ["AR", "Argentina"], ["AS", "American Samoa"], ["AT", "Austria"], ["AU", "Australia"], ["AW", "Aruba"], ["AX", "Åland Islands"], ["AZ", "Azerbaijan"], ["BA", "Bosnia and Herzegovina"], ["BB", "Barbados"], ["BD", "Bangladesh"], ["BE", "Belgium"], ["BF", "Burkina Faso"], ["BG", "Bulgaria"], ["BH", "Bahrain"], ["BI", "Burundi"], ["BJ", "Benin"], ["BM", "Bermuda"], ["BN", "Brunei Darussalam"], ["BO", "Bolivia, Plurinational State of"], ["BQ", "Bonaire, Sint Eustatius and Saba"], ["BR", "Brazil"], ["BS", "Bahamas"], ["BT", "Bhutan"], ["BV", "Bouvet Island"], ["BW", "Botswana"], ["BY", "Belarus"], ["BZ", "Belize"], ["CA", "Canada"], ["CM", "Cameroon"], ["CV", "Cape Verde"], ["KY", "Cayman Islands"], ["TD", "Chad"], ["CL", "Chile"], ["CN", "China"], ["CX", "Christmas Island"], ["CC", "Cocos (Keeling) Islands"], ["CD", "Congo, the Democratic Republic of the"], ["CF", "Central African Republic"], ["CG", "Congo"], ["CI", "Côte d&#39;Ivoire"], ["CK", "Cook Islands"], ["CO", "Colombia"], ["CR", "Costa Rica"], ["CU", "Cuba"], ["CW", "Curaçao"], ["CY", "Cyprus"], ["CZ", "Czech Republic"], ["DJ", "Djibouti"], ["DK", "Denmark"], ["DM", "Dominica"], ["DO", "Dominican Republic"], ["EC", "Ecuador"], ["SV", "El Salvador"], ["AE", "Emirates, United Arab"], ["EE", "Estonia"], ["EG", "Egypt"], ["GQ", "Equatorial Guinea"], ["ER", "Eritrea"], ["ES", "Spain"], ["ET", "Ethiopia"], ["FI", "Finland"], ["FJ", "Fiji"], ["FK", "Falkland Islands (Malvinas)"], ["GF", "French Guiana"], ["PF", "French Polynesia"], ["FO", "Faroe Islands"], ["FR", "France"], ["GA", "Gabon"], ["DE", "Germany"], ["GE", "Georgia"], ["GD", "Grenada"], ["GG", "Guernsey"], ["GH", "Ghana"], ["GI", "Gibraltar"], ["GL", "Greenland"], ["GM", "Gambia"], ["GN", "Guinea"], ["GP", "Guadeloupe"], ["GR", "Greece"], ["GS", "South Georgia and the South Sandwich Islands"], ["GT", "Guatemala"], ["GU", "Guam"], ["GW", "Guinea-Bissau"], ["GY", "Guyana"], ["HK", "Hong Kong"], ["HM", "Heard Island and McDonald Islands"], ["HN", "Honduras"], ["HR", "Croatia"], ["HT", "Haiti"], ["HU", "Hungary"], ["ID", "Indonesia"], ["IE", "Ireland"], ["IL", "Israel"], ["IM", "Isle of Man"], ["IN", "India"], ["IO", "British Indian Ocean Territory"], ["IQ", "Iraq"], ["IR", "Iran, Islamic Republic of"], ["IS", "Iceland"], ["IT", "Italy"], ["JE", "Jersey"], ["JM", "Jamaica"], ["JO", "Jordan"], ["JP", "Japan"], ["KE", "Kenya"], ["KG", "Kyrgyzstan"], ["KH", "Cambodia"], ["KI", "Kiribati"], ["KM", "Comoros"], ["KN", "Saint Kitts and Nevis"], ["KP", "Korea, Democratic People&#39;s Republic of"], ["KR", "Korea, Republic of"], ["KW", "Kuwait"], ["KZ", "Kazakhstan"], ["LA", "Lao People&#39;s Democratic Republic"], ["LB", "Lebanon"], ["LC", "Saint Lucia"], ["LI", "Liechtenstein"], ["LK", "Sri Lanka"], ["LR", "Liberia"], ["LS", "Lesotho"], ["LT", "Lithuania"], ["LU", "Luxembourg"], ["LV", "Latvia"], ["LY", "Libya"], ["MA", "Morocco"], ["MC", "Monaco"], ["MD", "Moldova, Republic of"], ["ME", "Montenegro"], ["MF", "Saint Martin (French part)"], ["MG", "Madagascar"], ["MH", "Marshall Islands"], ["MK", "Macedonia, the former Yugoslav Republic of"], ["ML", "Mali"], ["MM", "Myanmar"], ["MN", "Mongolia"], ["MO", "Macao"], ["MP", "Northern Mariana Islands"], ["MQ", "Martinique"], ["MR", "Mauritania"], ["MS", "Montserrat"], ["MT", "Malta"], ["MU", "Mauritius"], ["MV", "Maldives"], ["MW", "Malawi"], ["MX", "Mexico"], ["MY", "Malaysia"], ["YT", "Mayotte"], ["FM", "Micronesia, Federated States of"], ["MZ", "Mozambique"], ["NA", "Namibia"], ["NR", "Nauru"], ["NC", "New Caledonia"], ["NZ", "New Zealand"], ["NE", "Niger"], ["NG", "Nigeria"], ["NI", "Nicaragua"], ["NU", "Niue"], ["NL", "Netherlands"], ["NP", "Nepal"], ["NF", "Norfolk Island"], ["NO", "Norway"], ["OM", "Oman"], ["PS", "Palestine, State of"], ["PK", "Pakistan"], ["PW", "Palau"], ["PA", "Panama"], ["PG", "Papua New Guinea"], ["PE", "Peru"], ["PN", "Pitcairn"], ["PH", "Philippines"], ["PL", "Poland"], ["PT", "Portugal"], ["PR", "Puerto Rico"], ["PY", "Paraguay"], ["QA", "Qatar"], ["RE", "Réunion"], ["RO", "Romania"], ["RU", "Russian Federation"], ["RW", "Rwanda"], ["BL", "Saint Barthélemy"], ["PM", "Saint Pierre and Miquelon"], ["SM", "San Marino"], ["WS", "Samoa"], ["SA", "Saudi Arabia"], ["RS", "Serbia"], ["SB", "Solomon Islands"], ["SC", "Seychelles"], ["SD", "Sudan"], ["SE", "Sweden"], ["CH", "Switzerland"], ["SG", "Singapore"], ["SH", "Saint Helena, Ascension and Tristan da Cunha"], ["VC", "Saint Vincent and the Grenadines"], ["SI", "Slovenia"], ["SJ", "Svalbard and Jan Mayen"], ["SK", "Slovakia"], ["SL", "Sierra Leone"], ["SN", "Senegal"], ["SO", "Somalia"], ["SR", "Suriname"], ["ZA", "South Africa"], ["SS", "South Sudan"], ["ST", "Sao Tome and Principe"], ["SX", "Sint Maarten (Dutch part)"], ["SY", "Syrian Arab Republic"], ["SZ", "Swaziland"], ["TC", "Turks and Caicos Islands"], ["TF", "French Southern Territories"], ["TG", "Togo"], ["TH", "Thailand"], ["TJ", "Tajikistan"], ["TK", "Tokelau"], ["TL", "Timor-Leste"], ["TM", "Turkmenistan"], ["TN", "Tunisia"], ["TO", "Tonga"], ["TR", "Turkey"], ["TT", "Trinidad and Tobago"], ["TV", "Tuvalu"], ["TW", "Taiwan, Province of China"], ["TZ", "Tanzania, United Republic of"], ["UA", "Ukraine"], ["UG", "Uganda"], ["GB", "United Kingdom"], ["UM", "United States Minor Outlying Islands"], ["UY", "Uruguay"], ["UZ", "Uzbekistan"], ["VA", "Vatican City State"], ["VE", "Venezuela, Bolivarian Republic of"], ["VG", "Virgin Islands, British"], ["VI", "Virgin Islands, U.S."], ["VN", "Viet Nam"], ["VU", "Vanuatu"], ["WF", "Wallis and Futuna"], ["EH", "Western Sahara"], ["YE", "Yemen"], ["ZM", "Zambia"], ["ZW", "Zimbabwe"]]; var b = []; $.each(a, function () { b.push('<option value="' + this[0] + '"' + ((this[0] == c) || ((!this[0]) && (this[0] == "US")) ? ' selected="selected"' : "") + ">" + this[1] + "</option>") }); return new Handlebars.SafeString(b.join("")) }); (function (a, b, d) { function e(f) { return (/^(GET|HEAD|OPTIONS|TRACE)$/i.test(f)) } function c(g) { var j = document.location.host; var k = document.location.protocol; var h = "//" + j; var f = k + h; return (g == f || g.slice(0, f.length + 1) == f + "/") || (g == h || g.slice(0, h.length + 1) == h + "/") || !(/^(\/\/|http:|https:).*/.test(g)) } b.ajaxSetup({ beforeSend: function (g, f) { if ((!e(f.type)) && (c(f.url))) { g.setRequestHeader("X-CSRFToken", b.cookie("csrftoken")) } } }) })(window, window.jQuery); (function (b, e, c, d) { var a = { 400: { code: "bad_request", message: "Bad request" }, 404: { code: "not_found", message: "Not found" }, 500: { code: "internal_server_error", message: "Internal server error" }, 502: { code: "service_unavailable", message: "Iconfinder seems to be down" } }; e.transport = { request: function (f) { var g = c.extend({}, { method: "get", success: function () { }, error: function () { } }, f); c.ajax({ dataType: "json", type: g.method, url: g.url, data: g.data, contentType: g.contentType, processData: g.processData, success: function (h) { if (h.status == "success") { g.success(h) } else { g.error(h.code, h) } }, error: function (j) { if ((!j) || (!j.status) || (!a[j.status])) { return g.error("unknown") } var h = a[j.status]; return g.error(h.code, { status: "error", code: h.code, message: h.message }) } }) }, get: function (f) { e.transport.request(c.extend({}, { method: "get" }, f)) }, post: function (f) { e.transport.request(c.extend({}, { method: "post" }, f)) } } })(window, window.Nextfinder, window.jQuery); (function (a, b, c) { b.generateRandomAlphanumeric = function (f) { var g = "", d = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"; for (var e = 0; e < f; e++) { g += d.charAt(Math.floor(Math.random() * d.length)) } return g } })(window, window.jQuery); (function (k, f, d) { function c() { var o = navigator.userAgent, p = navigator.vendor || ""; if (k.opera) { if (o.indexOf("Mini") !== -1) { return "Opera Mini" } return "Opera" } else { if (/(BlackBerry|PlayBook|BB10)/i.test(o)) { return "BlackBerry" } else { if (o.indexOf("Chrome") !== -1) { return "Chrome" } else { if (p.indexOf("Apple") !== -1) { if (o.indexOf("Mobile") !== -1) { return "Mobile Safari" } return "Safari" } else { if (o.indexOf("Android") !== -1) { return "Android Mobile" } else { if (o.indexOf("Konqueror") !== -1) { return "Konqueror" } else { if (o.indexOf("Firefox") !== -1) { return "Firefox" } else { if (o.indexOf("MSIE") !== -1) { return "Internet Explorer" } else { if (o.indexOf("Gecko") !== -1) { return "Mozilla" } } } } } } } } } return d } function n() { var o = navigator.userAgent; if (/Windows/i.test(o)) { if (/Phone/.test(o)) { return "Windows Mobile" } return "Windows" } else { if (/(iPhone|iPad|iPod)/.test(o)) { return "iOS" } else { if (/Android/.test(o)) { return "Android" } else { if (/(BlackBerry|PlayBook|BB10)/i.test(o)) { return "BlackBerry" } else { if (/Mac/i.test(o)) { return "Mac OS X" } else { if (/Linux/.test(o)) { return "Linux" } } } } } } return d } function l() { var o = navigator.userAgent; if (/iPhone/.test(o)) { return "iPhone" } else { if (/iPad/.test(o)) { return "iPad" } else { if (/iPod/.test(o)) { return "iPod Touch" } else { if (/(BlackBerry|PlayBook|BB10)/i.test(o)) { return "BlackBerry" } else { if (/Windows Phone/i.test(o)) { return "Windows Phone" } else { if (/Android/.test(o)) { return "Android" } } } } } } return d } function h() { var o = function () { var t = 1 * new Date(), s = 0; while (t == 1 * new Date()) { s++ } return t.toString(16) + s.toString(16) }; var q = function () { return Math.random().toString(16).replace(".", "") }; var p = function (y) { var w = navigator.userAgent, v, x, t = [], u = 0; function s(z, A) { var B, C = 0; for (B = 0; B < A.length; B++) { C |= (t[B] << B * 8) } return z ^ C } for (v = 0; v < w.length; v++) { x = w.charCodeAt(v); t.unshift(x & 255); if (t.length >= 4) { u = s(u, t); t = [] } } if (t.length > 0) { u = s(u, t) } return u.toString(16) }; var r = (screen.height * screen.width).toString(16); return (o() + "-" + q() + "-" + p() + "-" + r + "-" + o()) } var e = "https://track.iconfinder.com", g = "/event", b = "norm_uuid", j = "norm_initial_referrer"; k.Norm = { uuid: d, pageViewUuid: d, initialReferrer: d, pageProperties: {}, track: function (p, q, u) { var t = q && f.isFunction(q); var o = (t ? {} : q || {}); var s = (t ? q : (f.isFunction(u) ? u : d)); var r = { event: p, uuid: this.uuid, properties: f.extend({ "$os": n(), "$browser": c(), "$device": l(), "$initialReferrer": this.initialReferrer || "$direct", "$referrer": document.referrer || d, "$url": document.location.href, "$pageViewUuid": this.pageViewUuid }, this.pageProperties, o) }; dataString = f.toJSON(r); f.ajax({ url: e + g + "?data=" + encodeURIComponent(Base64.encode(dataString)), cache: false, dataType: "json", error: function (v, x, w) { if (s) { s(v) } }, success: function () { if (s) { s() } } }) } }; var a = k.Norm; a.uuid = f.cookie(b); a.initialReferrer = f.cookie(j); a.pageViewUuid = h(); if (!a.uuid) { a.uuid = h(); f.cookie(b, a.uuid, { secure: true }); a.initialReferrer = document.referrer || d; if (a.initialReferrer) { f.cookie(j, a.initialReferrer, { secure: true }) } } f(k.document).ready(function () { a.track("$page_view") }) })(window, window.jQuery); (function (c, g, e, f) { var d = g.Class.extend({ trackEvent: function (l, o, h, n, j, k) { _gaq.push(["_trackEvent", l, o, h, n, k || false]) }, trackPageview: function (h, j) { _gaq.push(["_trackPageview", h]); if (j) { _gaq.push(j) } }, trackTransaction: function (q, s, o, r, k, p, n, l, h, j) { _gaq.push(["_addTrans", q, s, o, r, 0, l, h, j]); _gaq.push(["_addItem", q, k, p, n, o, 1]); _gaq.push(["_trackTrans"]); fbq("track", "Purchase", { value: o, currency: "USD" }) } }); var b = g.Class.extend({ trackEvent: function (l, o, h, n, j, k) { if (c.mixpanel) { mixpanel.track(l, { action: o, label: h, value: n }) } }, trackPageview: function (h, j) { }, trackTransaction: function (q, s, o, r, k, p, n, l, h, j) { } }); var a = g.Class.extend({ trackEvent: function (l, o, h, n, j, k) { if (!j) { j = {} } else { j = e.extend({}, j) } if (h) { j.event_label = h } if (n) { j.event_value = n } Norm.track(l + "/" + o, j) }, trackPageview: function (h, j) { }, trackTransaction: function (q, s, o, r, k, p, n, l, h, j) { Norm.track("Commerce/Transaction", { transaction_id: q, amount_total: o, product_id: k, product_name: p, product_type: n }) } }); g.tracking = { trackers: [d.create(), a.create()], trackEvent: function (l, o, h, n, j, k) { e.each(this.trackers, function (p, q) { q.trackEvent(l, o, h, n, j, k) }) }, trackPageview: function (h, j) { e.each(this.trackers, function (k, l) { l.trackPageview(h, j) }) }, trackTransaction: function (q, s, o, r, k, p, n, l, h, j) { e.each(this.trackers, function (t, u) { u.trackTransaction(q, s, o, r, k, p, n, l, h, j) }) } }; g.extendIntercomData = function () { var j = {}; var k = e.cookie("__utmz"); var h = e.urlParam("ref") || e.cookie("ref"); if (k) { var n = k.split("."); if (n.length >= 4) { var o = n[4].split("|"); for (i = 0; i < o.length; i++) { var l = o[i].split("="); j[l[0]] = l[1] } } } if (h && h != USER.username) { j.referal_username = h } e.extend(intercomSettings, j); if (typeof customIntercomData != "undefined" && !e.isEmptyObject(customIntercomData)) { e.extend(intercomSettings, customIntercomData) } } })(window, window.Nextfinder, window.jQuery); (function (a, b, c) { b.fn.collapsableHorizontalMenuBar = function () { b(this).each(function () { var l = b(this), n = l.find(".btn-group"), o = n.find("ul"), p = l.find("> a"), j = l.clone().addClass("collapsable-bar-shadow").css({ top: "-9999px" }).insertBefore(l), e = j.find("> a"), f = {}; for (var k = 0; k < p.length; k++) { f[b(p[k]).attr("data-listing")] = b(p[k]) } function d() { var r = [], q = 0; e.each(function () { var t = b(this), s = t.outerWidth(); r.push({ listing: t.attr("data-listing"), width: s, sumAfter: q + s }); q += s }); return { links: r, total: q } } function h(r) { if (r === null) { return null } var q = o.find('li a[data-listing="' + r + '"]'); return (q.length === 0 ? null : q.parent()) } function g() { var q = parseInt(b(a).width()), u = parseInt(l.offset().left), x = parseInt(u + l.outerWidth()), y = (q > x ? x : q), B = y - u; var A = d(); if (A.total <= B) { n.hide().find("li").remove(); p.show(); return } n.show(); var z = n.outerWidth(); B -= z; for (var r = A.links.length - 1; r >= 0; r--) { var v = A.links[r], w = f[v.listing], t = n.find('[data-listing="' + v.listing + '"]').parent(); if (v.sumAfter < B) { t.remove(); w.show() } else { if (t.length == 0) { t = b("<li></li>").append(w.clone()); var s = h(r + 1 == A.links.length ? null : A.links[r + 1].listing); if (s === null) { t.appendTo(o) } else { t.insertBefore(s) } w.hide() } } } } b(a).resize(function () { g() }); g() }) } })(window, window.jQuery); (function (a, b) { a.Icon = a.Class.extend({ init: function (c) { this.iconId = c.iconId; this.tags = c.tags; this.rasterSizes = c.rasterSizes } }); a.IconRasterSize = a.Class.extend({ init: function (c) { this.iconVersionId = c.iconVersionId; this.sizeWidth = c.sizeWidth; this.sizeHeight = c.sizeHeight; this.size = Math.max(this.sizeWidth, this.sizeHeight); this.url = c.url } }) })(window.Nextfinder); (function (a, b) { a.IconSet = a.Class.extend({ init: function (c) { this.iconsetId = c.iconsetId; this.icons = c.icons; this.isGlyph = c.isGlyph } }) })(window.Nextfinder); (function (a, b, c) { a.Nextfinder.iconsets = { init: function () { } } })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.TemplateTarget = a.Class.extend({ init: function (e, g, f) { this.canvas = e; this.template = g; this.settings = f }, redraw: function () { if (this.template._ready) { this.template.renderTarget(this) } else { this.template._renderQueue.push(this) } } }); a.iconsets.DefaultTemplate = a.Class.extend({ init: function (t, e, u) { this.width = e; this.height = u; this._renderQueue = []; this._ready = false; var r = 19, s = 48, w = 3; maxRows = 2; t = t.slice(0, maxRows * w); var l = (e - 2 * r - s) / (w - 1); var k = r, g = r; if (t.length > 0) { var f = Math.floor(t.length / w), p = t.length % w, o, j; if (p.length > 0) { o = f + 1; j = t.length / o; t = t.slice(0, o * j); k = (e - s - (j - 1) * l) / 2 } else { j = w; o = f } g = (u - s - (o - 1) * l) / 2 } var v = this; this.maxSize = s; this.icons = []; this.iconsLoaded = 0; var q = l, n = l, h = 0; c.each(t, function () { function C(G, F) { if (G.size < F.size) { return -1 } if (G.size > F.size) { return 1 } return 0 } this.rasterSizes.sort(C); var z = null; for (var A = 0; A < this.rasterSizes.length; A++) { if (this.rasterSizes[A].size <= s) { z = this.rasterSizes[A] } } if (z === null) { z = this.rasterSizes[0] } var D = new Image(); D.src = z.url; D.onload = function () { v.iconsLoaded++; if (v.iconsLoaded == v.icons.length) { v._readyCallback() } }; var y = (z.size > s ? z.sizeWidth / z.size * s : z.sizeWidth), x = (z.size > s ? z.sizeHeight / z.size * s : z.sizeHeight), E = Math.floor(h / j), B = h % j; v.icons.push({ width: y, height: x, image: D, x: k + l * B + Math.floor((s - y) / 2), y: g + l * E + Math.floor((s - x) / 2) }); h++ }); if (this.icons == 0) { this._readyCallback() } }, _readyCallback: function () { var e = this; this._preRender(); this._ready = true; c.each(this._renderQueue, function () { e.renderTarget(this) }); this._renderQueue = [] }, createTarget: function (e, f) { var g = a.iconsets.TemplateTarget.create(e, this, f); if (this._ready) { this.renderTarget(g) } else { this._renderQueue.push(g) } return g }, _preRender: function () { this._iconsLayer = c("<canvas>").attr({ width: this.width, height: this.height })[0]; var e = this._iconsLayer.getContext("2d"); c.each(this.icons, function () { e.drawImage(this.image, this.x, this.y, this.width, this.height) }); this._maskLayer = c("<canvas>").attr({ width: this.width, height: this.height })[0]; this._maskContext = this._maskLayer.getContext("2d"); this._maskContext.drawImage(this._iconsLayer, 0, 0); this._maskContext.globalCompositeOperation = "source-in" }, renderTarget: function (g) { var f = this; var e = g.canvas.getContext("2d"); e.fillStyle = g.settings.backgroundColor; e.fillRect(0, 0, this.width, this.height); if (g.settings.maskColor) { this._maskContext.fillStyle = g.settings.maskColor; this._maskContext.fillRect(0, 0, this.width, this.height); e.drawImage(this._maskLayer, 0, 0) } else { e.drawImage(this._iconsLayer, 0, 0) } } }); a.iconsets.edit_preview = a.Class.extend({ init: function () { var e = DefaultTemplate.create(b.ICONS, 220, 188); c('canvas[data-template-preview="true"]').each(function () { e.createTarget(this, { backgroundColor: c(this).attr("data-background-color"), maskColor: c(this).attr("data-mask-color") }) }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.manage = a.Class.extend({ _iconsetId: null, editTags: function (h, g) { var e = this; function f(l, k) { var n = c("body").createFormModal({ title: "Edit tags", template: "iconsets/templates/edit_tags.html", actionLabel: "Save tags", context: { icon: l, tags: l.tags, suggested_tags: k } }, function (o) { if (o.status == "success") { c.pnotify({ pnotify_title: "Tags saved successfully", pnotify_text: "All tags have been saved." }) } else { c.pnotify({ pnotify_title: "Oops! Something went wrong", pnotify_text: "Tags have not been saved correctly." }) } return false }); var j = n.find(".tags").tagsInput({ width: "auto" }); n.find("[data-tag]").on("click", function () { var o = c(this).attr("data-tag"); if (!j.tagExist(o)) { j.addTag(o) } return false }); return false } c.ajax({ dataType: "json", url: "/iconsets/" + h + "/icons/" + g + "/tags", success: function (j) { f(j.icon, j.suggested_tags) } }) }, init: function () { var e = this; this._iconsetId = c(".icon[data-iconset-id]").attr("data-iconset-id"); this._iconsetIsPremium = (c(".icon[data-iconset-id]").attr("data-iconset-is-premium") == "true"); this._activateButton = c('[data-action="activate-selected"]'); this._deactivateButton = c('[data-action="deactivate-selected"]'); this._deleteButton = c('[data-action="delete-selected"]'); c('.icon input[type="checkbox"]').click(function () { var f = c(this).parent(); if (c(this).is(":checked")) { c(f).addClass("selected") } else { c(f).removeClass("selected") } e.updateButtonState() }); c(".action-tags-edit").click(function () { var f = c(this).closest("[data-icon-id]"); var h = f.attr("data-iconset-id"); var g = f.attr("data-icon-id"); e.editTags(h, g); return false }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.manage_overview = a.Class.extend({ createCollection: function () { var e = this; var f = c("body").createFormModal({ title: "New collection", template: "iconsets/templates/new_collection.html", actionLabel: "Create collection" }, function (g) { location.reload() }) }, init: function () { var e = this; c('[data-action="new-collection"]').click(function () { e.createCollection(); return false }); c('[data-action="delete-collection"]').click(function () { e.deleteCollection(c(this).closest("[data-collection-id]").attr("data-collection-id")); return false }); c('[data-action="edit-collection"]').click(function () { e.editCollection(c(this).closest("[data-collection-id]").attr("data-collection-id")); return false }); c('[data-action="delete-iconset"]').click(function () { e.deletePackage(c(this).closest("[data-iconset-id]").attr("data-iconset-id")); return false }) }, deleteCollection: function (e) { if (confirm("Are you sure you want to delete this collection?")) { c.ajax({ type: "POST", url: "/collections/" + e + "/delete", success: function () { c("table").find("[data-collection-id='" + e + "']").remove(); c.pnotify({ pnotify_title: "Collection deleted", pnotify_text: "One collection was deleted." }) } }) } }, editCollection: function (e) { c.ajax({ type: "GET", url: "/collections/" + e + "/edit", success: function (g) { var f = c("body").createFormModal({ title: "Edit collection", template: "iconsets/templates/edit_collection.html", actionLabel: "Update collection", context: g }, function (h) { location.reload() }) } }) }, deletePackage: function (e) { if (confirm("Are you sure you want to delete this iconset?")) { c.ajax({ type: "POST", url: "/iconsets/" + e + "/delete", success: function () { c("table").find("[data-iconset-id='" + e + "']").remove(); c.pnotify({ pnotify_title: "Icon set deleted", pnotify_text: "One icon set and its icons was deleted." }) } }) } } }) })(window, window.jQuery); (function (d, a, e, g) { var c = d.Nextfinder; var f = ".management-container .version-container .drop-cover", b = ".management-container .spacer"; c.iconsets.edit_icons = c.Class.extend({ _iconsetId: null, _tagInputs: null, initializeContainer: function (h) { var j = this; this._tagInputs = {}; h.find("[data-icon-id]").each(function () { var l = e(this).attr("data-icon-id"), k = e(this).find('.tags input[type="text"]'); j._tagInputs[l] = k.tagsInput() }); h.find(".tags .tagsinput").css({ width: "", height: "" }) }, deleteIcon: function (h) { h.fadeOut("fast", function () { h.next(".spacer").remove(); h.remove() }) }, updateIcon: function (j) { var h = j.find(".version"); if (h.length == 0) { this.deleteIcon(j) } var k = h.find("a.delete"); if (h.length == 1) { k.hide() } else { k.show() } }, createIcon: function (n, k, l) { var j = e('<div class="spacer">').insertAfter(n); var h = e(Handlebars.templates["iconsets/templates/edit_icons_icon.html"]({ iconset_id: this._iconsetId, tags: k, is_active: l })).insertAfter(n); this.initializeContainer(h); return h }, submit: function () { var j = this; var l = []; e("[data-icon-id]").each(function () { if (l === g) { return } var q = e(this), s = q.attr("data-icon-id"), r = q.find('input[type="text"]').val(), p = []; q.find("[data-iconversion-id]").each(function () { p.push(e(this).attr("data-iconversion-id")) }); if (p.length == 0) { return } if (e.trim(r) == "") { l = g; alert("Error: Icon (ID " + s + ") or more icons have no tags."); return } l.push({ iconId: (s == "new" ? null : s), isActive: (q.attr("data-active") == "true"), tags: r, versions: p }) }); if (l === g) { return } var h = { icon_count: l.length }; var o = l.length; while (o--) { var n = l[o]; h["icon_" + o + "_icon_id"] = n.iconId; h["icon_" + o + "_tags"] = n.tags; h["icon_" + o + "_is_active"] = (n.isActive ? "true" : "false"); h["icon_" + o + "_versions"] = n.versions.join(",") } var k = e("body").overlayLoader("Saving changes..."); e.ajax({ type: "POST", url: "/iconsets/" + this._iconsetId + "/icons/edit", dataType: "json", data: h, success: function (p) { location.href = "/iconsets/" + j._iconsetId + "/manage" }, error: function () { k.remove(); alert("Failed to save changes. Please try again or reload the page if the problem persists.") } }) }, init: function () { var j = this; this.isDraggingVersion = false; this.draggingVersion = null; e(a).on("dragstart", "[data-iconversion-id]", function (n) { j.isDraggingVersion = true; j.draggingVersion = e(this); var l = e(this).closest(".version-container"); e(".management-container .version-container").each(function () { if (this != l[0]) { e(this).append('<div class="drop-cover"></div>') } }) }).on("dragend", "[data-iconversion-id]", function () { j.isDraggingVersion = false; var l = e(".management-container"); l.find(".version.ghost, .version-container > .drop-cover").remove(); l.find(".spacer-drop-target").removeClass("spacer-drop-target").html("") }); var h = null; function k(l) { if (!j.isDraggingVersion) { return } l.preventDefault(); return false } e(a).on("dragenter", b, function (n) { if (k(n) !== false) { return } var l = e(this); h = setTimeout(function () { h = null; l.addClass("spacer-drop-target").html("Create new icon") }, 100); return false }).on("dragover", b, k).on("dragleave", b, function () { e(this).removeClass("spacer-drop-target").html(""); if (h) { clearTimeout(h) } }).on("drop", b, function (o) { if (!j.isDraggingVersion) { return } var n = j.draggingVersion.closest("[data-icon-id]"); var l = j.createIcon(e(this), n.find('input[type="text"]').val(), n.attr("data-active") == "true"); j.draggingVersion.remove().appendTo(l.find(".version-container")); j.updateIcon(n); j.updateIcon(l) }); e(a).on("dragenter", f, function (l) { if (k(l) !== false) { return } e(this).parent().append('<div class="version ghost">&nbsp;</div>'); return false }).on("dragover", f, k).on("dragleave", f, function () { e(this).parent().find(".version.ghost").remove() }).on("drop", f, function (o) { if (!j.isDraggingVersion) { return } var n = j.draggingVersion.closest("[data-icon-id]"), l = e(this).closest("[data-icon-id]"); j.draggingVersion.remove().appendTo(l.find(".version-container")); j.updateIcon(n); j.updateIcon(l) }); e(a).on("click", '[data-action="delete-icon"]', function (l) { if (!confirm("Are you sure you want to delete this icon?\n\nThere's no way back, once you've deleted it. Seriously.")) { return false } j.deleteIcon(e(this).closest("[data-icon-id]")); return false }).on("click", '[data-action="toggle-icon-active"]', function (n) { var l = e(this).closest("[data-icon-id]"); if (l.attr("data-active") == "true") { l.attr("data-active", "false"); e(this).removeClass("is-active") } else { l.attr("data-active", "true"); e(this).addClass("is-active") } return false }).on("click", '[data-action="delete-version"]', function (o) { if (!confirm("Are you sure you want to delete this icon version?\n\nSomeone might need it, you know.")) { return false } var n = e(this).closest("[data-icon-id]"), l = e(this).closest(".version"); l.remove(); j.updateIcon(n); return false }).on("click", '[data-action="submit"]', function (l) { j.submit(); return false }); e(a).on("click", ".tagslist [data-tag]", function (q) { var n = e(this).closest("[data-icon-id]"), p = n.attr("data-icon-id"), l = e(this).attr("data-tag"), o = j._tagInputs[p]; e(this).remove(); if (!o.tagExist(l)) { o.addTag(l) } j.updateSuggestions([p]) }); this._iconsetId = e(".management-container [data-iconset-id]").attr("data-iconset-id"); this.initializeContainer(e(".management-container")); this.updateSuggestions() }, updateSuggestions: function (j) { iconMap = {}; if (j === g) { e("[data-icon-id]").each(function () { iconMap[e(this).attr("data-icon-id")] = true }) } else { for (var h = 0; h < j.length; h++) { iconMap[j[h]] = true } } iconTags = {}; e("[data-icon-id]").each(function () { var k = e(this), l = k.attr("data-icon-id"); if (iconMap[l] !== true) { return } iconTags[l] = e.trim(k.find('input[type="text"]').val()).split(",") }); e.ajax({ type: "post", url: "/iconsets/" + this._iconsetId + "/icons/tags/suggest", data: JSON.stringify(iconTags), contentType: "application/json; charset=utf-8", dataType: "json", success: function (l) { for (iconId in l.suggestions) { choicesContainer = e('[data-icon-id="' + iconId + '"] .suggestions .tagslist').html('<div class="tags_clear"></div>').removeClass("loading"); tags = l.suggestions[iconId]; for (var k = 0; k < tags.length; k++) { tag = tags[k]; e('<span class="tag"></span>').html("+ " + tag).attr("data-tag", tag).prependTo(choicesContainer) } } }, failure: function (k) { console.log("Request failed:", k) } }) } }) })(window, window.document, window.jQuery); (function (c, a, d, e) { var b = c.Nextfinder; b.iconsets.edit_icon = b.Class.extend({ init: function () { var f = this; this._uploadForm = d("#upload-form"); this._uploadFormFile = this._uploadForm.find('[type="file"]'); this._uploadFormFile.change(function (g) { f._uploadForm.submit(); d("body").overlay().overlayLoader("Replacing icon version...") }); d(a).on("click", '[data-action="replace-iconversion"]', function (k) { k.preventDefault(); var n = d(this), l = parseInt(n.attr("data-iconset-id"), 10), j = parseInt(n.attr("data-icon-id"), 10), g = parseInt(n.attr("data-iconversion-id"), 10); if ((!l) || (!j) || (!g)) { console.log("Missing icon IDs"); return } if (!confirm("Replacing an icon version does not perform any checks on the uploaded content. Please make sure the file type and data is consistent yourself. Understood?")) { return } var h = d("#upload-form"); f._uploadForm.attr("action", "/iconsets/" + l.toString() + "/icons/" + j.toString() + "/versions/" + g.toString() + "/replace"); f._uploadFormFile.click() }) } }) })(window, window.document, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.edit = a.Class.extend({ init: function () { var g = this; c("#id_collection").change(function () { if (c(this).val() == "create") { c(this).val(""); b.Nextfinder.modals.CreateCollection.create({ callback: function (n, k) { var l = c("<option></option"); l.val(n); l.html(k); c("#id_collection option:last-child").before(l); c("#id_collection").val(n); c.pnotify({ pnotify_title: 'Created collection "' + k + "'", pnotify_text: "Your new collection has been created and is ready for use." }) } }) } }); var f = c('input[name="price_per_set"]'); var e = parseInt(c("[data-icons-count]").attr("data-icons-count"), 10); var h = c('select[name="price_per_icon"]'); function j(l) { var k = (l / 100) * e; var n = Math.floor(k); var p = 1; var o = Math.floor(k * 0.8); if (o > 9) { var q = o % 10; if (q < 3) { o -= q + 1 } else { if (q < 8) { o -= q - 4 } else { o -= q - 9 } } if (o > n) { o = n } } if (o < p) { o = p } f.val(o) } c(document).on("change", 'select[name="price_per_icon"]', function (k) { j(parseInt(h.val(), 10)) }); if (f.val() === "") { j(parseInt(h.val(), 10)) } } }) })(window, window.jQuery); (function (c, d, e) { var b = c.Nextfinder; function a(f) { if ((f.length == 0) || (f == "#")) { return "" } if (f.match(/^\#?(?:[0-9a-f]{3}|[0-9a-f]{6})$/i) === null) { return null } if (f[0] != "#") { f = "#" + f.toLowerCase() } else { f = f.toLowerCase() } if (f.length == 4) { return "#" + f[1] + f[1] + f[2] + f[2] + f[3] + f[3] } return f } b.iconsets.base_edit_preview = b.Class.extend({ init: function () { this.template = b.iconsets.DefaultTemplate.create(c.ICONS, 220, 153); this.backgroundColorInput = d('input[name="background_color"]'); this.maskColorInput = d('input[name="mask_color"]'); this.saveSchemeButton = d('input[name="save_color_scheme"]'); this.submitButtons = d('#main-content [type="submit"]'); var f = this; d('.preview-template-options canvas[data-template-preview="true"]').each(function () { f.template.createTarget(this, { backgroundColor: d(this).attr("data-background-color"), maskColor: d(this).attr("data-mask-color") }) }); var g = d('.preview-template-selected canvas[data-template-preview="true"]'); this.selectedTarget = this.template.createTarget(g[0], { backgroundColor: g.attr("data-background-color"), maskColor: g.attr("data-mask-color") }); function h() { var j = a(f.backgroundColorInput.val()), l = a(f.maskColorInput.val()), k = ((j !== "") && (j !== null)), o = (l !== null), n = ((k) && (o)); f.backgroundColorInput.toggleClass("invalid", !k); f.maskColorInput.toggleClass("invalid", !o); f.toggleFormEnabled(n); if ((n) && (!f.isColorSchemeSaved(j, l))) { f.saveSchemeButton.removeAttr("disabled") } else { f.saveSchemeButton.attr("disabled", "disabled") } if (n) { f.updateSelected(j, l) } } this.backgroundColorInput.change(h).keypress(h).keyup(h); this.maskColorInput.change(h).keypress(h).keyup(h); d(c.document).on("click", "article.preview-option", function (k) { var j = d(this).find("canvas"); f.backgroundColorInput.val(j.attr("data-background-color")); f.maskColorInput.val(j.attr("data-mask-color")); h() }); this.saveSchemeButton.click(function () { f.saveSelected() }); h() }, updateSelected: function (f, g) { this.selectedTarget.settings.backgroundColor = f; this.selectedTarget.settings.maskColor = g; this.selectedTarget.redraw() }, toggleFormEnabled: function (f) { this.formEnabled = f; if (f) { this.submitButtons.removeAttr("disabled") } else { this.submitButtons.attr("disabled", "disabled") } }, isColorSchemeSaved: function (f, l) { var g = d(".preview-option canvas"); for (var h = 0; h < g.length; h++) { var k = d(g[h]); var n = k.attr("data-background-color").toLowerCase(), j = (k.attr("data-mask-color") == e ? "" : k.attr("data-mask-color").toLowerCase()); if ((f == n) && (l == j)) { return true } } return false }, saveSelected: function () { var g = this, f = a(this.backgroundColorInput.val()), j = a(this.maskColorInput.val()); var h = d("body").overlayLoader("Saving changes..."); b.transport.post({ url: "/iconsets/preview-templates", data: { background_color: f, mask_color: j }, success: function (n) { h.remove(); var l = d('.preview-option-category[data-category="custom"]'), k = d('<article class="preview-option"><canvas data-template-preview="true" data-background-color="' + f + '" data-mask-color="' + j + '" width="220" height="153"></canvas></article>').appendTo(l); g.template.createTarget(k.find("canvas")[0], { backgroundColor: f, maskColor: j }); g.saveSchemeButton.attr("disabled", "disabled"); l.css("display", "block") }, error: function () { h.remove(); alert("Failed to save color scheme. Please try again or reload the page if the problem persists.") } }) } }); b.iconsets.edit_preview = b.iconsets.base_edit_preview.extend({}) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.details = a.Class.extend({ init: function () { var e = this; var f = c(".iconset-details"); this.iconsetId = f.attr("data-iconset-id"); this.iconsetIsPremium = (f.attr("data-iconset-is-premium") == "true"); this.iconsetIsPurchased = (f.attr("data-iconset-is-purchased") == "true"); Nextfinder.tracking.trackEvent("Icon set", "View details", (this.iconsetIsPremium ? (this.iconsetIsPurchased ? "Premium, purchased" : "Premium") : "Non-premium"), this.iconsetId) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.review = a.Class.extend({ init: function () { var e = this; this.action = null; c('input[name="action"]').change(function () { c(".option").removeClass("active"); c(this).closest(".option").addClass("active"); e.action = c('input[name="action"]:checked').val(); e.updateFormState() }); function f() { e.updateFormState() } this.form = c("#main-content form"); this.form.find("div.review-reasons").hide(); this.form.find("input[type=checkbox]").change(function () { var g = c(this); if (g.is(":checked")) { c(this).closest("label").find(".review-reasons").slideDown() } else { c(this).closest("label").find(".review-reasons").slideUp() } }); this.submitButtons = this.form.find('[type="submit"]'); this.rejectionReasons = this.form.find(".review-rejection"); this.rejectionReasonCheckboxes = this.rejectionReasons.find('label input[type="checkbox"]').change(f).each(function () { c(this).val(c.trim(c(this).closest("label").find("span").text())) }); this.otherReasonsList = this.form.find("ul.other-reasons"); this.otherReasonInput = this.otherReasonsList.find("textarea").change(f).keypress(function (k) { if (k.keyCode == 13) { var j = c("<li />"); c('<input type="hidden" name="reasons[]" />').val(c(this).val()).appendTo(j); var g = c("<label />").html(c(this).val() + "&nbsp;").appendTo(j); var h = c('<a href="#">&times;</a>').click(function () { j.remove(); f(); return false }).appendTo(g); j.insertBefore(c(this).closest("li")); k.preventDefault(); c(this).val("") } f() }).keydown(f).keyup(f); c("a[href='#uncheck-all']").on("click", function (h) { h.preventDefault(); var g = c("#feedback").val(); c("input[name='reasons[]']").val(""); c('label input[type="checkbox"]').attr("checked", false); c("#feedback").val(g); c('label input[type="checkbox"]').closest("label").find(".review-reasons").slideUp() }); if (c("input[type=checkbox]:checked").size() > 0) { c("a[href='#uncheck-all']").closest("span").css("display", ""); c(".require-changes").click(); c(".handbook").click(); c("input[type=checkbox]:checked").closest("label").find(".review-reasons").slideDown() } }, updateFormState: function () { if (this.isSubmittable()) { this.submitButtons.removeAttr("disabled") } else { this.submitButtons.attr("disabled", "disabled") } var f = { approve: "Approve icon set", require_changes: "Request changes for icon set", reject: "Reject icon set" }; this.submitButtons.html(f[this.action] ? f[this.action] : "Update"); this.rejectionReasons.toggle((this.action != null) && (this.action != "approve")); if (this.action == "approve") { var e = c("#feedback").val(); c("input[name='reasons[]']").val(""); c('label input[type="checkbox"]').attr("checked", false); c("#feedback").val(e) } }, isSubmittable: function () { if (this.action == null) { return false } if (this.action == "approve") { return true } if (this.rejectionReasonCheckboxes.is(":checked")) { return true } if (this.otherReasonsList.find('li input[type="hidden"]').length > 0) { return true } return c.trim(this.otherReasonInput.val()).length > 0 } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconsets.admin_promoted = a.Class.extend({ init: function () { var e = this; e.source = null; c(".draggable").attr("draggable", true); c(".draggable a").attr("draggable", false); c(".draggable").on("dragstart", function (f) { e.drag(f) }); c(".draggable").on("dragover", function (f) { f.preventDefault(); f.stopPropagation(); var g = c(f.target).closest(".draggable"); g.addClass("drag-selected") }); c(".draggable").on("dragleave", function (f) { f.preventDefault(); f.stopPropagation(); var g = c(f.target).closest(".draggable"); g.removeClass("drag-selected") }); c(".draggable-container").on("drop", function (f) { e.drop(f) }); c(document).on("click", '[data-action="iconset-demote"]', function (g) { g.preventDefault(); var f = c(this).closest(".draggable"); var h = f.find("article").attr("data-iconset-id"); nfx.services.iconsetPromotionService.demote(h).then(function () { f.remove(); e.updateLabels() }, function (j) { console.log(j) }) }) }, drag: function (e) { self.source = c(e.target) }, drop: function (g) { var f = this; g.preventDefault(); g.stopPropagation(); c(this).removeClass("drag-selected"); var h = c(g.target).closest(".draggable"); h.removeClass("drag-selected"); var k = source.find("article").attr("data-iconset-id"); var e = null; if (source.index() > h.index()) { if (h.index() != 0) { var j = source.closest(".draggable-container").find(".draggable")[h.index() - 1]; e = c(j).find("article").attr("data-iconset-id") } h.before(source) } else { e = h.find("article").attr("data-iconset-id"); h.after(source) } if (k != e) { nfx.services.iconsetPromotionService.promote(k, e).then(f.updateLabels) } }, updateLabels: function () { var g = c(".draggable"); for (var f = 0; f < g.length; f++) { var e = c(g[f]); e.find(".item-order").text(e.index() + 1) } } }) })(window, window.jQuery); (function (a, b) { a.Nextfinder.profiles = {} })(window); (function (b, c, d) { var a = b.Nextfinder; a.profiles.details = a.Class.extend({ init: function () { var e = this; c("input.btn-file").change(function () { var f = c(this).val(); if ((!f) || (f == "")) { return } var g = ((/[.]/.exec(f)) ? /[^.]+$/.exec(f)[0] : d); if ((!g) || (g == "") || (g == d) || ((g.toLowerCase() != "jpg") && (g.toLowerCase() != "jpeg") && (g.toLowerCase() != "png"))) { alert("Unsupported file format for cover picture. Please choose a JPEG or PNG picture."); return } c("body").overlay().overlayLoader("Uploading image ..."); c("#edit-profile").submit() }); c(".designer-search").on("submit", function (g) { g.preventDefault(); var h = c(".designer-search .query").val(), f = c(".designer-search .query").data("username"); b.location = "/search/?q=" + encodeURIComponent("designer:" + f + " " + h) }); c(".iconset-navigation a").on("click", function () { var f = c(this).data("collection-id"); if (f == "collection-_allcollections") { c(".collection").slideDown().fadeIn() } else { c(".collection").each(function () { if (c(this).attr("id") == f) { c(this).slideDown().fadeIn() } else { c(this).slideUp().fadeOut() } }) } c(".iconset-navigation").find(".active").removeClass("active"); c(this).addClass("active"); return false }) } }) })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.account = { init: function () { } } })(window, window.jQuery); (function (c, a, d, e) { var b = c.Nextfinder; b.account.dashboard = b.Class.extend({ init: function () { } }) })(window, window.document, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.downloads = a.Class.extend({ _initBindings: function () { var e = this }, init: function () { var e = this; this._initBindings() } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.balance = a.Class.extend({ init: function () { c('[data-action="deposit-cash"]').click(function () { b.Nextfinder.commerce.deposit_cash({ success: function () { c.pnotify({ pnotify_notice_icon: "", pnotify_delay: 2000, pnotify_history: false, pnotify_text: "Your account balance was updated successfully." }); Nextfinder.transport.get({ url: "/account/ajax/state/", success: function (e) { c('[data-content="user-balance"]').text("$ " + Nextfinder.formatting.formatMoney(e.user.balance)) } }) }, error: function () { location.reload() } }); return false }); c('[data-action="redeem-giftcard"]').click(function () { }) } }) })(window, window.jQuery); (function (a, b, c) { var d = a.Nextfinder; d.account.payment_methods = d.Class.extend({ init: function () { var e = this; b(document).on("click", ".credit-card .default", function () { var g = b(this); if (g.hasClass("checked")) { return } d.transport.post({ url: "/account/ajax/payment-methods/" + b(this).closest("[data-card-id]").attr("data-card-id") + "/default", success: function () { b(".credit-card .default").removeClass("checked"); g.addClass("checked"); b.pnotify({ pnotify_notice_icon: "", pnotify_delay: 2000, pnotify_history: false, pnotify_title: "Credit card made default", pnotify_text: "The selected credit card is now your default credit card." }) } }) }); b('[data-action="delete-credit-card"]').click(function () { if (!confirm("Are you sure you want to remove this credit card from your account?")) { return false } }); b('[data-action="change-method"]').click(function (g) { g.preventDefault(); var h = b(this).attr("data-value"); e.changeMethod(h) }); b('[data-action="cash-out-submit"]').click(function (g) { g.preventDefault(); e.submitCashoutForm() }); var f = b('[name="cash_out_method"]').val(); if (!f) { f = "paypal" } e.changeMethod(f); b(document).on("click", '[data-action="add-credit-card"]', function () { nfx.app.modalStackController.present(new nfx.modules.AddCreditCardModalModule({ didAddCreditCard: function () { location.reload() } })) }) }, changeMethod: function (e) { if (self.method == e) { return } self.method = e; if (!self.methods) { self.methods = b("#cash-out-methods") } if (!self.forms) { self.forms = b("#cash-out-forms") } self.methods.children('[data-value!="' + e + '"]').removeClass("active"); self.methods.children('[data-value="' + e + '"]').addClass("active"); self.forms.children('[data-cash-out-method!="' + e + '"]').hide(); self.forms.children('[data-cash-out-method="' + e + '"]').show() }, submitCashoutForm: function () { var e = self.forms.children('[data-cash-out-method="' + self.method + '"]'); e[0]["cash_out_method"].value = self.method; e.submit() } }) })(window, window.jQuery); (function (c, d, e) { var b = c.Nextfinder; var a = ["#239d60", "#607d8b", "#8a9b9a"]; b.account.sales_overview = b.Class.extend({ drawChart: function () { var C = d("#sales_chart").parent().width(), n = 200, j = [10, 70, 30, 20], A = d3.scale.ordinal().rangeRoundBands([0, C - j[1] - j[3]]), u = d3.scale.linear().range([0, n - j[0] - j[2]]), r = d3.scale.ordinal().range([a[0], a[1], a[2]]), B = d3.time.format("%b %d"); var q = d3.select("#sales_chart").attr("width", C).attr("height", n); var l = q.select("g.chart"); if (l[0][0] !== null) { l.remove() } l = q.append("svg:g").attr("class", "chart"); l.attr("transform", "translate(" + j[3] + "," + (n - j[2]) + ")"); var o = d3.layout.stack()(["subscription_earnings", "icon_earnings", "iconset_earnings"].map(function (h) { return c.SALES_DATA.map(function (p) { return { x: p.date, y: +p[h] } }) })); A.domain(o[0].map(function (h) { return h.x })); u.domain([0, d3.max(o[o.length - 1], function (h) { return h.y0 + h.y })]); var t = l.selectAll("g.rule").data(u.ticks(5)).enter().append("svg:g").attr("class", "rule").attr("transform", function (h) { return "translate(0," + -u(h) + ")" }); t.append("svg:line").attr("x2", C - j[1] - j[3]).style("stroke", function (h) { return h ? "#F7F7F7" : "#E0E0E1" }); var g = l.selectAll("g.earning").data(o).enter().append("svg:g").attr("class", "earning").style("fill", function (p, h) { return r(h) }); var s = g.selectAll("rect").data(Object).enter().append("svg:rect").attr("x", function (h) { return A(h.x) + 3 }).attr("y", function (h) { return -u(h.y0) - u(h.y) }).attr("height", function (h) { return u(h.y) }).attr("width", A.rangeBand() > 6 ? A.rangeBand() - 6 : A.rangeBand()); var k = d3.min(o[0], function (h) { return h.x }), f = Math.ceil(50 / A.rangeBand()); var v = l.selectAll("text").data(A.domain()).enter().append("svg:text").attr("x", function (h) { return A(h) + A.rangeBand() / 2 }).attr("y", 6).attr("text-anchor", "middle").attr("dy", ".71em").text(function (p) { var h = parseInt((p - k) / 86400000, 10); return (h % f == 0 ? B(p) : "") }).style("fill", "#B2B2B2"); t.append("svg:text").attr("x", C - j[1] - j[3] + 6).attr("dy", ".35em").text(function (h) { return "$ " + d3.format(",.2f")(h) }).style("fill", "#B2B2B2") }, init: function () { var f = this; d(c).resize(function () { f.drawChart() }); this.drawChart() } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.login = a.Class.extend({ init: function () { c(".fixture").remove(); var e = c(".back").attr("href"); nfx.app.modalStackController.present(new nfx.modules.LogInModalModule({ dismissable: false, onAuthenticate: function () { location.href = e ? e : "/" } }), false) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.signup = a.Class.extend({ init: function () { c(".fixture").remove(); nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ dismissable: false, onAuthenticate: function () { location.href = "/" } }), false) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.settings = a.Class.extend({ init: function () { var e = this; c("body").find('[data-action="connect-facebook"]').click(function () { e.logInWithFacebook() }) }, logInWithFacebook: function () { var e = this; var f = c("body").overlay(); FB.login(function (g) { if (g.authResponse) { b.Nextfinder.transport.post({ url: "/user/ajax/social/facebook/connect", data: { access_token: g.authResponse.accessToken }, success: function (h) { location.reload() }, error: function (h, j) { if (h.code == "already_connected") { alert("Another user is already connected with this Facebook account.") } else { alert("Ooops! Something went wrong, sorry! Please try again.") } f.remove() } }) } else { f.remove() } }, { scope: "email" }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.billingdetails = a.Class.extend({ init: function () { var e = this; if (c("#id_accounttype").val() == "personal") { c("#id_company").prop("disabled", true); c("#id_vat_number").prop("disabled", true) } c("#id_accounttype").on("change", function () { if (c(this).val() == "business") { c("#id_company").removeAttr("disabled"); c("#id_vat_number").removeAttr("disabled") } else { c("#id_company").prop("disabled", true); c("#id_company").removeClass("error"); c("#id_company").siblings(".error").remove(); c("#id_vat_number").prop("disabled", true) } }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.account.privatemessages = a.Class.extend({ init: function () { var e = this; c("#sub-bar").sticky({ topSpacing: c("#navigation").outerHeight() }); c("#account-messages [data-message-id]").on("click", function () { var h = c(this).data("message-id"); var g = b.location.href; b.location.href = g + "/message/" + h }); var f = function (g) { nfx.api.account.getUser().then(function (h) { if (!h.hasSufficientBillingDetails()) { nfx.app.modalStackController.replaceTopmost(new nfx.modules.BillingDetailsModalModule({ user: h, didUpdate: g })) } else { g() } }) }; c('[data-action="request-payment"]').on("click", function () { f(function () { nfx.app.modalStackController.replaceTopmost(new nfx.modules.RequestPaymentModalModule()) }) }); c('[data-action="buy-custom-service"]').on("click", function () { var g = c(this).data("service-id"); Nextfinder.tracking.trackEvent("Commerce", "Click to buy", "Custom Service", g, { service_id: parseInt(g, 10) }); f(function () { b.Nextfinder.commerce.purchase({ asset: { identifier: "custom_service", primary_key: g }, success: function () { location.reload() } }) }) }); c("#account-messages").on("click", "[data-confirm]", function () { return confirm(c(this).data("confirm")) }); c(".reply-form textarea").autogrow(); c(".reply-form").on("change", 'input[type="file"]', function () { var j = c(this); var g = this.files[0].size; var k = 50 * 1000000; var h = j.val().split("\\").pop(); if (g > k || g === 0) { alert("You cannot attach files larger than 50Mb."); j.wrap("<form>").closest("form").get(0).reset(); j.unwrap(); return false } if (h.length > 25) { h = h.substring(0, 23) + "..." } j.siblings(".filename").text(h); c(".reply-form").valid() }); c(".reply-form").validate({ rules: { text: { required: { depends: function () { return c('.reply-form input[name="file_attachment"]').val().length < 1 } } } } }); c.each(["success", "error"], function (g, h) { if (c.urlParam(h)) { c.pnotify({ pnotify_title: c.urlParam(h), pnotify_history: false }) } }); c('[data-action="report"]').on("click", function () { b.intercomSettings.thread_id = b.location.href; Intercom("show") }) } }) })(window, window.jQuery); (function (a, b) { a.Nextfinder.commerce = { admin_sales_overview: a.Nextfinder.account.sales_overview } })(window); (function (b, e, c, d) { var a = e.Class.extend({ init: function (g) { var f = this; this.settings = c.extend({}, g); this.requestToken = c.generateRandomAlphanumeric(32); this.isSuccessful = false; this.asset = m.prop(); this.offer = m.prop(); this.proPlanSmallest = m.prop(); this.user = nfx.mext.watchedProp(d, function () { c('[data-content="user-balance"]').html("$ " + e.formatting.formatMoney(this.user().balance())) }.bind(this)); this.getOffers() }, getOffers: function () { var f = this; nfx.app.modalStackController.replaceAllWithLoader("Hang tight..."); nfx.api.commerce.getCheapestOffer(this.settings.asset.identifier, this.settings.asset.primary_key).then(function (g) { f.asset(g.asset); f.offer(g.offer); f.user(g.user); f.proPlanSmallest(g.proPlanSmallest); if (!f.user().hasSufficientBillingDetails()) { f.getBillingDetails(); return } if (f.user().balance() < f.offer().price()) { f.handleInsufficientFunds() } else { f.confirmPurchase() } }, function (g) { Raven.captureMessage("getCheapestOffer failed:" + g); f.fail("Something is awry", ["Something went wrong here. Please refresh the site and try again.", m("br"), m("br"), "If the problem persists, please do not hesitate to contact ", m("a", { href: "mailto:support@iconfinder.com" }, "support@iconfinder.com"), "."]) }) }, fail: function (g, f) { nfx.app.modalStackController.replaceTopmostWithError(g, f) }, getBillingDetails: function () { var f = this; nfx.app.modalStackController.replaceTopmost(new nfx.modules.BillingDetailsModalModule({ user: this.user(), didUpdate: function () { f.getOffers() } })) }, confirmPurchase: function () { var f = this; nfx.app.modalStackController.replaceTopmost(new nfx.modules.ConfirmAssetPurchaseModalModule({ user: this.user(), offer: this.offer(), asset: this.asset(), proPlanSmallest: this.proPlanSmallest(), didConfirmPurchase: function () { f.purchase() }, didConfirmPro: function () { f.beginSubscribeToPro() } })) }, requestCashDeposit: function () { var f = this; nfx.app.modalStackController.replaceAllWithLoader("Hang tight..."); nfx.api.commerce.listCreditCards().then(function (g) { nfx.app.modalStackController.replaceTopmost(new nfx.modules.DepositCashModalModule({ creditCards: g.creditCards, referral: g.referral, didDeposit: function () { f.verifyBalance() } })) }, function (g) { Raven.captureMessage("listCreditCards failed:" + g); f.fail("Something went wrong", "Sorry, but it seems that we cant get a hold of the servers. Please reload the page and try again.") }) }, handleInsufficientFunds: function () { var f = this; nfx.app.modalStackController.replaceTopmost(new nfx.modules.InsufficientFundsModalModule({ user: this.user(), asset: this.asset(), proPlanSmallest: this.proPlanSmallest(), didChooseDeposit: function () { f.requestCashDeposit() }, didChoosePro: function () { f.beginSubscribeToPro() } })) }, purchase: function () { var f = this; nfx.app.modalStackController.replaceAllWithLoader("Hang tight..."); e.transport.post({ url: "/commerce/ajax/purchase", data: { asset_identifier: f.settings.asset.identifier, asset_primary_key: f.settings.asset.primary_key, license_id: f.offer().license().licenseId(), request_token: f.requestToken }, success: function (j) { var g, h, o, p = 0, q = "TBD", k, l, n; if (f.asset().type == "icon") { g = "icon-" + f.asset().icon_id; h = "icon"; o = f.asset().tags.join(", ") + " icon"; k = "Icon"; l = f.offer().price(); n = { price: f.offer().price(), product_id: g, product_type: h, icon_id: parseInt(f.asset().icon_id, 10) } } else { if (f.asset().type == "iconset") { g = "iconset-" + f.asset().iconset_id; h = "package"; o = f.asset().name; k = "Icon set"; l = f.offer().price(); n = { price: f.offer().price(), iconset_id: parseInt(f.asset().iconset_id, 10), product_id: g, product_type: "iconset" } } else { if (f.asset().type == "custom_service") { g = "service-" + f.asset().iconset_id; h = "service"; o = "custon"; k = "Custom service"; l = f.asset().service_id; n = { price: f.offer().price(), iconset_id: parseInt(f.asset().iconset_id, 10), product_id: g, product_type: "iconset" } } else { console.log("Cannot handle asset type " + f.asset().type); Raven.captureMessage("Cannot handle asset type " + error) } } } if (k) { e.tracking.trackEvent("Commerce", "Buy", k, l * 1.25, n) } e.tracking.trackTransaction(f.requestToken, q, f.offer().price(), p, g, o, h, f.user().address().city(), f.user().address().state(), f.user().address().country()); f.isSuccessful = true; if (j.display_post_purchase) { f.displayCompletion() } else { nfx.app.modalStackController.dismissAll(); if (f.settings.success) { f.settings.success() } } }, error: function (g, h) { if (g == "insufficient_funds") { f.handleInsufficientFunds() } else { f.fail("Ooops", "We don't know why, but for some reason, the purchase fell through. Please reload the page and try again"); Raven.setExtraContext({ postData: this.data, code: g, response: h }); Raven.captureMessage("Purchase failed: " + g) } } }) }, verifyBalance: function () { var f = this; nfx.app.modalStackController.replaceAllWithLoader("Hang tight..."); nfx.api.account.getUser().then(function (g) { f.user(g); if (f.user().balance() < f.offer().price()) { f.handleInsufficientFunds() } else { f.confirmPurchase() } }, function () { f.fail("Ooops", "We don't know why, but for some reason, we can't get your current balance. Please reload the page and try again."); Raven.captureMessage("Verify Balance failed") }) }, displayCompletion: function () { var f = this; nfx.app.modalStackController.replaceTopmost(new nfx.modules.AssetPurchaseCompletedModalModule({ asset: this.asset(), didDismiss: function () { if (f.settings.success) { f.settings.success() } } })) }, beginSubscribeToPro: function () { var f = this; nfx.app.modalStackController.replaceAllWithLoader("Hang tight..."); nfx.api.commerce.listCreditCards().then(function (h) { f.user(h.user); var g = null, k = f.proPlanSmallest().identifier(), l = "monthly"; if (h.creditCards.length) { for (var j = 0; j < h.creditCards.length; j++) { var n = h.creditCards[j]; if ((n.isDefault()) && (n.paymentProvider() == "stripe")) { g = n; break } } } if (!g) { nfx.app.modalStackController.replaceTopmost(new nfx.modules.SubscriptionPaymentModalModule({ pricingPlanIdentifier: k, billingInterval: l, creditCards: h.creditCards, didSubscribe: function (p, o) { f.didSubscribeToPro(p, o) } })); return } e.transport.post({ url: "/pro/ajax/subscribe", data: { card_id: g.cardId(), billing_interval: "monthly", plan_identifier: k }, success: function (o) { f.didSubscribeToPro(new nfx.models.ProSubscription(o.proSubscription), new nfx.models.Transaction(o.transaction)) }, error: function (o, p) { var q = "Something went wrong while trying to set up your subscription."; switch (o) { case "invalid_credit_card": q = "Invalid credit card data. Please check your credit card data below."; break; case "credit_card_declined": q = "Your credit card was declined, sorry."; break; case "invalid_data": q = "The data you have entered is not valid."; break; case "suspicious_activity": q = "Your account has been flagged for suspicious activity. A support staff will review your account shortly. We're sorry about the inconvenience."; break }nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", q); Raven.setExtraContext({ code: o, response: p, card_id: g.cardId(), xhr: JSON.stringify(this) }); Raven.captureMessage("Subscription failed: " + o) } }) }, function (g) { nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", "Sorry, but it seems that we can't get a hold of the servers. Please reload the page and try again.") }) }, didSubscribeToPro: function (h, g) { var f = h.plan().identifier(); e.tracking.trackEvent("Commerce", "Pro: Subscribe", f, g.amountPayment()); e.tracking.trackTransaction(g.transactionId(), "Iconfinder", g.amountPayment(), 0, f, f, "Pro: Subscription", "N/A", "N/A", "N/A"); nfx.app.modalStackController.replaceTopmost(new nfx.modules.SubscriptionCreatedModalModule({ proSubscription: h, transaction: g, canDismissToReload: true })) } }); e.commerce.purchase = function (g) { if (!b.USER) { nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: function () { location.reload() } })); return } var f = a.create(g) } })(window, window.Nextfinder, window.jQuery); (function (a, d, b, c) { d.commerce.deposit_cash = function (f) { var e = this; var h = b.extend({}, { success: function () { } }, f || {}); nfx.app.modalStackController.replaceAllWithLoader("Hang tight..."); function g(j) { nfx.app.modalStackController.replaceTopmost(new nfx.modules.DepositCashModalModule({ creditCards: j.creditCards, referral: j.referral, didDeposit: function () { nfx.app.modalStackController.dismissAll(); h.success() } })) } nfx.api.commerce.listCreditCards().then(function (j) { if (!j.user.hasSufficientBillingDetails()) { nfx.app.modalStackController.replaceTopmost(new nfx.modules.BillingDetailsModalModule({ user: j.user, didUpdate: function () { g({ creditCards: j.creditCards, referral: j.referral }) } })); return } g({ creditCards: j.creditCards, referral: j.referral }) }, function (j) { nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", "Sorry, but it seems that we can't get a hold of the servers. Please reload the page and try again.") }) } })(window, window.Nextfinder, window.jQuery); (function (a, b, c) { a.Nextfinder.icons = { init: function () { }, getBase64: function (e) { var f = b(e).data("format"); if (f == "svg") { b.ajax({ dataType: "text", url: b(e).attr("href"), success: function (g) { a.Nextfinder.modals.ShowDataURI.create({ datauri: "data:image/svg+xml;base64," + Base64.encode(g), format: f }) } }) } else { var d = new Image(); d.src = b(e).attr("href"); d.onload = function () { var h = document.createElement("canvas"); h.width = this.width; h.height = this.height; var g = h.getContext("2d"); g.drawImage(this, 0, 0); var j = h.toDataURL("image/" + f); a.Nextfinder.modals.ShowDataURI.create({ datauri: j, format: f }) } } } } })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.icons.details = a.Class.extend({ init: function () { var e = this; c('[data-action="buy-detailed-icon"]').click(function () { var h = c(this).attr("data-icon-id"); b.Nextfinder.commerce.purchase({ asset: { identifier: "icon", primary_key: h }, success: function () { location.reload() } }); Nextfinder.tracking.trackEvent("Commerce", "Click to buy", "Icon", h, { icon_id: parseInt(h, 10) }) }); c('[data-action="select-size"]').click(function (h) { h.preventDefault(); e.selectSize(c(this).data("iconsize")) }); var f = b.location.hash.match(/size=(\d+)/); if (f !== null) { this.selectSize(parseInt(f[1], 10)) } var g = c("#detail-icon"); this.iconId = g.attr("data-icon-id"); this.iconIsPremium = (g.attr("data-icon-is-premium") == "true"); this.iconIsPurchased = (g.attr("data-icon-is-purchased") == "true"); Nextfinder.tracking.trackEvent("Icon", "View details", (this.iconIsPremium ? (this.iconIsPurchased ? "Premium, purchased" : "Premium") : "Non-premium"), this.iconId) }, selectSize: function (g) { if (c("#alternativesizes").length == 0) { return } var e = c('#alternativesizes .alticons[data-size="' + g + '"]'); currentAlternativeContainer = e.siblings("[data-size]:hidden"); if (e.length == 0) { return } var h = c("#detail-icon #downloadlinks"); h.find("a[data-size]").each(function () { var j = c(this).data("size"); var k = c(this).attr("href"); var l = k; k = k.replace("png/" + j, "png/" + g); k = k.replace("svg/" + j, "svg/" + g); c(this).attr("href", k); c(this).data("size", g) }); var f = e.find(".hiddenicon img"); if (f.length == 0) { f = e.find("img") } c("#detail-icon-img").attr("src", f.attr("src")).attr("width", f.attr("width")).attr("height", f.attr("height")); c(".iconsize").parent().removeClass("active"); c("[data-iconsize=" + g + "]").parent().addClass("active"); currentAlternativeContainer.css("display", "block"); e.css("display", "none"); b.location.hash = "size=" + g } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.icons.admin_all_iconsets = a.Class.extend({ createCollection: function () { var e = this; var f = c("body").createFormModal({ title: "New collection", template: "iconsets/templates/new_collection.html", actionLabel: "Create collection" }, function (g) { location.reload() }) }, init: function () { var e = this; c('[data-action="new-collection"]').click(function () { e.createCollection(); return false }); c('[data-action="delete-collection"]').click(function () { e.deleteCollection(c(this).closest("[data-collection-id]").attr("data-collection-id")); return false }); c('[data-action="edit-collection"]').click(function () { e.editCollection(c(this).closest("[data-collection-id]").attr("data-collection-id")); return false }); c('[data-action="delete-iconset"]').click(function () { e.deletePackage(c(this).closest("[data-iconset-id]").attr("data-iconset-id")); return false }) }, deleteCollection: function (e) { if (confirm("Are you sure you want to delete this collection?")) { c.ajax({ type: "POST", url: "/collections/" + e + "/delete", success: function () { c("table").find("[data-collection-id='" + e + "']").remove(); c.pnotify({ pnotify_title: "Collection deleted", pnotify_text: "One collection was deleted." }) } }) } }, editCollection: function (e) { c.ajax({ type: "GET", url: "/collections/" + e + "/edit", success: function (g) { var f = c("body").createFormModal({ title: "Edit collection", template: "iconsets/templates/edit_collection.html", actionLabel: "Update collection", context: g }, function (h) { location.reload() }) } }) }, deletePackage: function (e) { if (confirm("Are you sure you want to delete this iconset?")) { c.ajax({ type: "POST", url: "/iconsets/" + e + "/delete", success: function () { c("table").find("[data-iconset-id='" + e + "']").remove(); c.pnotify({ pnotify_title: "Icon set deleted", pnotify_text: "One icon set and its icons was deleted." }) } }) } } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.icons.admin_problematic = a.Class.extend({ init: function () { var f = this; var e = c(".tags").tagsInput({ width: "auto" }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.icons.admin_merge_icons = a.Class.extend({ init: function () { var f = this; var e = c("input.tags").tagsInput({ width: "auto" }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.icons.registration_required = a.Class.extend({ init: function () { c(".fixture").remove(); nfx.app.modalStackController.present(new nfx.modules.FreeDownloadPromptModalModule({ onAuthenticate: function () { location.reload() } }), false) } }) })(window, window.jQuery); (function (a, b) { a.Nextfinder.browse = {} })(window); (function (a, b, c) { a.Nextfinder.categories = { init: function () { b(document).on("click", ".category-list-toggle a", function () { b(".link-grid").toggle(); b(".category-menu-container").toggleClass("active"); b(".category-list-toggle a").eq(0).html((b(".category-list-toggle a").eq(0).html() == "Show categories") ? "Hide categories" : "Show categories"); return false }) } } })(window, window.jQuery); (function (a, b) { a.Nextfinder.search = {} })(window); (function (l, v, e, g) { var c = l.Nextfinder; c.COOKIE_SEARCH_FILTER_MENU = "search_filter_menu"; var s = 48; var C = 3; var A = 1; var B = s * C; var f = 0; var k = null; var E = 0; var D = 3; var r = true; var d = 7; function z() { E = b(); var G = e(l).width(); if (k != G) { if (e(".premium-icons").hasClass("collapsed")) { hidePremiumIcons() } h() } k = G } function p() { var G = e(".premium-icons"); G.removeClass("collapsed").find(".expand").remove(); G.children(":hidden").each(function (H) { e(this).fadeIn() }); Nextfinder.tracking.trackEvent("Search results", "Expand premium icons", "Click button"); return false } function b() { var G = e("#icons").innerWidth() - (parseInt(e("#icons").css("padding-left")) + parseInt(e("#icons").css("padding-right"))); var H = n(); var I = Math.round(G / H); if (I > 0 && I < 50) { return I } else { console.log("Error: Cells per row is less than 0 or more than 50. CellPerRow value: " + I); return false } } function n() { var G = e("#searchresults .icon:visible").eq(0).outerWidth(true); if (G > 0 && G < 2000) { return G } else { console.log("Error: Icon width is less than 0 or more than 2000. iconWidth value: " + G); return false } } function F() { var G = e(".icon.premium").length; if (typeof G == "undefined") { G = 0 } return G } function t() { var G = y() - F(); if (typeof G == "undefined") { G = 0 } return G } function q() { var G = e(".icon.premium:visible").length; if (typeof G == "undefined") { G = 0 } return G } function y() { var G = e("#icons").data("totalresults"); return G } function w() { var G = e("#icons .icon:visible").length; if (e(".expand:visible").length > 0) { G = G + 2 } return G } function u() { var G = e(".icon:visible").length; return G } function h() { var N = e("#icons .icon").first().outerHeight(true); try { var K = visibleIcons = w(); var I = q(); if (K > B * A) { K = B * A } if (A < (visibleIcons / (s * C))) { K = K + q() } var M = Math.ceil(K / E); var J = M * N; var G = 80; var H = J + G + "px"; e("#icons").css("height", H) } catch (L) { console.log("Error: Failed to autosize icons container: " + L) } } function j() { e("#icons").append(e("<div id='infscr-finished' class='button-container'><button class='btn btn-large scrolltotop'>Go to the top</button></div>")) } function o(G, H, I) { G.html("Loading new results ...").removeClass("not-loading"); G.remove(); A++; l.Nextfinder.currentView.addContinousScrolling(H, I); h(); return false } function a(G) { if (e(G).hasClass("premium")) { return true } else { return false } } function x(G) { if (a(G)) { return G.index(".icon.premium") + 1 } else { return G.index("#icons > .icon") + 1 } } l.hidePremiumIcons = function () { var J = e(".premium-icons"); var K = F(); var I = y(); var H = e(".expand"); var G = b(); if (I - K < G * 2) { D = 6 } if (K == I) { H.hide() } else { if (G * D == K) { e(".premium-icons .icon").show(); H.hide() } else { if (G * D > K) { e(".premium-icons .icon").show(); H.hide() } else { J.children().each(function (L) { if (L >= (G * D) && !e(this).hasClass("expand")) { e(this).hide() } else { e(this).show() } }) } } e("div#icons div.premium-icons div.expand a").click(function () { p(); h(); return false }) } }; c.search.results = c.Class.extend({ validFilters: ["license", "minimum", "maximum", "type", "style", "price"], setCookies: function (G, H) { e.get("/ajax/cookie/", G, function (I) { if (H) { H() } }) }, setCookiesAndUpdate: function (H) { var G = this; this.setCookies(H, function () { G.reloadResults(G.properties.page, G.properties.items_per_page, G.properties.continous_scrolling) }) }, persistFilters: function (I) { if (!r) { console.log("Error: Filters are persisted but remberFilters is not set to 'true'."); return false } for (var H = 0; H < this.validFilters.length; H++) { var G = this.validFilters[H]; var J = I[G]; if (J === g || J === null) { e.removeCookie(G, { path: "/" }) } else { e.cookie(G, J, { path: "/", expires: d }) } } }, clearPersistedFilters: function () { if (r) { console.log("Error: Persisted filters are being cleared but remberFilters is set to 'true'."); return false } for (var H = 0; H < this.validFilters.length; H++) { var G = this.validFilters[H]; e.removeCookie(G, { path: "/" }) } }, serializeFilters: function (J) { if (J === g) { if (this.filters === g) { this.parseFilterState() } J = this.filters } var G = { q: J.query }; if ((J.license !== g) && (J.license != "0")) { G.license = J.license } for (var I = 0; I < this.validFilters.length; I++) { var H = this.validFilters[I]; var K = J[H]; if (K !== g) { G[H] = K } } return G }, modifyFilters: function (I) { var H = e.extend({}, this.filters); for (var J in I) { if (I.hasOwnProperty(J)) { H[J] = I[J] } } var G = this.serializeFilters(H); History.pushState(G, e("html > head > title").html(), "?" + e.param(G)); if (r) { this.persistFilters(this.serializeFilters()) } }, showLoader: function () { if (e("#infscr-loading").length == 0) { e("body").append(e("<div id='infscr-loading'>&nbsp;</div>")); this.loadTimer = setTimeout(function () { e("#infscr-loading").fadeIn() }, this.loaderDelay) } }, hideLoader: function () { clearTimeout(this.loadTimer); var G = e("#infscr-loading"); G.fadeOut("fast", function () { G.remove() }) }, addContinousScrolling: function (H, K) { var G = this; f = H; e("#pagination").hide(); var J = Math.ceil(e("#icons").data().totalresults / K); if (J > 1) { j() } var L = e("#infscr-finished"), I = { offset: "before-bottom-in-view" }; L.show(); L.waypoint(function (M, N) { L.detach(); L.waypoint("remove"); if (u() < B * A) { if (f++ < J - 1) { G.showLoader(); e.get("/ajax/search/", e.extend({ page: f }, G.serializeFilters()), function (P) { var O = e(P); e("#icons").append(O.find(".icon")); e("#icons").append(L); e("#loadmoreicons").detach(); L.waypoint(I); G.hideLoader(); h() }) } else { e("#icons").append(L); e(".scrolltotop").css("display", "block"); G.hideLoader() } } else { G.hideLoader(); e("#icons").append("<div id='loadmoreicons' class='button-container'><button class='btn btn-large btn-primary not-loading' id='loadmoreiconsbutton'>Show more icons</button></div>"); e("#loadmoreiconsbutton").click(function () { o(e(this), f, K) }) } }, I); if (e(".icon").length == 0) { L.hide() } }, attachAlertBar: function () { if (e(".attachAlertBar-wrapper").length != 0) { var G = e(".attachAlertBar-wrapper").offset().top - 100; var H = function () { var I = e(l).scrollTop(); if (I > G) { e(".attachAlertBar-wrapper").addClass("attachAlertBar") } else { e(".attachAlertBar-wrapper").removeClass("attachAlertBar") } }; H() } }, reloadResults: function (K, L, J, G) { var H = this; A = 1; var I = e("#searchresults").eq(0); l.scrollTo(0, 0); I.addClass("loading"); H.showLoader(); e.get("/ajax/search/", e.extend({ page: K, crossDomain: false }, this.serializeFilters()), function (M) { H.hideLoader(); I.removeClass("loading"); I.html(M); hidePremiumIcons(); H.attachAlertBar(); H.updateStylesIconsCount(); if (G != true) { H.initHorizontalScrolling(e(".searchresults-horizontal:first").eq(0)) } if (J) { H.addContinousScrolling(K, L); h() } return false }); return false }, updateStylesIconsCount: function () { var J = e("#searchresults"), H = J.attr("data-icons-count-for-styles"), G = {}, I = 0; if ((H !== g) && (H !== null) && (H !== "")) { G = e.parseJSON(H) } for (key in G) { I += G[key] } e("#style-nav [data-style-id]").each(function () { var K = e(this).attr("data-style-id"); e(this).find(".style-count").html(G[K] || 0) }); e('#style-nav [data-listing="any"] .style-count').html(I) }, setTypeFilter: function (G) { Nextfinder.tracking.trackEvent("Settings", "Filter type", G); this.modifyFilters({ type: (G == "any" ? g : G) }) }, setPriceFilter: function (G) { Nextfinder.tracking.trackEvent("Settings", "Filter price", G); this.modifyFilters({ price: (G == "any" ? g : G) }) }, setStyleFilter: function (G) { Nextfinder.tracking.trackEvent("Settings", "Filter style", G); this.modifyFilters({ style: (G == "any" ? g : G) }) }, setBackgroundColorFilter: function (I) { this.setCookies({ bgcolor: I }); var H = e('[data-search-filter="background-color"]'); H.find('[data-value!="' + I + '"]').removeClass("active"); H.find('[data-value="' + I + '"]').addClass("active"); var G = e("#icons"); e.each(["white", "black", "gray", "transparent"], function (J, K) { G.toggleClass("icons-container-" + K, K == I) }); Nextfinder.tracking.trackEvent("Settings", "Set background color", I) }, setLicenseScopeFilter: function (G) { Nextfinder.tracking.trackEvent("Settings", "Filter license", G); this.modifyFilters({ license: (G == "0" ? g : G) }) }, initHorizontalScrolling: function (J) { var P = this; var G = e(J).find(".searchresults-inner:first").eq(0); var M = G.find(".iconset-preview").length; var L = M; var K = e(l).width(); var N = G.children(".iconset-preview:first").eq(0).outerWidth(); var I = Math.floor(K / N); var H = G.css("left"); var O = 0; if (L > I) { e(J).find(".nav-next").show() } e(v).on("click", ".searchresults-nav", function () { H = parseInt(G.css("left")); var R = moveRight = I; if (L < I) { R = L } if (e(this).hasClass("nav-next")) { O = (H - R * N) + " px"; L = L - I } if (e(this).hasClass("nav-prev")) { O = (H + moveRight * N) + " px"; L = L + I } e(J).find(".searchresults-nav").hide(); G.animate({ left: O }, 250, function () { if (parseInt(O) == 0) { e(J).find(".nav-prev").hide() } else { e(J).find(".nav-prev").show() } if (L <= I) { e(J).find(".nav-next").hide() } else { e(J).find(".nav-next:hidden").show() } }); return false }) }, parseFilterState: function (G) { if (G === g) { G = e.url().param() } G.q = e("#inputField").val(); this.filters = { query: G.q, minimum: ((G.minimum == "") || (G.minimum == "0") ? g : G.minimum), maximum: ((G.maximum == "") || (G.maximum == "0") ? g : G.maximum), license: ((G.license == "") || (G.license == "0") ? g : G.license), type: (G.type == "" ? g : G.type), price: (G.price == "" ? g : G.price), style: (G.style == "" ? g : G.style) } }, updateFilterUi: function () { var P = this; var M = (this.filters.type == g ? "any" : this.filters.type), K = e('[data-search-filter="type"]'); K.find('button[data-value][data-value!="' + M + '"]').removeClass("active"); K.find('button[data-value="' + M + '"]').addClass("active"); var L = (this.filters.price == g ? "any" : this.filters.price), N = e('[data-search-filter="price"]'); N.find('[data-value!="' + L + '"]').removeClass("active"); N.find('[data-value="' + L + '"]').addClass("active"); var I = (this.filters.license == g ? "0" : this.filters.license), J = e('[data-search-filter="license-scope"]'); J.find('[data-content="selected-description"]').html(J.find('[data-value="' + I + '"] [data-content="description"]').html()); var R = (this.filters.style == g ? "any" : this.filters.style), O = e('[data-search-filter="style"]'); O.find('[data-listing!="' + R + '"]').removeClass("active"); O.find('[data-listing="' + R + '"]').addClass("active"); O.find("[data-listing]").each(function () { var S = e.extend({}, P.filters), T = e(this).attr("data-listing"); S.style = (T == "any" ? g : T); e(this).attr("href", "/search/?" + e.param(P.serializeFilters(S))) }); if (this.filters.minimum === g) { var H = 0 } else { var H = this.filters.minimum } if (this.filters.maximum === g) { var G = 128 } else { var G = this.filters.maximum } e(".size-slider").val([H, G]); e("#min-disp").val(H + " px"); e("#max-disp").val(G + " px"); e("#inputField").val(this.filters.query); e(".reset-all-filters").show() }, init: function () { var H = this; e("#view-search #style-nav").sticky({ topSpacing: 60 }); e("#view-search #filter-menu").sticky({ bottomSpacing: e(".footer").outerHeight(), topSpacing: (60 + 47) }); this.properties = e.extend({ continous_scrolling: false }, l.SEARCH_PROPERTIES); this.loadTimer = null; this.loaderDelay = 700; if (this.properties.continous_scrolling) { if (y() > 0) { this.addContinousScrolling(this.properties.page, this.properties.items_per_page) } z() } if (e("#inputField").val() == "doge") { e("#view-search *").css("font-family", "Comic Sans MS"); e("#searchresults h3").prepend("Wow! "); var G = ["red", "blue", "green", "orange"]; e("#view-search a").each(function () { e(this).css("color", G[Math.floor(Math.random() * G.length)]) }) } this.updateStylesIconsCount(); r = e.cookie("remember-filters"); if (r !== g) { if (r === "true") { r = true } else { if (r === "false") { r = false } else { console.log("Cookie set to invalid value of: (" + typeof (r) + ")" + r); console.log("Deleting cookie: remember-filters"); e.removeCookie("remember-filters") } } if (e("#remember-filters").length) { e("#remember-filters").prop("checked", r) } } else { if (e("#remember-filters").prop("checked")) { e.cookie("remember-filters", "true", { path: "/", expires: d }); r = true } else { e.cookie("remember-filters", "false", { path: "/", expires: d }); r = false } } this.parseFilterState(); History.Adapter.bind(l, "statechange", function () { H.parseFilterState(History.getState().data); H.updateFilterUi(); H.reloadResults(H.properties.page, H.properties.items_per_page, H.properties.continous_scrolling) }); this.attachAlertBar(); e(l).resize(z); e("#style-nav .style-tabs").collapsableHorizontalMenuBar(); Nextfinder.tracking.trackEvent("Search results", "Rows of premium icons", D + ""); H.initHorizontalScrolling(e(".searchresults-horizontal:first").eq(0)); e('[data-search-filter="type"] [data-value]').click(function (N) { N.preventDefault(); H.setTypeFilter(e(this).data("value")) }); e('[data-search-filter="price"] [data-value]').click(function (N) { N.preventDefault(); H.setPriceFilter(e(this).data("value")) }); e(v).on("click", ".premium-icons .filter-premium a", function () { H.setPriceFilter("premium"); Nextfinder.tracking.trackEvent("Search results", "Show only premium icons", "Click"); return false }); e('[data-search-filter="license-scope"] [data-value]').click(function (N) { N.preventDefault(); H.setLicenseScopeFilter(e(this).data("value")) }); var I = e(".size-slider"); if (I.length > 0) { try { if (this.filters.minimum === g) { var K = 0 } else { var K = this.filters.minimum } if (this.filters.maximum === g) { var M = 128 } else { var M = this.filters.maximum } I.noUiSlider({ start: [K, M], range: { min: [0, 16], "15%": [16, 16], "30%": [32, 32], "50%": [64, 32], "65%": [128, 128], "80%": [256, 256], max: [512] } }).on("change", function () { var N = new Array(); N = e(this).val(); N[0] = Math.round(N[0]); N[1] = Math.round(N[1]); H.modifyFilters({ minimum: (N[0] == "0" ? g : N[0]), maximum: (N[1] == "128" ? g : N[1]) }) }).on("slide", function () { var N = new Array(); N = e(this).val(); N[0] = Math.round(N[0]); N[1] = Math.round(N[1]); e("#min-disp").val(N[0] + " px"); e("#max-disp").val(N[1] + " px") }) } catch (J) { console.log("Error: failed loading filters: " + J) } } e('[data-search-filter="background-color"] [data-value]').click(function (N) { N.preventDefault(); H.setBackgroundColorFilter(e(this).data("value")) }); e('[data-search-filter="style"] [data-listing]').click(function (N) { N.preventDefault(); H.setStyleFilter(e(this).data("listing")) }); e("#remember-filters").change(function (N) { r = e(this).is(":checked"); e.removeCookie("remember-filters"); e.cookie("remember-filters", r, { path: "/", expires: d }); if (r) { H.persistFilters(H.serializeFilters()) } else { H.clearPersistedFilters() } }); function L(O, N) { e(v).on("click", '[data-action="reset-' + O + '-filter"]', function () { H.modifyFilters(N); return false }) } L("size", { minimum: g, maximum: g }); L("type", { type: g }); L("price", { price: g }); L("license", { license: g }); L("style", { style: g }); e(v).on("click", '[data-action="reset-all-filters"]', function () { H.modifyFilters({ minimum: g, maximum: g, type: g, price: g, license: g, style: g }); e(".reset-all-filters").hide(); return false }); e(".filter-tab > a").on("click", function () { e(".back-container").toggleClass("filters-active"); e(this).toggleClass("active"); if (e(this).hasClass("active")) { e.cookie(l.Nextfinder.COOKIE_SEARCH_FILTER_MENU, true, { path: "/", expires: d }) } else { e.cookie(l.Nextfinder.COOKIE_SEARCH_FILTER_MENU, false, { path: "/", expires: d }) } }); if (e(".filter-tab a").hasClass("active") && l.Nextfinder.COOKIE_SEARCH_FILTER_MENU == "true") { e("#searchresults-outer, .footer.contentpage").addClass("active") } else { e("#searchresults-outer, .footer.contentpage").removeClass("active") } e("#filters .filter .btn, #filters .filter .btn-group").click(function () { e(this).parent("div").addClass("active") }); e(".close-filter, .close-filter img, .default").click(function () { e(this).parent("div").removeClass("active") }) } }) })(window, window.document, window.jQuery); (function (a, b) { a.Nextfinder.iconfinder = {} })(window); (function (b, c, d) { var a = b.Nextfinder; a.iconfinder.index = a.Class.extend({ init: function () { var e = this; c(document).ready(function () { var f = this; c(".search-filter").each(function () { console.log(c(this).attr("name") + " - " + c(this).attr("value")) }); function g(k, j) { c(document).on("click", '[data-action="reset-' + k + '-filter"]', function () { c.removeCookie(k); c("#searchform").find("input[name='" + k + "']").remove(); c(this).remove(); if (c(".tag-label").length === 0) { c(".active-filters-label").remove() } return false }) } g("minimum", { minimum: d }); g("maximum", { maximum: d }); g("type", { type: d }); g("price", { price: d }); g("license", { license: d }); g("style", { style: d }); c(".browse-icon-menu").mouseover(function () { var j = c(".nav-slide ul li"); c(j).each(function (l) { var k = c(this); setTimeout(function () { k.show("slide", { direction: "left" }, 80) }, 40 * l) }) }); c(".search").mouseover(function () { var j = c(".nav-slide ul li"); c(j).each(function (k) { c(this).hide("slide", { direction: "left" }, 80) }) }); var h = (function () { var k = c("#cbp-hrmenu > ul > li"), q = k.children("a"), l = c("body"), n = -1; function p() { q.on("click", j); k.on("click", function (r) { r.stopPropagation() }) } function j(t) { if (n !== -1) { k.eq(n).removeClass("cbp-hropen") } var s = c(t.currentTarget).parent("li"), r = s.index(); if (n === r) { s.removeClass("cbp-hropen"); n = -1 } else { s.addClass("cbp-hropen"); n = r; l.off("click").on("click", o) } return false } function o(r) { k.eq(n).removeClass("cbp-hropen"); n = -1 } return { init: p } })().init() }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.iconfinder.redeem = a.Class.extend({ getCouponCode: function () { return c.trim(this.inputField.val()) }, isCouponCodeSubmittable: function () { return this.getCouponCode().length == 15 }, submitCouponCode: function () { var e = this; if (!this.isCouponCodeSubmittable()) { return } Nextfinder.transport.post({ url: "/commerce/coupon-codes/" + this.getCouponCode() + "/redeem", success: function (f) { c(".coupon-amount").text(f.amount); e.selectCard(".card-success-done") }, error: function (f) { if (f == "not_authenticated") { e.selectCard(".card-success-authenticate") } else { if (f == "too_many_redeemed") { e.selectCard(".card-too-many-redeemed") } else { e.selectCard(".card-error") } } } }) }, selectCard: function (e, f) { c(".redeem-card-container .card:not(:hidden)").hide(); c(".redeem-card-container " + e).show(); if (f) { f() } }, init: function () { var f = this; f.inputForm = c(".card-input form"); f.inputField = f.inputForm.find('input[type="text"]'); f.submitButton = f.inputForm.find('input[type="submit"]'); f.inputForm.on("submit", function () { f.submitCouponCode(); return false }); f.inputField.on("change keypress keyup keydown", function () { var g = f.isCouponCodeSubmittable(); f.submitButton.attr("disabled", !g).toggleClass("active", g) }); c(".card-error").find("a.back").click(function () { f.selectCard(".card-input") }); function e() { f.submitCouponCode(); nfx.app.modalStackController.dismissAll() } c(".card-success-authenticate a.login").click(function () { nfx.app.modalStackController.present(new nfx.modules.LogInModalModule({ onAuthenticate: e })); return false }); c(".card-success-authenticate a.signup").click(function () { nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: e })); return false }) } }) })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.submissions = { init: function () { } } })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.submissions.submission_analysis = a.Class.extend({ init: function () { var f = this; var e = function () { c.getJSON("/iconsets/submissions/" + b.SUBMISSION_ID + "/state", function (g) { if ((g) && (g.state) && (g.state != 100)) { location.href = "/iconsets/submissions/" + b.SUBMISSION_ID; return } setTimeout(e, 1000) }) }; setTimeout(e, 1000) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.submissions.submission_information = a.Class.extend({ init: function () { var o = this; var n = c('input[name="author"]'), l = n.find('option:not([value^="u:"])'), e = c('input[name="designer_name"], input[name="designer_url"]'); c('input[name="submission_type"]').change(function () { c(".option").removeClass("active"); c(this).parent().parent().addClass("active"); var r = c('input[name="submission_type"]:checked').val(); var s = (r == "premium" || r == "someonepremium"), q = (r != "someone" && r != "someonepremium"); c(".details-content-designer").toggle(!q); c(".details-content-collection").toggle(q); c(".details-content-premium").toggle(s); c(".details-url").toggle(!s); c(".details-content-license").toggle(!s); c('input[name="is_premium"]').val(s ? "on" : ""); c('input[name="is_designer"]').val(q ? "on" : ""); var p = (n.length == 0 ? null : n.val()); if (p == "") { p = null } if (s) { if ((p !== null) && (p.substr(0, 2) != "u:")) { n.val("").trigger("change") } l.attr("disabled", "disabled"); e.attr("disabled", "disabled") } else { l.removeAttr("disabled"); if (p === null) { e.removeAttr("disabled") } else { e.attr("disabled", "disabled") } } }); c("#id_collection").change(function () { if (c(this).val() == "create") { c(this).val(""); b.Nextfinder.modals.CreateCollection.create({ callback: function (r, p) { var q = c("<option></option"); q.val(r); q.html(p); c("#id_collection option:last-child").before(q); c("#id_collection").val(r); c.pnotify({ pnotify_title: 'Created collection "' + p + "'", pnotify_text: "Your new collection has been created and is ready for use." }) } }) } }); n.select2({ placeholder: "Create a new designer or pick existing", minimumInputLength: 2, ajax: { url: "/iconsets/submissions/designers/search", dataType: "json", data: function (p, q) { return { q: p, exclude_authors: (c('input[name="submission_type"]:checked').val() == "someonepremium" ? "1" : "") } }, results: function (q, p) { return { results: q.designers } } }, initSelection: function (q, r) { var p = n.val(); if (p !== "") { c.ajax("/iconsets/submissions/designers/get?id=" + p, { dataType: "json" }).done(function (s) { r(s.designer) }) } }, allowClear: true }); function g() { if (n.val() == "") { c("#id_designer_name").removeAttr("disabled"); c("#id_designer_url").removeAttr("disabled") } else { c("#id_designer_name").attr("disabled", "disabled"); c("#id_designer_url").attr("disabled", "disabled") } } n.change(g); g(); var f = c('input[name="price_per_set"]'); var h = parseInt(c("[data-icons-count]").attr("data-icons-count"), 10); var k = c('select[name="price_per_icon"]'); function j(q) { var p = (q / 100) * h; var r = Math.floor(p); var t = 1; var s = Math.floor(p * 0.8); if (s > 9) { var u = s % 10; if (u < 3) { s -= u + 1 } else { if (u < 8) { s -= u - 4 } else { s -= u - 9 } } if (s > r) { s = r } } if (s < t) { s = t } f.val(s) } c(document).on("change", 'select[name="price_per_icon"]', function (p) { j(parseInt(k.val(), 10)) }); if (f.val() === "") { j(parseInt(k.val(), 10)) } } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.submissions.submission_preview = a.iconsets.base_edit_preview.extend({}) })(window, window.jQuery); (function (a, b, c) { var d = a.Nextfinder; d.submissions.submission_tag = d.Class.extend({ _initBindings: function () { var e = this; this.messagesContainer = b(".messages"); b("#action-delete").tableAction(function (g) { var f = function () { return e.deleteIcons(g) }; d.modals.ConfirmModal.create({ title: "Delete icons", message: "Are you sure you want to remove " + g.length + " icons?", callback: f }) }); b('[data-action="dismiss-submission"]').click(function (f) { f.preventDefault(); e.dismissSubmission(); return false }); b('[data-action="upload"]').click(function (f) { f.preventDefault(); location.href = "/iconsets/submit"; return false }) }, dismissSubmission: function () { var e = b("body").overlay(), f = b("body").createModal({ title: "Dismiss submission", content: "<article><section><p>Are you sure you want to dismiss this submission?</p><p>It'll be gone forever and ever, if you do. Seriously.</p></section></article>", action: "dismiss", backdrop: false }); f.find('[data-action="dismiss"]').click(function (g) { f.modal("hide"); e.overlayLoader("Hang tight..."); d.transport.post({ url: "/iconsets/submissions/" + a.SUBMISSION_ID + "/reject", success: function () { location.href = "/admin/icon-submissions/new" }, error: function () { e.remove(); alert("Failed to dismiss submission. Please try again or reload the page if the problem persists.") } }) }) }, deleteIcons: function (f) { var e = this; b.ajax({ type: "DELETE", url: "/iconsets/submissions/" + a.SUBMISSION_ID + "/icons", data: JSON.stringify({ submission_icon_id: f }), contentType: "application/json; charset=utf-8", dataType: "json", success: function (g) { b("input[type=checkbox]:not(#checkall)").each(function () { var n = false, k = b(this), l = k.attr("data-id"), j = f.length; while ((j--) && (!n)) { if (f[j] == l) { n = true } } if (!n) { return } var h = k.closest("tr"); h.fadeOut(500, function () { h.remove() }) }) }, failure: function (g) { console.log("Request failed:", g) } }) }, _updateTagWarning: function () { b(".tagsinput:has(span.tag):not(:has(span.warning))").closest("tr").removeClass("warning error"); b(".tagsinput:not(:has(span.tag))").closest("tr").removeClass("warning").addClass("error"); b(".tagsinput:has(span.warning)").closest("tr").removeClass("error").addClass("warning"); var f = b(".tagsinput:not(:has(span.tag))").length, e = b(".tagsinput span.warning").length; if (f > 0) { this.messagesContainer.html('<div class="alert alert-error" style="float: left;">' + (f == 1 ? "One icon has no tags." : f + " of the icons have no tags.") + "</div>") } else { if (e > 0) { this.messagesContainer.html('<div class="alert alert-warning" style="float: left;">' + e + ' of the tags look like they might not follow the tag guidelines. Please check the guidelines for <a href="http://support.iconfinder.com/contributor-s-handbook/tags">tagging</a>.</div>') } else { this.messagesContainer.html("") } } }, _initTagInputs: function (e) { var f = this, e = b("#confirm-icons"); function g() { f._updateTagWarning() } e.find("input.table-icon-tags").tagsInput({ onChange: g }); e.find(".tagsinput").css({ width: "", height: "" }); this._updateTagWarning() }, init: function () { var e = this; this._initBindings(); this._initTagInputs() } }) })(window, window.jQuery); (function (a, b, c) { var d = a.Nextfinder; a.Nextfinder.comments = { init: function () { var f = this; var e = b('[data-role="comments-container"]'); b(document).on("click", '[data-action="comment-delete"]', function (h) { h.preventDefault(); var g = b(this).closest("[data-comment-id]").attr("data-comment-id"); d.comments.del({ comment_id: g }) }); b(document).on("click", '[data-action="comment-mark-as-spam"]', function (h) { h.preventDefault(); var g = b(this).closest("[data-comment-id]").attr("data-comment-id"); d.comments.markAsSpam({ comment_id: g }) }); b(document).on("click", '[data-action="comment-reply"]', function (l) { l.preventDefault(); var k = b(this).closest("[data-comment-id]").attr("data-comment-id"); var j = b(this).closest("article"); var h = b("section.newcomment form").attr("action"); var n = n = b("form.reply"); if (n.length === 0) { n = b(f.getReplyForm(h, k)); j.after(n) } else { var g = n.closest("[data-comment-id]").attr("data-comment-id"); n.remove(); if (g == k) { return } n = b(f.getReplyForm(h, k)); j.after(n) } n.find("textarea").focus() }); b(document).on("click", '[data-action="comment-button"]', function (h) { h.preventDefault(); var j = b(this).data("referenceidentifier"); var g = b(this).data("referenceid"); if (b(".comments-overlay").eq(0).length > 0) { f.hideCommentsOverlay() } else { b("body").prepend("<div class='comments-overlay'></div>"); b(".comments-overlay").stop().show(); f.loadComments({ reference_identifier: j, reference_id: g, success: function (l) { var k = b(l); b(".comments-overlay").html(k); b(".comments-overlay").eq(0).prepend('<button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>') } }) } }); f.formHandler = function (k) { k.preventDefault(); var j = b(this); var n = b.trim(j.find('textarea[name="text"]').val()); var g = j.attr("action"); var l = j.find('input[name="parent_comment"]'); var h = (l.length > 0 ? l.val() : ""); d.comments.create({ url: g, parent_comment_id: h, text: n }) }; b(document).on("submit", '[data-role="comment-form"]', f.formHandler); b(document).on("focus", ".newcomment textarea", function () { b(this).parent().siblings("button").show() }); b(document).on("blur", ".newcomment textarea", function () { if (b(this).val() == "") { b(this).removeClass("has-comment"); b(this).parent().siblings("button").hide() } else { b(this).addClass("has-comment") } }); b(document).on("click", ".comments-overlay .close", function () { f.hideCommentsOverlay() }); b("#bulk-comment-delete").tableAction(function (g) { d.comments.del({ comment_ids: g }) }); b("#bulk-comment-mark-as-spam").tableAction(function (g) { d.comments.markAsSpam({ comment_ids: g }) }) }, hideCommentsOverlay: function () { b(".comments-overlay").remove() }, create: function (g) { var e = this; var f = g.url ? g.url : "/comments/" + g.reference_identifier + "/" + g.reference_id; b.ajax({ type: "POST", url: f, dataType: "json", data: { text: g.text, parent_comment_id: g.parent_comment_id }, success: function (h) { if (g.success) { g.success(h) } else { e.loadComments() } }, error: function (h, k, j) { if (g.error) { g.error(h, k, j) } else { b.pnotify({ pnotify_title: "Failed to post comment.", pnotify_text: "Something went wrong while trying to post your comment: " + j }) } } }) }, del: function (g) { var e = this; var f = g.comment_id ? "/comments/" + g.comment_id + "/delete" : "/comments/delete"; var h = g.comment_ids ? { comment_ids: JSON.stringify(g.comment_ids) } : {}; b.ajax({ type: "POST", url: f, dataType: "json", data: h, success: function (j) { if (g.success) { g.success(j) } else { b.pnotify({ pnotify_title: "Comment deleted.", pnotify_text: "Your comment has been deleted." }); e.loadComments() } }, error: function (j, l, k) { if (g.error) { g.error(j, l, k) } else { b.pnotify({ pnotify_title: "Failed to delete comment.", pnotify_text: "Something went wrong while trying to delete your comment." }); e.loadComments() } } }) }, markAsSpam: function (g) { var e = this; var f = g.comment_id ? "/comments/" + g.comment_id + "/spam" : "/comments/spam"; var h = g.comment_ids ? { comment_ids: JSON.stringify(g.comment_ids) } : {}; b.ajax({ type: "POST", url: f, data: h, dataType: "json", success: function (j) { if (g.success) { g.success(j) } else { b.pnotify({ pnotify_title: "Comment marked as spam.", pnotify_text: "The comment has been marked as spam." }); e.loadComments() } }, error: function (j, l, k) { if (g.error) { g.error(j, l, k) } else { b.pnotify({ pnotify_title: "Failed to mark comment as spam.", pnotify_text: "Something went wrong while trying to mark the comment as spam." }); e.loadComments() } } }) }, loadComments: function (h) { var f = b('[data-role="comments-container"]'); if (f.attr("data-comment-load") === "reload") { return location.reload() } var e = h ? h : {}; var k = e.reference_identifier || f.attr("data-reference-identifier"); var j = e.reference_id || f.attr("data-reference-id"); var g = "/comments/" + k + "/" + j + "/threads"; b.ajax({ type: "GET", url: g, success: function (l) { if (e.success) { e.success(l) } else { b(l).replaceAll('[data-role="comments-container"]') } }, error: function (l, o, n) { if (e.error) { e.error(l, o, n) } } }) }, getReplyForm: function (e, g) { var f = { submit_url: e, parent_comment_id: g }; if (typeof a.USER == "undefined") { return Handlebars.templates["comments/templates/not_logged_in.html"](f) } else { return Handlebars.templates["comments/templates/reply_form.html"](f) } } } })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.channels = { init: function (f) { var e = a.Nextfinder.channels; e.user_id = f.user_id; e.user_channel_token = f.user_channel_token; if (e.user_id && e.user_channel_token) { var d = new Faye.Client("/realtime_publish/channels/", { timeout: 120, retry: 5 }); d.addExtension(e.user_channel_auth); d.subscribe("/user/" + a.USER.user_id, function (g) { b(document).trigger(g.category, [g.channel, g.data]) }); d.subscribe("/broadcast", function (g) { console.log("broadcast message: " + g) }) } }, user_channel_auth: { outgoing: function (e, f) { var d = a.Nextfinder.channels; if (e.channel !== "/meta/subscribe") { return f(e) } if (!e.ext) { e.ext = {} } e.ext.user_id = d.user_id; e.ext.user_channel_token = d.user_channel_token; f(e) } } } })(window, window.jQuery); (function (a, b, c) { b(document).ready(function () { b(".alert").bind("closed", function () { var d = b(this).closest(".message-group"); var e = b(this).siblings(); if (e.length === 0) { d.remove() } }) }); a.setTimeout(function () { b(".alert.autoclose").fadeTo(500, 0).slideUp(500, function () { b(this).alert("close") }) }, 5000) })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.notification_messages = { init: function () { var d = this; var e = "/messages/notifications/read"; if (a.USER) { this.updateUnreadCounter(); b('[data-role="notification-get"]').on("click", function () { var f = b(this).closest("li.dropdown").hasClass("open"); if (f === false) { d.get() } }); b(document).on("click", '[data-notification-action="mark-all-as-read"]', function (f) { f.preventDefault(); b.post(e, { mark_all: true }, function () { d.updateUnreadCounter() }) }); b(document).on("click", '[data-notification-action="mark-as-read"]', function () { b.post(e, { message_id: b(this).attr("data-notification-id") }) }); b(document).on("new_notification_message", function (g, f, h) { d.updateUnreadCounter(h) }) } }, updateUnreadCounter: function (d) { var e = this; if (!d) { b.get("/messages/notifications/unread_counter", function (f) { e._setCounter(f.unread_counter) }) } else { e._setCounter(d) } }, _setCounter: function (e) { var d = b('[data-role="notification-counter"]'); if (e !== 0) { d.addClass("notification-counter-new"); d.closest(".navbar-item").removeClass("notification-hidden") } else { d.closest(".navbar-item").addClass("notification-hidden"); d.removeClass("notification-counter-new") } d.text(e) }, get: function () { b.get("/messages/notifications/", function (e) { var d = b('[data-role = "notification-messages"]'); d.html(e) }) } } })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.pro = { selectBillingInterval: function (d) { b(".monthly")[d == "monthly" ? "show" : "hide"](); b(".annual")[d == "monthly" ? "hide" : "show"](); b('[data-billing-interval="monthly"]').toggleClass("active", d == "monthly"); b('[data-billing-interval="annual"]').toggleClass("active", d != "monthly"); b("[data-selected-billing-interval]").data("selected-billing-interval", d) }, init: function () { b('[data-action="select-billing-interval"]').click(function () { a.Nextfinder.pro.selectBillingInterval(b(this).data("billing-interval")); return false }); if (a.location.search.indexOf("autoplay=yes") > -1) { b("#provideo-container").show(); b(".video-frame").attr("src", b(".video-frame").attr("src") + "&autoplay=1") } b(document).ready(function () { b(".fullscreen-bg").addClass("animate-init"); setTimeout(function () { b(".titles").addClass("animate-init") }, 350) }); b(a).load(function () { setTimeout(function () { b(".why-action .content, .pro-hero-wrapper").addClass("animate-init") }, 1000) }); b(".js-sticky-pro").sticky({ topSpacing: 0, className: "is-js-sticky", wrapperClassName: "js-sticky-wrapper" }); b(".why-action a").click(function () { var k = b(".fullscreen-bg").height() - 25; b("html, body").animate({ scrollTop: k }, 500); return false }); var j = b(".section-one"), g = { offset: "80%" }; var h = b(".section-two"), f = { offset: "80%" }; var e = b(".section-tree"), d = { offset: "75%" }; j.waypoint(function (k, l) { j.find(".image-wrapper").addClass("animate"); j.find(".content-wrapper").delay(200).queue(function () { b(this).addClass("animate").dequeue() }); j.find(".testify").delay(400).queue(function () { b(this).addClass("animate").dequeue() }) }, g); h.waypoint(function (k, l) { h.find(".image-wrapper").addClass("animate"); h.find(".content-wrapper").delay(300).queue(function () { b(this).addClass("animate").dequeue() }); h.find(".testify").delay(400).queue(function () { b(this).addClass("animate").dequeue() }) }, f); e.waypoint(function (k, l) { e.find(".image-wrapper").addClass("animate"); e.find(".content-wrapper").delay(300).queue(function () { b(this).addClass("animate").dequeue() }); e.find(".testify").delay(700).queue(function () { b(this).addClass("animate").dequeue() }) }, d); b('[data-action="select-billing-interval"]').click(function () { a.Nextfinder.pro.selectBillingInterval(b(this).data("billing-interval")); return false }) } } })(window, window.jQuery); $(document).ready(function () { if (!$.cookie("killProPromotion")) { $(".promotion-bar .close").click(function () { $(".promotion-bar").remove(); $(document.body).removeClass("has-promotion-bar"); $.cookie("killProPromotion", "true"); return false }) } }); (function (c, d, e) { var b = c.Nextfinder; var a = { performancePositive: "#5cbd00", performanceNegative: "#e44525", targetA: "#f9cb9c", targetB: "#fed86f", targetC: "#93c47d" }; b.pro.admin_sales_analysis = b.Class.extend({ drawChart: function () { var v = d("#net_subscribers_growth_chart").parent().width(), G = 200, B = [10, 70, 30, 20], u = d3.scale.ordinal().rangeRoundBands([0, v - B[1] - B[3]]), t = d3.scale.linear().range([0, G - B[0] - B[2]]), F = d3.time.format("%b %d"); var f = d3.select("#net_subscribers_growth_chart").attr("width", v).attr("height", G); var A = f.select("g.chart"); if (A[0][0] !== null) { A.remove() } A = f.append("svg:g").attr("class", "chart"); A.attr("transform", "translate(" + B[3] + "," + (G - B[2]) + ")"); function l(p, h) { return p.map(function (w) { return { x: w.date, y: w[h] } }) } var D = d3.layout.stack()(["performance"].map(function (h) { return l(c.NET_SUBSCRIBER_GROWTH_DATA, h) })); var J = [l(c.NET_SUBSCRIBER_GROWTH_DATA, "target_a"), l(c.NET_SUBSCRIBER_GROWTH_DATA, "target_b"), l(c.NET_SUBSCRIBER_GROWTH_DATA, "target_c")]; u.domain(D[0].map(function (h) { return h.x })); var s = [D[D.length - 1]]; var k = e; for (var E = 0; E < s.length; ++E) { var I = d3.min(s[E], function (h) { return h.y }), H = d3.max(s[E], function (h) { return h.y }); if (!k) { k = [I, H] } else { if (I < k[0]) { k[0] = I } if (H > k[1]) { k[1] = H } } } if (k[0] > 0) { k[0] = 0 } t.domain(k); var o = A.selectAll("g.rule").data(t.ticks(5)).enter().append("svg:g").attr("class", "rule").attr("transform", function (h) { return "translate(0," + -t(h) + ")" }); o.append("svg:line").attr("x2", v - B[1] - B[3]).style("stroke", function (h) { return h ? "#F7F7F7" : "#E0E0E1" }); var z = A.selectAll("g.performance").data(D).enter().append("svg:g").attr("class", "performance"); var g = z.selectAll("rect").data(Object).enter().append("svg:rect").attr("x", function (h) { return u(h.x) + 3 }).attr("y", function (w) { var p = t(w.y), h = t(w.y0); if (p < h) { return -h } return -p }).attr("height", function (h) { return Math.abs(t(h.y) - t(h.y0)) }).attr("width", u.rangeBand() > 6 ? u.rangeBand() - 6 : u.rangeBand()).style("fill", function (h) { return h.y > 0 ? a.performancePositive : a.performanceNegative }); var K = d3.svg.line().interpolate("basis").x(function (h) { return u(h.x) + u.rangeBand() / 2 }).y(function (h) { return -t(h.y) }); var C = A.selectAll("g.targets").data(J).enter().append("svg:g").attr("class", "targets"); var j = d3.scale.ordinal().range([a.targetA, a.targetB, a.targetC]); var g = C.selectAll("rect").data(Object).enter().append("svg:rect").attr("x", function (h) { return u(h.x) + 3 }).attr("y", function (h) { return -t(h.y) - 0.5 }).attr("height", function (h) { return 1 }).attr("width", u.rangeBand() > 6 ? u.rangeBand() - 6 : u.rangeBand()).style("fill", function (w, p, h) { return j(h) }); var n = d3.min(D[0], function (h) { return h.x }), r = Math.ceil(50 / u.rangeBand()); var q = A.selectAll("text").data(u.domain()).enter().append("svg:text").attr("x", function (h) { return u(h) + u.rangeBand() / 2 }).attr("y", 6).attr("text-anchor", "middle").attr("dy", ".71em").text(function (p) { var h = parseInt((p - n) / 86400000, 10); return (h % r == 0 ? F(p) : "") }).style("fill", "#B2B2B2"); o.append("svg:text").attr("x", v - B[1] - B[3] + 6).attr("dy", ".35em").text(function (h) { return d3.format(",.0f")(h) }).style("fill", "#B2B2B2") }, init: function () { var f = this; d(c).resize(function () { f.drawChart() }); this.drawChart() } }) })(window, window.jQuery); (function (a, b) { a.Nextfinder.reporting = {} })(window); (function (b, c) { var a = b.Nextfinder; a.reporting.admin_table_query = a.Class.extend({ init: function () { var d = this; this.editor = ace.edit("editor"); this.editor.setTheme("ace/theme/tomorrow_night_eighties"); this.editor.getSession().setMode("ace/mode/pgsql"); this.editor.setOptions({ minLines: 10, maxLines: 30 }); this.editor.commands.addCommand({ name: "executeQuery", bindKey: { win: "Ctrl-Enter", mac: "Meta-Enter" }, exec: function (e) { d.executeCurrentQuery() } }); this.result = m.prop(); this.isLoadingResult = m.prop(false); this.resultCounter = 0; m.module($('[data-content="table-query-result"]')[0], new nfx.modules.BiTableQueryResult({ result: this.result, isLoading: this.isLoadingResult })); $('[data-action="execute-query"]').click(function () { d.executeCurrentQuery() }); $('[data-action="save-query"]').click(function () { d.saveCurrentQuery() }); this.executeCurrentQuery() }, startLoadingResult: function () { m.startComputation(); this.isLoadingResult(true); m.endComputation() }, setResult: function (d) { m.startComputation(); this.isLoadingResult(false); this.result(d); m.endComputation() }, executeCurrentQuery: function () { var f = $.trim(this.editor.getSession().getValue()), d = this; if (f.length == 0) { return this.setResult(null) } var e = ++this.resultCounter; this.startLoadingResult(); Nextfinder.transport.post({ url: "/admin/reporting/table-queries/execute", data: { query: f }, success: function (g) { if (d.resultCounter != e) { return } d.setResult(new nfx.models.BiTableQueryResult({ columns: g.columns, rows: g.rows, executionTime: g.execution_time })) }, error: function (g, h) { if (d.resultCounter != e) { return } d.setResult(new nfx.models.BiTableQueryResult({ error: h.message })) } }) }, saveCurrentQuery: function () { var f = $.trim(this.editor.getSession().getValue()), d = this; if (!f.length) { return } var e = prompt("Query name", ""); if ((!e) || (!(e = $.trim(e)))) { return } Nextfinder.transport.post({ url: "/admin/reporting/table-queries/new", data: { query: f, name: e }, success: function (g) { location.href = "/admin/reporting/table-queries/" + g.query_id } }) } }) })(window); (function (a, b, c) { a.Nextfinder.subscriptions = {} })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.subscriptions.admin_details = a.Class.extend({ init: function () { var e = this; c(document).on("click", '[data-action="change-plan"]', function (g) { g.preventDefault(); if (!confirm("Are you sure you want to change the subscriber's plan?")) { return } var f = c(this).attr("data-subscription-id"), h = c(this).attr("data-pricing-plan-id"); b.Nextfinder.transport.request({ method: "post", data: { pricing_plan_id: h }, url: "/admin/subscriptions/" + f + "/change-plan", success: function () { location.reload() }, error: function (j, k) { alert("An error occured. Check the JS console."); console.log("An error occured: ", k) } }) }) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.subscriptions.admin_list = a.Class.extend({ init: function () { var e = this; c(document).on("click", '[data-action="change-plan"]', function (g) { g.preventDefault(); if (!confirm("Are you sure you want to change the subscriber's plan?")) { return } var f = c(this).attr("data-subscription-id"), h = c(this).attr("data-pricing-plan-id"); b.Nextfinder.transport.request({ method: "post", data: { pricing_plan_id: h }, url: "/admin/subscriptions/" + f + "/change-plan", success: function () { location.reload() }, error: function (j, k) { alert("An error occured") } }) }); c(document).on("click", '[data-action="add-plan"]', function (j) { j.preventDefault(); if (!confirm("Are you sure you want to add the selected plan?")) { return } var g = c(this).attr("data-subscription-id"), l = c(this).attr("data-pricing-plan-id"), f = c(this).attr("data-is-api-plan"), h = c(this).attr("data-billing-interval"), k = c(this).attr("data-detailed-user-id"); b.Nextfinder.transport.request({ method: "post", data: { subscription_id: g, pricing_plan_id: l, is_api_plan: f, billing_interval: h, detailed_user_id: k }, url: "/admin/subscriptions/" + k + "/add-plan", success: function (n) { location.href = "/admin/subscriptions/" + n.subscription_id }, error: function (n, o) { alert(n); if (console) { console.error(n) } } }) }) } }) })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.users = {} })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder; a.users.admin_details = a.Class.extend({ init: function () { c(document).on("click", '[data-action="change-username"]', function (j) { j.preventDefault(); var f = c(this).attr("data-user-id"), h = c(this).attr("data-username"); var g = c.trim(prompt("Change username", h)); if ((!g) || (g == h)) { return } b.Nextfinder.transport.request({ method: "post", data: { username: g }, url: "/admin/auth/details/" + f + "/set-username", success: function () { location.reload() }, error: function (e, k) { var l = "An unexpected error occured"; if ((k) && (k.message)) { l = k.message } alert(l) } }) }); c(document).on("click", '[data-action="redeem-giftcard"]', function (h) { h.preventDefault(); var f = c(this).attr("data-user-id"); var g = prompt("Please enter giftcard code"); Nextfinder.transport.post({ url: "/admin/auth/details/" + f + "/" + g + "/redeem", success: function (e) { alert("Giftcard added") }, error: function (e) { alert("Error: " + e); console.log(e) } }) }); c(document).on("click", '[data-tab="transactions"] #pagination a', function (f) { f.preventDefault(); c.ajax(c(this).attr("href"), { success: function (e) { c('[data-tab="transactions"]').html(e); c(b).scrollTop(0) } }) }) } }) })(window, window.jQuery); (function (a, b) { a.Nextfinder.mailing_lists = {} })(window); (function (b, c, d) { var a = b.Nextfinder; a.mailing_lists.subscribe = a.Class.extend({ init: function () { var e = c(".fixture"), f = parseInt(e.attr("data-mailing-list-id"), 10); e.remove(); nfx.app.modalStackController.present(new nfx.modules.MailingListSubscribeModalModule({ dismissable: false, mailingListId: f }), false) } }) })(window, window.jQuery); (function (a, b, c) { a.Nextfinder.modals = { init: function () { } } })(window, window.jQuery); (function (a, d, b, c) { d.modals.Modal = d.Class.extend({ modal: null, close: function () { this._modalActivelyClosed = true; this.modal.modal("hide") }, isLoading: function (f) { var e = this; f = (f === c ? true : f); if (f) { e.modal.find(":not([disabled])").attr("post-disabled", "disabled").attr("disabled", "disabled"); e.modal.addClass("loading"); e.modal.prepend("<div class='spinner'>&nbsp;</div>") } else { e.modal.find("[post-disabled]").removeAttr("post-disabled").removeAttr("disabled"); e.modal.removeClass("loading"); e.modal.find(".spinner").remove() } }, init: function (f) { var e = this; var g = b.extend({}, { action: function () { e.close() }, cancelLabel: "Cancel" }, f); this._modalActivelyClosed = false; d.tracking.trackPageview("/modal/" + g.title); this.modal = b("body").createModal({ id: g.id || "modal", title: g.title, template: g.template, action: ((g.actionLabel !== c) && (g.actionLabel !== null) ? "modal-action" : null), actionLabel: g.actionLabel, cancelLabel: g.cancelLabel, backdrop: g.backdrop, context: g.context, canHide: function () { if (g.canClose) { return g.canClose() } return true }, hide: function () { if (!e._modalActivelyClosed) { d.tracking.trackEvent("Modal", g.title, "Cancel"); if (g.cancel) { g.cancel() } } if (g.close) { g.close() } } }); this.modal.find('[data-action="modal-action"]').click(function () { d.tracking.trackEvent("Modal", g.title, "Confirm"); g.action() }) } }) })(window, window.Nextfinder, window.jQuery); (function (b, c, d) { var a = b.Nextfinder.modals; a.ErrorModal = a.Modal.extend({ init: function (f) { var e = this; f = c.extend({}, { template: "modals/templates/error.html", cancelLabel: "OK", context: { message: new Handlebars.SafeString(f.message) } }, f); this._super(f) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder.modals; a.ChangeCoverPictureModal = a.Modal.extend({ init: function (f) { var e = this; f = c.extend({}, { title: "Change cover picture", template: "modals/templates/change_cover_picture.html", actionLabel: "Update" }, f); this._super(f) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder.modals; a.ConfirmModal = a.Modal.extend({ init: function (f) { var e = this; c(".modal").modal("hide"); f = c.extend({}, { id: "confirmModal", title: new Handlebars.SafeString(f.title), template: "modals/templates/confirm.html", actionLabel: "Confirm", action: function () { f.callback(); e.close() }, context: { message: new Handlebars.SafeString(f.message) }, standalone: false }, f); this._super(f) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder.modals; a.ShowDataURI = a.Modal.extend({ init: function (f) { var e = this; f = c.extend({}, { title: "Base64 encoded data URI for the " + f.format + " file", template: "modals/templates/show_datauri.html", context: { datauri: f.datauri } }, f); this._super(f) } }) })(window, window.jQuery); (function (b, c, d) { var a = b.Nextfinder.modals; a.CreateCollection = a.Modal.extend({ form_initialized: false, init: function (f) { var e = this; c(".modal").modal("hide"); f = c.extend({}, { id: "createCollection", title: "New collection", template: "modals/templates/create_collection.html", actionLabel: "Create collection", action: function () { e.formSubmit(f.callback); e.close() }, standalone: false }, f); this._super(f) }, formSubmit: function (g) { var e = this; var f = c("#create_collection_form"); if (e.form_initialized === false) { f.ajaxifyForm({ success: function (h) { g(h.collection.collection_id, h.collection.name) } }); e.form_initialized = true } f.submit() } }) })(window, window.jQuery); window.nfx = { components: {}, controllers: {}, models: {}, modules: {}, views: {}, viewHelpers: {}, services: {}, api: {}, mext: { watchedProp: function (a, b) { var c = function () { if (arguments.length) { var d = (a !== arguments[0]); a = arguments[0]; if (d) { b() } } return a }; c.toJSON = function () { return a }; return c }, processedWatchedProp: function (a, c, b) { var d = function () { if (arguments.length) { var e = c(arguments[0]), f = (a !== e); a = e; if (f) { b() } } return a }; d.toJSON = function () { return a }; return d }, classMap: function () { classNames = []; for (var c = 0; c < arguments.length; c++) { var b = arguments[c]; if (b instanceof String) { classNames.push(b) } else { if (b instanceof Array) { for (var d = 0; d < b.length; d++) { classNames.push(b[d]) } } else { if (b instanceof Object) { for (var e in b) { if ((b.hasOwnProperty(e)) && (b[e])) { classNames.push(e) } } } else { if (b) { classNames.push(b) } } } } } return classNames.join(" ") }, validatedProp: function (a, b) { var c = b.errorMessages || {}; var d = function () { if (arguments.length) { a = arguments[0] } return a }; d.toJSON = function () { return a }; d.options = b; d.error = m.prop(undefined); d.clean = function () { return (b.clean ? b.clean(a) : a) }; d.validate = function () { var g = d.clean(); if ((b.required) && (!g)) { d.error(c.required || "This field is required"); return false } var f = (b.minlength ? b.minlength : b.minLength), e = (b.maxlength ? b.maxlength : b.maxLength); if ((f) && (g.length < f)) { d.error(c.minLength || ("Please enter at least " + f + " character" + (f == 1 ? "" : "s"))); return false } if ((e) && (g.length > e)) { d.error(c.maxLength || ("Please enter at most " + e + " character" + (e == 1 ? "" : "s"))); return false } d.error(undefined); return true }; return d }, validatedInput: function (b) { var a = m("input", { id: "id_ " + b.name, name: b.name, type: b.type || "text", placeholder: b.placeholder, value: b.value(), oninput: m.withAttr("value", b.value), "class": nfx.mext.classMap({ error: b.value.error && b.value.error() }) }); if ((!b.value.error) || (!b.value.error())) { return a } return [a, m("label", { "for": "id_" + b.name, "class": "error", style: "display: block" }, b.value.error())] } } }; nfx.services.userService = { connectWithFacebook: function (a) { a = a || {}; FB.login(function (b) { if (b.authResponse) { window.Nextfinder.transport.post({ url: "/user/ajax/login/facebook", data: { access_token: b.authResponse.accessToken, is_newsletter_subscriber: a.isNewsletterSubscriber ? "on" : undefined }, success: function (c) { if (a.onConnect) { a.onConnect() } }, error: function (c, d) { if (c == "missing_user_data") { if (a.onMissingUserData) { a.onMissingUserData(d.additional_data) } } else { if (a.onError) { a.onError() } } } }) } else { if (a.onCancel) { a.onCancel() } } }, { scope: "email" }) } }; (function () { var a = { AT: 20, BE: 21, BG: 20, CY: 19, CZ: 21, DE: 19, DK: 25, EE: 20, ES: 21, FI: 24, FR: 20, GB: 20, GR: 23, HR: 25, HU: 27, IE: 23, IT: 22, LT: 21, LU: 15, LV: 21, MT: 18, NL: 21, PL: 23, PT: 23, RO: 24, SE: 25, SI: 22, SK: 20 }; nfx.services.commerceService = { getVatCharge: function (b, d) { var c = a[b]; if (!c) { return new nfx.models.VatCharge({ rate: 0, action: nfx.models.VatChargeAction.noCharge }) } return new nfx.models.VatCharge({ rate: c, countryCode: b, action: ((d) && (b != "DK") ? nfx.models.VatChargeAction.reverseCharge : nfx.models.VatChargeAction.charge) }) } } })(); (function () { var a = "/admin/iconsets/promoted/"; nfx.services.iconsetPromotionService = { promote: function (d, b) { var c = new Promise(function (g, f) { var e = a + "promote/" + d; if (b) { e += "/" + b } window.Nextfinder.transport.post({ url: e, success: function (j, h, k) { g(j, h, k) }, error: function (h, k, j) { f(Error(j)) } }) }); return c }, demote: function (c) { var b = new Promise(function (e, d) { window.Nextfinder.transport.post({ url: a + "demote/" + c, success: function (g, f, h) { e(g, f, h) }, error: function (f, h, g) { d(Error(g)) } }) }); return b } } })(); nfx.services.staticAssetService = { upload: function (a) { var b = new FormData(); b.append("file", a, a.name); return new Promise(function (d, c) { Nextfinder.transport.post({ url: "/admin/static-assets/new", data: b, contentType: false, processData: false, success: function (e) { d(new nfx.models.StaticAsset(e.asset)) }, error: function (e, f) { c(new Error((f) && (f.message) ? f.message : e)) } }) }) } }; nfx.models.AccountState = function (a) { this.balance = m.prop(a.balance) }; nfx.models.Address = function (a) { this.street = m.prop(a.street); this.postalCode = m.prop(a.postalCode); this.city = m.prop(a.city); this.state = m.prop(a.state); this.country = m.prop(a.country) }; nfx.models.AssetOffer = function (a) { this.price = m.prop(a.price); this.license = m.prop(a.license ? new nfx.models.License(a.license) : null); this.seller = m.prop(a.seller_user ? a.seller_user : null) }; nfx.models.BiTableQueryResult = function (a) { this.error = m.prop(a.error); this.columns = m.prop(a.columns); this.rows = m.prop(a.rows); this.executionTime = m.prop(a.executionTime) }; nfx.models.CreditCard = function (a) { this.cardId = m.prop(a.cardId); this.numberLastFour = m.prop(a.numberLastFour); this.isDefault = m.prop(a.isDefault); this.cardType = m.prop(a.cardType); this.expirationMonth = m.prop(a.expirationMonth); this.expirationYear = m.prop(a.expirationYear); this.paymentProvider = m.prop(a.paymentProvider) }; nfx.models.License = function (a) { this.licenseId = m.prop(a.licenseId); this.name = m.prop(a.name); this.identifier = m.prop(a.identifier); this.url = m.prop(a.url); this.link = function () { if (this.url()) { return this.url() } if (this.identifier()) { return "/licenses/" + this.identifier() } return null }.bind(this) }; nfx.models.Organization = function (e) { this.organizationId = m.prop(e.organizationId); this.name = m.prop(e.name); this.proSubscription = m.prop(e.proSubscription ? new nfx.models.ProSubscription(e.proSubscription) : null); var a = null; if (e.memberships) { a = []; for (var c = 0; c < e.memberships.length; c++) { a.push(new nfx.models.OrganizationMembership(e.memberships[c])) } } this.memberships = m.prop(a); var d = null; if (e.invites) { d = []; for (var c = 0; c < e.invites.length; c++) { d.push(new nfx.models.OrganizationInvite(e.invites[c])) } } this.invites = m.prop(d); this.canAddMember = function () { var f = this.proSubscription(); if ((!f) || (!f.plan().proMembersMax())) { return true } return this.membersCount() < f.plan().proMembersMax() }.bind(this); var b = e.membersCount; this.membersCount = function () { if ((b !== undefined) && (b !== null)) { return b } return this.memberships().length + this.invites().length }.bind(this) }; nfx.models.OrganizationInvite = function (a) { this.inviteId = m.prop(a.inviteId); this.email = m.prop(a.email); this.emailMd5Hash = m.prop(a.emailMd5Hash); this.level = m.prop(a.level) }; nfx.models.OrganizationMembership = function (a) { this.level = m.prop(a.level); this.user = m.prop(a.user ? new nfx.models.User(a.user) : null); this.organization = m.prop(a.organization ? new nfx.models.Organization(a.organization) : null) }; nfx.models.PricingPlan = function (a) { this.name = m.prop(a.name); this.identifier = m.prop(a.identifier); this.priceMonthly = m.prop(a.priceMonthly); this.priceAnnual = m.prop(a.priceAnnual); this.attributes = m.prop(a.attributes); this.priceAnnualMonthly = function () { return Math.ceil(this.priceAnnual() / 12) }.bind(this); this.proDownloadsPerMonthMax = function () { return this.attributes().downloads_per_month_max }.bind(this); this.proMembersMax = function () { return this.attributes().organization_members_max }.bind(this); this.isPerceptuallyUnlimited = function () { return !this.attributes().downloads_per_month_max || this.attributes().is_perceptually_unlimited === true }.bind(this); this.isAvailable = function (b) { var c = this.proMembersMax(); return ((!c) || (!b) || (b.membersCount() <= c)) }.bind(this); this.priceForBillingIntervalAndMembers = function (e, c) { var d = (e == "annual" ? this.priceAnnual : this.priceMonthly)(), b = (e == "annual" ? this.attributes().price_annual_per_additional_member : this.attributes().price_monthly_per_additional_member); if (this.proMembersMax()) { return d } return d + b * (c - 1) }.bind(this); this.priceForBillingInterval = function (c, b) { return this.priceForBillingIntervalAndMembers(c, b ? b.membersCount() : 1) }.bind(this) }; nfx.models.ProSubscription = function (a) { this.subscriptionId = m.prop(a.subscriptionId); this.plan = m.prop(new nfx.models.PricingPlan(a.plan)); this.effectivePlan = m.prop(new nfx.models.PricingPlan(a.effectivePlan)); this.downloadsThisMonth = m.prop(a.downloadsThisMonth); this.isCancelled = m.prop(a.isCancelled); this.dateRenews = m.prop(a.dateRenews); this.dateExpires = m.prop(a.dateExpires); this.billingInterval = m.prop(a.billingInterval); this.currentBillingPeriodBillingInterval = m.prop(a.currentBillingPeriodBillingInterval); this.currentBillingPeriodPayment = m.prop(a.currentBillingPeriodPayment); this.currentBillingPeriodTotalDays = m.prop(a.currentBillingPeriodTotalDays); this.currentBillingPeriodResidualDays = m.prop(a.currentBillingPeriodResidualDays) }; nfx.models.Transaction = function (a) { this.transactionId = m.prop(a.transactionId); this.amountBalance = m.prop(parseFloat(a.amountBalance)); this.amountPayment = m.prop(parseFloat(a.amountPayment)) }; nfx.models.User = function (a) { this.userId = m.prop(a.userId); this.username = m.prop(a.username); this.fullName = m.prop(a.fullName); this.email = m.prop(a.email); this.emailMd5Hash = m.prop(a.emailMd5Hash); this.company = m.prop(a.company); this.vatNumber = m.prop(a.vatNumber); this.balance = m.prop(a.balance); this.address = m.prop(a.address ? new nfx.models.Address(a.address) : null); this.hasSufficientBillingDetails = function () { if (!this.email()) { return undefined } if ((!this.address()) || (!this.address().street()) || (!this.address().postalCode()) || (!this.address().city()) || (!this.address().country())) { return false } return true } }; nfx.models.VatChargeAction = { charge: "charge", reverseCharge: "reverseCharge", noCharge: "noCharge" }; nfx.models.VatCharge = function (a) { this.rate = m.prop(a.rate); this.countryCode = m.prop(a.countryCode); this.action = m.prop(a.action); this.calculateContainedVatAmount = function (b) { if (this.action() == nfx.models.VatChargeAction.charge) { return Math.round(b * this.rate() / (100 + this.rate()) * 100) / 100 } return 0 }.bind(this) }; nfx.models.SubscriptionDiscountCode = function (a) { this.code = m.prop(a.code); this.rule = m.prop(a.rule); this.description = function () { var b = this.rule(); if (b.identifier == "first_month_percentage") { return b.attributes.percentage.toString() + "% off your first month" } if (b.identifier == "full_year_percentage") { return b.attributes.percentage.toString() + "% off the full period" } }.bind(this); this.reason = function () { if (a.code) { return " with a discount code " + a.code } if (a.referrer) { return " thanks to an invitation from " + a.referrer } return false }; this.effectAmount = function (b, d) { var c = this.rule(); if (c.identifier == "first_month_percentage") { var e = (d == "annual" ? b / 12 : b); return Math.round(e * c.attributes.percentage) / 100 } if (c.identifier == "full_year_percentage") { var e = b; return Math.round(e * c.attributes.percentage) / 100 } } }; nfx.models.UserCommerceStatistics = function (a) { this.depositedTotal = m.prop(a.depositedTotal); this.depositedLast30Days = m.prop(a.depositedLast30Days); this.assetSpendingTotal = m.prop(a.assetSpendingTotal); this.assetSpendingLast30Days = m.prop(a.assetSpendingLast30Days); this.balance = m.prop(a.balance) }; nfx.models.SimpleNewsletterPart = function (a) { this.type = m.prop(a.type); this.label = m.prop(a.label); this.identifier = m.prop(a.identifier); this.helpText = m.prop(a.helpText); this.placeholder = m.prop(a.placeholder); this.data = m.prop(a.data); this.config = m.prop(a.config) }; nfx.models.ImageNewsletterPart = function (a) { this.type = function () { return "image" }; this.label = m.prop(a.label); this.identifier = m.prop(a.identifier); this.asset = m.prop(a.embedded.asset ? new nfx.models.StaticAsset(a.embedded.asset) : null); this.data = function () { return (this.asset() ? this.asset().assetId() : null) } }; nfx.models.ArticleListNewsletterPartArticle = function (a) { if (!a) { a = {} } this.title = m.prop(a.title); this.url = m.prop(a.url); this.author = m.prop(a.author); this.excerpt = m.prop(a.excerpt); this.thumbnail = m.prop(a.thumbnail); this.featured = m.prop(a.featured); this.backgroundColor = m.prop(a.bgcolor) }; nfx.models.ArticleListNewsletterPart = function (a) { this.type = function () { return "article_list" }; this.label = m.prop(a.label); this.identifier = m.prop(a.identifier); this.helpText = m.prop(a.helpText); this.config = m.prop(a.config || {}); this.articles = m.prop(a.data ? a.data.map(function (b) { var c = null; if (a.embedded.assets[b.thumbnail_asset_id]) { c = new nfx.models.StaticAsset(a.embedded.assets[b.thumbnail_asset_id]) } return new nfx.models.ArticleListNewsletterPartArticle($.extend({}, b, { thumbnail: c })) }) : []); this.removeArticle = function (b) { this.articles().splice(b, 1) }; this.addArticle = function (b) { if (!this.canAddArticle()) { return } this.articles().push(b ? b : new nfx.models.ArticleListNewsletterPartArticle()) }; this.moveArticle = function (b, c) { if ((b == c) || (b >= this.articles().length)) { return } if (c >= this.articles().length) { c = this.articles().length - 1 } this.articles().splice(c, 0, this.articles().splice(b, 1)[0]) }; this.canAddArticle = function () { return ((!this.config()) || (!this.config().countMax) || (this.config().countMax > this.articles().length)) }; this.data = function () { return this.articles().map(function (b) { return { title: b.title(), url: b.url(), author: b.author(), excerpt: b.excerpt(), thumbnail_asset_id: (b.thumbnail() ? b.thumbnail().assetId() : null), featured: b.featured(), bgcolor: b.backgroundColor() } }) } }; nfx.models.IconSetListNewsletterPartIconSet = function (a) { this.iconSetId = m.prop(a.iconSetId); this.name = m.prop(a.name); this.identifier = m.prop(a.identifier); this.isPremium = m.prop(a.isPremium) }; nfx.models.IconSetListNewsletterPart = function (a) { this.type = function () { return "iconset_list" }; this.label = m.prop(a.label); this.identifier = m.prop(a.identifier); this.helpText = m.prop(a.helpText); this.config = m.prop(a.config || {}); this.iconSets = m.prop(a.data ? a.data.map(function (b) { return new nfx.models.IconSetListNewsletterPartIconSet(a.embedded.iconSets[b]) }) : []); this.removeIconSet = function (b) { this.iconSets().splice(b, 1) }; this.moveIconSet = function (b, c) { if ((b == c) || (b >= this.iconSets().length)) { return } if (c >= this.iconSets().length) { c = this.iconSets().length - 1 } this.iconSets().splice(c, 0, this.iconSets().splice(b, 1)[0]) }; this.addIconSet = function (b) { if (!this.canAddIconSet()) { return } this.iconSets().push(b) }; this.canAddIconSet = function () { return ((!this.config()) || (!this.config().countMax) || (this.config().countMax > this.iconSets().length)) }; this.data = function () { return this.iconSets().map(function (b) { return b.iconSetId() }) } }; nfx.models.Newsletter = function (a) { this.newsletterId = m.prop(a.newsletterId); this.subject = m.prop(a.subject); this.parts = m.prop(a.parts) }; nfx.models.ExternalArticle = function (a) { this.urlCanonical = m.prop(a.urlCanonical); this.title = m.prop(a.title); this.excerpt = m.prop(a.excerpt); this.author = m.prop(a.author); this.thumbnailUrl = m.prop(a.thumbnailUrl); this.sourceIdentifier = m.prop(a.sourceIdentifier) }; nfx.models.StaticAsset = function (a) { this.assetId = m.prop(a.assetId); this.uri = m.prop(a.uri) }; nfx.api.account = { getUser: function () { return nfx.api.get({ url: "/account/ajax/state" }).then(function (a) { return Q(new nfx.models.User(a.user)) }) } }; nfx.api.ApiError = function (a, b) { this.code = a; this.data = b }; nfx.api.get = function (b) { var a = Q.defer(); Nextfinder.transport.get($.extend({}, { success: function (c) { a.resolve(c) }, error: function (c, d) { a.reject(new nfx.api.ApiError(c, d)) } }, b)); return a.promise }; nfx.api.commerce = { listCreditCards: function () { return nfx.api.get({ url: "/commerce/ajax/credit-cards" }).then(function (b) { var a = []; b.creditCards.forEach(function (c) { a.push(new nfx.models.CreditCard(c)) }); return Q({ creditCards: a, user: new nfx.models.User(b.user), referral: b.referralDiscount }) }) }, getCheapestOffer: function (b, a) { return nfx.api.get({ url: "/commerce/ajax/offers", data: { asset_identifier: b, asset_primary_key: a } }).then(function (c) { return Q({ asset: c.asset, offer: new nfx.models.AssetOffer(c.offers[0]), user: new nfx.models.User(c.user), proPlanSmallest: c.pro_plan_smallest ? new nfx.models.PricingPlan(c.pro_plan_smallest) : "" }) }) } }; nfx.controllers.AppController = function () { this.modalStackController = new nfx.controllers.AppModalStackController() }; nfx.controllers.AppModalStackController = function () { var j = this, a = null, c = null, d = { controller: function () { }, view: function (k) { } }, g = []; function e() { if (a) { return } a = $('<div class="modal-backdrop fade in" />').appendTo($("body")); function k() { g.length && g[g.length - 1].controllerState.dismissable() && !g[g.length - 1].controllerState.processing() && j.dismissTopmost() } $(document).on("keyup.dismiss.topmost.modal", function (l) { l.which == 27 && k() }); a.on("click", k) } function b() { if (!a) { return } $(document).off("keyup.dismiss.topmost.modal"); var k = a; a = null; k.attr("class", "modal-backdrop fade out"); setTimeout(function () { k.remove() }, 500) } function f(l) { var k = { view: l.view, controllerState: new l.controller }; k.controller = function () { return k.controllerState }; g.push(k); return k } function h(k) { Mithril.module(c[0], k); if (k.controller()) { var l = k.controller(); if (l.didAppear) { l.didAppear() } if (l.title) { Nextfinder.tracking.trackPageview("/modal/" + l.title()) } } } this.present = function (n, k) { if (k !== false) { e() } if (!c) { c = $('<div class="modal-container" />').appendTo("body") } if (g.length) { var o = g[g.length - 1]; if (o.controllerState.didDisappear) { o.controllerState.didDisappear() } } var l = f(n); h(l) }; this.presentLoader = function (k) { this.present(new nfx.modules.ModalStackLoaderModule(k)) }; this.replaceAll = function (k) { if (g.length) { var k = g.pop(); if (k.controllerState.didDisappear) { k.controllerState.didDisappear() } } g = []; j.present(k) }; this.replaceAllWithLoader = function (k) { this.replaceAll(new nfx.modules.ModalStackLoaderModule(k)) }; this.replaceTopmost = function (l) { if (!g.length) { return j.present(l) } var n = g.pop(); if (n.controllerState.didDisappear) { n.controllerState.didDisappear() } var k = f(l); h(k) }; this.replaceTopmostWithLoader = function (k) { this.replaceTopmost(new nfx.modules.ModalStackLoaderModule(k)) }; this.replaceTopmostWithError = function (l, k) { this.replaceTopmost(new nfx.modules.ErrorModalModule({ title: l, message: k })) }; this.dismissTopmost = function () { if (!g.length) { return } var k = g.pop(), l = (g.length ? g[g.length - 1] : undefined); if (k.controllerState.didDisappear) { k.controllerState.didDisappear() } if (l) { h(l) } else { h(d); b() } }; this.dismissAll = function () { if (g.length) { var k = g.pop(); if (k.controllerState.didDisappear) { k.controllerState.didDisappear() } } g = []; h(d); b() } }; nfx.controllers.ModalController = function () { var a = this; this.title = m.prop("Modal"); this.dismissable = m.prop(true); this.actionable = m.prop(false); this.actionLabel = m.prop("OK"); this.dismissLabel = m.prop("Cancel"); this.processing = m.prop(false); this.dismiss = function () { nfx.app.modalStackController.dismissTopmost(); this.trackAction("Cancel") }; this.action = function () { }; this.trackAction = function (b) { Nextfinder.tracking.trackEvent("Modal", a.title(), b) } }; nfx.controllers.AuthenticationModalController = function (a) { var b = new nfx.controllers.ModalController(); a = a || {}; b.errorMessage = m.prop(undefined); b.isNewsletterSubscriber = m.prop(true); b.connectWithFacebook = function () { this.processing(true); nfx.services.userService.connectWithFacebook({ isNewsletterSubscriber: this.isNewsletterSubscriber(), onConnect: function () { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Connect with Facebook", "Successful"); this.processing(false); if (a.onAuthenticate) { a.onAuthenticate() } m.endComputation() }.bind(this), onError: function () { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Connect with Facebook", "Failed"); this.processing(false); this.errorMessage("Failed to connect with Facebook."); m.endComputation() }.bind(this), onMissingUserData: function (c) { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Connect with Facebook", "Require data"); this.processing(false); nfx.app.modalStackController.replaceTopmost(new nfx.modules.MissingUserDataModalModule({ initialUserData: c, onAuthenticate: a.onAuthenticate })); m.endComputation() }.bind(this), onCancel: function () { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Connect with Facebook", "Cancelled"); this.processing(false); m.endComputation() }.bind(this) }) }; return b }; nfx.controllers.AccountDashboardOrganizationController = function (a, b) { this.organization = a; this.organizationMembership = b; this.loading = m.prop(false); this.reload = function () { var c = this; c.loading(true); Nextfinder.transport.get({ url: "/organizations/" + this.organization().organizationId(), success: function (d) { c.organization(new nfx.models.Organization(d.organization)); c.loading(false); m.redraw() } }) }.bind(this); this.inviteMembers = function () { var c = this; nfx.app.modalStackController.present(new nfx.modules.InviteMembersModalModule({ organization: this.organization, onInvited: function () { $.pnotify({ pnotify_title: "User has been invited." }); c.reload() } })) }.bind(this); this.resendInvite = function (c) { Nextfinder.transport.post({ url: "/organizations/" + this.organization().organizationId() + "/invites/" + c.inviteId() + "/resend" }) }; this.deleteInvite = function (c) { if (!confirm("Are you sure you want to remove this invite?")) { return } var d = this; Nextfinder.transport.post({ url: "/organizations/" + this.organization().organizationId() + "/invites/" + c.inviteId() + "/revoke", success: function (g) { var f = d.organization().invites(), e = f.indexOf(c); if (e > -1) { f.splice(e, 1); m.redraw() } } }) }; this.removeMember = function (c) { if (!confirm("Are you sure you want to remove " + c.fullName() + " from this team?")) { return } var d = this; Nextfinder.transport.post({ url: "/organizations/" + this.organization().organizationId() + "/members/" + c.userId() + "/remove", success: function (h) { var e = d.organization().memberships(), f = -1; for (var g = 0; g < e.length; g++) { if (e[g].user().userId() == c.userId()) { f = g; break } } if (f > -1) { e.splice(f, 1); m.redraw() } } }) }; this.leave = function () { if (!confirm("Are you sure you want to leave this organization?")) { return } var c = this; Nextfinder.transport.post({ url: "/organizations/" + this.organization().organizationId() + "/leave", success: function (d) { location.reload() } }) } }; nfx.controllers.AccountSubscriptionPlanController = function (a, b) { this.organization = a; this.pricingPlans = b; this.billingInterval = m.prop(this.organization().proSubscription().billingInterval()); this.selectedPlan = m.prop(this.organization().proSubscription().plan()); this.canSetName = m.prop(true); this.name = nfx.mext.watchedProp(a().name(), function () { this.canSetName($.trim(this.name()).length > 0) }.bind(this)); this.cancelSubscription = function () { if (confirm("Are you sure you want to cancel your subscription?")) { nfx.app.modalStackController.presentLoader(); var c = this.organization().proSubscription().subscriptionId(); Nextfinder.transport.post({ url: "/pro/ajax/subscriptions/" + c + "/cancel", success: function () { nfx.app.modalStackController.present(new nfx.modules.ChurnSurveyModalModule({ id: c, reasons: [{ label: "I have no regular need of icons for a monthly subscription", value: 1 }, { label: "I don't like how the monthly subscription is designed", value: 2 }, { label: "I am not using the subscription enough to justify the cost", value: 3 }, { label: "I prefer a pay-as-you go solution", value: 4 }, { label: "It is too expensive", value: 5 }, { label: "I couldn't find the icons I was looking for", value: 6 }, { label: "I use other sites to get icons", value: 7 }] })) }, error: function () { m.startComputation(); nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", "We're really sorry, but it looks like something went wrong. Please reload the page and try again."); m.endComputation() } }) } }; this.reopenSubscription = function () { if (confirm("Are you sure you want to reopen your subscription?")) { nfx.app.modalStackController.presentLoader(); Nextfinder.transport.post({ url: "/pro/ajax/subscriptions/" + this.organization().proSubscription().subscriptionId() + "/reopen", success: function () { location.reload() }, error: function () { m.startComputation(); nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", "We're really sorry, but it looks like something went wrong. Please reload the page and try again."); m.endComputation() } }) } }; this.selectPlan = function (c) { this.selectedPlan(c) }; this.selectBillingInterval = function (c) { this.billingInterval(c) }; this.changePlan = function () { nfx.app.modalStackController.presentLoader(); Nextfinder.transport.post({ url: "/pro/ajax/subscriptions/" + this.organization().proSubscription().subscriptionId() + "/change", data: { billing_interval: this.billingInterval(), pricing_plan_identifier: this.selectedPlan().identifier() }, success: function () { location.reload() }, error: function (d, e) { var f = "Something went wrong", c = "We're really sorry, but it looks like something went wrong. Please reload the page and try again."; if (d == "credit_card_declined") { f = "Credit card declined"; c = m.trust('We\'re sorry, but we could not change your Iconfinder Pro subscription plan because your credit card was declined. Please check to make sure you have the correct credit card set up in under <a href="/account/payment-methods">Payment methods</a>.') } else { if (d == "no_payment_method") { f = "You have no credit card registered"; c = m.trust('We\'re sorry, but we could not change your Iconfinder Pro subscription plan because you currently have no active credit cards registered. Please check to make sure you have the correct credit card set up in under <a href="/account/payment-methods">Payment methods</a>.') } else { if (d == "unpaid_billing_cycles") { f = "You have an outstanding payment"; c = m.trust('We\'re sorry, but we could not change your Iconfinder Pro subscription plan because you currently have an outstanding payment for your subscription. Please check to make sure you have the correct credit card set up in under <a href="/account/payment-methods">Payment methods</a> so we can process the payment before we can upgrade your plan.') } } } m.startComputation(); nfx.app.modalStackController.replaceTopmostWithError(f, c); m.endComputation() } }) }; this.changeName = function () { var c = $.trim(this.name()); if (c.length == 0) { return } nfx.app.modalStackController.presentLoader(); Nextfinder.transport.post({ url: "/organizations/" + this.organization().organizationId() + "/name", data: { name: this.name() }, success: function () { location.reload() }, error: function () { m.startComputation(); nfx.app.modalStackController.replaceTopmostWithError("Something went wrong", "We're really sorry, but it looks like something went wrong. Please reload the page and try again."); m.endComputation() } }) } }; nfx.controllers.AddCreditCardModalController = function (b) { var c = new nfx.controllers.ModalController(); var a = function (d, e) { m.startComputation(); c.processing(true); m.endComputation(); Nextfinder.transport.post({ url: "/commerce/ajax/credit-cards", data: { payment_token: d, payment_provider: e }, success: function () { if (b.didAddCreditCard) { b.didAddCreditCard() } }, error: function (f, g) { m.startComputation(); c.paymentFormController.errorMessage("Something went wrong while trying to add your credit card"); c.processing(false); m.endComputation() } }) }; c.title("Add credit card"); c.actionLabel("Add credit card"); c.actionable(true); c.paymentFormController = new nfx.controllers.PaymentFormController({ existingCreditCardAllowed: false, payPalAllowed: false, rememberCreditCardOptional: false, didSelectNewCreditCard: function (d, e) { a(d, e) }, didStartLoading: function () { c.processing(true) }, didEndLoading: function () { c.processing(false) } }); c.action = function (d) { d.preventDefault(); this.trackAction("Confirm"); this.paymentFormController.submit() }; return c }; nfx.controllers.AssetPurchaseCompletedModalController = function (a) { var b = new nfx.controllers.ModalController(); b.asset = m.prop(a.asset); b.dontShowAgain = m.prop(true); b.title("Thank you for your purchase"); b.dismiss = function () { nfx.app.modalStackController.dismissTopmost(); if (b.dontShowAgain()) { Nextfinder.transport.post({ url: "/commerce/ajax/never-show-post-purchase" }) } b.trackAction("Dismiss") }; b.didDisappear = function () { if (a.didDismiss) { a.didDismiss() } }; return b }; nfx.controllers.BiTableQueryResultController = function (a) { a = a || {}; this.result = (typeof (a.result) === "function" ? a.result : m.prop(a.result)); this.format = (typeof (a.format) === "function" ? a.format : m.prop(a.format || "table")); this.isLoading = (typeof (a.isLoading) === "function" ? a.isLoading : m.prop(a.isLoading || false)) }; nfx.controllers.BillingDetailsController = function (d) { var c = this; var b = null; if (d.user && typeof (d.user) == "function") { b = d.user() } else { b = d.user } var a = {}; if (b && b.address()) { a.addressStreet = b.address().street(); a.addressPostalCode = b.address().postalCode(); a.addressCity = b.address().city(); a.addressState = b.address().state(); a.addressCountry = b.address().country() } if (b) { a.company = b.company(); a.vatNumber = b.vatNumber() } this.addressStreet = nfx.mext.validatedProp(a.addressStreet || "", { required: true, minlength: 2, maxlength: 255, errorMessages: { required: "Please specify your street and street number" }, clean: $.trim }); this.addressPostalCode = nfx.mext.validatedProp(a.addressPostalCode || "", { required: true, minlength: 2, maxlength: 16, errorMessages: { required: "Please specify your postal code" }, clean: $.trim }); this.addressCity = nfx.mext.validatedProp(a.addressCity || "", { required: true, minlength: 2, maxlength: 128, errorMessages: { required: "Please specify your city" }, clean: $.trim }); this.addressState = nfx.mext.validatedProp(a.addressState || "", { maxlength: 128, clean: $.trim }); this.addressCountry = m.prop(a.addressCountry ? a.addressCountry : "US"); this.company = nfx.mext.validatedProp(a.company || "", { required: true, maxlength: 64, errorMessages: { required: "Please specify your company" }, clean: $.trim }); this.vatNumber = nfx.mext.validatedProp(a.vatNumber || "", { maxlength: 64, clean: $.trim }); this.isBusiness = m.prop(!!a.company ? true : false); this.errorMessage = m.prop(undefined); this.validateForm = function () { this.addressStreet.validate(); this.addressPostalCode.validate(); this.addressCity.validate(); if (this.isBusiness()) { this.company.validate(); this.vatNumber.validate() } else { this.company.error(undefined); this.vatNumber.error(undefined) } if ((this.addressStreet.error()) || (this.addressPostalCode.error()) || (this.addressCity.error()) || ((this.isBusiness()) && ((this.company.error()) || (this.vatNumber.error())))) { return false } return true }; this.submitForm = function (e) { var f = Q.Promise(function (o, q) { if (!c.validateForm()) { c.errorMessage("Oops! Please correct the errors below."); q(Error("Form is not valid.")) } var p = c.addressStreet.clean(), n = c.addressPostalCode.clean(), j = c.addressCity.clean(), k = c.addressState.clean(), h = c.addressCountry(), l = c.company.clean(), g = c.vatNumber.clean(); c.errorMessage(undefined); Nextfinder.transport.post({ url: "/account/ajax/billing-details", data: { address_street: p, address_postal_code: n, address_city: j, address_state: k, address_country: h, company: c.isBusiness() ? l : undefined, vat_number: c.isBusiness() ? g : undefined }, error: function (s, u) { m.startComputation(); if (s == "invalid_data") { c.errorMessage("Oops! Please correct the errors below."); var r = { address_street: c.addressStreet, address_city: c.addressCity, address_postal_code: c.addressPostalCode, address_state: c.addressState, company: c.company, vat_number: c.vatNumber }; for (var t in u.errors) { r[t].error(u.errors[t][0]) } } else { c.errorMessage(u.message) } m.endComputation(); q(Error(u)) }.bind(c), success: function (r) { o(r) }.bind(c) }) }); return f } }; nfx.controllers.BillingDetailsModalController = function (a) { var c = new nfx.controllers.ModalController(); var b = new nfx.controllers.BillingDetailsController({ user: a.user }); c.billingDetailsCtrl = b; c.title("Billing information"); c.actionLabel("Save billing information"); c.actionable(true); c.action = function (d) { if (d) { d.preventDefault() } c.trackAction("Confirm"); this.processing(true); b.submitForm().then(function (e) { m.startComputation(); if (a.didUpdate) { a.didUpdate() } m.endComputation() }, function (e) { }); this.processing(false) }; return c }; nfx.controllers.ConfirmAssetPurchaseModalController = function (a) { var b = new nfx.controllers.ModalController(); if (a.asset.type == "icon") { b.title(["Confirm purchase of icon for ", m("b", "$" + a.offer.price())]) } else { if (a.asset.type == "iconset") { b.title(["Confirm purchase of icon set for ", m("b", "$" + a.offer.price())]) } else { if (a.asset.type == "custom_service") { b.title(["Confirm prepay of custom service for ", m("b", "$" + Nextfinder.formatting.formatMoney(a.offer.price()))]) } else { b.title("Confirm purchase") } } } b.user = m.prop(a.user); b.asset = m.prop(a.asset); b.offer = m.prop(a.offer); b.proPlanSmallest = m.prop(a.proPlanSmallest); b.showProDescription = m.prop(false); this.processing = m.prop(); b.toggleProDescription = function () { this.showProDescription(!this.showProDescription()) }; b.confirmPurchase = function () { this.processing(true); if (a.didConfirmPurchase) { a.didConfirmPurchase() } b.trackAction("Confirm purchase") }; b.confirmPro = function () { if (a.didConfirmPro) { a.didConfirmPro() } b.trackAction("Subscribe to Pro") }; return b }; nfx.controllers.DepositCashModalController = function (d) { var e = new nfx.controllers.ModalController(); e.selectedAmount = m.prop(10); e.customAmount = m.prop("100"); e.customAmountValid = m.prop(true); e.referral = d.referral; e.selectAmount = function (j) { this.selectedAmount(j) }; e.requestToken = $.generateRandomAlphanumeric(32); var b = function (j, k) { m.startComputation(); e.processing(true); m.endComputation(); Nextfinder.transport.post({ url: "/commerce/ajax/credit-cards", data: { payment_token: j, payment_provider: k }, success: function () { if (d.didDepositCash) { d.didDepositCash() } }, error: function (l, n) { m.startComputation(); e.paymentFormController.errorMessage("Something went wrong while trying to add your credit card"); e.processing(false); m.endComputation() } }) }; function g(j) { e.paymentFormController.errorMessage(j) } function h(j, k, l) { window.Nextfinder.transport.post({ url: "/commerce/payments/paypal-express/setup-deposit", data: { amount: j * 100 }, success: function (n) { location.href = n.redirect }, error: function (n, o) { Nextfinder.tracking.trackEvent("Commerce", "Set up for PayPal", "Error code", error.code) } }) } function a(l, o, j, k, n, p) { window.Nextfinder.transport.post({ url: "/commerce/ajax/deposit", data: { amount: k * 100, payment_token: l, payment_provider: o, save_credit_card: j, request_token: e.requestToken }, success: function (q) { Nextfinder.tracking.trackEvent("Commerce", "Deposit cash", "Deposit amount", k * 1.5); n(q.balance) }, error: function (q, r) { Nextfinder.tracking.trackEvent("Commerce", "Deposit cash", "Error code", q); p(q, r) } }) } function f(k, j, l, n) { window.Nextfinder.transport.post({ url: "/commerce/ajax/deposit", data: { card_id: k.cardId(), amount: j * 100, request_token: e.requestToken }, success: function (o) { Nextfinder.tracking.trackEvent("Commerce", "Deposit cash", "Deposit amount", j * 1.5); l(o.balance) }, error: function (o, p) { Nextfinder.tracking.trackEvent("Commerce", "Deposit cash", "Error code", o); n(o, p) } }) } function c(l) { var k = e.selectedAmount(); if (k == null) { var j = $.trim(e.customAmount()); e.customAmountValid(!!j.match(/^\d+$/)); if (e.customAmountValid()) { k = parseInt(j, 10) } if ((!e.customAmountValid()) || (k < 5)) { m.startComputation(); g("Please enter a valid amount of at least $ 5"); m.endComputation(); return } } m.startComputation(); e.processing(true); g(); m.endComputation(); l(k, function (n) { if (d.didDeposit) { d.didDeposit(k, n) } }, function (n, o) { m.startComputation(); e.processing(false); g(o ? o.message : "An unexpected error occured. Please reload the page."); m.endComputation() }) } e.title("Deposit cash to your account"); e.actionLabel("Deposit"); e.actionable(true); e.paymentFormController = new nfx.controllers.PaymentFormController({ creditCards: d.creditCards, existingCreditCardAllowed: true, payPalAllowed: true, rememberCreditCardOptional: true, didSelectNewCreditCard: function (k, l, j) { c(a.bind(undefined, k, l, j)) }, didSelectExistingCreditCard: function (j) { c(f.bind(undefined, j)) }, didSelectPayPal: function () { c(h) }, didStartLoading: function () { e.processing(true) }, didEndLoading: function () { e.processing(false) } }); e.action = function (j) { j.preventDefault(); this.trackAction("Confirm"); this.paymentFormController.submit() }; return e }; nfx.controllers.DownloadLimitReachedModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Download limit reached"); b.dismissLabel("OK"); b.dateResets = m.prop(a.dateResets); b.downloadLimit = m.prop(a.downloadLimit); b.isPerceptuallyUnlimited = m.prop(a.isPerceptuallyUnlimited); return b }; nfx.controllers.ErrorModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title(a.title); b.message = m.prop(a.message); b.actionLabel("OK"); return b }; nfx.controllers.InsufficientFundsModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Your account balance is too low"); b.actionLabel("Deposit cash"); b.actionable(true); b.asset = m.prop(a.asset); b.user = m.prop(a.user); b.proPlanSmallest = m.prop(a.proPlanSmallest); b.showProDescription = m.prop(false); b.toggleProDescription = function () { this.showProDescription(!this.showProDescription()) }; b.depositCash = function () { if (a.didChooseDeposit) { a.didChooseDeposit() } this.trackAction("Deposit cash") }; b.subscribePro = function () { if (a.didChoosePro) { a.didChoosePro() } this.trackAction("Subscribe to Pro") }; return b }; nfx.controllers.InviteMembersModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Add team members"); b.actionLabel = function () { return (this.billedNow() ? "Pay and add team members" : "Add team members") }.bind(b); b.billedNext = function () { if (!this.organization().proSubscription()) { return } var c = this.organization().proSubscription(); return c.plan().priceForBillingIntervalAndMembers(c.billingInterval(), this.organization().membersCount() + this.emailsCount()) }.bind(b); b.billedNow = function () { if (!this.organization().proSubscription()) { return } var d = this.organization().proSubscription(), e = d.plan(); var c = (e.priceForBillingIntervalAndMembers(d.currentBillingPeriodBillingInterval(), this.organization().membersCount() + this.emailsCount()) - d.currentBillingPeriodPayment()) * (d.currentBillingPeriodResidualDays() / d.currentBillingPeriodTotalDays()); return (c > 0 ? c : 0) }.bind(b); b.organization = a.organization; b._emails = ""; b._emailsCount = 0; b.emails = (function () { if (arguments.length) { this._emails = arguments[0]; this.actionable(arguments[0] != ""); this._emailsCount = 0; var d = this._emails.split(/[,\s]+/); for (var c = 0; c < d.length; ++c) { if (d[c].match(/^[^@]+@[^@\.]+\.[^@]+$/)) { ++this._emailsCount } } } return this._emails }).bind(b); b.emails.toJSON = (function () { return this._emails }).bind(b); b.errorMessage = m.prop(undefined); b.emailsInvalid = m.prop(false); b.emailsCount = function () { return this._emailsCount }.bind(b); b.action = function () { var c = this; this.trackAction("Confirm"); this.processing(true); this.errorMessage(undefined); this.emailsInvalid(false); Nextfinder.transport.post({ url: "/organizations/" + b.organization().organizationId() + "/invites", data: { emails: this.emails() }, success: function (d) { nfx.app.modalStackController.dismissTopmost(); if (a.onInvited) { a.onInvited() } }, error: function (d, e) { c.processing(false); c.emailsInvalid(d == "invalid_data"); switch (d) { case "invalid_data": c.errorMessage("That does not look like e-mail addresses"); break; case "credit_card_declined": case "invalid_Credit_card": c.errorMessage("Sorry, but your credit card was declined"); break; case "no_payment_method": c.errorMessage("You don't have a credit card registered. Please update your payment methods"); break; case "unpaid_billing_cycles": c.errorMessage("You have unpaid subscription charges outstanding. Please check your payment methods"); break; default: c.errorMessage("We had a problem talking to the server. Sorry about that - please try again!") }m.redraw() } }) }; return b }; nfx.controllers.ModalStackLoaderController = function (a) { this.message = m.prop(a || "Hang tight..."); this.dismissable = m.prop(false) }; nfx.controllers.PaymentFormController = function (j) { var h = this; j = j || {}; var a = new CardCheck(); var k = function (n, l) { this.creditCard = m.prop(n); this.isSelected = m.prop((l() || false) && (n.paymentProvider() != "paymill")); this.isSelectable = m.prop(n.paymentProvider() != "paymill") }; this.hideUnselectable = m.prop(j.hideUnselectable == true); var c = function () { this.errorMessage(undefined); this.creditCardNumberInvalid(false); this.creditCardExpirationMonthInvalid(false); this.creditCardExpirationYearInvalid(false); this.creditCardHolderNameInvalid(false); this.creditCardCvcInvalid(false) }.bind(this); var g = function () { var u = $.trim(this.creditCardNumber()), o = $.trim(this.creditCardExpirationMonth()), r = $.trim(this.creditCardExpirationYear()), q = $.trim(this.creditCardCvc()), s = $.trim(this.creditCardHolderName()), l = true, t = this; function p(v) { l = false; t.errorMessage(v) } if (u.length == 0) { p("Please enter a credit card number"); this.creditCardNumberInvalid(true) } else { if (!$.payment.validateCardNumber(u)) { p("Your credit card number is not valid"); this.creditCardNumberInvalid(true) } else { this.creditCardNumberInvalid(false) } } if (o.length == 0) { p("Please enter the expiration month"); this.creditCardExpirationMonthInvalid(true) } if (r.length == 0) { p("Please enter the expiration year"); this.creditCardExpirationYearInvalid(true) } else { if (r.length == 4) { r = r.slice(-2); this.creditCardExpirationYearInvalid(false) } } if ((o.length > 0) && (r.length > 0)) { var n = $.payment.validateCardExpiry(o, r); this.creditCardExpirationYearInvalid(!n); this.creditCardExpirationMonthInvalid(!n); if (!n) { p("The expiration date is not valid") } } if (q.length < 3) { p("Please enter card verification code, eg. '123'"); this.creditCardCvcInvalid(true) } else { if (!$.payment.validateCardCVC(q)) { p("Your card validation code (CVC) is not valid"); this.creditCardCvcInvalid(true) } else { this.creditCardCvcInvalid(false) } } if (s.length == 0) { p("Please enter the name of the card holder"); this.creditCardHolderNameInvalid(true) } else { this.creditCardHolderNameInvalid(false) } return l }.bind(this); var d = function (r) { var n = [], l = false, q = false; r.forEach(function (t) { var s = new k(t, t.isDefault); if (!h.hideUnselectable() && s.isSelectable()) { n.push(s) } if (s.isSelected()) { l = true } else { if (!s.isSelectable()) { q = true } } }); if ((n.length) && (!l)) { for (var p = 0; p < n.length; p++) { var o = n[p]; if (o.isSelectable()) { o.isSelected(true); break } } } this.existingCreditCards(n); this.hasUnselectableExistingCreditCards(q); if (n.length) { this.selectPaymentMethod("existing-credit-card") } }.bind(this); var f = function () { var n = this; if (j.didStartLoading) { j.didStartLoading() } function l() { nfx.api.commerce.listCreditCards().then(function (o) { m.startComputation(); d(o.creditCards); if (j.didEndLoading) { j.didEndLoading() } m.endComputation() }, function (o) { m.startComputation(); if (j.didEndLoading) { j.didEndLoading() } m.endComputation() }) } l() }.bind(this); var b = function () { c() }.bind(this); var e = function () { a.cardNumber(this.creditCardNumber()); this.creditCardType(a.cardType()); this.newCreditCardFormTitle(this.creditCardType() ? a.cardType(true) : "Credit card"); b() }.bind(this); this.creditCardAllowed = m.prop(j.creditCardAllowed !== false); this.payPalAllowed = m.prop(j.payPalAllowed !== false); this.existingCreditCardAllowed = m.prop(j.existingCreditCardAllowed !== false); this.selectedPaymentMethod = m.prop(this.creditCardAllowed() ? "new-credit-card" : "paypal"); this.existingCreditCards = m.prop([]); this.hasUnselectableExistingCreditCards = m.prop(false); this.hasSelectedExistingCreditCard = function () { var n = this.existingCreditCards(); for (var l = 0; l < n.length; l++) { if (n[l].isSelected()) { return true } } return false }.bind(this); this.newCreditCardFormTitle = m.prop("Credit card"); this.creditCardType = m.prop(null); this.creditCardValid = m.prop(false); this.errorMessage = m.prop(); this.creditCardNumber = nfx.mext.processedWatchedProp("", function (l) { return $.payment.formatCardNumber(l) }, e); this.creditCardExpirationMonth = nfx.mext.watchedProp("", b); this.creditCardExpirationYear = nfx.mext.watchedProp("", b); this.creditCardHolderName = nfx.mext.watchedProp("", b); this.creditCardCvc = nfx.mext.watchedProp("", b); this.rememberCreditCard = m.prop(true); this.rememberCreditCardOptional = (j.rememberCreditCardOptional !== false); this.creditCardNumberInvalid = m.prop(false); this.creditCardExpirationMonthInvalid = m.prop(false); this.creditCardExpirationYearInvalid = m.prop(false); this.creditCardHolderNameInvalid = m.prop(false); this.creditCardCvcInvalid = m.prop(false); this.actionable = function () { return ((this.selectedPaymentMethod() != "existing-credit-card") || (this.hasSelectedExistingCreditCard())) }.bind(this); this.selectPaymentMethod = function (l, n) { c(); this.selectedPaymentMethod(l); if (n) { n.preventDefault() } if (j.didChangeActionable) { j.didChangeActionable(this.actionable()) } }; this.selectExistingCreditCard = function (l) { this.existingCreditCards().forEach(function (n) { n.isSelected(n.creditCard().cardId == l.cardId) }); if (j.didChangeActionable) { j.didChangeActionable(this.actionable()) } }; this.submit = function (n) { if (n) { n.preventDefault() } else { m.startComputation() } if (j.didStartLoading) { j.didStartLoading() } if (this.selectedPaymentMethod() == "new-credit-card") { if (!g()) { if (j.didEndLoading) { j.didEndLoading() } m.endComputation(); return } var w = $.trim(this.creditCardNumber()), r = $.trim(this.creditCardExpirationMonth()), t = $.trim(this.creditCardExpirationYear()), s = $.trim(this.creditCardCvc()), u = $.trim(this.creditCardHolderName()), l = true, v = this; Stripe.setPublishableKey(window.STRIPE_PUBLISHABLE_KEY); Stripe.card.createToken({ number: w, exp_month: r, exp_year: (t.length == 2 ? "20" + t : t), cvc: s, name: u }, function (x, y) { if (j.didEndLoading) { j.didEndLoading() } if (y.error) { v.errorMessage("Your credit card does not seem to be valid or we do not accept it"); m.redraw(); return } if (j.didSelectNewCreditCard) { j.didSelectNewCreditCard(y.id, "stripe", this.rememberCreditCard()) } }.bind(this)) } else { if (this.selectedPaymentMethod() == "existing-credit-card") { var o = this.existingCreditCards(), q; for (var p = 0; p < o.length; p++) { if (o[p].isSelected()) { q = o[p].creditCard(); break } } if ((q) && (j.didSelectExistingCreditCard)) { j.didSelectExistingCreditCard(q) } } else { if (this.selectedPaymentMethod() == "paypal") { if (j.didSelectPayPal) { j.didSelectPayPal() } } } } if (!n) { m.endComputation() } }.bind(this); if ((this.creditCardAllowed) && (this.existingCreditCardAllowed())) { if (j.creditCards) { d(j.creditCards) } else { f() } } }; nfx.controllers.SubscriptionCreatedModalController = function (a) { var b = new nfx.controllers.ModalController(); b.proSubscription = m.prop(a.proSubscription); b.transaction = m.prop(a.transaction); b.discount = m.prop(a.discount); b.title("Your Iconfinder Pro subscription is now ready"); b.dismissable(false); b.actionLabel("Take me to the dashboard"); b.actionable(true); b.action = function () { b.trackAction("Confirm"); location.href = "/account/" }; b.dismiss = function () { location.reload() }; return b }; nfx.controllers.SubscriptionPaymentModalController = function (b) { var c = new nfx.controllers.ModalController(); var a = function (f, d, e) { m.startComputation(); c.processing(true); m.endComputation(); Nextfinder.transport.post({ url: "/pro/ajax/subscribe", data: { plan_identifier: b.pricingPlanIdentifier, card_id: f, payment_token: d, payment_provider: e, billing_interval: b.billingInterval }, success: function (g) { if (b.didSubscribe) { b.didSubscribe(new nfx.models.ProSubscription(g.proSubscription), new nfx.models.Transaction(g.transaction)) } }, error: function (g, h) { var j = "Something went wrong while trying to set up your subscription."; switch (g) { case "invalid_credit_card": j = "Invalid credit card data. Please check your credit card data below."; break; case "credit_card_declined": j = "Your credit card was declined, sorry."; break; case "invalid_data": j = "The data you have entered is not valid."; break; case "suspicious_activity": j = "Your account has been flagged for suspicious activity. A support staff will review your account shortly. We're sorry about the inconvenience."; break }m.startComputation(); c.paymentFormController.errorMessage(j); c.processing(false); m.endComputation() } }) }; c.title("Subscribe to Iconfinder Pro"); c.actionLabel("Subscribe"); c.actionable(true); c.paymentFormController = new nfx.controllers.PaymentFormController({ creditCards: b.creditCards, payPalAllowed: false, rememberCreditCardOptional: false, didSelectExistingCreditCard: function (d) { a(d.cardId) }, didSelectNewCreditCard: function (d, e) { a(undefined, d, e) }, didStartLoading: function () { c.processing(true) }, didEndLoading: function () { c.processing(false) }, didChangeActionable: function (d) { c.actionable(d) } }); c.action = function (d) { d.preventDefault(); this.trackAction("Confirm"); this.paymentFormController.submit() }; return c }; nfx.controllers.ChurnSurveyModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Feedback"); b.dismissLabel("Close window"); b.dismissable(false); b.reasons = $.shuffle(a.reasons); b.toggleOther = function (d) { var c = $('#feedback-form input[value="0"]').is(":checked"); $("#other-reason").toggleClass("hidden", !c); if (d == 0) { setTimeout(function () { $("#other-reason").focus() }, 50) } }; b.validate = function () { var c = $('#feedback-form input[type="checkbox"]:checked').length > 0; $("#feedback-form .alert").toggleClass("hidden", c); return c }; b.submit = function () { if (b.validate()) { $("#feedback-form").parents(".modal").find(".btn").attr("disabled", true); b.trackAction("Submit"); var c = { reasons: [] }; c.freetext = $("#other-reason").val(); $("#feedback-form input").sort(function (e, d) { return $(e).val() - $(d).val() }).each(function () { c.reasons.push($(this).is(":checked")) }); Nextfinder.transport.post({ url: "/pro/ajax/subscriptions/" + a.id + "/feedback", data: c, success: function (d, e) { alert("Thank you for your feedback!"); location.reload() }.bind(self), error: function (d, e) { alert("Something went wrong, please try again!"); $("#feedback-form").parents(".modal").find(".btn").attr("disabled", false) }.bind(self) }) } }; b.dismiss = function () { b.trackAction("Dismiss"); location.reload() }; return b }; nfx.controllers.FreeDownloadPromptModalController = function (a) { var b = new nfx.controllers.AuthenticationModalController(a); a = a || {}; b.title("Continue downloading free icons"); b.logIn = function () { nfx.app.modalStackController.replaceTopmost(new nfx.modules.LogInModalModule({ onAuthenticate: a.onAuthenticate })) }; b.signUp = function () { nfx.app.modalStackController.replaceTopmost(new nfx.modules.SignUpModalModule({ onAuthenticate: a.onAuthenticate })) }; return b }; nfx.controllers.SignUpModalController = function (a) { var b = new nfx.controllers.AuthenticationModalController(a); a = a || {}; b.title("Sign up"); b.actionLabel("Sign up"); b.actionable(true); b.firstName = nfx.mext.validatedProp("", { required: true, minlength: 2, maxlength: 128, clean: $.trim }); b.lastName = nfx.mext.validatedProp("", { required: true, minlength: 2, maxlength: 128, clean: $.trim }); b.email = nfx.mext.validatedProp("", { required: true, minlength: 5, maxlength: 128, clean: $.trim }); b.username = nfx.mext.validatedProp("", { required: true, minlength: 2, maxlength: 128, clean: $.trim }); b.password = nfx.mext.validatedProp("", { required: true, minlength: 6, maxlength: 128, clean: $.trim }); b.dismissable(a.dismissable !== false); b.logIn = function (c) { if (c) { c.preventDefault() } nfx.app.modalStackController.replaceTopmost(new nfx.modules.LogInModalModule({ dismissable: a.dismissable, onAuthenticate: a.onAuthenticate })) }; b.action = function (d) { if (d) { d.preventDefault() } this.trackAction("Confirm"); if ((!this.firstName.validate()) || (!this.lastName.validate()) || (!this.username.validate()) || (!this.email.validate()) || (!this.password.validate())) { return } this.processing(true); this.errorMessage(undefined); var c = { first_name: this.firstName, last_name: this.lastName, username: this.username, email: this.email, password: this.password, is_newsletter_subscriber: this.isNewsletterSubscriber }; var f = {}; for (var g in c) { var e = c[g](); if (e === false) { e = "" } else { if (e === true) { e = "on" } } if (e) { f[g] = e } } Nextfinder.transport.post({ url: "/user/ajax/signup", data: f, error: function (h, k) { m.startComputation(); if (h == "invalid_data") { for (var j in k.errors) { c[j].error(k.errors[j][0]) } } else { this.errorMessage(k.message) } Nextfinder.tracking.trackEvent("User", "Sign up", "Error code", h); this.processing(false); m.endComputation() }.bind(this), success: function (h) { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Sign up", "Signed up successfully"); this.processing(false); if (a.onAuthenticate) { a.onAuthenticate() } m.endComputation() }.bind(this) }) }; return b }; nfx.controllers.MissingUserDataModalController = function (a) { var b = new nfx.controllers.ModalController(); a = a || {}; b.title("Sign up"); b.actionLabel("Create account"); b.actionable(true); b.errorMessage = m.prop(undefined); b.firstName = nfx.mext.validatedProp(a.initialUserData.first_name || "", { required: true, minlength: 2, maxlength: 128, clean: $.trim }); b.lastName = nfx.mext.validatedProp(a.initialUserData.last_name || "", { required: true, minlength: 2, maxlength: 128, clean: $.trim }); b.email = nfx.mext.validatedProp(a.initialUserData.email || "", { required: true, minlength: 5, maxlength: 128, clean: $.trim }); b.username = nfx.mext.validatedProp(a.initialUserData.username || "", { required: true, minlength: 2, maxlength: 128, clean: $.trim }); b.isNewsletterSubscriber = m.prop(true); b.action = function (d) { if (d) { d.preventDefault() } this.trackAction("Confirm"); if ((!this.firstName.validate()) || (!this.lastName.validate()) || (!this.username.validate()) || (!this.email.validate())) { return } this.processing(true); this.errorMessage(undefined); var c = { first_name: this.firstName, last_name: this.lastName, username: this.username, email: this.email, is_newsletter_subscriber: this.isNewsletterSubscriber }; var f = { backend_name: a.initialUserData.backend_name, backend_user_id: a.initialUserData.backend_user_id }; for (var g in c) { var e = c[g](); if (e === false) { e = "" } else { if (e === true) { e = "on" } } if (e) { f[g] = e } } Nextfinder.transport.post({ url: "/user/ajax/missing-user-data", data: f, error: function (h, k) { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Connect with Facebook", "Require data error code", h); if (h == "invalid_data") { this.errorMessage("Oops! Please correct the errors below."); for (var j in k.errors) { c[j].error(k.errors[j][0]) } } else { this.errorMessage(k.message) } this.processing(false); m.endComputation() }.bind(this), success: function (h) { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Connect with Facebook", "Successful"); this.processing(false); if (a.onAuthenticate) { a.onAuthenticate() } m.endComputation() }.bind(this) }) }; return b }; nfx.controllers.LogInModalController = function (a) { var b = new nfx.controllers.AuthenticationModalController(a); a = a || {}; b.title("Log in"); b.actionLabel("Log in"); b.actionable(true); b.username = nfx.mext.validatedProp("", { required: true, clean: $.trim }); b.password = nfx.mext.validatedProp("", { required: true, clean: $.trim }); b.remember = m.prop(true); b.recaptchaRequired = m.prop(false); b.recaptchaPublicKey = m.prop(); b.dismissable(a.dismissable !== false); b.signUp = function (d) { if (d) { d.preventDefault() } nfx.app.modalStackController.replaceTopmost(new nfx.modules.SignUpModalModule({ dismissable: a.dismissable, onAuthenticate: a.onAuthenticate })) }; function c(h) { if (window.Recaptcha) { h(); return } var g = false, f = document.getElementsByTagName("head")[0], e = document.createElement("script"); function d() { if (g) { return } g = true; h() } e.type = "text/javascript"; e.onreadystatechange = function () { d() }; e.onload = d; e.src = "https://www.google.com/recaptcha/api/js/recaptcha_ajax.js"; f.appendChild(e) } b.action = function (e) { if (e) { e.preventDefault() } this.trackAction("Confirm"); if ((!this.username.validate()) || (!this.password.validate())) { return } this.processing(true); this.errorMessage(undefined); var d = { username: this.username, password: this.password, remember_me: this.remember }; var g = { recaptcha_challenge_field: $('input[name="recaptcha_challenge_field"]').val(), recaptcha_response_field: $('input[name="recaptcha_response_field"]').val() }; for (var h in d) { var f = d[h](); if (f === false) { f = "" } else { if (f === true) { f = "on" } } if (f) { g[h] = f } } Nextfinder.transport.post({ url: "/user/ajax/login", data: g, error: function (j, l) { m.startComputation(); if (j == "invalid_data") { this.errorMessage("Oops! Please correct the errors below."); for (var k in l.errors) { if (k == "__all__") { this.errorMessage(l.errors[k][0]) } else { if (d[k]) { d[k].error(l.errors[k][0]) } } } } else { this.errorMessage(l.message) } Nextfinder.tracking.trackEvent("User", "Log in", "Error code", j); if ((l.recaptcha_required) && (!this.recaptchaRequired())) { c(function () { m.startComputation(); this.processing(false); this.recaptchaRequired(true); this.recaptchaPublicKey(l.recaptcha_public_key); m.endComputation() }.bind(this)) } else { this.processing(false) } m.endComputation() }.bind(this), success: function (j) { m.startComputation(); Nextfinder.tracking.trackEvent("User", "Log in", "Logged in successfully"); this.processing(false); if (a.onAuthenticate) { a.onAuthenticate() } m.endComputation() }.bind(this) }) }; return b }; nfx.controllers.FormatIsProOnlyPromptModalController = function (a) { var b = new nfx.controllers.AuthenticationModalController(a); a = a || {}; b.title("Get additional formats with Iconfinder Pro"); return b }; nfx.controllers.PrivateMessageIsProOnlyPromptModalController = function (a) { var b = new nfx.controllers.AuthenticationModalController(a); a = a || {}; b.title("Get access to private messages with Iconfinder Pro"); return b }; nfx.controllers.SubscriptionController = function (c) { var a = function () { var h = "/pro/subscribe?plan=" + this.currentPlan().identifier() + "&billing_interval=" + this.billingInterval(); if (this.campaignIdentifier()) { h += "&campaign=" + encodeURIComponent(this.campaignIdentifier()) } if (c.discountCode.length > 0) { this.validateDiscountCode() } if (c.referralDiscount !== null && !this.discount()) { this.discount(new nfx.models.SubscriptionDiscountCode(c.referralDiscount)) } History.replaceState(null, $("head title").text(), h) }.bind(this); this.iconsCount = m.prop(c.iconsCount); this.pricingPlans = m.prop(c && c.pricingPlans ? c.pricingPlans.map(function (h) { return new nfx.models.PricingPlan(h) }) : null); this.user = m.prop(c && c.user ? new nfx.models.User(c.user) : null); this.organization = m.prop(c && c.organization ? new nfx.models.Organization(c.organization) : null); this.billingInterval = nfx.mext.watchedProp(c.billingInterval, function () { a() }); this.isBusiness = m.prop(false); this.userCommerceStatistics = m.prop(c && c.userCommerceStatistics ? new nfx.models.UserCommerceStatistics(c.userCommerceStatistics) : null); var f; for (var d = 0; d < this.pricingPlans().length; ++d) { var g = this.pricingPlans()[d]; if (!g.isAvailable(this.organization())) { continue } f = g; break } if (c.defaultPlanIdentifier) { for (var d = 0; d < this.pricingPlans().length; ++d) { var g = this.pricingPlans()[d]; if ((!g.isAvailable(this.organization())) || (g.identifier() != c.defaultPlanIdentifier)) { continue } f = g; break } } this.currentPlan = nfx.mext.watchedProp(f, function () { a() }); this.discount = m.prop(); this.discountCode = m.prop(c.discountCode); this.discountCodePercentage = m.prop(c.discountCodePercentage); this.discountCodeError = m.prop(undefined); this.discountCodeLoading = m.prop(false); this.balance = m.prop(this.user() ? this.user().balance() : 0); this.processing = m.prop(); this.errorMessage = m.prop(); var e = new nfx.controllers.BillingDetailsController({ user: this.user }); this.billingDetailsCtrl = e; var b = new nfx.controllers.PaymentFormController({ existingCreditCardAllowed: true, payPalAllowed: false, rememberCreditCardOptional: false, hideUnselectable: false, didSelectNewCreditCard: function (j, k, h) { this.submitData.bind(this)({ token: j, paymentProvider: k, rememberCreditCard: h }) }.bind(this), didSelectExistingCreditCard: function (h) { this.submitData.bind(this)({ creditCard: h }) }.bind(this), didStartLoading: function () { this.processing(true) }.bind(this), didEndLoading: function () { if (b.hasUnselectableExistingCreditCards()) { this.errorMessage("The previously stored credit card can be used, but you have to add it again.") } this.processing(false) }.bind(this) }); this.paymentFormController = b; this.vatCharge = function () { return nfx.services.commerceService.getVatCharge(this.billingDetailsCtrl.addressCountry(), !!$.trim(this.billingDetailsCtrl.vatNumber())) }.bind(this); this.campaignIdentifier = m.prop(c ? c.campaignIdentifier : null); this.campaignDiscountAmount = function () { if (this.campaignIdentifier() == "payg-30") { return (this.userCommerceStatistics() ? this.userCommerceStatistics().assetSpendingLast30Days() : 0) } return 0 }.bind(this); this.campaignDiscountDescription = function () { return "Discount" }.bind(this); this.confirmSubscription = function () { if ((!this.user() || (this.processing()))) { return } this.errorMessage(undefined); this.processing(true); e.submitForm().then(function () { b.submit() }.bind(this), function (h) { m.startComputation(); this.errorMessage(e.errorMessage()); this.processing(false); m.endComputation() }.bind(this)) }; this.submitData = function (h) { m.startComputation(); this.processing(true); m.endComputation(); nfx.app.modalStackController.replaceAllWithLoader("Processing payment..."); var j = setTimeout(function () { nfx.app.modalStackController.replaceTopmostWithLoader("This may take a few seconds...") }, 3000); Nextfinder.transport.post({ url: "/pro/ajax/subscribe", data: { plan_identifier: this.currentPlan().identifier(), billing_interval: this.billingInterval(), discount_code: this.discountCode(), card_id: h.creditCard ? h.creditCard.cardId : undefined, payment_token: h.token ? h.token : undefined, payment_provider: h.paymentProvider ? h.paymentProvider : undefined, campaign: this.campaignIdentifier() || undefined }, error: function (k, l) { var n = "Something went wrong while trying to set up your subscription."; switch (k) { case "invalid_credit_card": n = "Invalid credit card data. Please check your credit card data below."; break; case "credit_card_declined": n = "Your credit card was declined, sorry."; break; case "invalid_data": n = "The data you have entered is not valid."; break; case "suspicious_activity": n = "Your account has been flagged for suspicious activity. A support staff will review your account shortly. We're sorry about the inconvenience."; break; case "invalid_discount_code": n = "The promotional code your entered is not valid."; break; case "plan_not_applicable": n = "The plan you've chosen is not available."; break }m.startComputation(); this.errorMessage(n); this.processing(false); m.endComputation(); clearInterval(j); nfx.app.modalStackController.dismissAll() }.bind(this), success: function (l) { var o = new nfx.models.ProSubscription(l.proSubscription), n = new nfx.models.Transaction(l.transaction), k = this.currentPlan().identifier(); Nextfinder.tracking.trackEvent("Commerce", "Subscribe", "Pro", n.amountPayment() * 1.75); Nextfinder.tracking.trackTransaction(n.transactionId(), "Iconfinder", n.amountPayment(), 0, k, k, "Pro: Subscription", "N/A", "N/A", "N/A"); clearInterval(j); nfx.app.modalStackController.replaceTopmost(new nfx.modules.SubscriptionCreatedModalModule({ proSubscription: o, transaction: n, discount: this.discount() })) }.bind(this) }) }; this.validateDiscountCode = function (h) { if (h) { h.preventDefault() } this.discountCodeLoading(true); this.processing(true); Nextfinder.transport.get({ url: "/pro/ajax/discount-code", data: { code: this.discountCode() }, error: function (j, k) { m.startComputation(); this.discount(undefined); this.discountCodeLoading(false); a(); this.processing(false); m.endComputation() }.bind(this), success: function (j) { m.startComputation(); this.discount(new nfx.models.SubscriptionDiscountCode(j)); this.discountCodeError("Valid code"); this.discountCodeLoading(false); a(); this.processing(false); m.endComputation() }.bind(this) }) }; a() }; nfx.controllers.PrivateMessageModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Contact user"); b.actionLabel("Send message"); b.actionable = m.prop(true); b.errorMessage = m.prop(); b.message = nfx.mext.validatedProp("", { required: true, minlength: 2, errorMessages: { required: "Please write a message to send." }, clean: $.trim }); b.action = function () { if (b.message.validate()) { b.processing(true); Nextfinder.transport.get({ url: "/account/messages/send", data: { to_user_id: a.toUserId, text: b.message.clean() }, error: function (c, d) { m.startComputation(); b.processing(false); b.errorMessage("There was an error sending your message."); m.endComputation() }.bind(b), success: function (c) { m.startComputation(); b.dismiss(); m.endComputation(); $.pnotify({ pnotify_notice_icon: "", pnotify_history: false, pnotify_text: "Your message has successfully been sent." }) }.bind(b) }) } }; return b }; nfx.controllers.PerformanceInspectorController = function (l) { var a = [], j = 0, d = 0, f = 0, b = 0; for (var e = 0; e < l.queries.length; ++e) { var h = l.queries[e]; a.push({ resource: "Database", startTime: h.start_time, duration: h.duration, result: null, operation: h.sql }); b += h.duration } for (var e = 0; e < l.cacheAccess.length; ++e) { var c = l.cacheAccess[e]; a.push({ resource: "Cache", startTime: c.start_time, duration: c.duration, result: c.total ? c.hits + "/" + c.total : null, operation: c.description }); if (c.total) { j += c.total } if (c.hits) { d += c.hits } f += h.duration } a.sort(function (o, n) { return o.startTime - n.startTime }); var k = 0; for (var e = 0; e < a.length; ++e) { var g = a[e].startTime + a[e].duration; if (g > k) { k = g } } this.cacheAccessTotal = m.prop(j); this.cacheAccessHits = m.prop(d); this.cacheAccessDuration = m.prop(f); this.queriesTotal = m.prop(l.queries.length); this.queriesDuration = m.prop(b); this.operations = m.prop(a); this.operationLastEnds = m.prop(k) }; nfx.controllers.NewsletterEditController = function (a) { this.newsletter = new nfx.models.Newsletter({ newsletterId: a.newsletter.newsletterId, subject: a.newsletter.subject, parts: a.newsletter.parts.map(function (b) { return new { line: nfx.models.SimpleNewsletterPart, text: nfx.models.SimpleNewsletterPart, color: nfx.models.SimpleNewsletterPart, article_list: nfx.models.ArticleListNewsletterPart, iconset_list: nfx.models.IconSetListNewsletterPart, image: nfx.models.ImageNewsletterPart }[b.type](b) }) }); this.latestExternalArticles = m.prop(a.latestExternalArticles ? a.latestExternalArticles.map(function (b) { return new nfx.models.ExternalArticle(b) }) : []); this.latestPromotedIconSets = m.prop(a.latestPromotedIconSets ? a.latestPromotedIconSets.map(function (b) { return new nfx.models.IconSetListNewsletterPartIconSet(b) }) : []); this._save = function (b) { var c = { subject: this.newsletter.subject(), data: {} }; this.newsletter.parts().forEach(function (d) { c.data[d.identifier()] = d.data() }); Nextfinder.transport.post({ url: "/admin/newsletters/" + this.newsletter.newsletterId(), data: JSON.stringify(c), contentType: "application/json; charset=utf-8", success: function (d) { if (b) { b() } else { nfx.app.modalStackController.dismissAll() } }, error: function (d, e) { nfx.app.modalStackController.replaceTopmostWithError("Couldn't save newsletter", ((e) && (e.message) ? e.message : "Error code: " + d)) } }); nfx.app.modalStackController.presentLoader("Saving...") }; this.save = function (b) { b.preventDefault(); this._save() }; this.saveAndSendPreview = function (b) { b.preventDefault(); this._save(function () { nfx.app.modalStackController.dismissAll(); var c = prompt("Recipient e-mail addresses (comma separated)"); if (!c) { return } var d = []; c.split(",").forEach(function (e) { e = $.trim(e); if (e) { d.push(e) } }); if (!d) { return } Nextfinder.transport.post({ url: "/admin/newsletters/" + this.newsletter.newsletterId() + "/send-preview", data: JSON.stringify({ emails: d }), contentType: "application/json; charset=utf-8", success: function (e) { nfx.app.modalStackController.dismissAll() }, error: function (e, f) { nfx.app.modalStackController.replaceTopmostWithError("Couldn't send newsletter preview", ((f) && (f.message) ? f.message : "Error code: " + e)) } }); nfx.app.modalStackController.presentLoader("Sending...") }.bind(this)) }; this.saveAndSend = function (b) { b.preventDefault(); this._save(function () { nfx.app.modalStackController.dismissAll(); var c = prompt('You\'re about to send an e-mail newsletter to a lot of people. Please enter "I understand" to confirm this.'); if ((!c) || (c.toLowerCase() != "i understand")) { return } Nextfinder.transport.post({ url: "/admin/newsletters/" + this.newsletter.newsletterId() + "/send", success: function (d) { location.reload() }, error: function (d, e) { nfx.app.modalStackController.replaceTopmostWithError("Couldn't send newsletter", ((e) && (e.message) ? e.message : "Error code: " + d)) } }); nfx.app.modalStackController.presentLoader("Sending...") }.bind(this)) }; this.uploadImage = function (b, c) { nfx.services.staticAssetService.upload(c).then(function (d) { m.startComputation(); b.asset(d); m.endComputation() }, function (d) { nfx.app.modalStackController.replaceTopmostWithError("Couldn't upload file", d.message) }) }; this.uploadArticleThumbnail = function (c, b) { nfx.services.staticAssetService.upload(b).then(function (d) { m.startComputation(); c.thumbnail(d); m.endComputation() }, function (d) { nfx.app.modalStackController.replaceTopmostWithError("Couldn't upload file", d.message) }) } }; nfx.controllers.MailingListSubscribeModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Subscribe to the Iconfinder mailing list"); b.dismissLabel("Cancel"); b.actionLabel("Subscribe"); b.actionable(true); b.dismissable(a.dismissable !== false); b.isSubscribed = m.prop(false); b.errorMessage = m.prop(undefined); b.email = nfx.mext.validatedProp("", { required: true, minlength: 5, maxlength: 128, clean: $.trim, errorMessages: { required: "We need to know where to send the newsletter." } }); b.firstName = nfx.mext.validatedProp("", { required: true, minlength: 2, maxlength: 128, clean: $.trim, errorMessages: { required: "What's your first name?" } }); b.lastName = nfx.mext.validatedProp("", { required: true, minlength: 2, maxlength: 128, clean: $.trim, errorMessages: { required: "What's your last name?" } }); b.action = function (e) { if (e) { e.preventDefault() } if (this.isSubscribed()) { if (a.dismissable !== false) { nfx.app.modalStackController.dismissAll() } else { location.href = "/" } return } var d = this.firstName.validate(); if (!this.lastName.validate()) { d = false } if (!this.email.validate()) { d = false } if (!d) { return } this.processing(true); this.errorMessage(undefined); var c = { first_name: this.firstName, last_name: this.lastName, email: this.email }; var g = {}; for (var h in c) { var f = c[h](); if (f) { g[h] = f } } b.trackAction("Subscribe"); Nextfinder.transport.post({ url: "/mailing-lists/ajax/" + a.mailingListId + "/subscribe", data: g, error: function (j, l) { m.startComputation(); if (j == "invalid_data") { this.errorMessage("Oops! Please correct the errors below."); for (var k in l.errors) { c[k].error(l.errors[k][0]) } } else { this.errorMessage(l.message) } this.processing(false); m.endComputation() }.bind(this), success: function (j) { m.startComputation(); Nextfinder.tracking.trackEvent("Mailing lists", "Subscribe", "Successful"); this.processing(false); this.isSubscribed(true); this.dismissable(false); this.actionLabel("Awesome!"); m.endComputation() }.bind(this) }) }; return b }; nfx.controllers.RequestPaymentModalController = function (a) { var b = new nfx.controllers.ModalController(); b.title("Request Payment"); b.requestPayment = function () { var c = $("#requestPaymentModal form"); c.validate({ errorElement: "div", errorClass: "text-error", focusInvalid: false, highlight: function (d) { $(d).parents(".control-group").addClass("error") }, unhighlight: function (d) { $(d).parents(".control-group").removeClass("error") }, errorPlacement: function (d, e) { d.appendTo(e.parents(".controls")) } }); if (c.valid()) { this.processing(true); $(".reply-form textarea").rules("remove"); c.serializeArray().map(function (d) { $("<input />", d).attr("type", "hidden").appendTo("form.reply-form") }); $("form.reply-form").submit() } }; return b }; nfx.viewHelpers.countrySelect = function (a, b) { return m("select", { name: a, id: "id_" + a, value: b(), onchange: m.withAttr("value", b) }, [m("option", { value: "US" }, "United States of America"), m("option", { value: "AF" }, "Afghanistan"), m("option", { value: "AX" }, "Åland Islands"), m("option", { value: "AL" }, "Albania"), m("option", { value: "DZ" }, "Algeria"), m("option", { value: "AS" }, "American Samoa"), m("option", { value: "AD" }, "Andorra"), m("option", { value: "AO" }, "Angola"), m("option", { value: "AI" }, "Anguilla"), m("option", { value: "AQ" }, "Antarctica"), m("option", { value: "AG" }, "Antigua and Barbuda"), m("option", { value: "AR" }, "Argentina"), m("option", { value: "AM" }, "Armenia"), m("option", { value: "AW" }, "Aruba"), m("option", { value: "AU" }, "Australia"), m("option", { value: "AT" }, "Austria"), m("option", { value: "AZ" }, "Azerbaijan"), m("option", { value: "BS" }, "Bahamas"), m("option", { value: "BH" }, "Bahrain"), m("option", { value: "BD" }, "Bangladesh"), m("option", { value: "BB" }, "Barbados"), m("option", { value: "BY" }, "Belarus"), m("option", { value: "BE" }, "Belgium"), m("option", { value: "BZ" }, "Belize"), m("option", { value: "BJ" }, "Benin"), m("option", { value: "BM" }, "Bermuda"), m("option", { value: "BT" }, "Bhutan"), m("option", { value: "BO" }, "Bolivia, Plurinational State of"), m("option", { value: "BQ" }, "Bonaire, Sint Eustatius and Saba"), m("option", { value: "BA" }, "Bosnia and Herzegovina"), m("option", { value: "BW" }, "Botswana"), m("option", { value: "BV" }, "Bouvet Island"), m("option", { value: "BR" }, "Brazil"), m("option", { value: "IO" }, "British Indian Ocean Territory"), m("option", { value: "BN" }, "Brunei Darussalam"), m("option", { value: "BG" }, "Bulgaria"), m("option", { value: "BF" }, "Burkina Faso"), m("option", { value: "BI" }, "Burundi"), m("option", { value: "KH" }, "Cambodia"), m("option", { value: "CM" }, "Cameroon"), m("option", { value: "CA" }, "Canada"), m("option", { value: "CV" }, "Cape Verde"), m("option", { value: "KY" }, "Cayman Islands"), m("option", { value: "CF" }, "Central African Republic"), m("option", { value: "TD" }, "Chad"), m("option", { value: "CL" }, "Chile"), m("option", { value: "CN" }, "China"), m("option", { value: "CX" }, "Christmas Island"), m("option", { value: "CC" }, "Cocos (Keeling) Islands"), m("option", { value: "CO" }, "Colombia"), m("option", { value: "KM" }, "Comoros"), m("option", { value: "CG" }, "Congo"), m("option", { value: "CD" }, "Congo, the Democratic Republic of the"), m("option", { value: "CK" }, "Cook Islands"), m("option", { value: "CR" }, "Costa Rica"), m("option", { value: "CI" }, "Côte d'Ivoire"), m("option", { value: "HR" }, "Croatia"), m("option", { value: "CU" }, "Cuba"), m("option", { value: "CW" }, "Curaçao"), m("option", { value: "CY" }, "Cyprus"), m("option", { value: "CZ" }, "Czech Republic"), m("option", { value: "DK" }, "Denmark"), m("option", { value: "DJ" }, "Djibouti"), m("option", { value: "DM" }, "Dominica"), m("option", { value: "DO" }, "Dominican Republic"), m("option", { value: "EC" }, "Ecuador"), m("option", { value: "EG" }, "Egypt"), m("option", { value: "SV" }, "El Salvador"), m("option", { value: "GQ" }, "Equatorial Guinea"), m("option", { value: "ER" }, "Eritrea"), m("option", { value: "EE" }, "Estonia"), m("option", { value: "ET" }, "Ethiopia"), m("option", { value: "FK" }, "Falkland Islands (Malvinas)"), m("option", { value: "FO" }, "Faroe Islands"), m("option", { value: "FJ" }, "Fiji"), m("option", { value: "FI" }, "Finland"), m("option", { value: "FR" }, "France"), m("option", { value: "GF" }, "French Guiana"), m("option", { value: "PF" }, "French Polynesia"), m("option", { value: "TF" }, "French Southern Territories"), m("option", { value: "GA" }, "Gabon"), m("option", { value: "GM" }, "Gambia"), m("option", { value: "GE" }, "Georgia"), m("option", { value: "DE" }, "Germany"), m("option", { value: "GH" }, "Ghana"), m("option", { value: "GI" }, "Gibraltar"), m("option", { value: "GB" }, "Great Britain"), m("option", { value: "GR" }, "Greece"), m("option", { value: "GL" }, "Greenland"), m("option", { value: "GD" }, "Grenada"), m("option", { value: "GP" }, "Guadeloupe"), m("option", { value: "GU" }, "Guam"), m("option", { value: "GT" }, "Guatemala"), m("option", { value: "GG" }, "Guernsey"), m("option", { value: "GN" }, "Guinea"), m("option", { value: "GW" }, "Guinea-Bissau"), m("option", { value: "GY" }, "Guyana"), m("option", { value: "HT" }, "Haiti"), m("option", { value: "HM" }, "Heard Island and McDonald Islands"), m("option", { value: "VA" }, "Holy See (Vatican City State)"), m("option", { value: "HN" }, "Honduras"), m("option", { value: "HK" }, "Hong Kong"), m("option", { value: "HU" }, "Hungary"), m("option", { value: "IS" }, "Iceland"), m("option", { value: "IN" }, "India"), m("option", { value: "ID" }, "Indonesia"), m("option", { value: "IR" }, "Iran, Islamic Republic of"), m("option", { value: "IQ" }, "Iraq"), m("option", { value: "IE" }, "Ireland"), m("option", { value: "IM" }, "Isle of Man"), m("option", { value: "IL" }, "Israel"), m("option", { value: "IT" }, "Italy"), m("option", { value: "JM" }, "Jamaica"), m("option", { value: "JP" }, "Japan"), m("option", { value: "JE" }, "Jersey"), m("option", { value: "JO" }, "Jordan"), m("option", { value: "KZ" }, "Kazakhstan"), m("option", { value: "KE" }, "Kenya"), m("option", { value: "KI" }, "Kiribati"), m("option", { value: "KP" }, "Korea, Democratic People's Republic of"), m("option", { value: "KR" }, "Korea, Republic of"), m("option", { value: "KW" }, "Kuwait"), m("option", { value: "KG" }, "Kyrgyzstan"), m("option", { value: "LA" }, "Lao People's Democratic Republic"), m("option", { value: "LV" }, "Latvia"), m("option", { value: "LB" }, "Lebanon"), m("option", { value: "LS" }, "Lesotho"), m("option", { value: "LR" }, "Liberia"), m("option", { value: "LY" }, "Libya"), m("option", { value: "LI" }, "Liechtenstein"), m("option", { value: "LT" }, "Lithuania"), m("option", { value: "LU" }, "Luxembourg"), m("option", { value: "MO" }, "Macao"), m("option", { value: "MK" }, "Macedonia, the former Yugoslav Republic of"), m("option", { value: "MG" }, "Madagascar"), m("option", { value: "MW" }, "Malawi"), m("option", { value: "MY" }, "Malaysia"), m("option", { value: "MV" }, "Maldives"), m("option", { value: "ML" }, "Mali"), m("option", { value: "MT" }, "Malta"), m("option", { value: "MH" }, "Marshall Islands"), m("option", { value: "MQ" }, "Martinique"), m("option", { value: "MR" }, "Mauritania"), m("option", { value: "MU" }, "Mauritius"), m("option", { value: "YT" }, "Mayotte"), m("option", { value: "MX" }, "Mexico"), m("option", { value: "FM" }, "Micronesia, Federated States of"), m("option", { value: "MD" }, "Moldova, Republic of"), m("option", { value: "MC" }, "Monaco"), m("option", { value: "MN" }, "Mongolia"), m("option", { value: "ME" }, "Montenegro"), m("option", { value: "MS" }, "Montserrat"), m("option", { value: "MA" }, "Morocco"), m("option", { value: "MZ" }, "Mozambique"), m("option", { value: "MM" }, "Myanmar"), m("option", { value: "NA" }, "Namibia"), m("option", { value: "NR" }, "Nauru"), m("option", { value: "NP" }, "Nepal"), m("option", { value: "NL" }, "Netherlands"), m("option", { value: "NC" }, "New Caledonia"), m("option", { value: "NZ" }, "New Zealand"), m("option", { value: "NI" }, "Nicaragua"), m("option", { value: "NE" }, "Niger"), m("option", { value: "NG" }, "Nigeria"), m("option", { value: "NU" }, "Niue"), m("option", { value: "NF" }, "Norfolk Island"), m("option", { value: "MP" }, "Northern Mariana Islands"), m("option", { value: "NO" }, "Norway"), m("option", { value: "OM" }, "Oman"), m("option", { value: "PK" }, "Pakistan"), m("option", { value: "PW" }, "Palau"), m("option", { value: "PS" }, "Palestine, State of"), m("option", { value: "PA" }, "Panama"), m("option", { value: "PG" }, "Papua New Guinea"), m("option", { value: "PY" }, "Paraguay"), m("option", { value: "PE" }, "Peru"), m("option", { value: "PH" }, "Philippines"), m("option", { value: "PN" }, "Pitcairn"), m("option", { value: "PL" }, "Poland"), m("option", { value: "PT" }, "Portugal"), m("option", { value: "PR" }, "Puerto Rico"), m("option", { value: "QA" }, "Qatar"), m("option", { value: "RE" }, "Réunion"), m("option", { value: "RO" }, "Romania"), m("option", { value: "RU" }, "Russian Federation"), m("option", { value: "RW" }, "Rwanda"), m("option", { value: "BL" }, "Saint Barthélemy"), m("option", { value: "SH" }, "Saint Helena, Ascension and Tristan da Cunha"), m("option", { value: "KN" }, "Saint Kitts and Nevis"), m("option", { value: "LC" }, "Saint Lucia"), m("option", { value: "MF" }, "Saint Martin (French part)"), m("option", { value: "PM" }, "Saint Pierre and Miquelon"), m("option", { value: "VC" }, "Saint Vincent and the Grenadines"), m("option", { value: "WS" }, "Samoa"), m("option", { value: "SM" }, "San Marino"), m("option", { value: "ST" }, "Sao Tome and Principe"), m("option", { value: "SA" }, "Saudi Arabia"), m("option", { value: "SN" }, "Senegal"), m("option", { value: "RS" }, "Serbia"), m("option", { value: "SC" }, "Seychelles"), m("option", { value: "SL" }, "Sierra Leone"), m("option", { value: "SG" }, "Singapore"), m("option", { value: "SX" }, "Sint Maarten (Dutch part)"), m("option", { value: "SK" }, "Slovakia"), m("option", { value: "SI" }, "Slovenia"), m("option", { value: "SB" }, "Solomon Islands"), m("option", { value: "SO" }, "Somalia"), m("option", { value: "ZA" }, "South Africa"), m("option", { value: "GS" }, "South Georgia and the South Sandwich Islands"), m("option", { value: "SS" }, "South Sudan"), m("option", { value: "ES" }, "Spain"), m("option", { value: "LK" }, "Sri Lanka"), m("option", { value: "SD" }, "Sudan"), m("option", { value: "SR" }, "Suriname"), m("option", { value: "SJ" }, "Svalbard and Jan Mayen"), m("option", { value: "SZ" }, "Swaziland"), m("option", { value: "SE" }, "Sweden"), m("option", { value: "CH" }, "Switzerland"), m("option", { value: "SY" }, "Syrian Arab Republic"), m("option", { value: "TW" }, "Taiwan, Province of China"), m("option", { value: "TJ" }, "Tajikistan"), m("option", { value: "TZ" }, "Tanzania, United Republic of"), m("option", { value: "TH" }, "Thailand"), m("option", { value: "TL" }, "Timor-Leste"), m("option", { value: "TG" }, "Togo"), m("option", { value: "TK" }, "Tokelau"), m("option", { value: "TO" }, "Tonga"), m("option", { value: "TT" }, "Trinidad and Tobago"), m("option", { value: "TN" }, "Tunisia"), m("option", { value: "TR" }, "Turkey"), m("option", { value: "TM" }, "Turkmenistan"), m("option", { value: "TC" }, "Turks and Caicos Islands"), m("option", { value: "TV" }, "Tuvalu"), m("option", { value: "UG" }, "Uganda"), m("option", { value: "UA" }, "Ukraine"), m("option", { value: "AE" }, "United Arab Emirates"), m("option", { value: "GB" }, "United Kingdom"), m("option", { value: "UM" }, "United States Minor Outlying Islands"), m("option", { value: "US" }, "United States of America"), m("option", { value: "UY" }, "Uruguay"), m("option", { value: "UZ" }, "Uzbekistan"), m("option", { value: "VU" }, "Vanuatu"), m("option", { value: "VE" }, "Venezuela, Bolivarian Republic of"), m("option", { value: "VN" }, "Viet Nam"), m("option", { value: "VG" }, "Virgin Islands, British"), m("option", { value: "VI" }, "Virgin Islands, U.S."), m("option", { value: "WF" }, "Wallis and Futuna"), m("option", { value: "EH" }, "Western Sahara"), m("option", { value: "YE" }, "Yemen"), m("option", { value: "ZM" }, "Zambia"), m("option", { value: "ZW" }, "Zimbabwe")]) }; nfx.viewHelpers.gravatarImg = function (d, b, a, e) { if (!e) { e = window.location.protocol + "//" + window.location.hostname + "/assets/img/default-avatar-user.png" } var c = (d ? "https://secure.gravatar.com/avatar/" + d + "?d=" + escape(e) + "&s=" + b : e); return m("img", { "class": a ? a : "", width: b, height: b, src: c }) }; nfx.viewHelpers.license = function (c, d) { var b = c.link(); if (!b) { return c.name() } var a = { href: b, title: c.name() }; if (d) { a.target = "_blank" } return m("a", a, c.name()) }; nfx.viewHelpers.pluralize = function (b, a) { return b + " " + a + (b == 1 ? "" : "s") }; nfx.viewHelpers.verbalJoin = function (b) { var a = []; for (var c = 0; c < b.length; c++) { if (c > 0) { a.push(c == b.length - 1 ? " and " : ", ") } a.push(b[c]) } return a }; nfx.viewHelpers.billingIntervalSubject = function (a) { if (a == "monthly") { return "month" } if (a == "annual") { return "year" } }; nfx.viewHelpers.billingIntervalAdverb = function (a) { if (a == "monthly") { return "monthly" } if (a == "annual") { return "annually" } }; nfx.viewHelpers.describeVatCharge = function (c, b) { var a; if (c.action() == nfx.models.VatChargeAction.charge) { a = "Including " + c.rate() + " % " + c.countryCode() + " VAT" } else { if (c.action() == nfx.models.VatChargeAction.reverseCharge) { a = "Including 0 % VAT (reverse charge)" } else { if (c.action() == nfx.models.VatChargeAction.noCharge) { a = "Including 0 % VAT" } } } return { amount: c.calculateContainedVatAmount(b), label: a } }; nfx.views.ModalView = function (b) { var a = function (c) { return m("div.modal" + (c.processing() ? ".loading" : ""), { tabindex: "-1", role: "dialog", id: b.id ? b.id(c) : undefined }, (c.processing() ? [m("div.spinner", " ")] : []).concat([m("div.modal-header", (c.dismissable() ? [m("button.close", { onclick: c.dismiss.bind(c), disabled: c.processing() }, "×")] : []).concat([m("h1", c.title())])), m("div.modal-body", b.body ? b.body.bind(a)(c) : []), m("div.modal-footer", b.footer ? b.footer.bind(a)(c) : a.defaultFooter(c))])) }; a.defaultFooter = function (c) { return [m("button.btn.btn-large.btn-primary", { disabled: !c.actionable() || c.processing(), onclick: c.action.bind(c) }, c.actionLabel())].concat(c.dismissable() ? [m("button.btn.btn-large", { onclick: c.dismiss.bind(c), disabled: c.processing() }, c.dismissLabel())] : []) }; return a }; nfx.views.ValidatedInputFieldView = function (b) { var a = m("input", { id: "id_" + b.name, name: b.name, type: b.type || "text", placeholder: b.placeholder, value: b.value(), oninput: m.withAttr("value", b.value), "class": nfx.mext.classMap(b["class"], { error: b.value.error && b.value.error() }) }); if ((!b.value.error) || (!b.value.error())) { return a } return [a, m("label", { "for": "id_" + b.name, "class": "error", style: "display: block" }, b.value.error())] }; nfx.views.FormErrorMessageView = function (a) { return m("div.error-container", { "class": nfx.mext.classMap({ visible: !!(a()) }) }, (a() ? [m("div.alert", a())] : [])) }; nfx.views.AccountDashboardOrganizationView = function (b) { var c = b.organizationMembership().level() == "owner", f = (b.organization().proSubscription() !== null), d = (f ? b.organization().proSubscription().effectivePlan() : null), a = (f ? b.organization().proSubscription().plan() : null); function h(p, n) { var o = [m("img", { width: 45, height: 45, src: p })]; if (n) { o.push(m("div.icon-team-status." + n)) } return m("li", [m("div.gravatar", o)]) } function l() { if (!b.organization().canAddMember()) { return m("div.user-management-wrapper.upgrade-to-add-team-member", [m("ul.invite-users", [h("/assets/img/plus-gray-24.png"), m("li", [m("p", [m("a", { href: "/account/plan" }, "Upgrade to add more team members")])])])]) } return m("div.user-management-wrapper.add-team-member", { onclick: b.inviteMembers }, [m("ul.invite-users", [h("/assets/img/plus-gray-24.png"), m("li", [m("p", [m("a.invite-users", { href: "javascript:void(0)" }, "Add new team members")])])])]) } function g(n) { return m("div.user-management-wrapper.invitation", [m("ul", [m("li", [m("div.gravatar", [nfx.viewHelpers.gravatarImg(n.emailMd5Hash(), 45)]), m("div.icon-team-status.pending")]), m("li", [m("p", n.email()), " ", m("p", "Invited - awaiting response")])])].concat(c ? [m("div.member-action", [m("a.resend-invite", { href: "javascript:void(0)", onclick: b.resendInvite.bind(b, n) }, "Resend invite"), m("div.icon-remove", { onclick: b.deleteInvite.bind(b, n) })])] : [])) } function j(n) { return m("div.user-management-wrapper", [m("ul", [m("li", [m("div.gravatar", [nfx.viewHelpers.gravatarImg(n.user().emailMd5Hash(), 45)]), m("div.icon-team-status.accepted")]), m("li", [m("p", n.user().fullName()), m("p", n.user().email())])])].concat(c ? [m("div.member-action", n.level() == "owner" ? "Owner" : m("div.icon-remove", { onclick: b.removeMember.bind(b, n.user()) }))] : [])) } function k() { if (d.isPerceptuallyUnlimited()) { return undefined } var n = b.organization().proSubscription().downloadsThisMonth(); return [m("div.progress.account-white", [m("div.bar", { style: { width: (n >= d.proDownloadsPerMonthMax() ? "100" : parseInt(Math.floor(n / d.proDownloadsPerMonthMax() * 100), 10)) + "%" } })]), m("p", "Downloads this month:"), m("p.right", [n, " / ", d.proDownloadsPerMonthMax()])] } function e() { if (b.organization().proSubscription().isCancelled()) { return [m("p", "Plan (cancelled - expires " + b.organization().proSubscription().dateExpires() + "):"), m("p.right", d.name())] } if (d.identifier() == a.identifier()) { return [m("p", "Plan (renews " + b.organization().proSubscription().dateRenews() + "):"), m("p.right", d.name())] } return [m("p", "Plan:"), m("p.right", d.name()), m("p", "Downgraded to plan (from " + b.organization().proSubscription().dateRenews() + "):"), m("p.right", a.name())] } return (b.loading() ? [m("div.spinner")] : []).concat([m("div", { "class": nfx.mext.classMap("account-details-bar-wrapper", d ? "plan-" + d.identifier() : undefined) }, [m('div[class="account-details-header"]', [m("h2", [m("a", { href: "/account/plan", "data-toggle": "tooltip", "data-original-title": "Rename organization name" }, b.organization().name())]), m('p[class="account-company-name"]', [m("b", c ? "Owner" : "Member")])]), m("div.account-details-bar", [f ? [k(), e()] : [], c ? [m("a.btn.btn-small", { href: "/account/transactions" }, "Transactions"), " ", (f ? m("a.btn.btn-small", { href: "/account/plan" }, "Change plan") : m("a.btn.btn-small", { href: "/pro" }, "Upgrade to subscription"))] : [m("a.btn.btn-small", { href: "javascript:void(0)", onclick: b.leave.bind(b) }, "Leave team")]]), m('section[class="manage-team"]', [m('div[class="user-management-wrapper header"]', [m("h3", c ? "Manage team" : "Team"), m("div.user-amount", (f) && (a.proMembersMax()) ? "(" + b.organization().membersCount() + "/" + a.proMembersMax() + " members)" : "(" + b.organization().membersCount() + " member" + (b.organization().membersCount() == 1 ? ")" : "s)"))]), l(), b.organization().memberships().map(function (n) { return j(n) }), b.organization().invites().map(function (n) { return g(n) })])])]) }; nfx.views.AccountSubscriptionPlanView = function (b) { var j = b.organization().proSubscription(), e = j.plan(), a = b.selectedPlan(); var k = function (n) { var l = n.proMembersMax() || b.organization().membersCount(); return (l > 1 ? nfx.viewHelpers.pluralize(l - 1, "additional team member") : "No additional team members") }; var d = function (l) { if (l.isPerceptuallyUnlimited()) { return "Unlimited downloads" } return l.proDownloadsPerMonthMax() + " downloads per month" }; var c = function () { return [m("h2", j.isCancelled() ? "Subscription cancelled" : "Your current Pro subscription"), m("h3", e.name()), m("p", k(e)), m("p", d(e)), m("p", "Billed " + (j.billingInterval() == "annual" ? "annually" : "monthly"))].concat(j.isCancelled() ? [m("table.table.price-table", [m("tr", [m("td", "Expires"), m("td", j.dateExpires())])]), m("a.btn.btn-medium", { href: "javascript:void(0)", onclick: b.reopenSubscription.bind(b) }, "Reopen subscription")] : [m("table.table.price-table", [m("tr", [m("td", "Next payment"), m("td", j.dateRenews())]), m("tr", [m("td", "Billed " + (j.billingInterval() == "monthly" ? "monthly" : "annually")), m("td", "$ " + e.priceForBillingInterval(j.billingInterval(), b.organization()) + ".00")])]), m("a.btn.btn-medium", { href: "/account/transactions" }, "View transaction history"), m("p.text-centered", m("a", { href: "javascript:void(0)", onclick: b.cancelSubscription.bind(b) }, "Cancel subscription")), m("p.extra-change-info", "Your cancellation will be effective at the end of this billing cycle.")]) }; var f = function () { var p = (a.proMembersMax() != e.proMembersMax() ? m("strong", k(a)) : k(a)), r = ((a.proDownloadsPerMonthMax() != e.proDownloadsPerMonthMax()) || (a.isPerceptuallyUnlimited() != e.isPerceptuallyUnlimited()) ? m("strong", d(a)) : d(a)); var o = [], n = 0; var q = a.priceForBillingInterval("monthly", b.organization()) - e.priceForBillingInterval("monthly", b.organization()), l = (a.priceForBillingInterval(j.currentBillingPeriodBillingInterval(), b.organization()) - j.currentBillingPeriodPayment()) * (j.currentBillingPeriodResidualDays() / j.currentBillingPeriodTotalDays()); if (l > 0) { n = l; o.push({ title: "Billed until " + j.dateRenews(), value: l }) } if (b.billingInterval() == "monthly") { o.push({ title: "Billed monthly from " + j.dateRenews(), value: a.priceForBillingInterval("monthly", b.organization()) }) } else { o.push({ title: "Billed annually from " + j.dateRenews(), value: a.priceForBillingInterval("annual", b.organization()) }) } o.push({ title: m("strong", "Total billed now"), value: n }); var s = "Billed " + (b.billingInterval() == "annual" ? "annually" : "monthly"); return [m("h2", "Selected changes"), m("h3", a.name()), m("p", p), m("p", r), m("p", b.billingInterval() == j.billingInterval() ? s : m("strong", s)), m("table.table.price-table", o.map(function (t) { return m("tr", [m("td", t.title), m("td", "$ " + Nextfinder.formatting.formatMoney(t.value))]) })), m("a.btn.btn-primary.btn-large", { href: "javascript:void(0)", onclick: b.changePlan.bind(b) }, (q < 0 ? "Downgrade now" : q > 0 ? "Upgrade now" : "Confirm changes"))] }; var h = function (s) { var l = b.organization().membersCount(), q = (!j.isCancelled() && s.isAvailable(b.organization())), r = s.identifier() == a.identifier(), p = (q ? b.selectPlan.bind(b, s) : undefined), o = (b.billingInterval() == "annual" ? s.priceAnnual() : s.priceMonthly()), t = (b.billingInterval() == "annual" ? "year" : "month"), n = (b.billingInterval() == "annual" ? s.attributes().price_annual_per_additional_member : s.attributes().price_monthly_per_additional_member); return m("table.table.table-bordered.plans.plan-box.plan-" + s.identifier(), { onclick: p }, [m("tbody", [m("tr", [q ? m("td", m("input", { type: "radio", checked: r })) : m("td"), m("td", [m("h3", "Iconfinder Pro " + s.name()), m("p", { starter: "1 seat. 25 downloads per month.", unlimited: "You will not be limited to 25 downloads per month." }[s.identifier()])]), m("td", m("h3", ["$ " + Nextfinder.formatting.formatMoney(o), m("span.price-interval", "/" + t)]))]), s.proMembersMax() ? "" : m("tr", [m("td"), m("td", [m("h4", "Additional team members"), m("p", ["With the Unlimited subscription you can add additional team members at $" + Nextfinder.formatting.formatMoney(n) + " per " + t + " per seat. You have " + (l == 1 ? "no team members" : l == 2 ? "1 team member" : l.toString() + " team members") + ". ", m("a", { href: "/account/" }, (l == 1 ? "Invite your team from the dashboard" : "Add more from the dashboard")), "."])]), l > 1 ? m("td", m("h4", [m("span.price-calculation", m.trust((l - 1).toString() + " &times; $" + Nextfinder.formatting.formatMoney(n) + " = ")), "$" + Nextfinder.formatting.formatMoney(n * (l - 1)), m("span.price-interval", "/" + t)])) : m("td")])])]) }; var g = function (n) { var l = a.identifier(); if (l.indexOf("api-plan") > -1) { return m("section.plan-list", [m("p", ["You are on a Pro API plan. You can find the details on the right hand side of this page. For upgrading and downgrading your subscription plan, please contact us at ", m("a", { href: "mailto:support@iconfinder.com" }, "support@iconfinder.com")])]) } else { return m("section.plan-list", [m("p", "You can easily change your Pro subscription at any time."), b.pricingPlans().map(n)]) } }; return [m("div.span8", [m("section", [m("h1", "Your Iconfinder Pro subscription")]), g(h), m("section.plan-billing", [m("form", [m("label", [m("input", { type: "checkbox", checked: b.billingInterval() == "annual", onchange: m.withAttr("checked", function (l) { b.selectBillingInterval.bind(b)(l ? "annual" : "monthly") }) }), m("span", [m("b", " Annual billing"), " - Choose annual billing and get 2 months free"])]), m("div", [m("span", "SAVE"), m("span", "16%")])])]), m("section.plan-name", [m("form.horizontal-form", [m("label", "Name of team: "), m("span", [m("input", { name: "organization-name", type: "text", value: b.name(), onchange: m.withAttr("value", b.name) }), " ", m("input", { type: "submit", value: "Update name", "class": "btn", onclick: b.changeName.bind(b), disabled: !b.canSetName() })])])])]), m("div.span4", [m("section.plan-status", ((a.identifier() == e.identifier()) && (b.billingInterval() == j.billingInterval()) ? c() : f())), m("br"), m("section", [m("h2", "Invite friends and earn money"), m("p", "When your friends sign up to Iconfinder Pro, they will get a 50% discount on their first month. As a reward, you will receive 50% of the price of the plan they choose."), m("p", "When friends you have referred deposit cash, they will receive a 25% bonus. You will receive 25% of what they deposit."), m("p", [m("a", { href: "/account/referrals", "class": "btn btn-medium", style: "display: block;" }, "Invite friends")])])])] }; nfx.views.AddCreditCardModalView = nfx.views.ModalView({ body: function (a) { return m("article", m("form.payment-form-inline#payment-form", { onsubmit: a.action.bind(a) }, nfx.views.PaymentFormView(a.paymentFormController))) }, id: function (a) { return "paymentModal" } }); nfx.views.AssetPurchaseCompletedModalView = nfx.views.ModalView({ id: function (a) { return "purchaseConfirmationModal" }, body: function (b) { var a = b.asset(); return m("article", m("section", [m("p", ["The purchase was successful."]), m("p", ["All receipts and transaction information is available in ", m("a", { href: "/account/transactions" }, "your transaction history"), "."]), m("label.checkbox", [m("span", m("input", { type: "checkbox", name: "hide_completed_purchase", checked: b.dontShowAgain(), onchange: m.withAttr("checked", b.dontShowAgain) })), " Don't show me this message again."])])) }, footer: function (a) { return m("button.btn.btn-large", { onclick: a.dismiss.bind(a) }, "OK") } }); nfx.views.BiTableQueryResultView = function (a) { var g = ["table", "csv", "tsv"], d = { table: "table", csv: "CSV", tsv: "TSV" }, h = d[a.format()], k = a.result(); if (a.isLoading()) { return m("h2", "Loading...") } if (!k) { return [] } if (k.error()) { return m("section.flow-navigation-top.flow-navigation", [m("h2", "Result"), m("div.alert.alert-error", [m("h4", "Query failed"), m("pre", k.error())])]) } function c(l) { return m("table.table.table-striped", {}, [m("thead", [m("tr", l.columns().map(function (n) { return m("th", m("tt", n)) }))]), m("tbody", l.rows().map(function (n) { return m("tr", n.map(function (o) { var p = o.toString(); if (p.match(/^https?:\/\//)) { o = m("a", { href: p }, p) } return m("td", m("tt", o)) })) }))]) } function j(l, o, n) { return [l.columns().map(function (p) { return n(p) }).join(o)].concat(l.rows().map(function (p) { return p.map(function (q) { return n(q) }).join(o) })) } function b(l, p, o) { var n = j(l, p, o); return m("textarea.raw-data", { readonly: true, rows: n.length }, n.join("\n")) } function f(l) { function n(o) { if ((o.indexOf(" ") != -1) || (o.indexOf(",") != -1) || (o.indexOf('"') != -1) || (o.indexOf("'") != -1)) { return '"' + o.replace('"', '""') + '"' } return o } return b(l, ",", n) } function e(l) { return b(l, "\t", function (n) { return n }) } return [m("", [m("h2", "Result (took " + (k.executionTime() * 1000).toFixed(3).toString() + " ms)"), m("div.btn-group", [m("a.btn.dropdown-toggle", { "data-toggle": "dropdown", href: "javascript:void(0)" }, ["View as ", m("strong", h), m("span.caret")]), m('ul.dropdown-menu[role="menu"]', g.map(function (l) { if (l == a.format()) { return [] } return m("li", m("a", { href: "javascript:void(0)", onclick: function () { a.format(l) } }, ["View as ", m("strong", d[l])])) }))])]), { table: c, csv: f, tsv: e }[a.format()](k)] }; nfx.views.BillingDetailsView = function (b) { var a = m("article", { style: "width: 50%" }, [m("p", m("span", nfx.mext.validatedInput({ name: "address_street", placeholder: "Address", value: b.addressStreet }))), m("p", m("span", nfx.mext.validatedInput({ name: "address_postal_code", placeholder: "Postal code", value: b.addressPostalCode }))), m("p", m("span", nfx.mext.validatedInput({ name: "address_city", placeholder: "City", value: b.addressCity }))), m("p", m("span", nfx.mext.validatedInput({ name: "address_state", placeholder: "State/province (if applicable)", value: b.addressState }))), m("p", m("span", nfx.viewHelpers.countrySelect("address_country", b.addressCountry)))]); var c = [m("p", m("div.control-group", [m("h2", { style: "margin: 0" }, "Account type"), m("div.controls", [m("label.radio", { style: "padding-left: 15px;" }, [m("input", { type: "radio", name: "account-type", id: "id_account_type_personal", checked: !b.isBusiness(), onclick: function () { b.isBusiness(false) } }), " Personal"]), m("label.radio", { style: "padding-left: 15px;" }, [m("input", { type: "radio", name: "account-type", id: "id_account_type_business", checked: b.isBusiness(), onclick: function () { b.isBusiness(true) } }), " Business"])])]))]; if (b.isBusiness()) { c.push(m("div.business-input", [m("p", m("span", nfx.mext.validatedInput({ name: "company", placeholder: "Company name", value: b.company }))), m("p", m("span", nfx.mext.validatedInput({ name: "vat_number", placeholder: "VAT number", value: b.vatNumber }))), m("p.help-text", m("a", { href: "http://support.iconfinder.com/purchasing-and-downloading/why-do-you-need-my-vat-number", target: "_blank" }, "Why do you ask for my VAT number?"))])) } return [nfx.views.FormErrorMessageView(b.errorMessage), m("article", { style: "float: right; width: 46%; padding-right: 0; margin-right: 8px" }, c), a] }; nfx.views.BillingDetailsModalView = nfx.views.ModalView({ body: function (a) { return m("section", new nfx.views.BillingDetailsView(a.billingDetailsCtrl)) } }); nfx.views.IconfinderProDescriptionModalSubView = function (d, c) { var b = d.user(), a = d.proPlanSmallest(); return m("article#purchase-pro-content", m("section", [m("p", ["With an Iconfinder Pro subscription you will get access to all ", m("b", "400,000+ icons"), " on Iconfinder. Subscription plans start at ", m("b", "$" + a.priceMonthly() + " per month"), ", where you’ll get ", m("b", a.attributes().downloads_per_month_max.toString() + " premium downloads every month"), ". For more details, ", m("a", { href: "/pro#pricing", target: "_blank" }, "see all the available plans.")]), m("p", "If you choose Iconfinder Pro, you will be able upgraded immediately and will be able to download the icon you just intended to purchase"), m("p", b.balance() > 0 ? "Your existing account balance of $" + Nextfinder.formatting.formatMoney(b.balance()) + " will be deducted from the the initial and future payments for your subscription plan. Subsequent payments will be charged to your credit card." : "Monthly payments for your Iconfinder Pro subscription will automatically be charged to your credit card."), m("a.pro-upsell-toggle", { href: "javascript:void(0)", onclick: d.toggleProDescription.bind(d) }, [m.trust("&larr; "), c])])) }; nfx.views.IconfinderProTeaserModalSubView = function (b) { var a = b.proPlanSmallest(); return m("section.pro-upsell", ["For just $" + a.priceMonthly() + " per month you can upgrade to an ", m("b", "Iconfinder Pro subscription"), " and download " + a.attributes().downloads_per_month_max + " icons every month. ", m("a.pro-upsell-toggle", { href: "/pro", target: "_blank" }, "Read more about Iconfinder Pro"), m("span.text-muted", " (opens in a new window)")]) }; nfx.views.ConfirmAssetPurchaseModalView = nfx.views.ModalView({ body: function (a) { var e = a.asset(), k = a.offer(), f = a.user(), c = a.proPlanSmallest(); if (a.showProDescription()) { return nfx.views.IconfinderProDescriptionModalSubView(a, "Back to your purchase") } var b, h, l; if (e.type == "icon") { var n = $.map(e.available_as_raster_sizes, function (o) { return [o.width, o.height].join("×") }); if (e.icon_type == "vector") { n.unshift("scalable (vector)") } b = "purchase-icon-content"; h = { width: e.display_version.size_width, height: e.display_version.size_height, src: e.display_version.public_raster_url, classname: "icon" }; l = { Formats: nfx.viewHelpers.verbalJoin(e.available_as), Sizes: nfx.viewHelpers.verbalJoin(n), License: nfx.viewHelpers.license(a.offer().license(), true) } } else { if (e.type == "iconset") { b = "purchase-iconset-content"; h = { width: e.preview_images.medium.width, height: e.preview_images.medium.height, src: e.preview_images.medium.url, classname: "iconset" }; l = { Format: "raster", License: nfx.viewHelpers.license(k.license(), true), "Number of icons": e.public_icons_count }; if (e.iconset_type == "vector") { l.Format = "vector (scalable)" } } else { if (e.type == "custom_service") { c = false; b = "purchase-custom_service-content"; l = { Designer: k.seller().fullName, Service: e.description, Price: "$" + Nextfinder.formatting.formatMoney(e.price) }; if (k.price() > e.price) { var g = { amount: k.price() - e.price }; g.percentage = Math.ceil((g.amount / e.price) * 100); g.key = "VAT " + g.percentage + "%"; l[g.key] = "$" + Nextfinder.formatting.formatMoney(g.amount); l.Total = "$" + Nextfinder.formatting.formatMoney(k.price()) } } } } var j = $.map(l, function (p, o) { return m("p", [m("b", [o, ":"]), " ", p]) }); var d = function () { if (h) { return m("div", { "class": h.classname }, m("img", { style: { width: h.width + "px", height: h.height + "px" }, src: h.src })) } }; return m("article", { id: b }, [m("section", [d(), j, m("div.clearboth")]), (c ? nfx.views.IconfinderProTeaserModalSubView(a) : "")]) }, footer: function (d) { var c = d.asset(), a = d.proPlanSmallest(), b = "Buy now"; if (c.type == "icon") { b = "Buy icon" } else { if (c.type == "iconset") { b = "Buy icon set" } else { if (c.type == "custom_service") { b = "Make prepayment"; a = false } } } return [(a ? m("button.btn.btn-large.btn", { disabled: d.processing(), onclick: d.confirmPro.bind(d) }, ["Upgrade to Pro ", "$" + a.priceMonthly().toString() + "/mo."]) : ""), m("button.btn.btn-large.btn-primary", { disabled: d.processing(), onclick: d.confirmPurchase.bind(d) }, [b, " ", "$" + d.offer().price().toFixed(2).toString()]), m("button.btn.btn-large", { onclick: d.dismiss.bind(d), disabled: d.processing() }, d.dismissLabel())] } }); nfx.views.DepositCashModalView = nfx.views.ModalView({ body: function (a) { var b = function () { if (a.referral !== undefined && a.referral !== null) { return m("div.alert.alert-success", "You will get " + a.referral.rule.attributes.percentage + "% extra cash on your first deposit thanks to the invitation from " + a.referral.referrer + ".") } }; return m("article", [m("section.amount", m("div", [b(), m("div.btn-group.amounts", [m("button", { type: "button", "class": nfx.mext.classMap("btn", "btn-large", { active: a.selectedAmount() == 2 }), onclick: a.selectAmount.bind(a, 2) }, "$ 2"), m("button", { type: "button", "class": nfx.mext.classMap("btn", "btn-large", { active: a.selectedAmount() == 5 }), onclick: a.selectAmount.bind(a, 5) }, "$ 5"), m("button", { type: "button", "class": nfx.mext.classMap("btn", "btn-large", { active: a.selectedAmount() == 10 }), onclick: a.selectAmount.bind(a, 10) }, "$ 10"), m("button", { type: "button", "class": nfx.mext.classMap("btn", "btn-large", { active: a.selectedAmount() == 50 }), onclick: a.selectAmount.bind(a, 50) }, "$ 50"), m("button", { type: "button", "class": nfx.mext.classMap("btn", "btn-large", { active: a.selectedAmount() == null }), onclick: a.selectAmount.bind(a, null) }, "Other")]), (a.selectedAmount() == null ? m("div.well", { id: "other-amount-well" }, [m("input", { type: "number", value: a.customAmount(), id: "customamount", oninput: m.withAttr("value", a.customAmount), "class": nfx.mext.classMap({ error: !a.customAmountValid() }) }), m("label", "Please enter amount in USD")]) : "")])), m("form.payment-form-inline#payment-form", { onsubmit: a.action.bind(a) }, nfx.views.PaymentFormView(a.paymentFormController))]) }, id: function (a) { return "paymentModal" } }); nfx.views.DownloadLimitReachedModalView = nfx.views.ModalView({ body: function (a) { return m("article", m("section.subscription-created-modal", [m("img", { src: "/assets/img/limit.svg", width: 120, height: 120 }), (a.isPerceptuallyUnlimited() ? [m("h1", "Wow, you are on fire!"), m("p", "You have been downloading a huge amount of icons from your Iconfinder account in the last 30 days. That is great, but it also made us worry about our designers’ work being scraped for illegal purposes."), m("p", "We know it is probably not your case, but please do get in touch with us at support@iconfinder.com to explain your use of the icons.")] : [m("h1", "Your team has hit the download limit"), m("h3", "Your team's monthly download limit of " + a.downloadLimit() + " icons has been reached. The limit will be reset on " + a.dateResets() + "."), m("p", [m("a", { href: "/account/" }, "Upgrade your team's Iconfinder Pro plan"), " to raise the download limit and continue downloading icons."])])])) }, footer: function (a) { return m("button.btn.btn-large", { onclick: a.dismiss.bind(a) }, a.dismissLabel()) } }); nfx.views.ErrorModalView = nfx.views.ModalView({ body: function (a) { return m("article", m("section", m("p", a.message()))) }, footer: function (a) { return m("button.btn.btn-large", { onclick: a.dismiss.bind(a) }, "OK") } }); nfx.views.InsufficientFundsModalView = nfx.views.ModalView({ body: function (a) { if (a.asset().type == "custom_service") { a.proPlanSmallest = function () { return false } } if (a.showProDescription()) { return nfx.views.IconfinderProDescriptionModalSubView(a, "Back") } var b = function () { var c = { iconset: "icon set", icon: "icon", custom_service: "service" }; return c[a.asset().type] || "item" }; return m("article", [m("section", [m("p", ["Your account balance of ", m("b", "$ " + Nextfinder.formatting.formatMoney(a.user().balance())), " is not enough to buy this " + b() + "."]), m("p", ["You can easily deposit cash to your account. It will only take you a minute and you can get back to designing beautiful stuff."])]), m("div.clearboth"), (a.proPlanSmallest() ? nfx.views.IconfinderProTeaserModalSubView(a) : "")]) }, footer: function (b) { var a = b.proPlanSmallest(); return [(a ? m("button.btn.btn-large", { disabled: !b.actionable() || b.processing(), onclick: b.subscribePro.bind(b) }, ["Upgrade to Iconfinder Pro ", "$" + a.priceMonthly().toString() + "/mo."]) : ""), m("button.btn.btn-large.btn-primary", { disabled: !b.actionable() || b.processing(), onclick: b.depositCash.bind(b) }, b.actionLabel()), m("button.btn.btn-large", { onclick: b.dismiss.bind(b), disabled: b.processing() }, b.dismissLabel())] } }); nfx.views.InviteMembersModalView = nfx.views.ModalView({ body: function (f) { var e = (f.organization().proSubscription() !== null); if (e) { var d = f.organization().proSubscription(), h = (d.plan()), g = d.billingInterval(), a = f.billedNow(), c = f.billedNext(), b = (g == "annual" ? h.attributes().price_annual_per_additional_member : h.attributes().price_monthly_per_additional_member) } return m("article", [m("section", [].concat(f.errorMessage() ? [m("p", [m("div.alert.alert-error", f.errorMessage())])] : []).concat([m("p", [m("div.input-wrapper", [m("label", ["Enter email: ", m('input[type="text"].invite-input' + (f.emailsInvalid() ? ".error" : ""), { placeholder: "Add people by e-mail address (separate by space or comma)", value: f.emails(), autofocus: "autofocus", oninput: m.withAttr("value", f.emails) })])]), m("p.invite-description", "New team members will receive an e-mail with an invitation to join Iconfinder Pro. You will be notified when they have accepted your invite.")]), (e ? m("div", [m("h3", "Changes to subscription"), m("p", "Additional team members on your Unlimited plan cost $" + b + " per " + (d.billingInterval() == "annual" ? "year" : "month") + "."), m("table.table.price-table.table-bordered.table-striped", [(a ? m("tr", [m("td", m("strong", "Billed now")), m("td.price-cell", "$" + Nextfinder.formatting.formatMoney(a))]) : ""), m("tr", [m("td", "Billed " + (d.billingInterval() == "annual" ? "annually" : "monthly") + " from " + d.dateRenews()), m("td.price-cell", "$" + Nextfinder.formatting.formatMoney(c))])])]) : "")]))]) } }); nfx.views.ModalStackLoaderView = function (a) { return m("h1.loader", [m("span.spinner", m("img", { src: "/assets/img/spinners/spinner-big.gif", width: 32, height: 32 })), a.message()]) }; nfx.views.PaymentFormView = function (a) { var b = a.selectedPaymentMethod(); return [(a.creditCardAllowed() && a.payPalAllowed() ? m("section#toggle-payment-methods", [m("ul.nav.nav-tabs", [(a.creditCardAllowed() ? m("li", { "class": ((b == "new-credit-card" || b == "existing-credit-card") ? "active" : undefined) }, [m("a#id-choose-creditcard", { href: "javascript:void(0)", onclick: a.selectPaymentMethod.bind(a, "new-credit-card") }, [m("i.icon-if.icon-if-creditcard"), "Credit card"])]) : ""), (a.payPalAllowed() ? m("li", { "class": b == "paypal" ? "active" : undefined }, [m("a#id-choose-paypal", { href: "javascript:void(0)", onclick: a.selectPaymentMethod.bind(a, "paypal") }, [m("i.icon-if.icon-if-paypal"), "PayPal"])]) : "")])]) : ""), m("div.error-container", { "class": nfx.mext.classMap({ visible: !!(a.errorMessage()) }) }, (a.errorMessage() ? [m("div.alert", a.errorMessage())] : [])), m("section.new-creditcard", { style: { display: (b != "existing-credit-card" ? "block" : "none") } }, [(a.creditCardAllowed() ? m("div.payment-method" + (b != "new-credit-card" ? ".flip" : "") + (a.creditCardType() ? "." + a.creditCardType() : "") + "#creditcard-method", [m("div#accepted-cards-images", ["visa", "mastercard", "americanexpress", "diners", "jcb", "maestro"].map(function (c) { return m("div.card-icons6.creditcard-" + c + (a.creditCardType() && a.creditCardType() != c ? ".faded" : "")) })), m("h3", a.newCreditCardFormTitle()), m("div.number", [m('label[for="payment-number"]', "Card number"), m("input#payment-number", { type: "tel", "x-autocompletetype": "cc-number", placeholder: m.trust("\u25cf\u25cf\u25cf\u25cf \u25cf\u25cf\u25cf\u25cf \u25cf\u25cf\u25cf\u25cf \u25cf\u25cf\u25cf\u25cf"), "data-encrypted-name": "number", oninput: m.withAttr("value", a.creditCardNumber), value: a.creditCardNumber(), "class": nfx.mext.classMap("card-number", { error: a.creditCardNumberInvalid() }) })]), m("div.expiry", [m('label[for="payment-expiry-month"]', "Expires (MM/YY)"), m("fieldset", [m("input#payment-expiry-month", { type: "text", placeholder: "MM", "x-autocompletetype": "cc-exp-month", "data-encrypted-name": "month", minlength: 1, maxlength: 2, oninput: m.withAttr("value", a.creditCardExpirationMonth), value: a.creditCardExpirationMonth(), "class": nfx.mext.classMap("card-expiry-month", { error: a.creditCardExpirationMonthInvalid() }) }), m("input.card-expiry-year#payment-expiry-year", { type: "text", placeholder: "YY", "x-autocompletetype": "cc-exp-year", "data-encrypted-name": "month", minlength: 1, maxlength: 4, oninput: m.withAttr("value", a.creditCardExpirationYear), value: a.creditCardExpirationYear(), "class": nfx.mext.classMap("card-expiry-year", { error: a.creditCardExpirationYearInvalid() }) })])]), m("div.name", [m('label[for="payment-name"]', "Name on card"), m("input#payment-name", { type: "text", "x-autocompletetype": "cc-name", name: "name_on_card", placeholder: "Name", minlength: 1, oninput: m.withAttr("value", a.creditCardHolderName), value: a.creditCardHolderName(), "class": nfx.mext.classMap("card-holdername", { error: a.creditCardHolderNameInvalid() }) })]), m("div.cvc", [m('label[for="payment-cvc"]', "Card code (CVC)"), m("input#payment-cvc", { type: "text", "x-autocompletetype": "cc-csc", placeholder: "CVC", "data-encrypted-name": "cvv", minlength: 1, maxlength: 4, oninput: m.withAttr("value", a.creditCardCvc), value: a.creditCardCvc(), "class": nfx.mext.classMap("card-cvc", { error: a.creditCardCvcInvalid() }) })]), m("div#remembercard", [m("label", [m("input", { type: "checkbox", onclick: m.withAttr("checked", a.rememberCreditCard), checked: a.rememberCreditCard(), disabled: !a.rememberCreditCardOptional }), " Remember this credit card"])])]) : ""), (a.payPalAllowed() ? m("div.payment-method" + (b == "paypal" ? ".flip" : "") + "#paypal-method", [m("div", [m("p", "At this point you will be redirected to the PayPal website."), m("p", "You are not required to have a PayPal account to make a payment via PayPal.")])]) : "")]), (b == "new-credit-card" && a.existingCreditCards().length ? m("section#show-existing-creditcards-container", { style: { display: "block" } }, [m('button.btn.btn-small[type="button"]', { onclick: a.selectPaymentMethod.bind(a, "existing-credit-card") }, "Show existing credit cards")]) : ""), m("section.existing-creditcards", { style: { display: (a.existingCreditCardAllowed() && b == "existing-credit-card" ? "block" : "none") } }, [m("h3", "Existing credit cards"), m("p", "Please select the credit card you want to use or add a new credit card."), m("table.table.table-bordered.table-striped#payment-methods", a.existingCreditCards().map(function (c) { return m("tr", [m("td.radiobutton", (c.isSelectable() ? m('input[type="radio"][name="existing-card"]', { checked: c.isSelected(), onclick: a.selectExistingCreditCard.bind(a, c.creditCard()) }) : [])), m("td.payment-icons.creditcard-visa", m.trust("&#9679;&#9679;&#9679;&#9679; &#9679;&#9679;&#9679;&#9679; &#9679;&#9679;&#9679;&#9679; " + c.creditCard().numberLastFour()))]) })), m("button.btn.btn-small#show-new-creditcard", { onclick: a.selectPaymentMethod.bind(a, "new-credit-card") }, "Add a new credit card")]), m("a.secureconnection", { href: "http://support.iconfinder.com/purchasing-and-downloading/is-credit-card-data-sent-using-a-secure-connection", target: "_blank" }, [m("img", { src: "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaGVpZ2h0PSIyNCIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTEwMjguNCkiPjxwYXRoIGQ9Im01IDEwMzcuNGMtMS4xMDQ2IDAtMiAwLjktMiAydjEgNiAxYzAgMS4xIDAuODk1NCAyIDIgMmgyIDEwIDJjMS4xMDUgMCAyLTAuOSAyLTJ2LTctMWMwLTEuMS0wLjg5NS0yLTItMmgtMi0xMnoiIGZpbGw9IiNmMWM0MGYiLz48cGF0aCBkPSJtNSAxMDQwLjRjLTEuMTA0NiAwLTIgMC45LTIgMnYxIDYgMWMwIDEuMSAwLjg5NTQgMiAyIDJoMiAxMCAyYzEuMTA1IDAgMi0wLjkgMi0ydi03LTFjMC0xLjEtMC44OTUtMi0yLTJoLTItMTJ6IiBmaWxsPSIjZjM5YzEyIi8+PHBhdGggZD0ibTEyIDEwMjkuNGMtMy44NjYgMC03IDMuMS03IDdoM2MwLTIuMiAxLjc5MDktNCA0LTQgMi4yMDkgMCA0IDEuOCA0IDRoM2MwLTMuOS0zLjEzNC03LTctN3oiIGZpbGw9IiNiZGMzYzciLz48cGF0aCBkPSJtNSAxNHYxaDE0di0xaC0xNHptMCAydjFoMTR2LTFoLTE0em0wIDJ2MWgxNHYtMWgtMTR6bTAgMnYxaDE0di0xaC0xNHoiIGZpbGw9IiNlNjdlMjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMTAyOC40KSIvPjxwYXRoIGQ9Im01IDEwMzcuNHYxYzAgMC41IDAuNjcxNiAxIDEuNSAxczEuNS0wLjUgMS41LTF2LTFjMCAwLjUtMC42NzE2IDEtMS41IDFzLTEuNS0wLjUtMS41LTF6IiBmaWxsPSIjN2Y4YzhkIi8+PHBhdGggZD0ibTE2IDEwMzcuNHYxYzAgMC41IDAuNjcyIDEgMS41IDFzMS41LTAuNSAxLjUtMXYtMWMwIDAuNS0wLjY3MiAxLTEuNSAxcy0xLjUtMC41LTEuNS0xeiIgZmlsbD0iIzdmOGM4ZCIvPjxwYXRoIGQ9Im0xMiAyLjQzNzVjLTAuMzUxIDAtMC42OTkgMC4wMzM4LTEuMDMxIDAuMDkzNy0wLjI0NyAwLjA0NDYtMC40ODcgMC4xMTI5LTAuNzE5IDAuMTg3Ni0wLjIxNyAwLjA2OTgtMC40MjI5IDAuMTU2MS0wLjYyNSAwLjI1LTAuMTA2IDAuMDQ5Mi0wLjIxMDkgMC4xMDA4LTAuMzEyNSAwLjE1NjItMC4xMzE5IDAuMDcxOS0wLjI1MTMgMC4xNjgyLTAuMzc1IDAuMjUtMC4xMTU4IDAuMDc2NS0wLjIzNTYgMC4xMzQyLTAuMzQzNyAwLjIxODgtMC4xNDA3IDAuMTA5Ny0wLjI3OTkgMC4yMjExLTAuNDA2MyAwLjM0MzctMC4wMzY5IDAuMDM2Mi0wLjA1ODEgMC4wODc4LTAuMDkzNyAwLjEyNS0wLjE2ODQgMC4xNzQ0LTAuMzMxMyAwLjMzNTYtMC40Njg4IDAuNTMxMy0wLjE0MDIgMC4xOTkzLTAuMjcwNCAwLjQwNjUtMC4zNzUgMC42MjUtMC4wMDQgMC4wMDg0IDAuMDA0IDAuMDIyNyAwIDAuMDMxMi0wLjExMTEgMC4yMzU5LTAuMjE1OSAwLjQ5NTktMC4yODEyIDAuNzUtMC4yNTMgMC41ODQ0LTAuOTQyNCAxLTEuNzUgMS0wLjA2IDAtMC4wODMyIDAuMDAxOC0wLjEyNSAwLTAuMDEwNS0wLjAwMDQtMC4wMTY4IDAuMDAxNC0wLjAzMTMgMGwtMC4wNjI1IDF2MSAxaDN2LTEtMWMwLTAuMjc2MSAwLjA0MDUtMC41NTIxIDAuMDkzOC0wLjgxMjUgMC4zNzI5LTEuODIyNyAxLjk3MzItMy4xODc1IDMuOTA2Mi0zLjE4NzUgMi4yMDkgMCA0IDEuNzkwOSA0IDR2MSAxaDN2LTEtMWwtMC4wNjItMWMtMC4wMTUgMC4wMDE0LTAuMDIxLTAuMDAwNC0wLjAzMiAwaC0wLjEyNWMtMC44MDcgMC0xLjQ5Ny0wLjQxNTYtMS43NS0xLTAuMDY1LTAuMjU0MS0wLjE3LTAuNTE0MS0wLjI4MS0wLjc1LTAuMDA0LTAuMDA4NSAwLjAwNC0wLjAyMjggMC0wLjAzMTItMC4xMDUtMC4yMTg1LTAuMjM1LTAuNDI1Ny0wLjM3NS0wLjYyNS0wLjEzOC0wLjE5NTctMC4zLTAuMzU2OS0wLjQ2OS0wLjUzMTMtMC4wMzYtMC4wMzgtMC4wNTUtMC4wODgxLTAuMDk0LTAuMTI1LTAuMTI2LTAuMTIyNi0wLjI2NS0wLjIzNC0wLjQwNi0wLjM0MzctMC4xMDQtMC4wODE3LTAuMjMyLTAuMTQ0OC0wLjM0NC0wLjIxODgtMC4xMjItMC4wODA5LTAuMjQ0LTAuMTc4OC0wLjM3NC0wLjI1LTAuMTAxLTAuMDU1LTAuMjA4LTAuMTA3NC0wLjMxMy0wLjE1NjItMC4yMDItMC4wOTM5LTAuNDA4LTAuMTgwMi0wLjYyNS0wLjI1LTAuMjMyLTAuMDc0Ny0wLjQ3Mi0wLjE0My0wLjcxOS0wLjE4NzYtMC4zMzItMC4wNTk5LTAuNjgtMC4wOTM3LTEuMDMxLTAuMDkzN3oiIGZpbGw9IiM5NWE1YTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMTAyOC40KSIvPjwvZz48L3N2Zz4=" }), " Secure connection"])]; return }; nfx.views.SubscriptionCreatedModalView = nfx.views.ModalView({ id: function (a) { return "subscription-created" }, body: function (e) { var b = "$" + Nextfinder.formatting.formatMoney(e.transaction().amountPayment()); var a = "$" + Nextfinder.formatting.formatMoney(e.transaction().amountBalance()); var d = a + " has been deducted from your account balance."; var c = Nextfinder.formatting.formatDate(e.proSubscription().dateRenews()); if (e.transaction().amountPayment() > 0) { d = "Your credit card has been charged " + b; if (e.transaction().amountBalance() > 0) { d += " and " + a + " has been deducted from your account balance" } } return m("article", m("section.subscription-created-modal", [m("img", { src: "/assets/img/pro/icon.svg", height: 250 }), m("p", d + "."), m("p", "Your subscription will be automatically renewed on " + c + ". You can choose to cancel your subscription at any time.")])) } }); nfx.views.SubscriptionPaymentModalView = nfx.views.ModalView({ body: function (a) { return m("article", m("form.payment-form-inline#payment-form", { onsubmit: a.action.bind(a) }, nfx.views.PaymentFormView(a.paymentFormController))) }, id: function (a) { return "paymentModal" } }); nfx.views.ChurnSurveyModalView = nfx.views.ModalView({ body: function (a) { return m("section", [m("p", ["We're sorry to see you cancel your Iconfinder Pro subscription. We would love to learn why you have cancelled in order to improve the product. ", "If there is anything we can help you with, please ", m('a[href="mailto:support@iconfinder.com"]', "contact support"), "."]), m("form#feedback-form", [m("div", { "class": "alert alert-danger hidden" }, "Please select a reason for cancelling."), a.reasons.map(function (b) { return m("label.checkbox", [m("input", { type: "checkbox", name: "cancel-reason", value: b.value }), " " + b.label]) }), m("label.checkbox", [m("input", { type: "checkbox", name: "cancel-reason", value: 0, onclick: m.withAttr("value", a.toggleOther) }), " Other"]), m("textarea", { name: "comment", placeholder: "Reason for cancelling", id: "other-reason", "class": "input-block-level hidden" })])]) }, footer: function (a) { return [m("button.btn", { onclick: a.dismiss.bind(a), disabled: a.processing() }, a.dismissLabel()), m("button.btn.btn-primary", { onclick: a.submit.bind(a), disabled: a.processing() }, "Send feedback")] } }); nfx.views.FreeDownloadPromptModalView = nfx.views.ModalView({ id: function (a) { return "free-download-prompt-modal" }, body: function (a) { return m("article", m("section.free-download-prompt-modal", [m("h2", "Continue downloading free icons"), m("p.pitch", "Sign up for Iconfinder Free to continue downloading free icons. You also get favorites and access to your download history."), m("a.btn.facebook-btn", { href: "javascript:void(0)", onclick: a.connectWithFacebook.bind(a) }, [m("i.icon-if.icon-if-facebook", " "), " Connect with Facebook"]), m("p.alternative-login", [m("a", { href: "javascript:void(0)", onclick: a.signUp.bind(a) }, "Sign up using e-mail"), " or ", m("a", { href: "javascript:void(0)", onclick: a.logIn.bind(a) }, "log in")]), m("p.newsletter-option", m("label", [m("input", { checked: a.isNewsletterSubscriber(), type: "checkbox", name: "is_newsletter_subscriber", id: "id_is_newsletter_subscriber", onchange: m.withAttr("checked", a.isNewsletterSubscriber) }), " Keep me updated via e-mail."]))])) }, footer: function (a) { return [] } }); nfx.views.SignUpModalView = nfx.views.ModalView({ id: function (a) { return "signupModal" }, body: function (a) { return [m("section.section-inputfields", [m("p", m("a.btn.facebook-btn", { href: "javascript:void(0)", onclick: a.connectWithFacebook.bind(a) }, [m("i.icon-if.icon-if-facebook", " "), " Connect with Facebook"])), m("div.orbullet", "OR"), m("div.orbullet-divider"), m("form", [nfx.views.FormErrorMessageView(a.errorMessage), m("div.inputfields", [m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "firstname", placeholder: "First name", value: a.firstName, "class": "input-block-level" }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "lastname", placeholder: "Last name", value: a.lastName, "class": "input-block-level" }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "username", placeholder: "Username", value: a.username, "class": ["input-block-level", "icon-bg", "icon-if-user"] }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "email", placeholder: "E-mail address", value: a.email, "class": ["input-block-level", "icon-bg", "icon-if-email"] }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "password", placeholder: "Password", type: "password", value: a.password, "class": ["input-block-level", "icon-bg", "icon-if-lock"] })))]), m("div.footertext", m("p", [m("label", [m("input", { checked: true, type: "checkbox", name: "remember_me", id: "id_remember_me" }), " Keep me logged in on this computer."]), m("label", [m("input", { checked: a.isNewsletterSubscriber(), type: "checkbox", name: "is_newsletter_subscriber", id: "id_is_newsletter_subscriber", onchange: m.withAttr("checked", a.isNewsletterSubscriber) }), " Send me news & updates."]), " By creating an account you agree to our ", m("a", { target: "_blank", href: "https://www.iconfinder.com/about/termsofservice" }, "terms of service")]))])])] }, footer: function (a) { return [m("a", { href: "/user/login", onclick: a.logIn.bind(a) }, "Log in "), " "].concat(this.defaultFooter(a)) } }); nfx.views.MissingUserDataModalView = nfx.views.ModalView({ id: function (a) { return "missing_or_invalid_data_modal" }, body: function (a) { return [m("section.section-inputfields", [m("p", "We need a little more information to create your account."), m("form", [nfx.views.FormErrorMessageView(a.errorMessage), m("div.inputfields", [m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "firstname", placeholder: "First name", value: a.firstName, "class": "input-block-level" }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "lastname", placeholder: "Last name", value: a.lastName, "class": "input-block-level" }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "username", placeholder: "Username", value: a.username, "class": ["input-block-level", "icon-bg", "icon-if-user"] }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "email", placeholder: "E-mail address", value: a.email, "class": ["input-block-level", "icon-bg", "icon-if-email"] })))]), m("div.footertext", m("p", [m("label", [m("input", { checked: a.isNewsletterSubscriber(), type: "checkbox", name: "is_newsletter_subscriber", id: "id_is_newsletter_subscriber", onchange: m.withAttr("checked", a.isNewsletterSubscriber) }), " Keep me updated via e-mail."]), " By creating an account you agree to our ", m("a", { target: "_blank", href: "https://www.iconfinder.com/about/termsofservice" }, "terms of service")]))])])] } }); nfx.views.LogInModalView = nfx.views.ModalView({ id: function (a) { return "loginModal" }, body: function (a) { return [m("section.section-inputfields", [m("p", m("a.btn.facebook-btn", { href: "javascript:void(0)", onclick: a.connectWithFacebook.bind(a) }, [m("i.icon-if.icon-if-facebook", " "), " Connect with Facebook"])), m("div.orbullet", "OR"), m("div.orbullet-divider"), m("form", { onsubmit: a.action.bind(a) }, [nfx.views.FormErrorMessageView(a.errorMessage), m("div.inputfields", [m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "username", placeholder: "Username or e-mail address", value: a.username, "class": ["input-block-level", "icon-bg", "icon-if-user"] }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "password", placeholder: "Password", type: "password", value: a.password, "class": ["input-block-level", "icon-bg", "icon-if-lock"] })))]), (a.recaptchaRequired() ? m("div#recaptcha-container", { config: function (d, c, b) { if (c) { return } Recaptcha.create(a.recaptchaPublicKey(), "recaptcha-container", { theme: "white" }) }.bind(a) }) : ""), m("div.footertext", [m("p", ["Don't have an account? ", m("a.login-signup-link", { href: "/user/signup", onclick: a.signUp.bind(a) }, "Sign up here"), "."]), m("p", [m("label", [m("input", { checked: a.remember(), type: "checkbox", name: "remember_me", id: "id_remember_me", onchange: m.withAttr("checked", a.remember) }), " Keep me logged in on this computer."])]), m("p", m("a", { href: "/user/password-reset" }, "Lost your password?"))]), m("input", { type: "submit", style: "display: none" }, "Log in")])])] } }); nfx.views.FormatIsProOnlyPromptModalView = nfx.views.ModalView({ id: function (a) { return "format-is-pro-only-prompt-modal" }, body: function (a) { return m("article", m("section.format-is-pro-only-prompt-modal", [m("h2", "Get access to Adobe Illustrator icons, Adobe Photoshop shapes and much more"), m("p.pitch", "Sign up for Iconfinder Pro and download icons in Adobe Illustrator format, as Adobe Photoshop shapes, and get access to the World's largest collection of premium icons."), m("a.btn.btn-primary", { href: "/pro/subscribe" }, ["Sign up for Iconfinder Pro"])])) }, footer: function (a) { return [] } }); nfx.views.PrivateMessageIsProOnlyPromptModalView = nfx.views.ModalView({ id: function (a) { return "private-message-is-pro-only-prompt-modal" }, body: function (a) { return m("article", m("section.feature-is-pro-only-prompt-modal", [m("h2", "Send private messages to icon designers"), m("p.pitch", "Sign up for Iconfinder Pro to send icon designers a private message and get access to the World's largest collection of premium icons."), m("a.btn.btn-primary", { href: "/pro/subscribe" }, ["Sign up for Iconfinder Pro"])])) }, footer: function (a) { return [] } }); nfx.views.SubscriptionView = function (a) { var f = a.billingInterval(), k = nfx.viewHelpers.billingIntervalSubject(f), g = nfx.viewHelpers.billingIntervalAdverb(f); var b = '<div class="span4"><div class="boxit"><div class="content-section"><b>You\'ll love Iconfinder Pro</b><br>Both plans include:</div><div class="content-section secondary"><ul><li><span class="icon-if icon-if-checkmark-green"></span> ' + Nextfinder.formatting.formatInt(a.iconsCount()) + ' premium vector icons</li><li><span class="icon-if icon-if-checkmark-green"></span> Licenses for commercial projects</li><li><span class="icon-if icon-if-checkmark-green"></span> 70% is paid out to the icon designers</li><li><span class="icon-if icon-if-checkmark-green"></span> Icons in AI and CSH formats</li><li><span class="icon-if icon-if-checkmark-green"></span> High priority support</li></ul><a href="#pro-faq">Frequently asked questions</a></div></div></div>'; var e = function () { if (a.discount()) { return m("div.span12", [m("div.alert.alert-success.discount-message", "You get " + a.discount().description() + a.discount().reason()), m("br")]) } }; var l = '<div class="span4"><div class="boxit"><div class="content-section"><b>Pay by invoice</b></div><div class="content-section secondary">You can pay by invoice instead of credit card. Simply send us an email to <a href="mailto:support@iconfinder.com">support@iconfinder.com</a> and we\'ll guide you through the process.</div></div></div>'; var d = function (q) { if (q.isPerceptuallyUnlimited()) { return "No download limit on premium icons" } return q.proDownloadsPerMonthMax() + " premium icons each month" }; var n = function (r) { var q = (a.billingInterval() == "annual" ? r.attributes().price_annual_per_additional_member : r.attributes().price_monthly_per_additional_member); if (!r.proMembersMax()) { return m("div.content-section.secondary", m("div.row", m("div.span5.plan-description", [m("b", "Additional team members"), m("div", m("p", "After you sign up, you can add team members for $" + Nextfinder.formatting.formatInt(q) + "/" + k + " per seat. All members will have Iconfinder Pro Unlimited."))]))) } }; var p = function (t) { var q = t.isAvailable(a.organization()), r = (a.billingInterval() == "annual" ? t.priceAnnual() : t.priceMonthly()); var s = a.currentPlan().identifier() == t.identifier() ? ".active" : ""; return m("label.boxit.radio" + s, [m("div.content-section", m("div.row", [m("div.span.plan-selection", m("input", { type: "radio", id: t.identifier(), checked: a.currentPlan().identifier() == t.identifier(), disabled: !q || a.processing(), name: "optionsRadios", onchange: function () { a.currentPlan(t) } })), m("div.span4.plan-description", [m("h2", t.name()), m("p", d(t))]), m("div.span2.pull-right.plan-price", ["$" + Nextfinder.formatting.formatInt(r), m("div.periode", "per " + k)])])), n(t)]) }; var j = function () { var r = function () { var z = a.currentPlan().priceForBillingInterval(f, a.organization()); var u = [m("p.yourorder", "Your order"), m("h3", "Iconfinder Pro: " + a.currentPlan().name()), m("p.order-description", d(a.currentPlan())), m("p.items", ["Billed " + g, m("span.pull-right", "$" + Nextfinder.formatting.formatMoney(z))])]; var A = z, w = (a.discount() ? a.discount().effectAmount(z, f) : null), y = a.campaignDiscountAmount(); if ((w) || (y > 0)) { if (w) { A -= w; u.push(m("p.discount", [a.discount().description(), m("span.pull-right", "- $" + Nextfinder.formatting.formatMoney(w))])) } if (y > 0) { if (y > A) { y = A } A -= y; u.push(m("p.discount", [a.campaignDiscountDescription(), m("span.pull-right", "- $" + Nextfinder.formatting.formatMoney(y))])) } u.push(m("p.items", ["Billed for the first " + k, m("span.pull-right", "$" + Nextfinder.formatting.formatMoney(A))])) } var v = nfx.viewHelpers.describeVatCharge(a.vatCharge(), A); u.push(m("p.vat", [v.label, m("span.pull-right", "$" + Nextfinder.formatting.formatMoney(v.amount))])); var x = A; if (a.balance() > 0) { var t = (a.balance() > A ? A : a.balance()); x -= t; u.push(m("p.balance", ["Deducted from account balance", m("span.pull-right", "-$" + Nextfinder.formatting.formatMoney(t))])) } u.push(m("p.charge", ["Total credit card charge", m("span.pull-right", "$" + Nextfinder.formatting.formatMoney(x))])); return m("div.order-details", u) }; var s = m("button.btn.btn-primary.btn-large.fluid", { onclick: a.confirmSubscription.bind(a), disabled: a.processing() || !a.user() }, "Confirm and subscribe"); var q = m("div.secure-connection", m("a.secureconnection", { href: "http://support.iconfinder.com/purchasing-and-downloading/is-credit-card-data-sent-using-a-secure-connection", target: "_blank" }, [m("img", { src: "data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiA/PjxzdmcgaGVpZ2h0PSIyNCIgdmVyc2lvbj0iMS4xIiB3aWR0aD0iMjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6Y2M9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL25zIyIgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPjxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgLTEwMjguNCkiPjxwYXRoIGQ9Im01IDEwMzcuNGMtMS4xMDQ2IDAtMiAwLjktMiAydjEgNiAxYzAgMS4xIDAuODk1NCAyIDIgMmgyIDEwIDJjMS4xMDUgMCAyLTAuOSAyLTJ2LTctMWMwLTEuMS0wLjg5NS0yLTItMmgtMi0xMnoiIGZpbGw9IiNmMWM0MGYiLz48cGF0aCBkPSJtNSAxMDQwLjRjLTEuMTA0NiAwLTIgMC45LTIgMnYxIDYgMWMwIDEuMSAwLjg5NTQgMiAyIDJoMiAxMCAyYzEuMTA1IDAgMi0wLjkgMi0ydi03LTFjMC0xLjEtMC44OTUtMi0yLTJoLTItMTJ6IiBmaWxsPSIjZjM5YzEyIi8+PHBhdGggZD0ibTEyIDEwMjkuNGMtMy44NjYgMC03IDMuMS03IDdoM2MwLTIuMiAxLjc5MDktNCA0LTQgMi4yMDkgMCA0IDEuOCA0IDRoM2MwLTMuOS0zLjEzNC03LTctN3oiIGZpbGw9IiNiZGMzYzciLz48cGF0aCBkPSJtNSAxNHYxaDE0di0xaC0xNHptMCAydjFoMTR2LTFoLTE0em0wIDJ2MWgxNHYtMWgtMTR6bTAgMnYxaDE0di0xaC0xNHoiIGZpbGw9IiNlNjdlMjIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMTAyOC40KSIvPjxwYXRoIGQ9Im01IDEwMzcuNHYxYzAgMC41IDAuNjcxNiAxIDEuNSAxczEuNS0wLjUgMS41LTF2LTFjMCAwLjUtMC42NzE2IDEtMS41IDFzLTEuNS0wLjUtMS41LTF6IiBmaWxsPSIjN2Y4YzhkIi8+PHBhdGggZD0ibTE2IDEwMzcuNHYxYzAgMC41IDAuNjcyIDEgMS41IDFzMS41LTAuNSAxLjUtMXYtMWMwIDAuNS0wLjY3MiAxLTEuNSAxcy0xLjUtMC41LTEuNS0xeiIgZmlsbD0iIzdmOGM4ZCIvPjxwYXRoIGQ9Im0xMiAyLjQzNzVjLTAuMzUxIDAtMC42OTkgMC4wMzM4LTEuMDMxIDAuMDkzNy0wLjI0NyAwLjA0NDYtMC40ODcgMC4xMTI5LTAuNzE5IDAuMTg3Ni0wLjIxNyAwLjA2OTgtMC40MjI5IDAuMTU2MS0wLjYyNSAwLjI1LTAuMTA2IDAuMDQ5Mi0wLjIxMDkgMC4xMDA4LTAuMzEyNSAwLjE1NjItMC4xMzE5IDAuMDcxOS0wLjI1MTMgMC4xNjgyLTAuMzc1IDAuMjUtMC4xMTU4IDAuMDc2NS0wLjIzNTYgMC4xMzQyLTAuMzQzNyAwLjIxODgtMC4xNDA3IDAuMTA5Ny0wLjI3OTkgMC4yMjExLTAuNDA2MyAwLjM0MzctMC4wMzY5IDAuMDM2Mi0wLjA1ODEgMC4wODc4LTAuMDkzNyAwLjEyNS0wLjE2ODQgMC4xNzQ0LTAuMzMxMyAwLjMzNTYtMC40Njg4IDAuNTMxMy0wLjE0MDIgMC4xOTkzLTAuMjcwNCAwLjQwNjUtMC4zNzUgMC42MjUtMC4wMDQgMC4wMDg0IDAuMDA0IDAuMDIyNyAwIDAuMDMxMi0wLjExMTEgMC4yMzU5LTAuMjE1OSAwLjQ5NTktMC4yODEyIDAuNzUtMC4yNTMgMC41ODQ0LTAuOTQyNCAxLTEuNzUgMS0wLjA2IDAtMC4wODMyIDAuMDAxOC0wLjEyNSAwLTAuMDEwNS0wLjAwMDQtMC4wMTY4IDAuMDAxNC0wLjAzMTMgMGwtMC4wNjI1IDF2MSAxaDN2LTEtMWMwLTAuMjc2MSAwLjA0MDUtMC41NTIxIDAuMDkzOC0wLjgxMjUgMC4zNzI5LTEuODIyNyAxLjk3MzItMy4xODc1IDMuOTA2Mi0zLjE4NzUgMi4yMDkgMCA0IDEuNzkwOSA0IDR2MSAxaDN2LTEtMWwtMC4wNjItMWMtMC4wMTUgMC4wMDE0LTAuMDIxLTAuMDAwNC0wLjAzMiAwaC0wLjEyNWMtMC44MDcgMC0xLjQ5Ny0wLjQxNTYtMS43NS0xLTAuMDY1LTAuMjU0MS0wLjE3LTAuNTE0MS0wLjI4MS0wLjc1LTAuMDA0LTAuMDA4NSAwLjAwNC0wLjAyMjggMC0wLjAzMTItMC4xMDUtMC4yMTg1LTAuMjM1LTAuNDI1Ny0wLjM3NS0wLjYyNS0wLjEzOC0wLjE5NTctMC4zLTAuMzU2OS0wLjQ2OS0wLjUzMTMtMC4wMzYtMC4wMzgtMC4wNTUtMC4wODgxLTAuMDk0LTAuMTI1LTAuMTI2LTAuMTIyNi0wLjI2NS0wLjIzNC0wLjQwNi0wLjM0MzctMC4xMDQtMC4wODE3LTAuMjMyLTAuMTQ0OC0wLjM0NC0wLjIxODgtMC4xMjItMC4wODA5LTAuMjQ0LTAuMTc4OC0wLjM3NC0wLjI1LTAuMTAxLTAuMDU1LTAuMjA4LTAuMTA3NC0wLjMxMy0wLjE1NjItMC4yMDItMC4wOTM5LTAuNDA4LTAuMTgwMi0wLjYyNS0wLjI1LTAuMjMyLTAuMDc0Ny0wLjQ3Mi0wLjE0My0wLjcxOS0wLjE4NzYtMC4zMzItMC4wNTk5LTAuNjgtMC4wOTM3LTEuMDMxLTAuMDkzN3oiIGZpbGw9IiM5NWE1YTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDAgMTAyOC40KSIvPjwvZz48L3N2Zz4=" }), " Secure connection"])); return m("div.span4", m("div.the-bill.pull-right", m("div.content-section", [r(), s, q]))) }; var o = function () { var q = [m("b", "Promotional code"), m("input", { type: "text", name: "checkout-discount", placeholder: "Enter promotional code here", value: a.discountCode(), oninput: m.withAttr("value", function (r) { a.discountCode(r); a.validateDiscountCode() }) })]; if (a.discountCodeLoading()) { q.push(m("span.loader")) } else { if (a.discountCodeError()) { q.push(m("label", a.discountCodeError())) } } return m("div.discount-field pull-left", m("div.content-section", m("form", { onsubmit: a.user() ? a.validateDiscountCode.bind(a) : function (r) { r.preventDefault() } }, q))) }; var c = function () { var r = m("div.billing-address", { style: "" }, [m("label", "Address"), m("p", m("span", nfx.mext.validatedInput({ name: "address_street", placeholder: "Address", value: a.billingDetailsCtrl.addressStreet }))), m("label", "Postal code"), m("p", m("span", nfx.mext.validatedInput({ name: "address_postal_code", placeholder: "Postal code", value: a.billingDetailsCtrl.addressPostalCode }))), m("label", "City"), m("p", m("span", nfx.mext.validatedInput({ name: "address_city", placeholder: "City", value: a.billingDetailsCtrl.addressCity }))), m("label", "State/province"), m("p", m("span", nfx.mext.validatedInput({ name: "address_state", placeholder: "State/province (if applicable)", value: a.billingDetailsCtrl.addressState }))), m("label", "Country"), m("p", m("span", nfx.viewHelpers.countrySelect("address_country", a.billingDetailsCtrl.addressCountry)))]); var q = [m("p", m("div.control-group", [m("label", { style: "margin-bottom: 10px" }, "Account type:"), m("div.controls", [m("label.radio", { style: "padding-left: 15px;" }, [m("input", { type: "radio", name: "account-type", id: "id_account_type_personal", checked: !a.billingDetailsCtrl.isBusiness(), onclick: function () { a.billingDetailsCtrl.isBusiness(false) } }), " Personal"]), m("label.radio", { style: "padding-left: 15px;" }, [m("input", { type: "radio", name: "account-type", id: "id_account_type_business", checked: a.billingDetailsCtrl.isBusiness(), onclick: function () { a.billingDetailsCtrl.isBusiness(true) } }), " Business"])])]))]; if (a.billingDetailsCtrl.isBusiness()) { q.push(m("div.business-input", [m("label", "Company name"), m("p", m("span", nfx.mext.validatedInput({ name: "company", placeholder: "Company name", value: a.billingDetailsCtrl.company }))), m("label", "VAT number (Optional)"), m("p", m("span", nfx.mext.validatedInput({ name: "vat_number", placeholder: "VAT number", value: a.billingDetailsCtrl.vatNumber }))), m("p.help-text", m("a", { href: "http://support.iconfinder.com/purchasing-and-downloading/why-do-you-need-my-vat-number", target: "_blank" }, "Why do you ask for my VAT number?"))])) } return [nfx.views.FormErrorMessageView(a.errorMessage), r, m("form.payment-form-inline#payment-form", new nfx.views.PaymentFormView(a.paymentFormController)), m("div.account-type", q)] }; var h = function () { form = []; if (!a.user()) { var q = m("div.span8.not-logged-in", [m("h3", "Log in to continue"), m("p", "Take a second to log in to your existing Iconfinder account. Or sign up, if you do not already have an account."), m('a.btn.btn-primary.login-link[href="#"]', "Log in"), m("span.seperator", "or"), m('a.btn.btn-primary.signup-link[href="#"]', "Sign up")]); form.push(q) } form.push(c()); return m("div.boxit.span12 customer-details", m("div.row", [m("div.span8", [m("div.content-section.pull-left", form), o()]), j()])) }; return [m("div.row", [m("div.span12.main-headline", [m("h1", "You're only two steps away from becoming a real Pro"), m("h2", "with access to the world's largest collection of premium icons")]), e(), m("div.span12", m("h2.section-headline", "1. Choose your subscription plan")), m("div.span8.plans", m("div.controls", a.pricingPlans().map(p))), m.trust(b)]), m("div.row", [m("div.span8", m("div.boxit.billing-option", m("div.content-section", { onclick: function () { a.billingInterval(a.billingInterval() == "monthly" ? "annual" : "monthly") } }, [m("input", { type: "checkbox", name: "upsell", checked: a.billingInterval() == "annual" }), m("b", "Annual billing"), " - Sign me up for a year and get 2 months for free ", m("span.pull-right", m("b", "Save 16%"))]))), m.trust(l)]), m("div.row", [m("div.span12", m("h2.section-headline", "2. Fill out the billing details")), h()])] }; nfx.views.PrivateMessageModalView = nfx.views.ModalView({ body: function (a) { return m("article", m("section", [nfx.views.FormErrorMessageView(a.errorMessage), m("p", "Send a message to this user"), m("p", m("textarea.send-message", { style: "width: 97%", rows: 5, cols: 40, value: a.message(), placeholder: "Type your message", oninput: m.withAttr("value", a.message) }))])) } }); nfx.views.PerformanceInspectorView = function (b) { var a = function (c) { return Nextfinder.formatting.formatMoney(c, 1) + " ms" }; return [m("summary", [m("ul", [m("li.cache", [m("h2", "Cache"), m("p", [m("em", b.cacheAccessHits() + "/" + b.cacheAccessTotal()), m.trust(" hits &asymp; "), m("em", Math.round(b.cacheAccessHits() * 100 / b.cacheAccessTotal()) + " %"), " in ", m("em", a(b.cacheAccessDuration()))])]), m("li.database", [m("h2", "Database"), m("p", [m("em", b.queriesTotal()), " queries in ", m("em", a(b.queriesDuration()))])]), m("li.redis", [m("h2", "Redis"), m("p", m("i", "(not available)"))]), m("li.elasticsearch", [m("h2", "ElasticSearch"), m("p", m("i", "(not available)"))])])]), m("table.table.operations", [m("thead", [m("tr", [m("th.resource", "Resource"), m("th.operation", "Operation"), m("th.duration", "Duration"), m("th.result", "Result"), m("th.timeline", "Timeline")])]), m("tbody", [b.operations().map(function (d) { var c = (d.startTime / b.operationLastEnds() * 90) + "%"; return m("tr", [m("td.resource", d.resource), m("td.operation", m("pre", d.operation)), m("td.duration", a(d.duration)), m("td.result", d.result), m("td.timeline", [m("div.bar", { style: { width: (d.duration / b.operationLastEnds() * 90) + "%", left: c } }), m("div.time-span", { style: { left: c } }, [a(d.startTime), m.trust(" &#8594; "), a(d.startTime + d.duration)])])]) })])])] }; nfx.views.NewsletterEditView = function (a) { function c(n, k, l) { return m("section.newsletter-part", [m("div.row", [m("div.span5", [m("h3", n), m("span", k)]), m("div.span4.help-text", l)])]) } function e(k) { return c(k.label(), m("input.span4", { placeholder: k.placeholder(), type: "text", value: k.data() || "", oninput: m.withAttr("value", k.data) }), k.helpText()) } function b(k) { return c(k.label(), m("textarea.span4", { rows: 10, cols: 40, placeholder: k.placeholder(), oninput: m.withAttr("value", k.data) }, k.data() || ""), k.helpText()) } function d(k) { return c(k.label(), m("input.span4", { type: "color", value: k.data() || "", oninput: m.withAttr("value", k.data) }), k.helpText()) } function j(k) { return m("section.newsletter-part", [m("div.row", [m("div.span5", [m("h3", k.label()), (k.asset() ? m("img", { src: k.asset().uri() }) : ""), m("input", { type: "file", onchange: function (n) { var l = n.target.files; if (l.length) { a.uploadImage(k, l[0]) } } })])])]) } function g(k) { return [m("section", m("div.row", m("div.span9", m("h3", k.label())))), m("section.card-container.newsletter-articles.newsletter-part", [m("div.available-articles.sidebar", [a.latestExternalArticles().map(function (l) { return m("div.available-article", [m("a.add", { href: "javascript: void(0)", onclick: function () { return k.addArticle(new nfx.models.ArticleListNewsletterPartArticle({ title: l.title(), url: l.urlCanonical(), author: l.author(), excerpt: l.excerpt() })) } }, "+"), m("p.title", l.title()), (l.author() ? m("p.author", l.author()) : ""), (l.urlCanonical() ? m("p.url", m("a", { href: l.urlCanonical(), target: "_blank" }, l.urlCanonical())) : "")]) })]), m("div.row", k.articles().map(function (o, n) { var l = "articles-" + k.identifier() + "-article"; return m("div", { draggable: true, ondragstart: function (p) { p.dataTransfer.setData("type", l); p.dataTransfer.setData("index", n); o._isDragging = true }, ondragend: function (p) { o._isDragging = false }, ondragover: function (p) { p.preventDefault() }, ondragenter: function () { m.startComputation(); o._dropTargetCounter = (o._dropTargetCounter ? o._dropTargetCounter + 1 : 1); m.endComputation() }, ondragleave: function () { o._dropTargetCounter-- }, ondrop: function (q) { if (q.dataTransfer.getData("type") != l) { return } var p = parseInt(q.dataTransfer.getData("index"), 10); k.moveArticle(p, n); o._dropTargetCounter = 0 }, className: nfx.mext.classMap("card", { "drop-target": ((!o._isDragging) && (o._dropTargetCounter > 0)) }) }, [m("a.remove", { title: "Remove", href: "javascript:void(0)", onclick: function () { if (confirm("Are you sure you want to remove this article?")) { k.removeArticle(n) } } }, m.trust("&times;")), m("p", [m("label", "Title"), m("span", m("input", { type: "text", value: o.title() || "", oninput: m.withAttr("value", o.title) }))]), m("p", [m("label", "URL"), m("span", m("input", { type: "text", value: o.url() || "", oninput: m.withAttr("value", o.url) }))]), m("p", [m("label", "Author"), m("span", m("input", { type: "text", value: o.author() || "", oninput: m.withAttr("value", o.author) }))]), m("p", [m("label", "Excerpt"), m("span", m("textarea", { oninput: m.withAttr("value", o.excerpt) }, o.excerpt() || ""))]), m("p", [m("label", "Thumbnail"), m("span.article-thumbnail", [m("img", { src: (o.thumbnail() ? o.thumbnail().uri() : "http://placehold.it/360x360"), style: "height: 90px" }), m("input", { type: "file", onchange: function (q) { var p = q.target.files; if (p.length) { a.uploadArticleThumbnail(o, p[0]) } }, width: 315, height: 90 })])]), m("p", [m("label", "Featured"), m("span", m("input", { type: "checkbox", checked: o.featured(), onclick: m.withAttr("checked", o.featured) }))]), (o.featured() ? m("p", [m("label", "Background"), m("span", m("input", { type: "color", value: o.backgroundColor() || "", oninput: m.withAttr("value", o.backgroundColor) }))]) : "")]) }).concat(k.canAddArticle() ? [m("div.card.ghost.add", { onclick: function () { k.addArticle() } }, m("span", "+"))] : []))])] } function h(l) { function n(o) { return m("article.span4.iconset-preview.iconset-preview-medium", [m("a", { href: "/iconsets/" + o.identifier(), className: "preview-image", draggable: false, target: "_blank" }, m("img", { src: "/data/iconsets/previews/medium/" + o.identifier() + ".png", title: o.name(), draggable: false })), m("section.info", [m("span", { className: (o.isPremium() ? "label-premium" : "label-free") }, (o.isPremium() ? "Premium" : "Free")), m("h4", m("a", { href: "/iconsets/" + o.identifier(), title: o.name(), draggable: false, target: "_blank" }, o.name()))])]) } var k = {}; l.iconSets().forEach(function (o) { k[o.iconSetId()] = true }); return [m("section", m("div.row", m("div.span9", m("h3", l.label())))), m("section.card-container.newsletter-iconsets.newsletter-part", [m("div.available-iconsets", [a.latestPromotedIconSets().map(function (o) { if (k[o.iconSetId()]) { return [] } return m("div.available-iconset", [m("a.add", { href: "javascript: void(0)", onclick: function () { return l.addIconSet(o) } }, "+"), n(o)]) })]), m("div.row", l.iconSets().map(function (p, q) { var o = "iconsets-" + l.identifier() + "-iconset"; return m("div", { draggable: true, ondragstart: function (r) { r.dataTransfer.setData("type", o); r.dataTransfer.setData("index", q); p._isDragging = true }, ondragend: function (r) { p._isDragging = false }, ondragover: function (r) { r.preventDefault() }, ondragenter: function () { m.startComputation(); p._dropTargetCounter = (p._dropTargetCounter ? p._dropTargetCounter + 1 : 1); m.endComputation() }, ondragleave: function () { p._dropTargetCounter-- }, ondrop: function (s) { if (s.dataTransfer.getData("type") != o) { return } var r = parseInt(s.dataTransfer.getData("index"), 10); l.moveIconSet(r, q); p._dropTargetCounter = 0 }, className: nfx.mext.classMap("card", { "drop-target": ((!p._isDragging) && (p._dropTargetCounter > 0)) }) }, [m("a.remove", { title: "Remove", href: "javascript:void(0)", onclick: function () { if (confirm("Are you sure you want to remove this icon set?")) { l.removeIconSet(q) } } }, m.trust("&times;")), n(p)]) }))])] } function f(k) { return { line: e, text: b, color: d, article_list: g, iconset_list: h, image: j }[k.type()](k) } return [c("Subject line", m("input.span4", { name: "subject", maxlength: "100", placeholder: "E.g. Designer's Digest #85", type: "text", value: a.newsletter.subject() || "", oninput: m.withAttr("value", a.newsletter.subject) }), "Subject line as it will appear to the recipients and as the title of the newsletter.")].concat(a.newsletter.parts().map(f)).concat([m("section.flow-navigation-bottom.flow-navigation", [m("button.btn.btn-next.btn-large.btn-primary", { onclick: a.save.bind(a) }, "Save"), m("button.btn.btn-next.btn-large", { onclick: a.saveAndSendPreview.bind(a) }, "Save and send preview"), m("button.btn.btn-next.btn-large.btn-warning", { onclick: a.saveAndSend.bind(a) }, "Save and send")])]) }; nfx.views.MailingListSubscribeModalView = nfx.views.ModalView({ id: function () { return "mailing_list_subscribe" }, body: function (a) { if (a.isSubscribed()) { return m("article", m("section", [m("span", [m("img", { src: "/assets/img/illustrations/mail.svg", width: 338, height: 274 })]), m("h3", "You are now subscribed to the mailing list"), m("p", "The latest goodies from Iconfinder will be coming your way soon.")])) } return [m("section.section-inputfields", [m("p", "Enter your details below to get the latest goodies from Iconfinder. Don't worry – we won't spam you."), m("form", { onsubmit: a.action.bind(a) }, [nfx.views.FormErrorMessageView(a.errorMessage), m("div.inputfields", [m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "email", type: "email", placeholder: "E-mail address", value: a.email, "class": ["input-block-level", "icon-bg", "icon-if-email"] }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "first_name", placeholder: "First name", value: a.firstName, "class": ["input-block-level", "icon-bg", "icon-if-user"] }))), m("p", m("span", nfx.views.ValidatedInputFieldView({ name: "last_name", placeholder: "Last name", value: a.lastName, "class": ["input-block-level", "icon-bg", "icon-if-user"] })))]), m("input", { type: "submit", style: "display: none" }, "Subscribe")])])] } }); var earnings = 0; nfx.views.RequestPaymentModalView = nfx.views.ModalView({ id: function (a) { return "requestPaymentModal" }, body: function (a) { return m("section", [m("form.form-horizontal", { onsubmit: a.requestPayment.bind(a) }, [m("div.inputfields", [m("p.control-group", [m("label.control-label", { "for": "description" }, "Service description:"), m("div.controls", [m("textarea.input-block-level", { name: "description", id: "description", placeholder: "Describe the service to be listed in the invoice, for example “Design of 5 custom icons”", rows: 3, minlength: 2, required: true }), m("p.text-muted", "This text will appear on the official invoices from Iconfinder. Make sure the information is complete and correct.")])]), m("p.control-group", [m("label.control-label", { "for": "price" }, "Payment amount:"), m("div.controls", [m("div.input-prepend", [m("span.add-on", "$"), m("input.text-right", { type: "number", name: "price", id: "price", placeholder: "20", required: true, style: { width: "50px" }, oninput: function (b) { earnings = b.target.value * 0.95 } })]), m("span", [" =  ", m("strong.text-success", ["$", Nextfinder.formatting.formatMoney(earnings), " earnings"]), " (after 5% Iconfinder fee)"])])]), m("input", { type: "hidden", "class": "hidden", name: "attachment_type", value: "payment_request" })])])]) }, footer: function (a) { return [m("button.btn.btn-large.btn-primary", { disabled: a.processing(), onclick: a.requestPayment.bind(a) }, "Request payment"), m("button.btn.btn-large", { onclick: a.dismiss.bind(a), disabled: a.processing() }, a.dismissLabel())] } }); nfx.modules.AccountDashboardOrganizationModule = function (c) { var a = m.prop(c && c.organization ? new nfx.models.Organization(c.organization) : null), b = m.prop(c && c.organizationMembership ? new nfx.models.OrganizationMembership(c.organizationMembership) : null); this.controller = nfx.controllers.AccountDashboardOrganizationController.bind(nfx.controllers.AccountDashboardOrganizationController, a, b); this.view = nfx.views.AccountDashboardOrganizationView }; nfx.modules.AccountSubscriptionPlanModule = function (b) { var a = m.prop(b && b.organization ? new nfx.models.Organization(b.organization) : null), c = m.prop(b && b.pricingPlans ? b.pricingPlans.map(function (d) { return new nfx.models.PricingPlan(d) }) : null); this.controller = nfx.controllers.AccountSubscriptionPlanController.bind(nfx.controllers.AccountSubscriptionPlanController, a, c); this.view = nfx.views.AccountSubscriptionPlanView }; nfx.modules.AddCreditCardModalModule = function (a) { this.controller = nfx.controllers.AddCreditCardModalController.bind(nfx.controllers.AddCreditCardModalController, a); this.view = nfx.views.AddCreditCardModalView }; nfx.modules.AssetPurchaseCompletedModalModule = function (a) { this.controller = nfx.controllers.AssetPurchaseCompletedModalController.bind(nfx.controllers.AssetPurchaseCompletedModalController, a); this.view = nfx.views.AssetPurchaseCompletedModalView }; nfx.modules.BiTableQueryResult = function (a) { this.controller = nfx.controllers.BiTableQueryResultController.bind(nfx.controllers.BiTableQueryResultController, a); this.view = nfx.views.BiTableQueryResultView }; nfx.modules.BillingDetailsModule = function (a) { this.controller = nfx.controllers.BillingDetailsController.bind(nfx.controllers.BillingDetailsController, a); this.view = nfx.views.BillingDetailsView }; nfx.modules.BillingDetailsModalModule = function (a) { this.controller = nfx.controllers.BillingDetailsModalController.bind(nfx.controllers.BillingDetailsModalController, a); this.view = nfx.views.BillingDetailsModalView }; nfx.modules.ConfirmAssetPurchaseModalModule = function (a) { this.controller = nfx.controllers.ConfirmAssetPurchaseModalController.bind(nfx.controllers.ConfirmAssetPurchaseModalController, a); this.view = nfx.views.ConfirmAssetPurchaseModalView }; nfx.modules.DepositCashModalModule = function (a) { this.controller = nfx.controllers.DepositCashModalController.bind(nfx.controllers.DepositCashModalController, a); this.view = nfx.views.DepositCashModalView }; nfx.modules.DownloadLimitReachedModalModule = function (a) { this.controller = nfx.controllers.DownloadLimitReachedModalController.bind(nfx.controllers.DownloadLimitReachedModalController, a); this.view = nfx.views.DownloadLimitReachedModalView }; nfx.modules.ErrorModalModule = function (a) { this.controller = nfx.controllers.ErrorModalController.bind(nfx.controllers.ErrorModalController, a); this.view = nfx.views.ErrorModalView }; nfx.modules.InsufficientFundsModalModule = function (a) { this.controller = nfx.controllers.InsufficientFundsModalController.bind(nfx.controllers.InsufficientFundsModalController, a); this.view = nfx.views.InsufficientFundsModalView }; nfx.modules.InviteMembersModalModule = function (a) { this.controller = nfx.controllers.InviteMembersModalController.bind(nfx.controllers.InviteMembersModalController, a); this.view = nfx.views.InviteMembersModalView }; nfx.modules.ModalStackLoaderModule = function (a) { this.controller = nfx.controllers.ModalStackLoaderController.bind(nfx.controllers.ModalStackLoaderController, a); this.view = nfx.views.ModalStackLoaderView }; nfx.modules.PaymentFormModule = function (b) { var a = new nfx.controllers.PaymentFormController(b); this.controller = function () { return a }; this.view = nfx.views.PaymentFormView }; nfx.modules.SubscriptionCreatedModalModule = function (a) { this.controller = nfx.controllers.SubscriptionCreatedModalController.bind(nfx.controllers.SubscriptionCreatedModalController, a); this.view = nfx.views.SubscriptionCreatedModalView }; nfx.modules.SubscriptionPaymentModalModule = function (a) { this.controller = nfx.controllers.SubscriptionPaymentModalController.bind(nfx.controllers.SubscriptionPaymentModalController, a); this.view = nfx.views.SubscriptionPaymentModalView }; nfx.modules.ChurnSurveyModalModule = function (a) { this.controller = nfx.controllers.ChurnSurveyModalController.bind(nfx.controllers.ChurnSurveyModalController, a); this.view = nfx.views.ChurnSurveyModalView }; nfx.modules.FreeDownloadPromptModalModule = function (a) { this.controller = nfx.controllers.FreeDownloadPromptModalController.bind(nfx.controllers.FreeDownloadPromptModalController, a); this.view = nfx.views.FreeDownloadPromptModalView }; nfx.modules.SignUpModalModule = function (a) { this.controller = nfx.controllers.SignUpModalController.bind(nfx.controllers.SignUpModalController, a); this.view = nfx.views.SignUpModalView }; nfx.modules.MissingUserDataModalModule = function (a) { this.controller = nfx.controllers.MissingUserDataModalController.bind(nfx.controllers.MissingUserDataModalController, a); this.view = nfx.views.MissingUserDataModalView }; nfx.modules.LogInModalModule = function (a) { this.controller = nfx.controllers.LogInModalController.bind(nfx.controllers.LogInModalController, a); this.view = nfx.views.LogInModalView }; nfx.modules.FormatIsProOnlyPromptModalModule = function (a) { this.controller = nfx.controllers.FormatIsProOnlyPromptModalController.bind(nfx.controllers.FormatIsProOnlyPromptModalController, a); this.view = nfx.views.FormatIsProOnlyPromptModalView }; nfx.modules.PrivateMessageIsProOnlyPromptModalModule = function (a) { this.controller = nfx.controllers.PrivateMessageIsProOnlyPromptModalController.bind(nfx.controllers.PrivateMessageIsProOnlyPromptModalController, a); this.view = nfx.views.PrivateMessageIsProOnlyPromptModalView }; nfx.modules.SubscriptionModule = function (a) { this.controller = nfx.controllers.SubscriptionController.bind(nfx.controllers.SubscriptionController, a); this.view = nfx.views.SubscriptionView }; nfx.modules.PrivateMessageModalModule = function (a) { this.controller = nfx.controllers.PrivateMessageModalController.bind(nfx.controllers.PrivateMessageModalController, a); this.view = nfx.views.PrivateMessageModalView }; nfx.modules.PerformanceInspectorModule = function (a) { this.controller = nfx.controllers.PerformanceInspectorController.bind(nfx.controllers.PerformanceInspectorController, a); this.view = nfx.views.PerformanceInspectorView }; nfx.modules.NewsletterEditModule = function (a) { this.controller = nfx.controllers.NewsletterEditController.bind(nfx.controllers.NewsletterEditController, a); this.view = nfx.views.NewsletterEditView }; nfx.modules.MailingListSubscribeModalModule = function (a) { this.controller = nfx.controllers.MailingListSubscribeModalController.bind(nfx.controllers.MailingListSubscribeModalController, a); this.view = nfx.views.MailingListSubscribeModalView }; nfx.modules.RequestPaymentModalModule = function (a) { this.controller = nfx.controllers.RequestPaymentModalController.bind(nfx.controllers.RequestPaymentModalController, a); this.view = nfx.views.RequestPaymentModalView }; window.nfx.app = new nfx.controllers.AppController(); !function (a) { a(function () { a.support.transition = (function () { var b = (function () { var e = document.createElement("bootstrap"), d = { WebkitTransition: "webkitTransitionEnd", MozTransition: "transitionend", OTransition: "oTransitionEnd", msTransition: "MSTransitionEnd", transition: "transitionend" }, c; for (c in d) { if (e.style[c] !== undefined) { return d[c] } } }()); return b && { end: b } })() }) }(window.jQuery); !function (c) { var b = '[data-dismiss="alert"]', a = function (d) { c(d).on("click", b, this.close) }; a.prototype.close = function (j) { var h = c(this), f = h.attr("data-target"), g; if (!f) { f = h.attr("href"); f = f && f.replace(/.*(?=#[^\s]*$)/, "") } g = c(f); j && j.preventDefault(); g.length || (g = h.hasClass("alert") ? h : h.parent()); g.trigger(j = c.Event("close")); if (j.isDefaultPrevented()) { return } g.removeClass("in"); function d() { g.trigger("closed").remove() } c.support.transition && g.hasClass("fade") ? g.on(c.support.transition.end, d) : d() }; c.fn.alert = function (d) { return this.each(function () { var f = c(this), e = f.data("alert"); if (!e) { f.data("alert", (e = new a(this))) } if (typeof d == "string") { e[d].call(f) } }) }; c.fn.alert.Constructor = a; c(function () { c("body").on("click.alert.data-api", b, a.prototype.close) }) }(window.jQuery); !function (d) { var b = '[data-toggle="dropdown"]', a = function (f) { var e = d(f).on("click.dropdown.data-api", this.toggle); d("html").on("click.dropdown.data-api", function () { e.parent().removeClass("open") }) }; a.prototype = { constructor: a, toggle: function (k) { var j = d(this), h, f, g; if (j.is(".disabled, :disabled")) { return } f = j.attr("data-target"); if (!f) { f = j.attr("href"); f = f && f.replace(/.*(?=#[^\s]*$)/, "") } h = d(f); h.length || (h = j.parent()); g = h.hasClass("open"); c(); if (!g) { h.toggleClass("open") } return false } }; function c() { d(b).parent().removeClass("open") } d.fn.dropdown = function (e) { return this.each(function () { var g = d(this), f = g.data("dropdown"); if (!f) { g.data("dropdown", (f = new a(this))) } if (typeof e == "string") { f[e].call(g) } }) }; d.fn.dropdown.Constructor = a; d(function () { d("html").on("click.dropdown.data-api", c); d("body").on("click.dropdown", ".dropdown form", function (f) { f.stopPropagation() }).on("click.dropdown.data-api", b, a.prototype.toggle) }) }(window.jQuery); !function (a) { var b = function (d, c) { this.$element = a(d); this.options = a.extend({}, a.fn.collapse.defaults, c); if (this.options.parent) { this.$parent = a(this.options.parent) } this.options.toggle && this.toggle() }; b.prototype = { constructor: b, dimension: function () { var c = this.$element.hasClass("width"); return c ? "width" : "height" }, show: function () { var f, c, e, d; if (this.transitioning) { return } f = this.dimension(); c = a.camelCase(["scroll", f].join("-")); e = this.$parent && this.$parent.find("> .accordion-group > .in"); if (e && e.length) { d = e.data("collapse"); if (d && d.transitioning) { return } e.collapse("hide"); d || e.data("collapse", null) } this.$element[f](0); this.transition("addClass", a.Event("show"), "shown"); this.$element[f](this.$element[0][c]) }, hide: function () { var c; if (this.transitioning) { return } c = this.dimension(); this.reset(this.$element[c]()); this.transition("removeClass", a.Event("hide"), "hidden"); this.$element[c](0) }, reset: function (c) { var d = this.dimension(); this.$element.removeClass("collapse")[d](c || "auto")[0].offsetWidth; this.$element[c !== null ? "addClass" : "removeClass"]("collapse"); return this }, transition: function (g, d, e) { var f = this, c = function () { if (d.type == "show") { f.reset() } f.transitioning = 0; f.$element.trigger(e) }; this.$element.trigger(d); if (d.isDefaultPrevented()) { return } this.transitioning = 1; this.$element[g]("in"); a.support.transition && this.$element.hasClass("collapse") ? this.$element.one(a.support.transition.end, c) : c() }, toggle: function () { this[this.$element.hasClass("in") ? "hide" : "show"]() } }; a.fn.collapse = function (c) { return this.each(function () { var f = a(this), e = f.data("collapse"), d = typeof c == "object" && c; if (!e) { f.data("collapse", (e = new b(this, d))) } if (typeof c == "string") { e[c]() } }) }; a.fn.collapse.defaults = { toggle: true }; a.fn.collapse.Constructor = b; a(function () { a("body").on("click.collapse.data-api", "[data-toggle=collapse]", function (h) { var g = a(this), c, f = g.attr("data-target") || h.preventDefault() || (c = g.attr("href")) && c.replace(/.*(?=#[^\s]+$)/, ""), d = a(f).data("collapse") ? "toggle" : g.data(); a(f).collapse(d) }) }) }(window.jQuery); !function (b) { var a = function (d, c) { this.$element = b(d); this.options = b.extend({}, b.fn.button.defaults, c) }; a.prototype.setState = function (f) { var h = "disabled", c = this.$element, e = c.data(), g = c.is("input") ? "val" : "html"; f = f + "Text"; e.resetText || c.data("resetText", c[g]()); c[g](e[f] || this.options[f]); setTimeout(function () { f == "loadingText" ? c.addClass(h).attr(h, h) : c.removeClass(h).removeAttr(h) }, 0) }; a.prototype.toggle = function () { var c = this.$element.parent('[data-toggle="buttons-radio"]'); c && c.find(".active").removeClass("active"); this.$element.toggleClass("active") }; b.fn.button = function (c) { return this.each(function () { var f = b(this), e = f.data("button"), d = typeof c == "object" && c; if (!e) { f.data("button", (e = new a(this, d))) } if (c == "toggle") { e.toggle() } else { if (c) { e.setState(c) } } }) }; b.fn.button.defaults = { loadingText: "loading..." }; b.fn.button.Constructor = a; b(function () { b("body").on("click.button.data-api", "[data-toggle^=button]", function (d) { var c = b(d.target); if (!c.hasClass("btn")) { c = c.closest(".btn") } c.button("toggle") }) }) }(window.jQuery); !function (e) { var a = function (j, h) { this.options = h; this.$element = e(j).delegate('[data-dismiss="modal"]', "click.dismiss.modal", e.proxy(this.hide, this)) }; a.prototype = { constructor: a, toggle: function () { return this[!this.isShown ? "show" : "hide"]() }, show: function () { var h = this, j = e.Event("show"); this.$element.trigger(j); if (this.isShown || j.isDefaultPrevented()) { return } e("body").addClass("modal-open"); this.isShown = true; d.call(this); c.call(this, function () { var k = e.support.transition && h.$element.hasClass("fade"); if (!h.$element.parent().length) { h.$element.appendTo(document.body) } h.$element.show(); if (k) { h.$element[0].offsetWidth } h.$element.addClass("in"); k ? h.$element.one(e.support.transition.end, function () { h.$element.trigger("shown") }) : h.$element.trigger("shown") }) }, hide: function (j) { j && j.preventDefault(); var h = this; j = e.Event("hide"); this.$element.trigger(j); if (!this.isShown || j.isDefaultPrevented() || (this.options.canHide && !this.options.canHide())) { return } this.isShown = false; e("body").removeClass("modal-open"); d.call(this); this.$element.removeClass("in"); e.support.transition && this.$element.hasClass("fade") ? g.call(this) : f.call(this) } }; function g() { var h = this, j = setTimeout(function () { h.$element.off(e.support.transition.end); f.call(h) }, 500); this.$element.one(e.support.transition.end, function () { clearTimeout(j); f.call(h) }) } function f(h) { this.$element.hide().trigger("hidden"); c.call(this) } function c(l) { var k = this, j = this.$element.hasClass("fade") ? "fade" : ""; if (this.isShown && this.options.backdrop && e(".modal-backdrop").length == 0) { var h = e.support.transition && j; this.$backdrop = e('<div class="modal-backdrop ' + j + '" />').appendTo(document.body); if (this.options.backdrop != "static") { this.$backdrop.click(e.proxy(this.hide, this)) } if (h) { this.$backdrop[0].offsetWidth } this.$backdrop.addClass("in"); h ? this.$backdrop.one(e.support.transition.end, l) : l() } else { if (!this.isShown && this.$backdrop) { this.$backdrop.removeClass("in"); e.support.transition && this.$element.hasClass("fade") ? this.$backdrop.one(e.support.transition.end, e.proxy(b, this)) : b.call(this) } else { if (l) { l() } } } } function b() { this.$backdrop.remove(); this.$backdrop = null } function d() { var h = this; if (this.isShown && this.options.keyboard) { e(document).on("keyup.dismiss.modal", function (j) { j.which == 27 && h.hide() }) } else { if (!this.isShown) { e(document).off("keyup.dismiss.modal") } } } e.fn.modal = function (h) { return this.each(function () { var l = e(this), k = l.data("modal"), j = e.extend({}, e.fn.modal.defaults, l.data(), typeof h == "object" && h); if (!k) { l.data("modal", (k = new a(this, j))) } if (typeof h == "string") { k[h]() } else { if (j.show) { k.show() } } }) }; e.fn.modal.defaults = { backdrop: true, keyboard: true, show: true }; e.fn.modal.Constructor = a; e(function () { e("body").on("click.modal.data-api", '[data-toggle="modal"]', function (n) { var l = e(this), j, h = e(l.attr("data-target") || (j = l.attr("href")) && j.replace(/.*(?=#[^\s]+$)/, "")), k = h.data("modal") ? "toggle" : e.extend({}, h.data(), l.data()); n.preventDefault(); h.modal(k) }) }) }(window.jQuery); !function (d) { function f() { return new Date(Date.UTC.apply(Date, arguments)) } function b() { var g = new Date(); return f(g.getUTCFullYear(), g.getUTCMonth(), g.getUTCDate()) } var a = function (h, g) { var j = this; this.element = d(h); this.language = g.language || this.element.data("date-language") || "en"; this.language = this.language in e ? this.language : "en"; this.format = c.parseFormat(g.format || this.element.data("date-format") || "mm/dd/yyyy"); this.picker = d(c.template).appendTo("body").on({ click: d.proxy(this.click, this) }); this.isInput = this.element.is("input"); this.component = this.element.is(".date") ? this.element.find(".add-on") : false; this.hasInput = this.component && this.element.find("input").length; if (this.component && this.component.length === 0) { this.component = false } this._attachEvents(); this.forceParse = true; if ("forceParse" in g) { this.forceParse = g.forceParse } else { if ("dateForceParse" in this.element.data()) { this.forceParse = this.element.data("date-force-parse") } } d(document).on("mousedown", function (k) { if (d(k.target).closest(".datepicker").length === 0) { j.hide() } }); this.autoclose = false; if ("autoclose" in g) { this.autoclose = g.autoclose } else { if ("dateAutoclose" in this.element.data()) { this.autoclose = this.element.data("date-autoclose") } } this.keyboardNavigation = true; if ("keyboardNavigation" in g) { this.keyboardNavigation = g.keyboardNavigation } else { if ("dateKeyboardNavigation" in this.element.data()) { this.keyboardNavigation = this.element.data("date-keyboard-navigation") } } this.viewMode = this.startViewMode = 0; switch (g.startView || this.element.data("date-start-view")) { case 2: case "decade": this.viewMode = this.startViewMode = 2; break; case 1: case "year": this.viewMode = this.startViewMode = 1; break }this.todayBtn = (g.todayBtn || this.element.data("date-today-btn") || false); this.todayHighlight = (g.todayHighlight || this.element.data("date-today-highlight") || false); this.weekStart = ((g.weekStart || this.element.data("date-weekstart") || e[this.language].weekStart || 0) % 7); this.weekEnd = ((this.weekStart + 6) % 7); this.startDate = -Infinity; this.endDate = Infinity; this.daysOfWeekDisabled = []; this.setStartDate(g.startDate || this.element.data("date-startdate")); this.setEndDate(g.endDate || this.element.data("date-enddate")); this.setDaysOfWeekDisabled(g.daysOfWeekDisabled || this.element.data("date-days-of-week-disabled")); this.fillDow(); this.fillMonths(); this.update(); this.showMode() }; a.prototype = { constructor: a, _events: [], _attachEvents: function () { this._detachEvents(); if (this.isInput) { this._events = [[this.element, { focus: d.proxy(this.show, this), keyup: d.proxy(this.update, this), keydown: d.proxy(this.keydown, this) }]] } else { if (this.component && this.hasInput) { this._events = [[this.element.find("input"), { focus: d.proxy(this.show, this), keyup: d.proxy(this.update, this), keydown: d.proxy(this.keydown, this) }], [this.component, { click: d.proxy(this.show, this) }]] } else { this._events = [[this.element, { click: d.proxy(this.show, this) }]] } } for (var g = 0, h, j; g < this._events.length; g++) { h = this._events[g][0]; j = this._events[g][1]; h.on(j) } }, _detachEvents: function () { for (var g = 0, h, j; g < this._events.length; g++) { h = this._events[g][0]; j = this._events[g][1]; h.off(j) } this._events = [] }, show: function (g) { this.picker.show(); this.height = this.component ? this.component.outerHeight() : this.element.outerHeight(); this.update(); this.place(); d(window).on("resize", d.proxy(this.place, this)); if (g) { g.stopPropagation(); g.preventDefault() } this.element.trigger({ type: "show", date: this.date }) }, hide: function (g) { this.picker.hide(); d(window).off("resize", this.place); this.viewMode = this.startViewMode; this.showMode(); if (!this.isInput) { d(document).off("mousedown", this.hide) } if (this.forceParse && (this.isInput && this.element.val() || this.hasInput && this.element.find("input").val())) { this.setValue() } this.element.trigger({ type: "hide", date: this.date }) }, remove: function () { this._detachEvents(); this.picker.remove(); delete this.element.data().datepicker }, getDate: function () { var g = this.getUTCDate(); return new Date(g.getTime() + (g.getTimezoneOffset() * 60000)) }, getUTCDate: function () { return this.date }, setDate: function (g) { this.setUTCDate(new Date(g.getTime() - (g.getTimezoneOffset() * 60000))) }, setUTCDate: function (g) { this.date = g; this.setValue() }, setValue: function () { var g = c.formatDate(this.date, this.format, this.language); if (!this.isInput) { if (this.component) { this.element.find("input").prop("value", g) } this.element.data("date", g) } else { this.element.prop("value", g) } }, setStartDate: function (g) { this.startDate = g || -Infinity; if (this.startDate !== -Infinity) { this.startDate = c.parseDate(this.startDate, this.format, this.language) } this.update(); this.updateNavArrows() }, setEndDate: function (g) { this.endDate = g || Infinity; if (this.endDate !== Infinity) { this.endDate = c.parseDate(this.endDate, this.format, this.language) } this.update(); this.updateNavArrows() }, setDaysOfWeekDisabled: function (g) { this.daysOfWeekDisabled = g || []; if (!d.isArray(this.daysOfWeekDisabled)) { this.daysOfWeekDisabled = this.daysOfWeekDisabled.split(/,\s*/) } this.daysOfWeekDisabled = d.map(this.daysOfWeekDisabled, function (h) { return parseInt(h, 10) }); this.update(); this.updateNavArrows() }, place: function () { var h = parseInt(this.element.parents().filter(function () { return d(this).css("z-index") != "auto" }).first().css("z-index")) + 10; var g = this.component ? this.component.offset() : this.element.offset(); this.picker.css({ top: g.top + 30, left: g.left, zIndex: h }) }, update: function () { this.date = c.parseDate(this.isInput ? this.element.prop("value") : this.element.data("date") || this.element.find("input").prop("value"), this.format, this.language); if (this.date < this.startDate) { this.viewDate = new Date(this.startDate) } else { if (this.date > this.endDate) { this.viewDate = new Date(this.endDate) } else { this.viewDate = new Date(this.date) } } this.fill() }, fillDow: function () { var g = this.weekStart, h = "<tr>"; while (g < this.weekStart + 7) { h += '<th class="dow">' + e[this.language].daysMin[(g++) % 7] + "</th>" } h += "</tr>"; this.picker.find(".datepicker-days thead").append(h) }, fillMonths: function () { var h = "", g = 0; while (g < 12) { h += '<span class="month">' + e[this.language].monthsShort[g++] + "</span>" } this.picker.find(".datepicker-months td").html(h) }, fill: function () { var v = new Date(this.viewDate), n = v.getUTCFullYear(), w = v.getUTCMonth(), p = this.startDate !== -Infinity ? this.startDate.getUTCFullYear() : -Infinity, t = this.startDate !== -Infinity ? this.startDate.getUTCMonth() : -Infinity, j = this.endDate !== Infinity ? this.endDate.getUTCFullYear() : Infinity, q = this.endDate !== Infinity ? this.endDate.getUTCMonth() : Infinity, k = this.date.valueOf(), u = new Date(); this.picker.find(".datepicker-days thead th:eq(1)").text(e[this.language].months[w] + " " + n); this.picker.find("tfoot th.today").text(e[this.language].today).toggle(this.todayBtn !== false); this.updateNavArrows(); this.fillMonths(); var y = f(n, w - 1, 28, 0, 0, 0, 0), s = c.getDaysInMonth(y.getUTCFullYear(), y.getUTCMonth()); y.setUTCDate(s); y.setUTCDate(s - (y.getUTCDay() - this.weekStart + 7) % 7); var g = new Date(y); g.setUTCDate(g.getUTCDate() + 42); g = g.valueOf(); var l = []; var o; while (y.valueOf() < g) { if (y.getUTCDay() == this.weekStart) { l.push("<tr>") } o = ""; if (y.getUTCFullYear() < n || (y.getUTCFullYear() == n && y.getUTCMonth() < w)) { o += " old" } else { if (y.getUTCFullYear() > n || (y.getUTCFullYear() == n && y.getUTCMonth() > w)) { o += " new" } } if (this.todayHighlight && y.getUTCFullYear() == u.getFullYear() && y.getUTCMonth() == u.getMonth() && y.getUTCDate() == u.getDate()) { o += " today" } if (y.valueOf() == k) { o += " active" } if (y.valueOf() < this.startDate || y.valueOf() > this.endDate || d.inArray(y.getUTCDay(), this.daysOfWeekDisabled) !== -1) { o += " disabled" } l.push('<td class="day' + o + '">' + y.getUTCDate() + "</td>"); if (y.getUTCDay() == this.weekEnd) { l.push("</tr>") } y.setUTCDate(y.getUTCDate() + 1) } this.picker.find(".datepicker-days tbody").empty().append(l.join("")); var z = this.date.getUTCFullYear(); var h = this.picker.find(".datepicker-months").find("th:eq(1)").text(n).end().find("span").removeClass("active"); if (z == n) { h.eq(this.date.getUTCMonth()).addClass("active") } if (n < p || n > j) { h.addClass("disabled") } if (n == p) { h.slice(0, t).addClass("disabled") } if (n == j) { h.slice(q + 1).addClass("disabled") } l = ""; n = parseInt(n / 10, 10) * 10; var x = this.picker.find(".datepicker-years").find("th:eq(1)").text(n + "-" + (n + 9)).end().find("td"); n -= 1; for (var r = -1; r < 11; r++) { l += '<span class="year' + (r == -1 || r == 10 ? " old" : "") + (z == n ? " active" : "") + (n < p || n > j ? " disabled" : "") + '">' + n + "</span>"; n += 1 } x.html(l) }, updateNavArrows: function () { var j = new Date(this.viewDate), g = j.getUTCFullYear(), h = j.getUTCMonth(); switch (this.viewMode) { case 0: if (this.startDate !== -Infinity && g <= this.startDate.getUTCFullYear() && h <= this.startDate.getUTCMonth()) { this.picker.find(".prev").css({ visibility: "hidden" }) } else { this.picker.find(".prev").css({ visibility: "visible" }) } if (this.endDate !== Infinity && g >= this.endDate.getUTCFullYear() && h >= this.endDate.getUTCMonth()) { this.picker.find(".next").css({ visibility: "hidden" }) } else { this.picker.find(".next").css({ visibility: "visible" }) } break; case 1: case 2: if (this.startDate !== -Infinity && g <= this.startDate.getUTCFullYear()) { this.picker.find(".prev").css({ visibility: "hidden" }) } else { this.picker.find(".prev").css({ visibility: "visible" }) } if (this.endDate !== Infinity && g >= this.endDate.getUTCFullYear()) { this.picker.find(".next").css({ visibility: "hidden" }) } else { this.picker.find(".next").css({ visibility: "visible" }) } break } }, click: function (o) { o.stopPropagation(); o.preventDefault(); var n = d(o.target).closest("span, td, th"); if (n.length == 1) { switch (n[0].nodeName.toLowerCase()) { case "th": switch (n[0].className) { case "switch": this.showMode(1); break; case "prev": case "next": var j = c.modes[this.viewMode].navStep * (n[0].className == "prev" ? -1 : 1); switch (this.viewMode) { case 0: this.viewDate = this.moveMonth(this.viewDate, j); break; case 1: case 2: this.viewDate = this.moveYear(this.viewDate, j); break }this.fill(); break; case "today": var h = new Date(); h = f(h.getFullYear(), h.getMonth(), h.getDate(), 0, 0, 0); this.showMode(-2); var p = this.todayBtn == "linked" ? null : "view"; this._setDate(h, p); break }break; case "span": if (!n.is(".disabled")) { this.viewDate.setUTCDate(1); if (n.is(".month")) { var l = n.parent().find("span").index(n); this.viewDate.setUTCMonth(l); this.element.trigger({ type: "changeMonth", date: this.viewDate }) } else { var k = parseInt(n.text(), 10) || 0; this.viewDate.setUTCFullYear(k); this.element.trigger({ type: "changeYear", date: this.viewDate }) } this.showMode(-1); this.fill() } break; case "td": if (n.is(".day") && !n.is(".disabled")) { var g = parseInt(n.text(), 10) || 1; var k = this.viewDate.getUTCFullYear(), l = this.viewDate.getUTCMonth(); if (n.is(".old")) { if (l === 0) { l = 11; k -= 1 } else { l -= 1 } } else { if (n.is(".new")) { if (l == 11) { l = 0; k += 1 } else { l += 1 } } } this._setDate(f(k, l, g, 0, 0, 0, 0)) } break } } }, _setDate: function (g, j) { if (!j || j == "date") { this.date = g } if (!j || j == "view") { this.viewDate = g } this.fill(); this.setValue(); this.element.trigger({ type: "changeDate", date: this.date }); var h; if (this.isInput) { h = this.element } else { if (this.component) { h = this.element.find("input") } } if (h) { h.change(); if (this.autoclose && (!j || j == "date")) { this.hide() } } }, moveMonth: function (g, h) { if (!h) { return g } var l = new Date(g.valueOf()), q = l.getUTCDate(), n = l.getUTCMonth(), k = Math.abs(h), p, o; h = h > 0 ? 1 : -1; if (k == 1) { o = h == -1 ? function () { return l.getUTCMonth() == n } : function () { return l.getUTCMonth() != p }; p = n + h; l.setUTCMonth(p); if (p < 0 || p > 11) { p = (p + 12) % 12 } } else { for (var j = 0; j < k; j++) { l = this.moveMonth(l, h) } p = l.getUTCMonth(); l.setUTCDate(q); o = function () { return p != l.getUTCMonth() } } while (o()) { l.setUTCDate(--q); l.setUTCMonth(p) } return l }, moveYear: function (h, g) { return this.moveMonth(h, g * 12) }, dateWithinRange: function (g) { return g >= this.startDate && g <= this.endDate }, keydown: function (p) { if (this.picker.is(":not(:visible)")) { if (p.keyCode == 27) { this.show() } return } var k = false, j, h, o, g, n; switch (p.keyCode) { case 27: this.hide(); p.preventDefault(); break; case 37: case 39: if (!this.keyboardNavigation) { break } j = p.keyCode == 37 ? -1 : 1; if (p.ctrlKey) { g = this.moveYear(this.date, j); n = this.moveYear(this.viewDate, j) } else { if (p.shiftKey) { g = this.moveMonth(this.date, j); n = this.moveMonth(this.viewDate, j) } else { g = new Date(this.date); g.setUTCDate(this.date.getUTCDate() + j); n = new Date(this.viewDate); n.setUTCDate(this.viewDate.getUTCDate() + j) } } if (this.dateWithinRange(g)) { this.date = g; this.viewDate = n; this.setValue(); this.update(); p.preventDefault(); k = true } break; case 38: case 40: if (!this.keyboardNavigation) { break } j = p.keyCode == 38 ? -1 : 1; if (p.ctrlKey) { g = this.moveYear(this.date, j); n = this.moveYear(this.viewDate, j) } else { if (p.shiftKey) { g = this.moveMonth(this.date, j); n = this.moveMonth(this.viewDate, j) } else { g = new Date(this.date); g.setUTCDate(this.date.getUTCDate() + j * 7); n = new Date(this.viewDate); n.setUTCDate(this.viewDate.getUTCDate() + j * 7) } } if (this.dateWithinRange(g)) { this.date = g; this.viewDate = n; this.setValue(); this.update(); p.preventDefault(); k = true } break; case 13: this.hide(); p.preventDefault(); break; case 9: this.hide(); break }if (k) { this.element.trigger({ type: "changeDate", date: this.date }); var l; if (this.isInput) { l = this.element } else { if (this.component) { l = this.element.find("input") } } if (l) { l.change() } } }, showMode: function (g) { if (g) { this.viewMode = Math.max(0, Math.min(2, this.viewMode + g)) } this.picker.find(">div").hide().filter(".datepicker-" + c.modes[this.viewMode].clsName).show(); this.updateNavArrows() } }; d.fn.datepicker = function (h) { var g = Array.apply(null, arguments); g.shift(); return this.each(function () { var l = d(this), k = l.data("datepicker"), j = typeof h == "object" && h; if (!k) { l.data("datepicker", (k = new a(this, d.extend({}, d.fn.datepicker.defaults, j)))) } if (typeof h == "string" && typeof k[h] == "function") { k[h].apply(k, g) } }) }; d.fn.datepicker.defaults = {}; d.fn.datepicker.Constructor = a; var e = d.fn.datepicker.dates = { en: { days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"], daysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"], daysMin: ["Su", "Mo", "Tu", "We", "Th", "Fr", "Sa", "Su"], months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], monthsShort: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], today: "Today" } }; var c = { modes: [{ clsName: "days", navFnc: "Month", navStep: 1 }, { clsName: "months", navFnc: "FullYear", navStep: 1 }, { clsName: "years", navFnc: "FullYear", navStep: 10 }], isLeapYear: function (g) { return (((g % 4 === 0) && (g % 100 !== 0)) || (g % 400 === 0)) }, getDaysInMonth: function (g, h) { return [31, (c.isLeapYear(g) ? 29 : 28), 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][h] }, validParts: /dd?|mm?|MM?|yy(?:yy)?/g, nonpunctuation: /[^ -\/:-@\[-`{-~\t\n\r]+/g, parseFormat: function (j) { var g = j.replace(this.validParts, "\0").split("\0"), h = j.match(this.validParts); if (!g || !g.length || !h || h.length == 0) { throw new Error("Invalid date format.") } return { separators: g, parts: h } }, parseDate: function (k, u, o) { if (k instanceof Date) { return k } if (/^[-+]\d+[dmwy]([\s,]+[-+]\d+[dmwy])*$/.test(k)) { var w = /([-+]\d+)([dmwy])/, n = k.match(/([-+]\d+)([dmwy])/g), g, l; k = new Date(); for (var p = 0; p < n.length; p++) { g = w.exec(n[p]); l = parseInt(g[1]); switch (g[2]) { case "d": k.setUTCDate(k.getUTCDate() + l); break; case "m": k = a.prototype.moveMonth.call(a.prototype, k, l); break; case "w": k.setUTCDate(k.getUTCDate() + l * 7); break; case "y": k = a.prototype.moveYear.call(a.prototype, k, l); break } } return f(k.getUTCFullYear(), k.getUTCMonth(), k.getUTCDate(), 0, 0, 0) } var n = k && k.match(this.nonpunctuation) || [], k = new Date(), r = {}, t = ["yyyy", "yy", "M", "MM", "m", "mm", "d", "dd"], v = { yyyy: function (y, s) { return y.setUTCFullYear(s) }, yy: function (y, s) { return y.setUTCFullYear(2000 + s) }, m: function (y, s) { s -= 1; while (s < 0) { s += 12 } s %= 12; y.setUTCMonth(s); while (y.getUTCMonth() != s) { y.setUTCDate(y.getUTCDate() - 1) } return y }, d: function (y, s) { return y.setUTCDate(s) } }, j, q, g; v.M = v.MM = v.mm = v.m; v.dd = v.d; k = f(k.getFullYear(), k.getMonth(), k.getDate(), 0, 0, 0); if (n.length == u.parts.length) { for (var p = 0, h = u.parts.length; p < h; p++) { j = parseInt(n[p], 10); g = u.parts[p]; if (isNaN(j)) { switch (g) { case "MM": q = d(e[o].months).filter(function () { var s = this.slice(0, n[p].length), y = n[p].slice(0, s.length); return s == y }); j = d.inArray(q[0], e[o].months) + 1; break; case "M": q = d(e[o].monthsShort).filter(function () { var s = this.slice(0, n[p].length), y = n[p].slice(0, s.length); return s == y }); j = d.inArray(q[0], e[o].monthsShort) + 1; break } } r[g] = j } for (var p = 0, x; p < t.length; p++) { x = t[p]; if (x in r && !isNaN(r[x])) { v[x](k, r[x]) } } } return k }, formatDate: function (g, l, o) { var n = { d: g.getUTCDate(), m: g.getUTCMonth() + 1, M: e[o].monthsShort[g.getUTCMonth()], MM: e[o].months[g.getUTCMonth()], yy: g.getUTCFullYear().toString().substring(2), yyyy: g.getUTCFullYear() }; n.dd = (n.d < 10 ? "0" : "") + n.d; n.mm = (n.m < 10 ? "0" : "") + n.m; var g = [], k = d.extend([], l.separators); for (var j = 0, h = l.parts.length; j < h; j++) { if (k.length) { g.push(k.shift()) } g.push(n[l.parts[j]]) } return g.join("") }, headTemplate: '<thead><tr><th class="prev"><i class="icon-arrow-left"/></th><th colspan="5" class="switch"></th><th class="next"><i class="icon-arrow-right"/></th></tr></thead>', contTemplate: '<tbody><tr><td colspan="7"></td></tr></tbody>', footTemplate: '<tfoot><tr><th colspan="7" class="today"></th></tr></tfoot>' }; c.template = '<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">' + c.headTemplate + "<tbody></tbody>" + c.footTemplate + '</table></div><div class="datepicker-months"><table class="table-condensed">' + c.headTemplate + c.contTemplate + c.footTemplate + '</table></div><div class="datepicker-years"><table class="table-condensed">' + c.headTemplate + c.contTemplate + c.footTemplate + "</table></div></div>" }(window.jQuery); !function (c) { var b = function (e, d) { this.options = c.extend({}, c.fn.affix.defaults, d); this.$window = c(window).on("scroll.affix.data-api", c.proxy(this.checkPosition, this)).on("click.affix.data-api", c.proxy(function () { setTimeout(c.proxy(this.checkPosition, this), 1) }, this)); this.$element = c(e); this.checkPosition() }; b.prototype.checkPosition = function () { if (!this.$element.is(":visible")) { return } var h = c(document).height(), k = this.$window.scrollTop(), d = this.$element.offset(), l = this.options.offset, f = l.bottom, g = l.top, j = "affix affix-top affix-bottom", e; if (typeof l != "object") { f = g = l } if (typeof g == "function") { g = l.top() } if (typeof f == "function") { f = l.bottom() } e = this.unpin != null && (k + this.unpin <= d.top) ? false : f != null && (d.top + this.$element.height() >= h - f) ? "bottom" : g != null && k <= g ? "top" : false; if (this.affixed === e) { return } this.affixed = e; this.unpin = e == "bottom" ? d.top - k : null; this.$element.removeClass(j).addClass("affix" + (e ? "-" + e : "")) }; var a = c.fn.affix; c.fn.affix = function (d) { return this.each(function () { var g = c(this), f = g.data("affix"), e = typeof d == "object" && d; if (!f) { g.data("affix", (f = new b(this, e))) } if (typeof d == "string") { f[d]() } }) }; c.fn.affix.Constructor = b; c.fn.affix.defaults = { offset: 0 }; c.fn.affix.noConflict = function () { c.fn.affix = a; return this }; c(window).on("load", function () { c('[data-spy="affix"]').each(function () { var e = c(this), d = e.data(); d.offset = d.offset || {}; d.offsetBottom && (d.offset.bottom = d.offsetBottom); d.offsetTop && (d.offset.top = d.offsetTop); e.affix(d) }) }) }(window.jQuery); !function (b) { var a = function (d, c) { this.init("tooltip", d, c) }; a.prototype = { constructor: a, init: function (f, e, d) { var g, c; this.type = f; this.$element = b(e); this.options = this.getOptions(d); this.enabled = true; if (this.options.trigger != "manual") { g = this.options.trigger == "hover" ? "mouseenter" : "focus"; c = this.options.trigger == "hover" ? "mouseleave" : "blur"; this.$element.on(g, this.options.selector, b.proxy(this.enter, this)); this.$element.on(c, this.options.selector, b.proxy(this.leave, this)) } this.options.selector ? (this._options = b.extend({}, this.options, { trigger: "manual", selector: "" })) : this.fixTitle() }, getOptions: function (c) { c = b.extend({}, b.fn[this.type].defaults, c, this.$element.data()); if (c.delay && typeof c.delay == "number") { c.delay = { show: c.delay, hide: c.delay } } return c }, enter: function (d) { var c = b(d.currentTarget)[this.type](this._options).data(this.type); if (!c.options.delay || !c.options.delay.show) { return c.show() } clearTimeout(this.timeout); c.hoverState = "in"; this.timeout = setTimeout(function () { if (c.hoverState == "in") { c.show() } }, c.options.delay.show) }, leave: function (d) { var c = b(d.currentTarget)[this.type](this._options).data(this.type); if (this.timeout) { clearTimeout(this.timeout) } if (!c.options.delay || !c.options.delay.hide) { return c.hide() } c.hoverState = "out"; this.timeout = setTimeout(function () { if (c.hoverState == "out") { c.hide() } }, c.options.delay.hide) }, show: function () { var g, c, j, e, h, d, f; if (this.hasContent() && this.enabled) { g = this.tip(); this.setContent(); if (this.options.animation) { g.addClass("fade") } d = typeof this.options.placement == "function" ? this.options.placement.call(this, g[0], this.$element[0]) : this.options.placement; c = /in/.test(d); g.remove().css({ top: 0, left: 0, display: "block" }).appendTo(c ? this.$element : document.body); j = this.getPosition(c); e = g[0].offsetWidth; h = g[0].offsetHeight; switch (c ? d.split(" ")[1] : d) { case "bottom": f = { top: j.top + j.height, left: j.left + j.width / 2 - e / 2 }; break; case "top": f = { top: j.top - h, left: j.left + j.width / 2 - e / 2 }; break; case "left": f = { top: j.top + j.height / 2 - h / 2, left: j.left - e }; break; case "right": f = { top: j.top + j.height / 2 - h / 2, left: j.left + j.width }; break }g.css(f).addClass(d).addClass("in") } }, isHTML: function (c) { return typeof c != "string" || (c.charAt(0) === "<" && c.charAt(c.length - 1) === ">" && c.length >= 3) || /^(?:[^<]*<[\w\W]+>[^>]*$)/.exec(c) }, setContent: function () { var d = this.tip(), c = this.getTitle(); d.find(".tooltip-inner")[this.isHTML(c) ? "html" : "text"](c); d.removeClass("fade in top bottom left right") }, hide: function () { var c = this, d = this.tip(); d.removeClass("in"); function e() { var f = setTimeout(function () { d.off(b.support.transition.end).remove() }, 500); d.one(b.support.transition.end, function () { clearTimeout(f); d.remove() }) } b.support.transition && this.$tip.hasClass("fade") ? e() : d.remove() }, fixTitle: function () { var c = this.$element; if (c.attr("title") || typeof (c.attr("data-original-title")) != "string") { c.attr("data-original-title", c.attr("title") || "").removeAttr("title") } }, hasContent: function () { return this.getTitle() }, getPosition: function (c) { return b.extend({}, (c ? { top: 0, left: 0 } : this.$element.offset()), { width: this.$element[0].offsetWidth, height: this.$element[0].offsetHeight }) }, getTitle: function () { var e, c = this.$element, d = this.options; e = c.attr("data-original-title") || (typeof d.title == "function" ? d.title.call(c[0]) : d.title); return e }, tip: function () { return this.$tip = this.$tip || b(this.options.template) }, validate: function () { if (!this.$element[0].parentNode) { this.hide(); this.$element = null; this.options = null } }, enable: function () { this.enabled = true }, disable: function () { this.enabled = false }, toggleEnabled: function () { this.enabled = !this.enabled }, toggle: function () { this[this.tip().hasClass("in") ? "hide" : "show"]() } }; b.fn.tooltip = function (c) { return this.each(function () { var f = b(this), e = f.data("tooltip"), d = typeof c == "object" && c; if (!e) { f.data("tooltip", (e = new a(this, d))) } if (typeof c == "string") { e[c]() } }) }; b.fn.tooltip.Constructor = a; b.fn.tooltip.defaults = { animation: true, placement: "bottom", selector: false, template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>', trigger: "hover", title: "", delay: 300 } }(window.jQuery); !function (b) { var c = function (e, d) { this.$element = b(e); this.$indicators = this.$element.find(".carousel-indicators"); this.options = d; this.options.pause == "hover" && this.$element.on("mouseenter", b.proxy(this.pause, this)).on("mouseleave", b.proxy(this.cycle, this)) }; c.prototype = { cycle: function (d) { if (!d) { this.paused = false } if (this.interval) { clearInterval(this.interval) } this.options.interval && !this.paused && (this.interval = setInterval(b.proxy(this.next, this), this.options.interval)); return this }, getActiveIndex: function () { this.$active = this.$element.find(".item.active"); this.$items = this.$active.parent().children(); return this.$items.index(this.$active) }, to: function (f) { var d = this.getActiveIndex(), e = this; if (f > (this.$items.length - 1) || f < 0) { return } if (this.sliding) { return this.$element.one("slid", function () { e.to(f) }) } if (d == f) { return this.pause().cycle() } return this.slide(f > d ? "next" : "prev", b(this.$items[f])) }, pause: function (d) { if (!d) { this.paused = true } if (this.$element.find(".next, .prev").length && b.support.transition.end) { this.$element.trigger(b.support.transition.end); this.cycle(true) } clearInterval(this.interval); this.interval = null; return this }, next: function () { if (this.sliding) { return } return this.slide("next") }, prev: function () { if (this.sliding) { return } return this.slide("prev") }, slide: function (l, f) { var o = this.$element.find(".item.active"), d = f || o[l](), k = this.interval, n = l == "next" ? "left" : "right", g = l == "next" ? "first" : "last", h = this, j; this.sliding = true; k && this.pause(); d = d.length ? d : this.$element.find(".item")[g](); j = b.Event("slide", { relatedTarget: d[0], direction: n }); if (d.hasClass("active")) { return } if (this.$indicators.length) { this.$indicators.find(".active").removeClass("active"); this.$element.one("slid", function () { var e = b(h.$indicators.children()[h.getActiveIndex()]); e && e.addClass("active") }) } if (b.support.transition && this.$element.hasClass("slide")) { this.$element.trigger(j); if (j.isDefaultPrevented()) { return } d.addClass(l); d[0].offsetWidth; o.addClass(n); d.addClass(n); this.$element.one(b.support.transition.end, function () { d.removeClass([l, n].join(" ")).addClass("active"); o.removeClass(["active", n].join(" ")); h.sliding = false; setTimeout(function () { h.$element.trigger("slid") }, 0) }) } else { this.$element.trigger(j); if (j.isDefaultPrevented()) { return } o.removeClass("active"); d.addClass("active"); this.sliding = false; this.$element.trigger("slid") } k && this.cycle(); return this } }; var a = b.fn.carousel; b.fn.carousel = function (d) { return this.each(function () { var h = b(this), g = h.data("carousel"), e = b.extend({}, b.fn.carousel.defaults, typeof d == "object" && d), f = typeof d == "string" ? d : e.slide; if (!g) { h.data("carousel", (g = new c(this, e))) } if (typeof d == "number") { g.to(d) } else { if (f) { g[f]() } else { if (e.interval) { g.pause().cycle() } } } }) }; b.fn.carousel.defaults = { interval: 5000, pause: "hover" }; b.fn.carousel.Constructor = c; b.fn.carousel.noConflict = function () { b.fn.carousel = a; return this }; b(document).on("click.carousel.data-api", "[data-slide], [data-slide-to]", function (k) { var j = b(this), f, d = b(j.attr("data-target") || (f = j.attr("href")) && f.replace(/.*(?=#[^\s]+$)/, "")), g = b.extend({}, d.data(), j.data()), h; d.carousel(g); if (h = j.attr("data-slide-to")) { d.data("carousel").pause().to(h).cycle() } k.preventDefault() }) }(window.jQuery); !function (b) { function a(f, e) { var g = b.proxy(this.process, this), c = b(f).is("body") ? b(window) : b(f), d; this.options = b.extend({}, b.fn.scrollspy.defaults, e); this.$scrollElement = c.on("scroll.scroll.data-api", g); this.selector = (this.options.target || ((d = b(f).attr("href")) && d.replace(/.*(?=#[^\s]+$)/, "")) || "") + " .nav li > a"; this.$body = b("body"); this.refresh(); this.process() } a.prototype = { constructor: a, refresh: function () { var c = this, d; this.offsets = b([]); this.targets = b([]); d = this.$body.find(this.selector).map(function () { var f = b(this), e = f.data("target") || f.attr("href"), g = /^#\w/.test(e) && b(e); return (g && e.length && [[g.position().top, e]]) || null }).sort(function (f, e) { return f[0] - e[0] }).each(function () { c.offsets.push(this[0]); c.targets.push(this[1]) }) }, process: function () { var h = this.$scrollElement.scrollTop() + this.options.offset, e = this.$scrollElement[0].scrollHeight || this.$body[0].scrollHeight, g = e - this.$scrollElement.height(), f = this.offsets, c = this.targets, j = this.activeTarget, d; if (h >= g) { return j != (d = c.last()[0]) && this.activate(d) } for (d = f.length; d--;) { j != c[d] && h >= f[d] && (!f[d + 1] || h <= f[d + 1]) && this.activate(c[d]) } }, activate: function (e) { var d, c; this.activeTarget = e; b(this.selector).parent(".active").removeClass("active"); c = this.selector + '[data-target="' + e + '"],' + this.selector + '[href="' + e + '"]'; d = b(c).parent("li").addClass("active"); if (d.parent(".dropdown-menu")) { d = d.closest("li.dropdown").addClass("active") } d.trigger("activate") } }; b.fn.scrollspy = function (c) { return this.each(function () { var f = b(this), e = f.data("scrollspy"), d = typeof c == "object" && c; if (!e) { f.data("scrollspy", (e = new a(this, d))) } if (typeof c == "string") { e[c]() } }) }; b.fn.scrollspy.Constructor = a; b.fn.scrollspy.defaults = { offset: 10 }; b(function () { b('[data-spy="scroll"]').each(function () { var c = b(this); c.scrollspy(c.data()) }) }) }(window.jQuery);
/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */
;
/*! NOTE: If you're already including a window.matchMedia polyfill via Modernizr or otherwise, you don't need this part */
; window.matchMedia = window.matchMedia || (function (n, l) { var p, j = n.documentElement, h = j.firstElementChild || j.firstChild, o = n.createElement("body"), k = n.createElement("div"); k.id = "mq-test-1"; k.style.cssText = "position:absolute;top:-100em"; o.style.background = "none"; o.appendChild(k); return function (a) { k.innerHTML = '&shy;<style media="' + a + '"> #mq-test-1 { width: 42px; }</style>'; j.insertBefore(o, h); p = k.offsetWidth == 42; j.removeChild(o); return { matches: p, media: a } } })(document);
/*! Respond.js v1.1.0: min/max-width media query polyfill. (c) Scott Jehl. MIT/GPLv2 Lic. j.mp/respondjs  */
(function (P) { P.respond = {}; respond.update = function () { }; respond.mediaQueriesSupported = P.matchMedia && P.matchMedia("only all").matches; if (respond.mediaQueriesSupported) { return } var x = P.document, B = x.documentElement, L = [], J = [], D = [], F = {}, M = 30, O = x.getElementsByTagName("head")[0] || B, N = x.getElementsByTagName("base")[0], T = O.getElementsByTagName("link"), R = [], U = function () { var c = T, g = c.length, f = 0, b, e, d, a; for (; f < g; f++) { b = c[f], e = b.href, d = b.media, a = b.rel && b.rel.toLowerCase() === "stylesheet"; if (!!e && a && !F[e]) { if (b.styleSheet && b.styleSheet.rawCssText) { H(b.styleSheet.rawCssText, e, d); F[e] = true } else { if ((!/^([a-zA-Z:]*\/\/)/.test(e) && !N) || e.replace(RegExp.$1, "").split("/")[0] === P.location.host) { R.push({ href: e, media: d }) } } } } z() }, z = function () { if (R.length) { var a = R.shift(); G(a.href, function (b) { H(b, a.href, a.media); F[a.href] = true; z() }) } }, H = function (j, h, e) { var l = j.match(/@media[^\{]+\{([^\{\}]*\{[^\}\{]*\})+/gi), g = l && l.length || 0, h = h.substring(0, h.lastIndexOf("/")), f = function (p) { return p.replace(/(url\()['"]?([^\/\)'"][^:\)'"]+)['"]?(\))/g, "$1" + h + "$2$3") }, d = !g && e, a = 0, b, o, n, c, k; if (h.length) { h += "/" } if (d) { g = 1 } for (; a < g; a++) { b = 0; if (d) { o = e; J.push(f(j)) } else { o = l[a].match(/@media *([^\{]+)\{([\S\s]+?)$/) && RegExp.$1; J.push(RegExp.$2 && f(RegExp.$2)) } c = o.split(","); k = c.length; for (; b < k; b++) { n = c[b]; L.push({ media: n.split("(")[0].match(/(only\s+)?([a-zA-Z]+)\s?/) && RegExp.$2 || "all", rules: J.length - 1, hasquery: n.indexOf("(") > -1, minw: n.match(/\(min\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/) && parseFloat(RegExp.$1) + (RegExp.$2 || ""), maxw: n.match(/\(max\-width:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/) && parseFloat(RegExp.$1) + (RegExp.$2 || "") }) } } K() }, I, C, y = function () { var c, b = x.createElement("div"), a = x.body, d = false; b.style.cssText = "position:absolute;font-size:1em;width:1em"; if (!a) { a = d = x.createElement("body"); a.style.background = "none" } a.appendChild(b); B.insertBefore(a, B.firstChild); c = b.offsetWidth; if (d) { B.removeChild(a) } else { a.removeChild(b) } c = E = parseFloat(c); return c }, E, K = function (n) { var l = "clientWidth", c = B[l], o = x.compatMode === "CSS1Compat" && c || x.body[l] || c, a = {}, p = T[T.length - 1], g = (new Date()).getTime(); if (n && I && g - I < M) { clearTimeout(C); C = setTimeout(K, M); return } else { I = g } for (var r in L) { var j = L[r], b = j.minw, k = j.maxw, d = b === null, f = k === null, h = "em"; if (!!b) { b = parseFloat(b) * (b.indexOf(h) > -1 ? (E || y()) : 1) } if (!!k) { k = parseFloat(k) * (k.indexOf(h) > -1 ? (E || y()) : 1) } if (!j.hasquery || (!d || !f) && (d || o >= b) && (f || o <= k)) { if (!a[j.media]) { a[j.media] = [] } a[j.media].push(J[j.rules]) } } for (var r in D) { if (D[r] && D[r].parentNode === O) { O.removeChild(D[r]) } } for (var r in a) { var e = x.createElement("style"), q = a[r].join("\n"); e.type = "text/css"; e.media = r; O.insertBefore(e, p.nextSibling); if (e.styleSheet) { e.styleSheet.cssText = q } else { e.appendChild(x.createTextNode(q)) } D.push(e) } }, G = function (a, b) { var c = S(); if (!c) { return } c.open("GET", a, true); c.onreadystatechange = function () { if (c.readyState != 4 || c.status != 200 && c.status != 304) { return } b(c.responseText) }; if (c.readyState == 4) { return } c.send(null) }, S = (function () { var a = false; try { a = new XMLHttpRequest() } catch (b) { a = new ActiveXObject("Microsoft.XMLHTTP") } return function () { return a } })(); U(); respond.update = U; function A() { K(true) } if (P.addEventListener) { P.addEventListener("resize", A, false) } else { if (P.attachEvent) { P.attachEvent("onresize", A) } } })(this); (function (a) { a.fn.inViewport = function (b) { var l = parseInt(a(window).scrollLeft()), n = parseInt(a(window).width() + l), g = parseInt(a(window).scrollTop()), h = parseInt(a(window).height() + g); var d = parseInt(this.offset().left), j = parseInt(d + this.outerWidth()), e = parseInt(this.offset().top), k = parseInt(e + this.outerHeight()); var c = d >= l && j <= n, f = e >= g && k <= h; if (b == "vertical") { return f } else { if (b == "horizontal") { return c } else { return c && f } } } }(jQuery)); if (typeof console === "undefined" || typeof console.log === "undefined") { console = { log: function () { } } } $(document).ajaxError(function (c, b, d, a) { if (d.url.indexOf("track.iconfinder.com") > 0) { return } Raven.captureMessage(a || b.statusText, { extra: { type: d.type, url: d.url, data: d.data, status: b.status, error: a || b.statusText, response: b.responseText } }) }); $(document).ready(function () { if ($("#navigation").length) { var b = $("#navigation").offset().top; var c = $(".homepage-header, .landingpage header, .hero.hypeanimation"); if (c.length) { b = c.offset().top + c.outerHeight(); $("body").addClass("nav-fade") } $(window).on("load scroll", function () { $("body").toggleClass("nav-fixed", $(window).scrollTop() > b); $(".autosuggest").fadeOut("fast") }) }  Nextfinder.comments.init(); Nextfinder.notification_messages.init(); $(function () { $("input, textarea").placeholder() }); $(".filter-tab a").on("click", function () { $(".filter-menu").animate({ height: "toggle" }, 0) }); $(".filter-tab a").on("click", function () { if ($("#searchresults-outer").hasClass("active")) { $(this).removeClass("active"); $("#searchresults-outer, .footer.contentpage").removeClass("active") } else { $(this).addClass("active"); $("#searchresults-outer, .footer.contentpage").addClass("active") } }); if ($(".filter-tab a").hasClass("active")) { $("#searchresults-outer, .footer.contentpage").addClass("active") } else { $("#searchresults-outer, .footer.contentpage").removeClass("active") } if (window.location.hash === "#intro-video") { var a = $("#video-intro-container"); videoPopUp(a) } $("#filters .filter .btn, #filters .filter .btn-group").click(function () { $(this).parent("div").addClass("active") }); $(".close-filter, .close-filter img, .default").click(function () { $(this).parent("div").removeClass("active") }); $("input.autocomplete").each(function (d) { var f = $(this).attr("id"); if ($("input.autocomplete").length > 1) { f += d; $(this).attr("id", f) } var e = new AutoSuggest(f, { script: "/ajax/autocomplete/?", varname: "input" }) }) }); $(document).on("click", ".scrolltotop", function () { window.scrollTo(0, 0); return false; return true }); $(document).on("click", ".page-overlay", function () { $("#modal").modal("hide"); return false }); $(document).on("focus", "input.autocomplete", function () { $(this).siblings().addClass("btn-primary") }); $(document).on("blur", "input.autocomplete", function () { $(this).siblings().removeClass("btn-primary") }); $(document).keydown(handleKey); function handleKey(f) { if ($(".pagination").is(":visible")) { var b = 37; var a = 39; if (f.target.localName == "body" || f.target.localName == "html") { if (!f.ctrlKey && !f.altKey && !f.shiftKey && !f.metaKey) { var d = f.which; if (d == b) { prevPage() } else { if (d == a) { nextPage() } } } } } if (f.which == 27) { if ($(".comments-overlay").is(":visible")) { window.Nextfinder.comments.hideCommentsOverlay() } if ($(".share-button").hasClass("active")) { $(".share-button").removeClass("active") } if ($(".escapable").is(":visible")) { var c = $("video"); $(c).each(function () { var e = $(this).get(0); if (!e.paused) { e.pause() } else { e.play() } }); $(".escapable:visible").each(function () { if ($(this).hasClass("on-escape-hide")) { $(this).fadeOut(function () { }) } else { $(this).fadeOut(function () { $(this).remove() }) } }) } } if (f.which == 67) { if ($(".bitly-short").is(":visible")) { $.pnotify({ pnotify_title: "URL was copied to clipboard", pnotify_history: false }); $(".bitly-short").fadeOut("slow"); setTimeout(function () { $(".bitly-short").remove() }, 2000) } } } function prevPage() { var a = $(".pageslist .prev").attr("href"); if (a && a != document.location) { document.location = a } } function nextPage() { var a = $(".pageslist .next").attr("href"); if (a && a != document.location) { document.location = a } } $(document).on("click", ".share-button", function (a) { a.preventDefault(); $(this).toggleClass("active") }); function showSharingWindow(b, e, a) { var d = (window.screen.width - e) / 2, c = (window.screen.height - a) / 2; window.open(b, "SharingWindow", "status=1,height=" + a + ",width=" + e + ",resizable=0,screenX=" + d + ",screenY=" + c) } $(document).on("click", ".if-twitter", function (c) { c.preventDefault(); var b = $('meta[name="twitter:title"]').attr("content") || $('meta[name="description"]').attr("content"); var a = "http://www.twitter.com/share?text=" + b + "&url=" + encodeURIComponent(getCampaignTrackingURL($(location).attr("href"), "twitter")); showSharingWindow(a, 550, 300); return false }); $(document).on("click", ".if-facebook", function (b) { b.preventDefault(); var a = "https://www.facebook.com/dialog/feed?app_id=" + FACEBOOK_APP_ID + "&link=" + getCampaignTrackingURL($(location).attr("href"), "facebook"); showSharingWindow(a, 700, 320); return false }); $(document).on("click", ".if-link", function (d) { d.preventDefault(); var a = $(this); var c = getCampaignTrackingURL($(location).attr("href"), "link"); var b; $("body").prepend("<div class='bitly-short overlay escapable'><h1>Copy URL below</h1><input id='bitly-short-input' type='text' value='Generating short url ...' readonly /></div>"); $.getJSON("https://api-ssl.bitly.com/v3/shorten?callback=?", { format: "json", apiKey: "R_a2533566c06cbd8702c83c2d45b4bff9", login: "iconfinder", longUrl: c }, function (e) { if (e.status_txt == "OK") { b = e.data.url; $("#bitly-short-input").eq(0).val(b).focus().select() } else { $.pnotify({ pnotify_title: "Something went wrong when generating a shortened URL: " + e.status_txt, pnotify_history: false }) } }); return false }); $(document).on("click", ".bitly-short input[type='text']", function () { $(this).select() }); function getCampaignTrackingURL(d, b) { var e = d.indexOf("?") === -1 ? "?" : "&"; var a = "utm_source=sharing-feature&utm_medium=social&utm_content=" + b + "&utm_campaign=sharing-feature"; var c = typeof USER !== "undefined" ? "ref=" + USER.username + "&" : ""; return d + e + c + a } $.urlParam = function (b) { var a = RegExp("[?&]" + b + "=([^&]*)").exec(window.location.search); return a && decodeURIComponent(a[1].replace(/\+/g, " ")) }; $(document).click(function () { hideInfoMenu($(document).find(".infomenu")) }); $(document).on("click", ".infolink", function () { showInfoMenu($(this).closest("[data-icon-id]").attr("data-icon-id"), $(this).position().left); return false }); function showInfoMenu(b, a) { hideInfoMenu($(document).find(".infomenu")); infomenu = $("#infomenu-" + b); $("#infolink-" + b).addClass("selected"); infomenu.css("display", "block"); if (infomenu.position().left > 140) { infomenu.css("left", (a - 140) + "px") } infomenu.addClass("loading"); hiddensize = $("#size-" + b).val(); $.get("/icons/ajax/" + b + "/" + hiddensize + "/info", function (c) { infomenu.html(c); infomenu.removeClass("loading"); Nextfinder.tracking.trackEvent("Search results", "Info menu", "Show info") }); obj = null; b = null; hiddensize = null; return false } function hideInfoMenu(a) { a.siblings(".infolink").removeClass("selected"); a.fadeOut("fast") } function videoPopUp(a) { $('<div class="modal-backdrop escapable" />').appendTo(document.body); var b = $(a).find("video").get(0); $(a).fadeIn("fast"); b.play() } $(document).on("click", "[data-action='video-play']", function () { $("body").find("video").get(0).pause(); var a = $("#" + $(this).data("video-container")); videoPopUp(a) }); $(document).on("click", "a.external", function () { Nextfinder.tracking.trackEvent("Links", "External", $(this).attr("href")) }); $(document).on("click", '[data-action="iconset-promote"]', function (b) { b.preventDefault(); var a = $(this).closest("[data-iconset-id]"); var c = a.attr("data-iconset-id"); nfx.services.iconsetPromotionService.promote(c); $('[data-action="iconset-promote"]').hide(); $('[data-action="iconset-demote"]').show() }); $(document).on("click", '[data-action="iconset-demote"]', function (b) { b.preventDefault(); var a = $(this).closest("[data-iconset-id]"); var c = a.attr("data-iconset-id"); nfx.services.iconsetPromotionService.demote(c); $('[data-action="iconset-demote"]').hide(); $('[data-action="iconset-promote"]').show() }); $(document).on("click", '[data-action="send-private-message"]', function (a) { a.preventDefault(); if (!window.USER) { nfx.app.modalStackController.present(new nfx.modules.SignUpModalModule({ onAuthenticate: function () { location.reload() } })); return } nfx.app.modalStackController.present(new nfx.modules.PrivateMessageModalModule({ toUserId: $(this).attr("data-to-user-id") })) }); (function () { var b = Handlebars.template, a = Handlebars.templates = Handlebars.templates || {}; a["comments/templates/not_logged_in.html"] = b(function (f, g, d, c, e) { d = d || f.helpers; return '<section class="newcomment reply">\n    <div class="user-actions">\n        <h4>Please log in or sign up to leave a comment</h4>\n        <a class="login-link btn" href="#">Log in</a>\n        <a class="signup-link btn" href="#">Sign up</a>\n        </div>\n</section>' }); a["comments/templates/reply_form.html"] = b(function (e, n, d, l, k) { d = d || e.helpers; var h = "", c, g, f = "function", j = this.escapeExpression; h += '<form data-role="comment-form" action="'; g = d.submit_url; if (g) { c = g.call(n, { hash: {} }) } else { c = n.submit_url; c = typeof c === f ? c() : c } h += j(c) + '" method="post" class="newcomment reply">\n    <span><textarea rows="10" cols="40" name="text" placeholder="Post a reply"></textarea></span>\n    <span><input type="hidden" name="parent_comment" value="'; g = d.parent_comment_id; if (g) { c = g.call(n, { hash: {} }) } else { c = n.parent_comment_id; c = typeof c === f ? c() : c } h += j(c) + '"></span>\n    <button type="submit" class="btn btn-primary">Post reply</button>\n</form>\n'; return h }); a["helpers/templates/latest_post.html"] = b(function (e, n, d, l, k) { d = d || e.helpers; var h = "", c, g, f = "function", j = this.escapeExpression; h += '<a target="_blank" href="'; g = d.link; if (g) { c = g.call(n, { hash: {} }) } else { c = n.link; c = typeof c === f ? c() : c } h += j(c) + '"><span class="muted">Latest from the blog:</span>  '; g = d.title; if (g) { c = g.call(n, { hash: {} }) } else { c = n.title; c = typeof c === f ? c() : c } h += j(c) + "</a>\n"; return h }); a["iconsets/templates/edit_collection.html"] = b(function (e, l, d, k, j) { d = d || e.helpers; var g = "", c, f = "function", h = this.escapeExpression; g += '<form action="/collections/'; c = l.collection; c = c == null || c === false ? c : c.collection_id; c = typeof c === f ? c() : c; g += h(c) + '/edit" method="post" class="horizontal-form">\n    <section>\n        <p>A collection can be used to group icon sets. E.g. if several icon sets are made in the same style.</p>\n        <p>\n            <label for="id_name">Collection name</label>\n            <span><input id="id_name" type="text" name="name" value="'; c = l.collection; c = c == null || c === false ? c : c.name; c = typeof c === f ? c() : c; g += h(c) + '" placeholder="E.g. Lovely icons" maxlength="100" /></span>\n        </p>\n        <p>\n            <label for="id_description">Description</label>\n            <span class="textarea">\n                <textarea placeholder="This description will be visible to the users." name="description" id="id_description">'; c = l.collection; c = c == null || c === false ? c : c.description; c = typeof c === f ? c() : c; g += h(c) + '</textarea>\n            </span>\n        </p>\n        <p>\n            <label for="id_name">Sort index</label>\n            <span><input id="id_sort_index" type="text" name="sort_index" value="'; c = l.collection; c = c == null || c === false ? c : c.sort_index; c = typeof c === f ? c() : c; g += h(c) + '" maxlength="2" style="width: 50px;" /></span>\n        </p>\n    </section>\n</form>\n'; return g }); a["iconsets/templates/edit_icons_icon.html"] = b(function (g, p, f, o, n) { f = f || g.helpers; var k = "", d, j, h = "function", l = this.escapeExpression, r = this; function e(t, s) { return "true" } function c(t, s) { return "false" } function q(t, s) { return " is-active" } k += '<div class="manage-icon" data-icon-id="new" data-iconset-id="'; j = f.iconset_id; if (j) { d = j.call(p, { hash: {} }) } else { d = p.iconset_id; d = typeof d === h ? d() : d } k += l(d) + '" data-active="'; d = p.is_active; d = f["if"].call(p, d, { hash: {}, inverse: r.program(3, c, n), fn: r.program(1, e, n) }); if (d || d === 0) { k += d } k += '">\n    <table>\n        <tr>\n            <td class="versions">\n                <a href="#" class="activate'; d = p.is_active; d = f["if"].call(p, d, { hash: {}, inverse: r.noop, fn: r.program(5, q, n) }); if (d || d === 0) { k += d } k += '" title="Toggle whether icon is active or not" data-action="toggle-icon-active"></a>\n                <div class="version-container"></div>\n            </td>\n            <td class="tags">\n                <a href="#" class="delete" title="Delete icon" data-action="delete-icon"></a>\n                <h3>Tags</h3>\n                <input type="text" value="'; j = f.tags; if (j) { d = j.call(p, { hash: {} }) } else { d = p.tags; d = typeof d === h ? d() : d } k += l(d) + '" />\n            </td>\n        </tr>\n    </table>\n</div>\n'; return k }); a["iconsets/templates/edit_tags.html"] = b(function (g, p, f, o, n) { f = f || g.helpers; var k = "", c, j, h = "function", l = this.escapeExpression, q = this; function e(u, t) { var r = "", s; r += '\n            <div class="tagslist">\n                <h4>Suggestions:</h4>\n                '; s = u.suggested_tags; s = f.each.call(u, s, { hash: {}, inverse: q.noop, fn: q.program(2, d, t) }); if (s || s === 0) { r += s } r += '\n                <div class="tags_clear"></div>\n            </div>\n        '; return r } function d(t, s) { var r = ""; r += '\n                    <span class="tag" data-tag="'; t = typeof t === h ? t() : t; r += l(t) + '">+ '; t = typeof t === h ? t() : t; r += l(t) + "</span>\n                "; return r } k += '<form action="/iconsets/'; c = p.icon; c = c == null || c === false ? c : c.iconset_id; c = typeof c === h ? c() : c; k += l(c) + "/icons/"; c = p.icon; c = c == null || c === false ? c : c.icon_id; c = typeof c === h ? c() : c; k += l(c) + '/tags" method="post" class="horizontal-form">\n    <section>\n        <p>Tags makes it possible for the users to find the icons. Please add as many meaningful tags as possible.</p>\n        <h3>Current tags:</h3>\n        <input name="tags" type="text" class="tags" value="'; j = f.tags; if (j) { c = j.call(p, { hash: {} }) } else { c = p.tags; c = typeof c === h ? c() : c } k += l(c) + '" />\n        '; c = p.suggested_tags; c = f["if"].call(p, c, { hash: {}, inverse: q.noop, fn: q.program(1, e, n) }); if (c || c === 0) { k += c } k += "\n    </section>\n</form>\n"; return k }); a["iconsets/templates/new_collection.html"] = b(function (f, g, d, c, e) { d = d || f.helpers; return '<section>\n    <form action="/collections/new" method="post" class="horizontal-form">\n        <p>A collection can be used to group icon sets. E.g. if several icon sets are made in the same style.</p>\n        <p>\n            <label for="id_name">Collection name</label>\n            <span><input id="id_name" type="text" name="name" value="" placeholder="E.g. Lovely icons" maxlength="100" /></span>\n        </p>\n        <p>\n            <label for="id_description">Description</label>\n            <span class="textarea">\n                <textarea placeholder="This description will be visible to the users." name="description" id="id_description"></textarea>\n            </span>\n        </p>\n        <p>\n            <label for="id_name">Sort index</label>\n            <span><input id="id_sort_index" type="text" name="sort_index" value="1" maxlength="2" style="width: 50px;" /></span>\n        </p>\n        <label>&nbsp;</label>\n        <span class="checkboxes">\n            <label class="checkbox">\n                <span><input checked type="checkbox" name="is_active" id="id_is_active" /></span>\n                This collection and icon sets are active.\n            </label>\n        </span>\n    </form>\n</section>\n' }); a["modals/templates/change_cover_picture.html"] = b(function (f, g, d, c, e) { d = d || f.helpers; return '<section class="change-cover-picture-modal">\n    <article class="option option-upload">\n        <h3>Upload cover picture</h3>\n        <a href="#" class="btn btn-primary">Upload</a>\n    </article>\n    <article class="option option-reset">\n        <h3>Reset to default</h3>\n        <a href="#" class="btn btn-primary">Reset</a>\n    </article>\n</section>\n' }); a["modals/templates/confirm.html"] = b(function (e, n, d, l, k) { d = d || e.helpers; var h = "", c, g, f = "function", j = this.escapeExpression; h += "<section>\n    <p>"; g = d.message; if (g) { c = g.call(n, { hash: {} }) } else { c = n.message; c = typeof c === f ? c() : c } h += j(c) + "</p>\n</section>\n            \n"; return h }); a["modals/templates/create_collection.html"] = b(function (f, g, d, c, e) { d = d || f.helpers; return '<section>\n    <form id="create_collection_form" action="/collections/new" method="post" class="horizontal-form">\n        <p>A collection can be used to group icon sets. E.g. if several icon sets are made in the same style.</p>\n        <p>\n            <label for="id_name">Collection name</label>\n            <span><input id="id_name" type="text" name="name" value="" placeholder="E.g. Lovely icons" maxlength="100" /></span>\n        </p>\n        <p>\n            <label for="id_description">Description</label>\n            <span class="textarea">\n                <textarea placeholder="This description will be visible to the users." name="description" id="id_description"></textarea>\n            </span>\n        </p>\n        <p>\n            <label for="id_name">Sort index</label>\n            <span><input id="id_sort_index" type="text" name="sort_index" value="1" maxlength="2" style="width: 50px;" /></span>\n        </p>\n    </form>\n</section>\n' }); a["modals/templates/error.html"] = b(function (e, n, d, l, k) { d = d || e.helpers; var h = "", c, g, f = "function", j = this.escapeExpression; h += "<article>\n    <section>\n        <p>"; g = d.message; if (g) { c = g.call(n, { hash: {} }) } else { c = n.message; c = typeof c === f ? c() : c } h += j(c) + "</p>\n    </section>\n</article>\n"; return h }); a["modals/templates/show_datauri.html"] = b(function (e, n, d, l, k) { d = d || e.helpers; var h = "", c, g, f = "function", j = this.escapeExpression; h += '<section>\n    <p>Copy the base64 encoded data URI below and insert it in HTML or CSS. For more information <a href="http://blog.iconfinder.com/base64-encoding-assets-the-what-when-and-how/">read this blog post about data URIs</a>.</p>\n    <textarea class="datauri">'; g = d.datauri; if (g) { c = g.call(n, { hash: {} }) } else { c = n.datauri; c = typeof c === f ? c() : c } h += j(c) + '</textarea>\n    <script>\n        $(".datauri").eq(0).focus().select();\n        $(".datauri").click(function(){\n            $(this).focus().select();\n        });\n    <\/script>\n</section>\n\n'; return h }); a["submissions/templates/submission_upload_files.html"] = b(function (f, t, r, k, x) { r = r || f.helpers; var s = "", g, p = this, d = "function", c = this.escapeExpression, q = r.helperMissing; function o(C, B) { var z = "", A, y; z += "\n                        "; A = C.error; A = r["if"].call(C, A, { hash: {}, inverse: p.program(4, l, B), fn: p.program(2, n, B) }); if (A || A === 0) { z += A } z += "\n							<td>"; y = r.name; if (y) { A = y.call(C, { hash: {} }) } else { A = C.name; A = typeof A === d ? A() : A } z += c(A) + '</td>\n							<td style="width: 100px;">'; A = C.size; y = r.format_size; A = y ? y.call(C, A, { hash: {} }) : q.call(C, "format_size", A, { hash: {} }); z += c(A) + '</td>\n							<td style="width: 150px;">\n								'; A = C.error; A = r["if"].call(C, A, { hash: {}, inverse: p.program(11, w, B), fn: p.program(9, e, B) }); if (A || A === 0) { z += A } z += "\n							</td>\n						</tr>\n					"; return z } function n(z, y) { return '\n                            <tr data-type="file" class="error">\n                        ' } function l(B, A) { var y = "", z; y += "\n						    "; z = B.data; z = r["if"].call(B, z, { hash: {}, inverse: p.program(7, h, A), fn: p.program(5, j, A) }); if (z || z === 0) { y += z } y += "\n                        "; return y } function j(z, y) { return '\n                                <tr data-type="file">\n                            ' } function h(z, y) { return '\n                                <tr data-type="file" class="success">\n                            ' } function e(C, B) { var z = "", A, y; z += "\n									"; y = r.error; if (y) { A = y.call(C, { hash: {} }) } else { A = C.error; A = typeof A === d ? A() : A } z += c(A) + "\n								"; return z } function w(B, A) { var y = "", z; y += "\n									"; z = B.data; z = r["if"].call(B, z, { hash: {}, inverse: p.program(14, u, A), fn: p.program(12, v, A) }); if (z || z === 0) { y += z } y += "\n								"; return y } function v(B, A) { var y = "", z; y += '\n										<div class="progress small-progress progress-striped active"><div class="bar" style="width: '; z = B.progress; z = z == null || z === false ? z : z.percentage; z = typeof z === d ? z() : z; y += c(z) + '%;"></div></div>\n									'; return y } function u(z, y) { return "\n										Uploaded\n									" } s += '<section>\n	<div class="row-fluid">\n		<div class="js-sticky table-actions">\n			<h3>Files</h3>\n		</div>\n		<div class="span12">\n			<table class="table table-striped table-actions table-bordered">\n				<thead>\n					<tr>\n						<th>Filename</th>\n						<th>Size</th>\n						<th>Status</th>\n					</tr>\n				</thead>\n				<tbody>\n					'; g = t.files; g = r.each.call(t, g, { hash: {}, inverse: p.noop, fn: p.program(1, o, x) }); if (g || g === 0) { s += g } s += "\n				</tbody>\n			</table>\n		</div>\n	</div>\n</section>\n"; return s }) })();